---
title: "CMDIFrameWndEx Class"
description: "Learn more about: CMDIFrameWndEx class"
ms.date: 08/16/2022
f1_keywords: ["CMDIFrameWndEx", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ActiveItemRecalcLayout", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AddPane", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AdjustClientArea", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AdjustDockingLayout", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AreMDITabs", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::CanConvertControlBarToMDIChild", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ControlBarToTabbedDocument", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::CreateDocumentWindow", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::CreateNewWindow", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::DockPane", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::DockPaneLeftOf", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableAutoHidePanes", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableDocking", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableFullScreenMainMenu", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableFullScreenMode", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableLoadDockState", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableMDITabbedGroups", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableMDITabs", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableMDITabsLastActiveActivation", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnablePaneMenu", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableWindowsDialog", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetActivePopup", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetPane", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetDefaultResId", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMDITabGroups", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMDITabs", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMDITabsContextMenuAllowedItems", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMenuBar", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetRibbonBar", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetTearOffBars", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetToolbarButtonToolTipText", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::InsertPane", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsFullScreen", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsMDITabbedGroup", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsMemberOfMDITabGroup", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsMenuBarAvailable", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsPointNearDockSite", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsPrintPreview", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::LoadFrame", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::LoadMDIState", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::MDITabMoveToNextGroup", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::MDITabNewGroup", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::NegotiateBorderSpace", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnCloseDockingPane", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnCloseMiniFrame", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnClosePopupMenu", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnCmdMsg", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnDrawMenuImage", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnDrawMenuLogo", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnEraseMDIClientBackground", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnMenuButtonToolHitTest", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnMoveMiniFrame", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnSetPreviewMode", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowCustomizePane", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowMDITabContextMenu", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowPanes", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowPopupMenu", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnSizeMDIClient", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnTearOffMenu", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnUpdateFrameMenu", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::PaneFromPoint", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::RecalcLayout", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::RemovePaneFromDockManager", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::SaveMDIState", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::SetPrintPreviewFrame", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::SetupToolbarMenu", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ShowFullScreen", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ShowPane", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ShowWindowsDialog", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::TabbedDocumentToControlBar", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::UpdateCaption", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::UpdateMDITabbedBarsIcons", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::WinHelp", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::m_bCanConvertControlBarToMDIChild", "AFXMDIFRAMEWNDEX/CMDIFrameWndEx::m_bDisableSetRedraw"]
helpviewer_keywords: ["CMDIFrameWndEx [MFC], ActiveItemRecalcLayout", "CMDIFrameWndEx [MFC], AddPane", "CMDIFrameWndEx [MFC], AdjustClientArea", "CMDIFrameWndEx [MFC], AdjustDockingLayout", "CMDIFrameWndEx [MFC], AreMDITabs", "CMDIFrameWndEx [MFC], CanConvertControlBarToMDIChild", "CMDIFrameWndEx [MFC], ControlBarToTabbedDocument", "CMDIFrameWndEx [MFC], CreateDocumentWindow", "CMDIFrameWndEx [MFC], CreateNewWindow", "CMDIFrameWndEx [MFC], DockPane", "CMDIFrameWndEx [MFC], DockPaneLeftOf", "CMDIFrameWndEx [MFC], EnableAutoHidePanes", "CMDIFrameWndEx [MFC], EnableDocking", "CMDIFrameWndEx [MFC], EnableFullScreenMainMenu", "CMDIFrameWndEx [MFC], EnableFullScreenMode", "CMDIFrameWndEx [MFC], EnableLoadDockState", "CMDIFrameWndEx [MFC], EnableMDITabbedGroups", "CMDIFrameWndEx [MFC], EnableMDITabs", "CMDIFrameWndEx [MFC], EnableMDITabsLastActiveActivation", "CMDIFrameWndEx [MFC], EnablePaneMenu", "CMDIFrameWndEx [MFC], EnableWindowsDialog", "CMDIFrameWndEx [MFC], GetActivePopup", "CMDIFrameWndEx [MFC], GetPane", "CMDIFrameWndEx [MFC], GetDefaultResId", "CMDIFrameWndEx [MFC], GetMDITabGroups", "CMDIFrameWndEx [MFC], GetMDITabs", "CMDIFrameWndEx [MFC], GetMDITabsContextMenuAllowedItems", "CMDIFrameWndEx [MFC], GetMenuBar", "CMDIFrameWndEx [MFC], GetRibbonBar", "CMDIFrameWndEx [MFC], GetTearOffBars", "CMDIFrameWndEx [MFC], GetToolbarButtonToolTipText", "CMDIFrameWndEx [MFC], InsertPane", "CMDIFrameWndEx [MFC], IsFullScreen", "CMDIFrameWndEx [MFC], IsMDITabbedGroup", "CMDIFrameWndEx [MFC], IsMemberOfMDITabGroup", "CMDIFrameWndEx [MFC], IsMenuBarAvailable", "CMDIFrameWndEx [MFC], IsPointNearDockSite", "CMDIFrameWndEx [MFC], IsPrintPreview", "CMDIFrameWndEx [MFC], LoadFrame", "CMDIFrameWndEx [MFC], LoadMDIState", "CMDIFrameWndEx [MFC], MDITabMoveToNextGroup", "CMDIFrameWndEx [MFC], MDITabNewGroup", "CMDIFrameWndEx [MFC], NegotiateBorderSpace", "CMDIFrameWndEx [MFC], OnCloseDockingPane", "CMDIFrameWndEx [MFC], OnCloseMiniFrame", "CMDIFrameWndEx [MFC], OnClosePopupMenu", "CMDIFrameWndEx [MFC], OnCmdMsg", "CMDIFrameWndEx [MFC], OnDrawMenuImage", "CMDIFrameWndEx [MFC], OnDrawMenuLogo", "CMDIFrameWndEx [MFC], OnEraseMDIClientBackground", "CMDIFrameWndEx [MFC], OnMenuButtonToolHitTest", "CMDIFrameWndEx [MFC], OnMoveMiniFrame", "CMDIFrameWndEx [MFC], OnSetPreviewMode", "CMDIFrameWndEx [MFC], OnShowCustomizePane", "CMDIFrameWndEx [MFC], OnShowMDITabContextMenu", "CMDIFrameWndEx [MFC], OnShowPanes", "CMDIFrameWndEx [MFC], OnShowPopupMenu", "CMDIFrameWndEx [MFC], OnSizeMDIClient", "CMDIFrameWndEx [MFC], OnTearOffMenu", "CMDIFrameWndEx [MFC], OnUpdateFrameMenu", "CMDIFrameWndEx [MFC], PaneFromPoint", "CMDIFrameWndEx [MFC], RecalcLayout", "CMDIFrameWndEx [MFC], RemovePaneFromDockManager", "CMDIFrameWndEx [MFC], SaveMDIState", "CMDIFrameWndEx [MFC], SetPrintPreviewFrame", "CMDIFrameWndEx [MFC], SetupToolbarMenu", "CMDIFrameWndEx [MFC], ShowFullScreen", "CMDIFrameWndEx [MFC], ShowPane", "CMDIFrameWndEx [MFC], ShowWindowsDialog", "CMDIFrameWndEx [MFC], TabbedDocumentToControlBar", "CMDIFrameWndEx [MFC], UpdateCaption", "CMDIFrameWndEx [MFC], UpdateMDITabbedBarsIcons", "CMDIFrameWndEx [MFC], WinHelp", "CMDIFrameWndEx [MFC], m_bCanConvertControlBarToMDIChild", "CMDIFrameWndEx [MFC], m_bDisableSetRedraw"]
---
# `CMDIFrameWndEx` class

Extends the functionality of [`CMDIFrameWnd`](../../mfc/reference/cframewnd-class.md), a Windows Multiple Document Interface (MDI) frame window.

## Syntax

```cpp
class CMDIFrameWndEx : public CMDIFrameWnd
```

## Members

### Public Methods

|Name|Description|
|----------|-----------------|
|[`CMDIFrameWndEx::ActiveItemRecalcLayout`](#activeitemrecalclayout)|Recalculates the layout of the active item.|
|`CMDIFrameWndEx::AddDockSite`|This method isn't used.|
|[`CMDIFrameWndEx::AddPane`](#addpane)|Registers a pane with the docking manager.|
|[`CMDIFrameWndEx::AdjustClientArea`](#adjustclientarea)|Reduces the client area to allow for a border.|
|[`CMDIFrameWndEx::AdjustDockingLayout`](#adjustdockinglayout)|Recalculates the layout of all docked panes.|
|[`CMDIFrameWndEx::AreMDITabs`](#aremditabs)|Determines whether the MDI Tabs feature or the MDI Tabbed Groups feature is enabled.|
|[`CMDIFrameWndEx::CanConvertControlBarToMDIChild`](#canConvertcontrolbartomdichild)|Called by the framework to determine whether the frame window can convert docking panes to tabbed documents.|
|[`CMDIFrameWndEx::ControlBarToTabbedDocument`](#controlbartotabbeddocument)|Converts the specified docking pane to a tabbed document.|
|[`CMDIFrameWndEx::CreateDocumentWindow`](#createdocumentwindow)|Creates a child document window.|
|[`CMDIFrameWndEx::CreateNewWindow`](#createnewwindow)|Called by the framework to create a new window.|
|`CMDIFrameWndEx::CreateObject`|Used by the framework to create a dynamic instance of this class type.|
|[`CMDIFrameWndEx::DockPane`](#dockpane)|Docks the specified pane to the frame window.|
|[`CMDIFrameWndEx::DockPaneLeftOf`](#dockpaneleftof)|Docks one pane to the left of another pane.|
|[`CMDIFrameWndEx::EnableAutoHidePanes`](#enableautohidepanes)|Enables auto-hide mode for panes when they're docked at specified sides of the main frame window.|
|[`CMDIFrameWndEx::EnableDocking`](#enabledocking)|Enables docking of the panes that belong to the MDI frame window.|
|[`CMDIFrameWndEx::EnableFullScreenMainMenu`](#enablefullscreenmainmenu)|Shows or hides the main menu in full-screen mode.|
|[`CMDIFrameWndEx::EnableFullScreenMode`](#enablefullscreenmode)|Enables full-screen mode for the frame window.|
|[`CMDIFrameWndEx::EnableLoadDockState`](#enableloaddockstate)|Enables or disables the loading of the docking state.|
|[`CMDIFrameWndEx::EnableMDITabbedGroups`](#enablemditabbedgroups)|Enables or disables the MDI Tabbed Groups feature.|
|[`CMDIFrameWndEx::EnableMDITabs`](#enablemditabs)|Enables or disables the MDI Tabs feature. When enabled, the frame window displays a tab for each MDI child window.|
|[`CMDIFrameWndEx::EnableMDITabsLastActiveActivation`](#enablemditabslastactiveactivation)|Specifies whether the last active tab should be activated when the user closes the current tab.|
|[`CMDIFrameWndEx::EnablePaneMenu`](#enablepanemenu)|Enables or disables automatic creation and management of the pop-up pane menu, which displays a list of application panes.|
|[`CMDIFrameWndEx::EnableWindowsDialog`](#enablewindowsdialog)|Inserts a menu item whose command ID calls a [`CMFCWindowsManagerDialog`](../../mfc/reference/cmfcwindowsmanagerdialog-class.md) dialog box.|
|[`CMDIFrameWndEx::GetActivePopup`](#getactivepopup)|Returns a pointer to the currently displayed popup menu.|
|[`CMDIFrameWndEx::GetPane`](#getpane)|Returns a pointer to the pane that has the specified control ID.|
|[`CMDIFrameWndEx::GetDefaultResId`](#getdefaultresid)|Returns the ID of shared resources of the MDI frame window.|
|[`CMDIFrameWndEx::GetMDITabGroups`](#getmditabgroups)|Returns a list of MDI tabbed windows.|
|[`CMDIFrameWndEx::GetMDITabs`](#getmditabs)|Returns a reference to the underlined tabbed window.|
|[`CMDIFrameWndEx::GetMDITabsContextMenuAllowedItems`](#getmditabscontextmenualloweditems)|Returns a combination of flags that determines what context menu items are valid when the MDI Tabbed Groups feature is enabled.|
|[`CMDIFrameWndEx::GetMenuBar`](#getmenubar)|Returns a pointer to a menu bar object attached to the frame window.|
|[`CMDIFrameWndEx::GetRibbonBar`](#getribbonbar)|Retrieves the ribbon bar control for the frame.|
|[`CMDIFrameWndEx::GetTearOffBars`](#gettearoffbars)|Returns a list of [`CPane`](../../mfc/reference/cpane-class.md)-derived objects that are in a tear-off state.|
|`CMDIFrameWndEx::GetThisClass`|Called by the framework to obtain a pointer to the [`CRuntimeClass`](../../mfc/reference/cruntimeclass-structure.md) object that is associated with this class type.|
|[`CMDIFrameWndEx::GetToolbarButtonToolTipText`](#gettoolbarbuttontooltiptext)|Called by the framework when the application displays the tooltip for a toolbar button.|
|[`CMDIFrameWndEx::InsertPane`](#insertpane)|Registers the specified pane with the docking manager.|
|[`CMDIFrameWndEx::IsFullScreen`](#isfullscreen)|Determines whether the frame window is in full-screen mode.|
|[`CMDIFrameWndEx::IsMDITabbedGroup`](#ismditabbedgroup)|Determines whether the MDI Tabbed Groups feature is enabled.|
|[`CMDIFrameWndEx::IsMemberOfMDITabGroup`](#ismemberofmditabgroup)|Determines whether the specified tabbed window is in the list of windows that are in MDI Tabbed Groups.|
|[`CMDIFrameWndEx::IsMenuBarAvailable`](#ismenubaravailable)|Determines whether the frame window has a menu bar.|
|[`CMDIFrameWndEx::IsPointNearDockSite`](#ispointneardocksite)|Determines whether a specified point is near the dock site.|
|[`CMDIFrameWndEx::IsPrintPreview`](#isprintpreview)|Determines whether the frame window is in print-preview mode.|
|[`CMDIFrameWndEx::LoadFrame`](#loadframe)|Creates a frame window from resource information. (Overrides `CMDIFrameWnd::LoadFrame`.)|
|[`CMDIFrameWndEx::LoadMDIState`](#loadmdistate)|Loads the specified layout of MDI Tabbed Groups and the list of previously opened documents.|
|[`CMDIFrameWndEx::MDITabMoveToNextGroup`](#mditabmovetonextgroup)|Moves the active tab from the currently active tabbed window to the next or previous tabbed group.|
|[`CMDIFrameWndEx::MDITabNewGroup`](#mditabnewgroup)|Creates a new tabbed group that has a single window.|
|[`CMDIFrameWndEx::NegotiateBorderSpace`](#negotiateborderspace)|Negotiates border space in a frame window during OLE in-place activation.|
|[`CMDIFrameWndEx::OnCloseDockingPane`](#onclosedockingpane)|Called by the framework when the user clicks the **Close** button on a dockable pane.|
|[`CMDIFrameWndEx::OnCloseMiniFrame`](#oncloseminiframe)|Called by the framework when the user clicks the **Close** button on a floating mini frame window.|
|[`CMDIFrameWndEx::OnClosePopupMenu`](#onclosepopupmenu)|Called by the framework when an active pop-up menu processes a `WM_DESTROY` message.|
|[`CMDIFrameWndEx::OnCmdMsg`](#oncmdmsg)|Called by the framework to route and dispatch command messages and to update command user-interface objects.|
|[`CMDIFrameWndEx::OnDrawMenuImage`](#ondrawmenuimage)|Called by the framework when the image associated with a menu item is drawn.|
|[`CMDIFrameWndEx::OnDrawMenuLogo`](#ondrawmenulogo)|Called by the framework when a [`CMFCPopupMenu`](../../mfc/reference/cmfcpopupmenu-class.md) processes a `WM_PAINT` message.|
|[`CMDIFrameWndEx::OnEraseMDIClientBackground`](#onerasemdiclientbackground)|Called by the framework when the MDI frame window processes a `WM_ERASEBKGND` message.|
|[`CMDIFrameWndEx::OnMenuButtonToolHitTest`](#onmenubuttontoolhittest)|Called by the framework when a [`CMFCToolBarButton`](../../mfc/reference/cmfctoolbarbutton-class.md) object processes a `WM_NCHITTEST` message.|
|[`CMDIFrameWndEx::OnMoveMiniFrame`](#onmoveminiframe)|Called by the framework to move a mini-frame window.|
|[`CMDIFrameWndEx::OnSetPreviewMode`](#onsetpreviewmode)|Sets the application's main frame window print-preview mode. (Overrides [`CFrameWnd::OnSetPreviewMode`](../../mfc/reference/cframewnd-class.md#onsetpreviewmode).)|
|[`CMDIFrameWndEx::OnShowCustomizePane`](#onshowcustomizepane)|Called by the framework when a Quick Customize pane is activated.|
|[`CMDIFrameWndEx::OnShowMDITabContextMenu`](#onshowmditabcontextmenu)|Called by the framework when a context menu should be displayed on one of the tabs. (Valid for MDI Tabbed Groups only.)|
|[`CMDIFrameWndEx::OnShowPanes`](#onshowpanes)|Called by the framework to show or hide panes.|
|[`CMDIFrameWndEx::OnShowPopupMenu`](#onshowpopupmenu)|Called by the framework when a pop-up menu is activated.|
|[`CMDIFrameWndEx::OnSizeMDIClient`](#onsizemdiclient)|Called by the framework when the size of the client MDI window is changing.|
|[`CMDIFrameWndEx::OnTearOffMenu`](#ontearoffmenu)|Called by the framework when a menu that has a tear-off bar is activated.|
|[`CMDIFrameWndEx::OnUpdateFrameMenu`](#onupdateframemenu)|Called by the framework to update the frame menu. (Overrides `CMDIFrameWnd::OnUpdateFrameMenu`.)|
|[`CMDIFrameWndEx::PaneFromPoint`](#panefrompoint)|Returns the docking pane that contains the specified point.|
|`CMDIFrameWndEx::PreTranslateMessage`|Used by class [`CWinApp`](../../mfc/reference/cwinapp-class.md) to translate window messages before they're dispatched to the [`TranslateMessage`](/windows/win32/api/winuser/nf-winuser-translatemessage) and [`DispatchMessage`](/windows/win32/api/winuser/nf-winuser-dispatchmessage) Windows functions.  (Overrides `CMDIFrameWnd::PreTranslateMessage`.)|
|[`CMDIFrameWndEx::RecalcLayout`](#recalclayout)|Called by the framework to recalculate the layout of the frame window. (Overrides [`CFrameWnd::RecalcLayout`](../../mfc/reference/cframewnd-class.md#recalclayout).)|
|[`CMDIFrameWndEx::RemovePaneFromDockManager`](#removepanefromdockmanager)|Unregisters a pane and removes it from the docking manager.|
|[`CMDIFrameWndEx::SaveMDIState`](#savemdistate)|Saves the current layout of MDI Tabbed Groups and the list of previously opened documents.|
|[`CMDIFrameWndEx::SetPrintPreviewFrame`](#setprintpreviewframe)|Sets the print preview frame window.|
|[`CMDIFrameWndEx::SetupToolbarMenu`](#setuptoolbarmenu)|Modifies a toolbar object by searching for dummy items and replacing them with the specified user-defined items.|
|[`CMDIFrameWndEx::ShowFullScreen`](#showfullscreen)|Switches the main frame from regular mode to full-screen mode.|
|[`CMDIFrameWndEx::ShowPane`](#showpane)|Shows or hides the specified pane.|
|[`CMDIFrameWndEx::ShowWindowsDialog`](#showwindowsdialog)|Creates a [`CMFCWindowsManagerDialog`](../../mfc/reference/cmfcwindowsmanagerdialog-class.md) box and opens it.|
|[`CMDIFrameWndEx::TabbedDocumentToControlBar`](#tabbeddocumenttocontrolbar)|Converts the specified tabbed document to a docking pane.|
|[`CMDIFrameWndEx::UpdateCaption`](#updatecaption)|Called by the framework to update the window frame caption.|
|[`CMDIFrameWndEx::UpdateMDITabbedBarsIcons`](#updatemditabbedbarsicons)|Sets the icon for each MDI tabbed pane.|
|[`CMDIFrameWndEx::WinHelp`](#winhelp)|Called by the framework to initiate the WinHelp application or context help. (Overrides [`CWnd::WinHelp`](../../mfc/reference/cwnd-class.md#winhelp).)|

### Data members

|Name|Description|
|----------|-----------------|
|[`CMDIFrameWndEx::m_bCanConvertControlBarToMDIChild`](#m_bcanConvertcontrolbartomdichild)|Determines whether docking panes can be converted to MDI child windows.|
|[`CMDIFrameWndEx::m_bDisableSetRedraw`](#m_bdisablesetredraw)|Enables or disables redraw optimization for MDI child windows.|

## Remarks

To take advantage of extended customization features in your MDI application, derive the MDI frame window class of the application from `CMDIFrameWndEx` instead of `CMDIFrameWnd`.

## Example

The following example derives a class from `CMDIFrameWndEx`. This code snippet comes from the [DrawClient Sample: MFC Ribbon-Based OLE Object Drawing Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_DrawClient#1](../../mfc/reference/codesnippet/cpp/cmdiframewndex-class_1.h)]

## Inheritance Hierarchy

[`CObject`](../../mfc/reference/cobject-class.md)

[`CCmdTarget`](../../mfc/reference/ccmdtarget-class.md)

[`CWnd`](../../mfc/reference/cwnd-class.md)

[`CFrameWnd`](../../mfc/reference/cframewnd-class.md)

[`CMDIFrameWnd`](../../mfc/reference/cmdiframewnd-class.md)

[`CMDIFrameWndEx`](../../mfc/reference/cmdiframewndex-class.md)

## Requirements

**Header:** `afxMDIFrameWndEx.h`

## <a name="activeitemrecalclayout"></a> `CMDIFrameWndEx::ActiveItemRecalcLayout`

Recalculates the layout of the active item.

```cpp
void ActiveItemRecalcLayout();
```

## <a name="addpane"></a> `CMDIFrameWndEx::AddPane`

Registers a pane with the docking manager.

```cpp
BOOL AddPane(
    CBasePane* pControlBar,
    BOOL bTail=TRUE);
```

### Parameters

*`pControlBar`*\
[in] Pointer to the pane to register.

*`bTail`*\
[in] Specifies whether to add this pane to the end of the list.

### Return value

Returns a non-zero value if the pane is registered successfully. Returns 0 if the pane is already registered with the docking manager.

### Remarks

Each pane must be registered with the [`CDockingManager` class](../../mfc/reference/cdockingmanager-class.md) before it can take a part in the docking layout. Use this method to notify the docking manager that you want to dock a specific pane. Once that pane is registered, the docking manager aligns it based on its alignment setting and position in the list of panes maintained by the docking manager.

## <a name="adjustclientarea"></a> `CMDIFrameWndEx::AdjustClientArea`

Reduces the client area to allow for a border.

```cpp
virtual void AdjustClientArea();
```

## <a name="adjustdockinglayout"></a> `CMDIFrameWndEx::AdjustDockingLayout`

Recalculates the layout of all docked panes.

```cpp
virtual void AdjustDockingLayout(HDWP hdwp=NULL);
```

### Parameters

*`hdwp`*\
[in] Identifies the multiple-window-position structure. You can obtain this value by calling `BeginDeferWindowPos`.

### Remarks

Call this member function to recalculate the layout of all panes docked to the frame window.

## <a name="aremditabs"></a> `CMDIFrameWndEx::AreMDITabs`

Determines whether the MDI tabs feature or the MDI tabbed groups feature is enabled.

```cpp
BOOL AreMDITabs(int* pnMDITabsType=NULL) const;
```

### Parameters

*`pnMDITabsType`*\
[out] A pointer to an integer variable that indicates which features are enabled:

- 0: All features are disabled.
- 1: MDI tabs is enabled.
- 2: MDI tabbed groups is enabled.

### Return value

Returns `TRUE` if MDI tabs or MDI tabbed groups is enabled.

Returns `FALSE` if none of the above features are enabled.

### Remarks

Use this function to determine whether MDI tabs or MDI tabbed groups is enabled for the frame window. Use [`CMDIFrameWndEx::EnableMDITabs`](#enablemditabs) to enable or disable the MDI tabs feature.

Use [`CMDIFrameWndEx::EnableMDITabbedGroups`](#enablemditabbedgroups) to enable or disable the MDI tabbed groups feature.

## <a name="canConvertcontrolbartomdichild"></a> `CMDIFrameWndEx::CanConvertControlBarToMDIChild`

Called by the framework to determine whether the frame window can convert docking panes to tabbed documents

```cpp
virtual BOOL CanConvertControlBarToMDIChild();
```

### Return Value

Returns `TRUE` if the frame window can convert docking panes to tabbed documents; otherwise returns `FALSE`.

### Remarks

Override this method in a derived class and return `TRUE` to enable the conversion of docking panes to tabbed documents. Alternatively, you can set [`CMDIFrameWndEx::m_bCanConvertControlBarToMDIChild`](#m_bcanConvertcontrolbartomdichild) to `TRUE`.

## <a name="controlbartotabbeddocument"></a> `CMDIFrameWndEx::ControlBarToTabbedDocument`

Converts the specified docking pane to a tabbed document.

```cpp
virtual CMDIChildWndEx* ControlBarToTabbedDocument(CDockablePane* pBar);
```

### Parameters

*`pBar`*\
A pointer to the docking pane to convert.

### Return Value

Returns a pointer to the new MDI child window that contains the docking pane.

### Remarks

This method converts a docking pane to a tabbed document. When you call this method, the framework creates a [`CMDIChildWndEx` class](../../mfc/reference/cmdichildwndex-class.md) object, removes the docking pane from the docking manager, and adds the docking pane to the new MDI child window. The MDI child window resizes the docking pane to cover the entire client area

## <a name="createdocumentwindow"></a> `CMDIFrameWndEx::CreateDocumentWindow`

Creates a child document window.

```cpp
virtual CMDIChildWndEx* CreateDocumentWindow(
    LPCTSTR lpcszDocName,
    CObject* pObj);
```

### Parameters

*`lpcszDocName`*\
[in] A text string that contains a document identifier. Typically, it's the full path of a document file.

*`pObj`*\
[in] A pointer to a user-defined object. For example, a developer can create an application-specific data structure describing the document and telling how the document should be initialized at startup.

### Return value

A pointer to `CMDIChildWndEx`.

### Remarks

The framework calls this method when it loads the list of documents previously saved in the registry.

Override this method in order to create documents when they're being loaded from the registry.

### Example

The following example shows how `CreateDocumentWindow` is used in the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

In this example, `g_strStartViewName` could be the name of a "virtual document" (for example, "Start Page") that isn't loaded from a disk file. Therefore we need special processing to handle that case.

[!code-cpp[NVC_MFC_VisualStudioDemo#13](../../mfc/codesnippet/cpp/cmdiframewndex-class_2.cpp)]

## <a name="createnewwindow"></a> `CMDIFrameWndEx::CreateNewWindow`

Called by the framework to create a new window.

```cpp
virtual CMDIChildWndEx* CreateNewWindow(
    LPCTSTR lpcszDocName,
    CObject* pObj);
```

### Parameters

*`lpcszDocName`*\
[in] The document name.

*`pObj`*\
[in] Reserved for future use.

### Return value

A pointer to the new window.

## <a name="dockpane"></a> `CMDIFrameWndEx::DockPane`

Docks the specified pane to the frame window.

```cpp
void DockPane(
    CBasePane* pBar,
    UINT nDockBarID=0,
    LPCRECT lpRect=NULL);
```

### Parameters

*`pBar`*\
[in] Pointer to the pane to dock.

*`nDockBarID`*\
[in] Specifies which sides of the frame window to dock to.

*`lpRect`*\
[in] Not used.

### Remarks

This method docks the specified pane to one of the sides of the frame window that was specified when [`CBasePane::EnableDocking`](../../mfc/reference/cbasepane-class.md#enabledocking) and [`CMDIFrameWndEx::EnableDocking`](#enabledocking) were called.

### Example

The following example demonstrates the use of the `DockPane` method. This code snippet comes from the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#4](../../mfc/codesnippet/cpp/cmdiframewndex-class_3.cpp)]

## <a name="dockpaneleftof"></a> `CMDIFrameWndEx::DockPaneLeftOf`

Docks one pane to the left of another pane.

```cpp
BOOL DockPaneLeftOf(
    CPane* pBar,
    CPane* pLeftOf);
```

### Parameters

*`pBar`*\
[in] A pointer to the docking pane.

*`pLeftOf`*\
[in] A pointer to the pane that serves as the dock site.

### Return value

Returns `TRUE` if the operation is successful. Otherwise returns `FALSE`.

### Remarks

Call this method to dock several pane objects in a predefined order. This method docks the pane specified by *`pBar`* to the left of the pane specified by *`pLeftOf`*.

### Example

The following example shows how the `DockPaneLeftOf` method is used in the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#5](../../mfc/codesnippet/cpp/cmdiframewndex-class_4.cpp)]

## <a name="enableautohidepanes"></a> `CMDIFrameWndEx::EnableAutoHidePanes`

Enables auto-hide mode for panes when they're docked at the specified sides of the main frame window.

```cpp
BOOL EnableAutoHidePanes(DWORD dwDockStyle);
```

### Parameters

*`dwDockStyle`*\
[in] Specifies the sides of the main frame window that will be enabled. Use one or more of the following flags.

- `CBRS_ALIGN_LEFT`
- `CBRS_ALIGN_RIGHT`
- `CBRS_ALIGN_TOP`
- `CBRS_ALIGN_BOTTOM`

### Return value

Call this function to enable auto-hide mode for panes when they're docked at the specified sides of the main frame window.

### Example

The following example shows how the `EnableAutoHidePanes` method is used in the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#6](../../mfc/codesnippet/cpp/cmdiframewndex-class_5.cpp)]

### Remarks

## <a name="enabledocking"></a> `CMDIFrameWndEx::EnableDocking`

Enables docking of the panes that belong to the MDI frame window.

```cpp
BOOL EnableDocking(DWORD dwDockStyle);
```

### Parameters

*`dwDockStyle`*\
[in] Specifies the docking style that you want to apply.

### Return value

### Remarks

Call this function to enable docking of panes that belong to the `CMDIFrameWndEx` object.

### Example

The following example shows how the `EnableDocking` method is used in the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#7](../../mfc/codesnippet/cpp/cmdiframewndex-class_6.cpp)]

## <a name="enablefullscreenmainmenu"></a> `CMDIFrameWndEx::EnableFullScreenMainMenu`

Shows or hides the main menu in full-screen mode.

```cpp
void EnableFullScreenMainMenu(BOOL bEnableMenu);
```

### Parameters

*`bEnableMenu`*\
[in] `TRUE` to show the main menu in full-screen mode, or `FALSE` to hide it.

### Remarks

## <a name="enablefullscreenmode"></a> `CMDIFrameWndEx::EnableFullScreenMode`

Enables full-screen mode for the frame window.

```cpp
void EnableFullScreenMode(UINT uiFullScreenCmd);
```

### Parameters

*`uiFullScreenCmd`*\
[in] The ID of a command that enables or disables full-screen mode.

### Remarks

In full-screen mode, all docking control bars, toolbars and menus are hidden and the active view is resized to occupy the full-screen. When you enable full-screen mode, you must specify an ID of the command that enables or disables it. You can call `EnableFullScreenMode` from the main frame's `OnCreate` function. When a frame window is being switched to full-screen mode, the framework creates a floating toolbar with one button that has the specified command ID. If you want to keep the main menu on the screen, call [`CMDIFrameWndEx::EnableFullScreenMainMenu`](#enablefullscreenmainmenu).

## <a name="enableloaddockstate"></a> `CMDIFrameWndEx::EnableLoadDockState`

Enables or disables the loading of the docking state.

```cpp
void EnableLoadDockState(BOOL bEnable = TRUE);
```

### Parameters

*`bEnable`*\
[in] `TRUE` to enable the loading of the docking state, `FALSE` to disable the loading of the docking state.

### Remarks

## <a name="enablemditabbedgroups"></a> `CMDIFrameWndEx::EnableMDITabbedGroups`

Enables or disables the MDI tabbed groups feature for the frame window.

```cpp
void EnableMDITabbedGroups(
    BOOL bEnable,
    const CMDITabInfo& params);
```

### Parameters

*`bEnable`*\
[in] If `TRUE`, the MDI tabbed groups feature is enabled; if `FALSE`, the MDI tabbed groups feature is disabled.

*`params`*\
[in] Specifies parameters that the framework applies to child windows that are created in the MDI client area.

### Remarks

Use this method to enable or disable the MDI tabbed groups feature. This feature enables MDI applications to display child windows as tabbed windows that are aligned vertically or horizontally within the MDI client area. Groups of tabbed windows are separated by splitters. The user can resize tabbed groups by using a splitter.

The user can:

- Drag individual tabs between groups.
- Drag individual tabs to the edge of the window to create new groups.
- Move tabs or create new groups by using a shortcut menu.
- Your application can save the current layout of tabbed windows and the list of currently opened documents.

If you call this method with *`bEnable`* set to `FALSE`, *`params`* is ignored.

Even if MDI tabbed groups is already enabled, you can call this method again to modify the settings for child windows. Call the method with *`bEnable`* set to `TRUE` and modify the members of the `CMDITabInfo` object that are specified by the *`params`* parameter.

For more information about how to use MDI tabbed groups, see [MDI Tabbed Groups](../../mfc/mdi-tabbed-groups.md).

### Example

The following example shows how `EnableMDITabbedGroups` is used in the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#8](../../mfc/codesnippet/cpp/cmdiframewndex-class_7.cpp)]

## <a name="enablemditabs"></a> `CMDIFrameWndEx::EnableMDITabs`

Enables or disables the MDI Tabs feature for the MDI frame window. When enabled, the frame window displays a tab for each MDI child window.

```cpp
void EnableMDITabs(
    BOOL bEnable=TRUE,
    BOOL bIcons=TRUE,
    CMFCTabCtrl::Location tabLocation=CMFCTabCtrl::LOCATION_BOTTOM,
    BOOL bTabCloseButton=FALSE,
    CMFCTabCtrl::Style style=CMFCTabCtrl::STYLE_3D_SCROLLED,
    BOOL bTabCustomTooltips=FALSE,
    BOOL bActiveTabCloseButton=FALSE);
```

### Parameters

*`bEnable`*\
Specifies whether tabs are enabled.

*`bIcons`*\
Specifies whether icons should be displayed on the tabs.

*`tabLocation`*\
Specifies the location of the tab labels.

*`bTabCloseButton`*\
Specifies whether to display tab close buttons.

*`style`*\
Specifies the style of tabs. Use `STYLE_3D_SCROLLED` for regular tabs or `STYLE_3D_ONENOTE` for Microsoft OneNote tabs.

*`bTabCustomTooltips`*\
Specifies whether custom tooltips are enabled.

*`bActiveTabCloseButton`*\
If `TRUE`, a **Close** button will be displayed on the active tab instead of on the right corner of the tab area.

### Remarks

Call this method to enable or disable the MDI tabs feature for the MDI frame window. When enabled, all child windows are displayed as tabs.

The tab labels can be located at the top or bottom of the frame, depending on the setting of the parameter *`tabLocation`*. You may specify either `CMFCTabCtrl::LOCATION_BOTTOM` (the default setting) or `CMFCTabCtrl::LOCATION_TOP`.

If *`bTabCustomTooltips`* is `TRUE`, an `AFX_WM_ON_GET_TAB_TOOLTIP` message will be sent to the main frame window. Your code can handle this message and provide the framework with custom tooltips for MDI tabs.

### Example

The following example shows how `EnableMDITabs` is used in the [MDITabsDemo Sample: MFC Tabbed MDI Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_MDITabsDemo#3](../../mfc/reference/codesnippet/cpp/cmdiframewndex-class_8.cpp)]

## <a name="enablemditabslastactiveactivation"></a> `CMDIFrameWndEx::EnableMDITabsLastActiveActivation`

Specifies whether the last active tab should be opened when the user closes the current tab.

```cpp
void EnableMDITabsLastActiveActivation(BOOL bLastActiveTab=TRUE);
```

### Parameters

*`bLastActiveTab`*\
[in] If `TRUE`, enable activation of the last active tab. If `FALSE`, disable activation of the last active tab.

### Remarks

There are two ways to open a tab when the active tab is closed:

- Activate the next tab.
- Activate the previously active tab.

The default implementation uses the first way.

Use `EnableMDITabsLastActiveActivation` to enable the second way of tab activation. It emulates the way Windows opens MDI child windows.

## <a name="enablepanemenu"></a> `CMDIFrameWndEx::EnablePaneMenu`

Enables or disables automatic creation and management of the pop-up pane menu, which displays a list of application panes.

```cpp
void EnablePaneMenu(
    BOOL bEnable,
    UINT uiCustomizeCmd,
    const CString& strCustomizeLabel,
    UINT uiViewToolbarsMenuEntryID,
    BOOL bContextMenuShowsToolbarsOnly=FALSE,
    BOOL bViewMenuShowsToolbarsOnly=FALSE);
```

### Parameters

*`bEnable`*\
[in] If `TRUE`, automatic handling of the pane menu is enabled; if `FALSE`, automatic handling is disabled.

*`uiCustomizeCmd`*\
[in] Command ID of the **Customize** menu item. This menu item is usually added to the end of the list of panes.

*`strCustomizeLabel`*\
[in] The text to be displayed for the **Customize** menu item (for localization).

*`uiViewToolbarsMenuEntryID`*\
[in] Specifies the ID of a toolbar menu item that opens the pane menu. Usually this is the **Toolbars** submenu of the **View** menu.

*`bContextMenuShowsToolbarsOnly`*\
[in] If `TRUE`, the pane menu displays only a list of toolbars. If `FALSE`, the menu displays a list of toolbars and docking bars.

*`bViewMenuShowsToolbarsOnly`*\
[in] If `TRUE`, the pane menu displays only a list of toolbars. If `FALSE`, the menu displays a list of toolbars and docking bars.

### Remarks

The pop-up pane menu displays the list of the application's panes and lets the user show or hide individual panes.

### Example

The following example shows how `EnablePaneMenu` is used in the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#9](../../mfc/codesnippet/cpp/cmdiframewndex-class_9.cpp)]

## <a name="enablewindowsdialog"></a> `CMDIFrameWndEx::EnableWindowsDialog`

Inserts a menu item whose command ID calls a [`CMFCWindowsManagerDialog`](../../mfc/reference/cmfcwindowsmanagerdialog-class.md) dialog box.

```cpp
void EnableWindowsDialog(
    UINT uiMenuId,
    LPCTSTR lpszMenuText,
    BOOL bShowAllways=FALSE,
    BOOL bShowHelpButton=FALSE);

void EnableWindowsDialog(
    UINT uiMenuId,
    UINT uiMenuTextResId,
    BOOL bShowAllways=FALSE,
    BOOL bShowHelpButton=FALSE);
```

### Parameters

*`uiMenuId`*\
[in] Specifies the resource ID of a menu.

*`lpszMenuText`*\
[in] Specifies the item's text.

*`bShowHelpButton`*\
[in] Specifies whether to display a **Help** button on the windows management dialog box.

*`uiMenuTextResId`*\
[in] The string resource identifier that contains the item's text string.

### Remarks

Use this method to insert a menu item whose command calls an MDI child window management dialog box ( [`CMFCWindowsManagerDialog` class](../../mfc/reference/cmfcwindowsmanagerdialog-class.md)). The new item is inserted into the menu specified by *`uiMenuId`*. Call `EnableWindowsDialog` when you process the `WM_CREATE` message.

### Example

The following example shows how `EnableWindowsDialog` is used in the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#10](../../mfc/codesnippet/cpp/cmdiframewndex-class_10.cpp)]

## <a name="getactivepopup"></a> `CMDIFrameWndEx::GetActivePopup`

Returns a pointer to the currently displayed popup menu.

```cpp
CMFCPopupMenu* GetActivePopup() const;
```

### Return value

A pointer to the active popup menu; `NULL` if no popup menu is active.

### Remarks

Use this function to obtain a pointer to the [`CMFCPopupMenu` class](../../mfc/reference/cmfcpopupmenu-class.md) object that is currently displayed.

## <a name="getdefaultresid"></a> `CMDIFrameWndEx::GetDefaultResId`

Returns the ID of shared resources of the MDI frame window.

```cpp
UINT GetDefaultResId() const;
```

### Return value

A resource ID value. 0 if the frame window has no menu bar.

### Remarks

This method returns the resource ID that was specified when the MDI frame window was loaded by [`CFrameWnd::LoadFrame`](../../mfc/reference/cframewnd-class.md#loadframe).

## <a name="getmditabgroups"></a> `CMDIFrameWndEx::GetMDITabGroups`

Returns a list of MDI tabbed windows.

```cpp
const CObList& GetMDITabGroups() const;
```

### Return value

A reference to a [`CObList` class](../../mfc/reference/coblist-class.md) object that contains a list of tabbed windows. Don't store or modify the list.

### Remarks

Use this method to access the list of tabbed windows. It can be helpful if you want to change or query some parameters of individual tabbed windows.

## <a name="getmditabs"></a> `CMDIFrameWndEx::GetMDITabs`

Returns a reference to the underlined tabbed window.

```cpp
CMFCTabCtrl& GetMDITabs();
```

### Return value

A reference to the underlined tabbed window.

## <a name="getmditabscontextmenualloweditems"></a> `CMDIFrameWndEx::GetMDITabsContextMenuAllowedItems`

Returns a combination of flags that determines what operations are valid when the MDI Tabbed Groups feature is enabled.

```cpp
DWORD GetMDITabsContextMenuAllowedItems();
```

### Return value

A bitwise "or" (`|`) combination of the following flags:

- `AFX_MDI_CREATE_VERT_GROUP` - can create a vertical tab group.
- `AFX_MDI_CREATE_HORZ_GROUP` - can create a horizontal tab group.
- `AFX_MDI_CAN_MOVE_PREV` - can move a tab to the previous tab group.
- `AFX_MDI_CAN_MOVE_NEXT` - can move a tab to the next tab group.

### Remarks

When the MDI Tabbed Groups feature is enabled, you must know what operations are allowed on the tabs of a particular window. This method analyzes the current layout of tabbed windows and returns a combination of flags that can be used to build, for example, a shortcut menu.

You can create a new vertical tab group when all tabbed windows are aligned vertically, or when there's only one tabbed window.

You can create a new horizontal tab group when all tabbed windows are aligned horizontally, or when there's only one tabbed window.

You can move a tab to the previous group only if there's more than one tab in a tabbed window.

You can move a tab to the next group only if there's more than one tab in a tabbed window.

## <a name="getmenubar"></a> `CMDIFrameWndEx::GetMenuBar`

Returns a pointer to a menu bar object attached to the frame window.

```cpp
const CMFCMenuBar* GetMenuBar() const;
```

### Return value

A pointer to a menu bar object.

## <a name="getpane"></a> `CMDIFrameWndEx::GetPane`

Returns a pointer to the pane that has the specified control ID.

```cpp
CBasePane* GetPane(UINT nID);
```

### Parameters

*`nID`*\
[in] The control ID.

### Return value

A pointer to the pane that has the specified control ID, if it exists. Otherwise, `NULL`.

## <a name="getribbonbar"></a> `CMDIFrameWndEx::GetRibbonBar`

Retrieves the ribbon bar control for the frame.

```cpp
CMFCRibbonBar* GetRibbonBar();
```

### Return value

Pointer to the [`CMFCRibbonBar` class](../../mfc/reference/cmfcribbonbar-class.md) for the frame.

### Remarks

## <a name="gettearoffbars"></a> `CMDIFrameWndEx::GetTearOffBars`

Returns a list of tear-off menus.

```cpp
const CObList& GetTearOffBars() const;
```

### Return value

A reference to a [`CObList` class](../../mfc/reference/coblist-class.md) object that contains a collection of pointers to `CPane`-derived objects that are in a tear-off state.

### Remarks

`CMDIFrameWndEx` maintains a collection of tear-off menus. Use this method to retrieve a reference to this list.

## <a name="gettoolbarbuttontooltiptext"></a> `CMDIFrameWndEx::GetToolbarButtonToolTipText`

Called by the framework when the application displays the tooltip for a toolbar button.

```cpp
virtual BOOL GetToolbarButtonToolTipText(
    CMFCToolBarButton* pButton,
    CString& strTTText);
```

### Parameters

*`pButton`*\
[in] A pointer to a toolbar button.

*`strTTText`*\
[in] The tooltip text to display for the button.

### Return value

`TRUE` if the tooltip has been displayed. `FALSE` otherwise.

### Remarks

## <a name="insertpane"></a> `CMDIFrameWndEx::InsertPane`

Registers the specified pane with the docking manager.

```cpp
BOOL InsertPane(
    CBasePane* pControlBar,
    CBasePane* pTarget,
    BOOL bAfter=TRUE);
```

### Parameters

*`pControlBar`*\
[in] A pointer to the pane to be inserted.

*`pTarget`*\
[in] A pointer to the pane before or after which to insert the pane.

*`bAfter`*\
[in] If `TRUE`, *`pControlBar`* is inserted after *`pTarget`*. If `FALSE`, *`pControlBar`* is inserted before *`pTarget`*.

### Return value

`TRUE` if the method successfully registers the pane, `FALSE` if the pane was already registered with the docking manager.

### Remarks

Use this method to tell the docking manager about a pane specified by *`pControlBar`*. The docking manager will align this pane according to the pane's alignment and position in the docking manager's internal list.

## <a name="isfullscreen"></a> `CMDIFrameWndEx::IsFullScreen`

Determines whether the frame window is in full-screen mode.

```cpp
BOOL IsFullScreen() const;
```

### Return value

`TRUE` if the frame window is in full screen mode; otherwise `FALSE`.

### Remarks

You can set the full screen mode by calling the [`CMDIFrameWndEx::EnableFullScreenMode`](#enablefullscreenmode) method.

## <a name="ismditabbedgroup"></a> `CMDIFrameWndEx::IsMDITabbedGroup`

Specifies whether the MDI Tabbed Groups feature is enabled.

```cpp
BOOL IsMDITabbedGroup() const;
```

### Return value

`TRUE` if the MDI Tabbed Groups feature is enabled; otherwise `FALSE`.

### Remarks

To determine whether regular MDI tabs or the MDI Tabbed Groups feature is enabled, use [`CMDIFrameWndEx::AreMDITabs`](#aremditabs).

## <a name="ismemberofmditabgroup"></a> `CMDIFrameWndEx::IsMemberOfMDITabGroup`

Determines whether the specified tabbed window is in the list of windows that are in MDI Tabbed Groups.

```cpp
BOOL IsMemberOfMDITabGroup(CWnd* pWnd);
```

### Parameters

*`pWnd`*\
[in] A pointer to tabbed window.

### Return value

`TRUE` if the specified tabbed window is in the list of tabbed windows that form MDI Tabbed Groups. Otherwise `FALSE`.

## <a name="ismenubaravailable"></a> `CMDIFrameWndEx::IsMenuBarAvailable`

Determines whether the frame window has a menu bar.

```cpp
BOOL IsMenuBarAvailable() const;
```

### Return value

`TRUE` if the pointer to the menu bar object isn't `NULL`; otherwise `FALSE`.

## <a name="ispointneardocksite"></a> `CMDIFrameWndEx::IsPointNearDockSite`

Determines whether a specified point is near the dock site.

```cpp
BOOL IsPointNearDockSite(
    CPoint point,
    DWORD& dwBarAlignment,
    BOOL& bOuterEdge) const;
```

### Parameters

*`point`*\
[in] The specified point in screen coordinates.

*`dwBarAlignment`*\
[in] Specifies which edge the point is near. Possible values are `CBRS_ALIGN_LEFT`, `CBRS_ALIGN_RIGHT`, `CBRS_ALIGN_TOP`, and `CBRS_ALIGN_BOTTOM`

*`bOuterEdge`*\
[in] `TRUE` if the point is near the outer border of the dock site; `FALSE` otherwise.

### Return value

`TRUE` if the point is near the dock site; otherwise `FALSE`.

### Remarks

The point is near the dock site when it is within the sensitivity set in the docking manager. The default sensitivity is 15 pixels.

## <a name="isprintpreview"></a> `CMDIFrameWndEx::IsPrintPreview`

Determines whether the frame window is in print-preview mode.

```cpp
BOOL IsPrintPreview();
```

### Return value

`TRUE` if the frame window is in print-preview mode; otherwise, `FALSE`.

### Remarks

## <a name="loadframe"></a> `CMDIFrameWndEx::LoadFrame`

Creates a frame window from resource information.

```cpp
virtual BOOL LoadFrame(
    UINT nIDResource,
    DWORD dwDefaultStyle = WS_OVERLAPPEDWINDOW | FWS_ADDTOTITLE,
    CWnd* pParentWnd = NULL,
    CCreateContext* pContext = NULL);
```

### Parameters

*`nIDResource`*\
[in] The ID of a shared resource associated with the frame window.

*`dwDefaultStyle`*\
[in] The style of the frame window.

*`pParentWnd`*\
[in] A pointer to the frame's parent.

*`pContext`*\
[in] A pointer to a [`CCreateContext` Structure](../../mfc/reference/ccreatecontext-structure.md). This parameter can be `NULL`.

### Return value

`TRUE` if the method succeeds, otherwise `FALSE`.

## <a name="loadmdistate"></a> `CMDIFrameWndEx::LoadMDIState`

Loads the specified layout of MDI Tabbed Groups and the list of previously opened documents.

```cpp
virtual BOOL LoadMDIState(LPCTSTR lpszProfileName);
```

### Parameters

*`lpszProfileName`*\
[in] Specifies the profile name.

### Return value

`TRUE` if the load succeeded; `FALSE` if the load failed or there's no data to load.

### Remarks

To load or save the state of MDI tabs and groups and the list of opened documents, do the following:

- Call [`CMDIFrameWndEx::SaveMDIState`](#savemdistate) when the main frame is being closed
- Call [`CMDIFrameWndEx::LoadMDIState`](#loadmdistate) when the main frame is being created. The recommended place for this call is before the main frame is displayed for the first time. Add `CWinAppEx::EnableLoadWindowPlacement` `(FALSE);` before `pMainFrame->LoadFrame (IDR_MAINFRAME);`. Add `CWinAppEx::ReloadWindowPlacement` `(pMainFrame);` after the call to `LoadMDIState` to display the main frame at the position that was stored in the registry.
- Override `GetDocumentName` in the `CMDIChildWndEx`- derived class if your application displays documents that aren't stored as files. The returned string will be saved in the registry as the document identifier. The base implementation of [`CMDIChildWndEx::GetDocumentName`](../../mfc/reference/cmdichildwndex-class.md#getdocumentname) returns a value obtained from [`CDocument::GetPathName`](../../mfc/reference/cdocument-class.md#getpathname).
- Override [`CMDIFrameWndEx::CreateDocumentWindow`](#createdocumentwindow) to correctly create documents when they're being loaded from the registry. The first parameter is the string that `GetDocumentName` returned.

### Example

The following example shows how `LoadMDIState` is used in the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#11](../../mfc/codesnippet/cpp/cmdiframewndex-class_11.cpp)]

## <a name="mditabmovetonextgroup"></a> `CMDIFrameWndEx::MDITabMoveToNextGroup`

Moves the active tab from the currently active tabbed window to the next or previous tabbed group.

```cpp
void MDITabMoveToNextGroup(BOOL bNext=TRUE);
```

### Parameters

*`bNext`*\
[in] If `TRUE`, move the tab to the next tabbed group. If `FALSE`, move it to the previous tabbed group.

## <a name="mditabnewgroup"></a> `CMDIFrameWndEx::MDITabNewGroup`

Creates a new tabbed group that has a single window.

```cpp
void MDITabNewGroup(BOOL bVert=TRUE);
```

### Parameters

*`bVert`*\
[in] Specifies the new group alignment. If `TRUE`, the new group is aligned vertically. If `FALSE`, the new group is aligned horizontally.

### Remarks

Use this function to create a new tabbed window (new tabbed group) and add the first tab to it.

### Example

The following example shows how `MDITabNewGroup` is used in the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#12](../../mfc/codesnippet/cpp/cmdiframewndex-class_12.cpp)]

## <a name="m_bcanConvertcontrolbartomdichild"></a> `CMDIFrameWndEx::m_bCanConvertControlBarToMDIChild`

Specifies whether docking panes can be converted to MDI child windows.

```cpp
BOOL m_bCanConvertControlBarToMDIChild;
```

### Remarks

Indicates whether docking control bars can be converted to MDI child windows. If this flag is `TRUE`, the framework handles the conversion automatically when the user selects the **Tabbed Document** command. The flag is protected and you must explicitly enable this option either by setting `m_bCanConvertControlBarToMDIChild` in a constructor of a `CMDIFrameWndEx`-derived class, or by overriding `CanConvertControlBarToMDIChild`.

The default value is `FALSE`.

### Example

The following example shows how `m_bCanConvertControlBarToMDIChild` is used in the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#13](../../mfc/codesnippet/cpp/cmdiframewndex-class_2.cpp)]

## <a name="m_bdisablesetredraw"></a> `CMDIFrameWndEx::m_bDisableSetRedraw`

Enables or disables redraw optimization for MDI child windows.

```cpp
AFX_IMPORT_DATA static BOOL m_bDisableSetRedraw;
```

### Remarks

The default value is `TRUE`.

Set this flag to `FALSE` if you want to optimize redrawing of MDI children. In this case, the framework will call `SetRedraw (FALSE)` for the main frame when the application is changing the active tab.

This flag can cause unwanted effects (such as background applications that become visible). Therefore we recommend that you change the default only if you experience noticeable flickering during MDI tab activation.

## <a name="negotiateborderspace"></a> `CMDIFrameWndEx::NegotiateBorderSpace`

Negotiates border space in a frame window during OLE in-place activation.

```cpp
virtual BOOL NegotiateBorderSpace(
    UINT nBorderCmd,
    LPRECT lpRectBorder);
```

### Parameters

*`nBorderCmd`*\
[in] Contains one of the following values from the enum `CFrameWnd::BorderCmd`:

- `borderGet` = 1
- `borderRequest` = 2
- `borderSet` = 3

*`lpRectBorder`*\
[in, out] Pointer to a [`RECT` structure](/windows/win32/api/windef/ns-windef-rect) or a [`CRect` class](../../atl-mfc-shared/reference/crect-class.md) object that specifies the coordinates of the border.

### Return value

Nonzero if the method was successful; otherwise 0.

### Remarks

This method is an implementation of OLE border space negotiation.

## <a name="onclosedockingpane"></a> `CMDIFrameWndEx::OnCloseDockingPane`

Called by the framework when the user clicks the **Close** button on a dockable pane.

```cpp
virtual BOOL OnCloseDockingPane(CDockablePane* pWnd);
```

### Parameters

*`pWnd`*\
[in] Pointer to the pane being closed.

### Return value

`TRUE` if the docking pane can be closed. Otherwise, `FALSE`.

### Remarks

Override this method to handle hiding of docking panes. Return `FALSE` if you want to prevent a docking pane from being hidden.

The default implementation does nothing and returns `TRUE`.

## <a name="oncloseminiframe"></a> `CMDIFrameWndEx::OnCloseMiniFrame`

Called by the framework when the user clicks the **Close** button on a floating mini-frame window.

```cpp
virtual BOOL OnCloseMiniFrame(CPaneFrameWnd*);
```

### Parameters

*`pWnd`*\
[in] Pointer to the mini-frame window being closed.

### Return value

`TRUE` if the floating mini-frame window can be closed. Otherwise, `FALSE`.

### Remarks

Override this method to handle hiding of floating mini-frame windows. Return `FALSE` if you want to prevent a floating mini-frame window from being hidden.

The default implementation does nothing and returns `TRUE`.

## <a name="onclosepopupmenu"></a> `CMDIFrameWndEx::OnClosePopupMenu`

Called by the framework when an active pop-up menu processes a `WM_DESTROY` message.

```cpp
virtual void OnClosePopupMenu(CMFCPopupMenu* pMenuPopup);
```

### Parameters

*`pMenuPopup`*\
[in] Pointer to a pop-up menu.

### Remarks

Override this method if you want to process notifications from [`CMFCPopupMenu` class](../../mfc/reference/cmfcpopupmenu-class.md) objects that belong to the MDI frame window when those objects process `WM_DESTROY` messages.

## <a name="oncmdmsg"></a> `CMDIFrameWndEx::OnCmdMsg`

Called by the framework to route and dispatch command messages and to update command user-interface objects.

```cpp
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### Parameters

*`nID`*\
[in] The command ID.

*`nCode`*\
[in] Identifies the command notification code. For more information about values for *`nCode`*, see [`CCmdTarget::OnCmdMsg`](../../mfc/reference/ccmdtarget-class.md#oncmdmsg).

*`pExtra`*\
[in] Used according to the value of *`nCode`*. For more information about *`pExtra`*, see [`CCmdTarget::OnCmdMsg`](../../mfc/reference/ccmdtarget-class.md#oncmdmsg).

*`pHandlerInfo`*\
[in, out] Typically, this parameter should be `NULL`. If not `NULL`, `OnCmdMsg` fills in the `pTarget` and `pmf` members of the *`pHandlerInfo`* structure instead of dispatching the command.

### Return value

Nonzero if the message is handled; otherwise 0.

## <a name="ondrawmenuimage"></a> `CMDIFrameWndEx::OnDrawMenuImage`

Called by the framework when the image associated with a menu item is drawn.

```cpp
virtual BOOL OnDrawMenuImage(
    CDC* pDC,
    const CMFCToolBarMenuButton* pMenuButton,
    const CRect& rectImage);
```

### Parameters

*`pDC`*\
[in] Pointer to a device context.

*`pMenuButton`*\
[in] Pointer to the menu button.

*`rectImage`*\
[in] Bounding rectangle of the image.

### Return value

`TRUE` if the method draws the image. The default implementation returns `FALSE`.

### Remarks

Override this method  if you want to customize image rendering for the menu items that belong to the menu bar owned by the `CMDIFrameWndEx`-derived object. The default implementation does nothing.

## <a name="ondrawmenulogo"></a> `CMDIFrameWndEx::OnDrawMenuLogo`

Called by the framework when a [`CMFCPopupMenu`](../../mfc/reference/cmfcpopupmenu-class.md) processes a `WM_PAINT` message.

```cpp
virtual void OnDrawMenuLogo(
    CDC*,
    CMFCPopupMenu*,
    const CRect&);
```

### Remarks

Override this function to display a logo on the pop-up menu that belongs to the menu bar owned by the `CMDIFrameWndEx`-derived object. The default implementation does nothing.

## <a name="onerasemdiclientbackground"></a> `CMDIFrameWndEx::OnEraseMDIClientBackground`

Called by the framework when the MDI frame window processes a `WM_ERASEBKGND` message.

```cpp
virtual BOOL OnEraseMDIClientBackground(CDC*);
```

### Return value

`TRUE` if the application processes the message and erases the background.

### Remarks

Override this member function if you want to process the `WM_ERASEBKGND` message in a `CMDIFrameWndEx`-derived class.

## <a name="onmenubuttontoolhittest"></a> `CMDIFrameWndEx::OnMenuButtonToolHitTest`

Called by the framework when a [`CMFCToolBarButton`](../../mfc/reference/cmfctoolbarbutton-class.md) object processes a `WM_NCHITTEST` message.

```cpp
virtual BOOL OnMenuButtonToolHitTest(
    CMFCToolBarButton* pButton,
    TOOLINFO* pTI);
```

### Parameters

*`pButton`*\
[in] The toolbar button.

*`pTI`*\
[out] Pointer to a [`TOOLINFO`](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure.

### Return value

`TRUE` if the application fills the *`pTI`* parameter. The default implementation returns `FALSE`.

### Remarks

Override this method if you want to provide information about specific menu items to a tooltip. The default implementation does nothing.

## <a name="onmoveminiframe"></a> `CMDIFrameWndEx::OnMoveMiniFrame`

Called by the framework to move a mini-frame window.

```cpp
virtual BOOL OnMoveMiniFrame(CWnd* pFrame);
```

### Parameters

*`pFrame`*\
[in] A pointer to a mini-frame window.

### Return value

`TRUE` if the method succeeds, otherwise `FALSE`.

## <a name="onsetpreviewmode"></a> `CMDIFrameWndEx::OnSetPreviewMode`

Sets the application's main frame window print-preview mode.

```cpp
virtual void OnSetPreviewMode(
    BOOL bPreview,
    CPrintPreviewState* pState);
```

### Parameters

*`bPreview`*\
[in] If `TRUE`, sets print-preview mode. If `FALSE`, cancels preview mode.

*`pState`*\
[in] A pointer to a `CPrintPreviewState` structure.

### Remarks

This method overrides [`CFrameWnd::OnSetPreviewMode`](../../mfc/reference/cframewnd-class.md#onsetpreviewmode).

## <a name="onshowcustomizepane"></a> `CMDIFrameWndEx::OnShowCustomizePane`

Called by the framework when a Quick Customize pane is activated.

```cpp
virtual BOOL OnShowCustomizePane(
    CMFCPopupMenu* pMenuPane,
    UINT uiToolbarID);
```

### Parameters

*`pMenuPane`*\
[in] A pointer to the Quick Customize pane.

*`uiToolbarID`*\
[in] Control ID of the toolbar to customize.

### Return value

This method always returns `TRUE`.

### Remarks

The Quick Customize pane is a menu that opens when the user clicks **Customize** on a toolbar.

Override this method in a derived class to make changes in the Quick Customize pane.

## <a name="onshowmditabcontextmenu"></a> `CMDIFrameWndEx::OnShowMDITabContextMenu`

Called by the framework before a shortcut menu is displayed on one of the tabs. Valid for MDI Tabbed Groups only.

```cpp
virtual BOOL OnShowMDITabContextMenu(
    CPoint point,
    DWORD dwAllowedItems,
    BOOL bTabDrop);
```

### Parameters

*`point`*\
[in] The location of the menu in screen coordinates.

*`dwAllowedItems`*\
[in] A bitwise "or" (`|`) combination of flags that indicates what actions are allowed for the current tab:

- `AFX_MDI_CREATE_VERT_GROUP` - can create a vertical tab group.
- `AFX_MDI_CREATE_HORZ_GROUP` - can create a horizontal tab group.
- `AFX_MDI_CAN_MOVE_PREV` - can move a tab to the previous tab group.
- `AFX_MDI_CAN_MOVE_NEXT` - can move a tab to the next tab group.
- `AFX_MDI_CAN_BE_DOCKED` - switch a tabbed document to docked state (relevant for tabbed documents only).

*`bTabDrop`*\
[in] `TRUE` to display the menu as a result of dragging the tab onto another tabbed group. `FALSE` to display the menu as a shortcut menu on the currently active tab.

### Return value

Override this method in a [`CMDIFrameWndEx`](../../mfc/reference/cmdiframewndex-class.md)-derived class.

### Remarks

If you don't process `OnShowMDITabContextMenu`, the shortcut menu won't be displayed. This function is generated by the **MFC Application Wizard** when you enable the MDI Tabbed Groups feature.

### Example

The following example shows how `OnShowMDITabContextMenu` is used in the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#14](../../mfc/codesnippet/cpp/cmdiframewndex-class_13.cpp)]

## <a name="onshowpanes"></a> `CMDIFrameWndEx::OnShowPanes`

Called by the framework to show or hide panes.

```cpp
virtual BOOL OnShowPanes(BOOL bShow);
```

### Parameters

*`bShow`*\
[in] `TRUE` to show panes, `FALSE` to hide panes.

### Return value

`TRUE` if the state of the panes changes as a result of calling this method, `FALSE` if the panes are already in the state specified by *`bShow`*. For example, if the panes are hidden and *`bShow`* is `FALSE`, the Return value is `FALSE`.

### Remarks

The default implementation removes the toolbar from the top-level frame window.

If [`CDockingManager::m_bHideDockingBarsInContainerMode`](../../mfc/reference/cdockingmanager-class.md#m_bhidedockingbarsincontainermode) is `TRUE` (the default), all docking panes will be hidden.

## <a name="onshowpopupmenu"></a> `CMDIFrameWndEx::OnShowPopupMenu`

Called by the framework when it opens a pop-up menu.

```cpp
virtual BOOL OnShowPopupMenu(CMFCPopupMenu*);
```

### Return value

`TRUE` if the pop-up menu is to be displayed. Otherwise, `FALSE`. The default implementation returns `TRUE`.

### Remarks

Override this method if you want to implement special processing upon pop-up menu activation. For example, if you want to change regular menu items to color menu buttons, set up tear-off bars, and so on.

The default implementation does nothing.

## <a name="onsizemdiclient"></a> `CMDIFrameWndEx::OnSizeMDIClient`

Called by the framework when the size of the client MDI window is changing.

```cpp
virtual void OnSizeMDIClient(
    const CRect& rectOld,
    const CRect& rectNew);
```

### Parameters

*`rectOld`*\
[in] The current size of the MDI client window.

*`rectNew`*\
[in] The new size of the MDI client window.

### Remarks

## <a name="ontearoffmenu"></a> `CMDIFrameWndEx::OnTearOffMenu`

Called by the framework when a menu that has a tear-off bar is activated.

```cpp
virtual BOOL OnTearOffMenu(
    CMFCPopupMenu* pMenuPopup,
    CPane* pBar);
```

### Parameters

*`pMenuPopup`*\
[in] A pointer to the pop-up menu.

*`pBar`*\
[in] A pointer to the tear-off bar.

### Return value

`TRUE` to allow the pop-up menu with the tear-off bar to be made activate; otherwise `FALSE`. The default is `TRUE`.

### Remarks

Override this function when you want to implement a special setup for the tear-off bar. The default implementation does nothing.

## <a name="onupdateframemenu"></a> `CMDIFrameWndEx::OnUpdateFrameMenu`

Called by the framework to update the frame menu.

```cpp
virtual void OnUpdateFrameMenu(HMENU hMenuAlt);
```

### Parameters

*`hMenuAlt`*\
[in] A handle to a menu.

## <a name="panefrompoint"></a> `CMDIFrameWndEx::PaneFromPoint`

Returns the docking pane that contains the specified point.

```cpp
CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    bool bExactBar,
    CRuntimeClass* pRTCBarType) const;

CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    DWORD& dwAlignment,
    CRuntimeClass* pRTCBarType) const;
```

### Parameters

*`point`*\
[in] The point (in screen coordinates).

*`nSensitivity`*\
[in] The window rectangle of each checked pane is enlarged in all directions by this value.

*`bExactBar`*\
[in] If `TRUE`, the *`nSensitivity`* parameter is ignored.

*`pRTCBarType`*\
[in] If non- `NULL`, the method iterates over only the panes of the specified type.

*`dwAlignment`*\
[out] If a pane is found, this parameter will specify which side of the pane is closest to the specified point.

### Return value

A pointer to a docking pane, or `NULL` if no control contains the point specified by *`point`*.

### Remarks

The call is redirected to the [`CDockingManager` class](../../mfc/reference/cdockingmanager-class.md). For more information, see [`CDockingManager::ControlBarFromPoint`](../../mfc/reference/cdockingmanager-class.md#panefrompoint).

## <a name="recalclayout"></a> `CMDIFrameWndEx::RecalcLayout`

Called by the framework to recalculate the layout of the frame window.

```cpp
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### Parameters

*`bNotify`*\
[in] Determines whether the active in-place item for the frame window receives notification of the layout change. If `TRUE`, the item is notified; otherwise `FALSE`.

### Remarks

This method overrides [CFrameWnd::RecalcLayout](../../mfc/reference/cframewnd-class.md#recalclayout).

## <a name="removepanefromdockmanager"></a> `CMDIFrameWndEx::RemovePaneFromDockManager`

Unregisters a pane and removes it from the docking manager.

```cpp
void RemovePaneFromDockManager(
    CBasePane* pControlBar,
    BOOL bDestroy,
    BOOL bAdjustLayout,
    BOOL bAutoHide,
    CBasePane* pBarReplacement);
```

### Parameters

*`pControlBar`*\
[in] A pointer to a pane to be removed.

*`bDestroy`*\
[in] `TRUE` to destroy the removed pane. `FALSE` to not destroy it.

*`bAdjustLayout`*\
[in] `TRUE` to adjust the docking layout immediately. If `FALSE`, the adjustment will occur only when a redraw event occurs for other reasons (the user resizes the window, drags the main frame, etc.).

*`bAutoHide`*\
[in] `TRUE` to remove the pane from the list of autohide panes. `FALSE` to remove the pane from the list of regular panes.

*`pBarReplacement`*\
[in] A pointer to a pane that replaces the removed pane.

### Remarks

You must register each pane with the docking manager to take part in the docking layout. Use [`CMDIFrameWndEx::AddPane`](#addpane) or [`CMDIFrameWndEx::InsertPane`](#insertpane) to register panes.

Use this method when a pane is no longer a part of the docking layout of the frame window.

## <a name="savemdistate"></a> `CMDIFrameWndEx::SaveMDIState`

Saves the current layout of MDI Tabbed Groups and the list of previously opened documents.

```cpp
virtual BOOL SaveMDIState(LPCTSTR lpszProfileName);
```

### Parameters

*`lpszProfileName`*\
[in] Specifies the profile name.

### Return value

`TRUE` if the save succeeded; `FALSE` if the save failed.

### Remarks

To load or save the state of MDI tabs and groups and the list of opened documents, do the following:

- Call `SaveMDIState` when the main frame is being closed
- Call [`CMDIFrameWndEx::LoadMDIState`](#loadmdistate) when the main frame is being created. The recommended location for this call is before the main frame is displayed for the first time.
- Call `CWinAppEx::EnableLoadWindowPlacement(FALSE);` before `pMainFrame->LoadFrame (IDR_MAINFRAME);`
- Call `CWinAppEx::ReloadWindowPlacement(pMainFrame)` after `LoadMDIState` to display the main frame at the position that was stored in the registry.
- Override `GetDocumentName` in the `CMDIChildWndEx`- derived class if your application displays documents that aren't stored as files. The returned string will be saved in the registry as a document identifier. For more information, see [`CMDIChildWndEx::GetDocumentName`](../../mfc/reference/cmdichildwndex-class.md#getdocumentname).
- Override [`CMDIFrameWndEx::CreateDocumentWindow`](#createdocumentwindow) to correctly create documents when they're loaded from the registry. The parameter to `CreateDocumentWindow` is the string that `GetDocumentName` returned earlier.

### Example

The following example shows how `SaveMDIState` is used in the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#15](../../mfc/codesnippet/cpp/cmdiframewndex-class_14.cpp)]

## <a name="setprintpreviewframe"></a> `CMDIFrameWndEx::SetPrintPreviewFrame`

Sets the print preview frame window.

```cpp
void SetPrintPreviewFrame(CFrameWnd* pWnd);
```

### Parameters

*`pWnd`*\
[in] Pointer to a print preview frame window.

### Remarks

## <a name="setuptoolbarmenu"></a> `CMDIFrameWndEx::SetupToolbarMenu`

Modifies a toolbar object by replacing dummy items with user-defined items.

```cpp
void SetupToolbarMenu(
    CMenu& menu,
    const UINT uiViewUserToolbarCmdFirst,
    const UINT uiViewUserToolbarCmdLast);
```

### Parameters

*`menu`*\
[in] A reference to a [`CMenu` class](../../mfc/reference/cmenu-class.md) object to be modified.

*`uiViewUserToolbarCmdFirst`*\
[in] Specifies the first user-defined command.

*`uiViewUserToolbarCmdLast`*\
[in] Specifies the last user-defined command.

## <a name="showfullscreen"></a> `CMDIFrameWndEx::ShowFullScreen`

Switches the main frame from regular mode to full-screen mode.

```cpp
void ShowFullScreen();
```

### Remarks

## <a name="showpane"></a> `CMDIFrameWndEx::ShowPane`

Shows or hides the specified pane.

```cpp
void ShowPane(
    CBasePane* pBar,
    BOOL bShow,
    BOOL bDelay,
    BOOL bActivate);
```

### Parameters

*`pBar`*\
[in] Pointer to the pane to be shown or hidden.

*`bShow`*\
[in] `TRUE` to show the pane. `FALSE` to hide the pane.

*`bDelay`*\
[in] `TRUE` to delay the recalculation of the docking layout. `FALSE` to recalculate the docking layout immediately.

*`bActivate`*\
[in] `TRUE` to show the pane as active. `FALSE` to show the pane as inactive.

### Remarks

Call this method to show or hide the pane. Don't use `ShowWindow` for docking panes.

### Example

The following example shows how `ShowPane` is used in the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#16](../../mfc/codesnippet/cpp/cmdiframewndex-class_15.cpp)]

## <a name="showwindowsdialog"></a> `CMDIFrameWndEx::ShowWindowsDialog`

Creates a [`CMFCWindowsManagerDialog`](../../mfc/reference/cmfcwindowsmanagerdialog-class.md) box and opens it.

```cpp
void ShowWindowsDialog();
```

### Example

The following example shows how `ShowWindowsDialog` is used in the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#18](../../mfc/codesnippet/cpp/cmdiframewndex-class_16.cpp)]

## <a name="tabbeddocumenttocontrolbar"></a> `CMDIFrameWndEx::TabbedDocumentToControlBar`

Converts the specified tabbed document to a docking pane.

```cpp
virtual BOOL TabbedDocumentToControlBar(CMDIChildWndEx* pMDIChildWnd);
```

### Parameters

*`pMDIChildWnd`*\
A pointer to MDI child window that contains a docking pane.

### Return value

`TRUE` if the method was successful, `FALSE` on failure.

### Remarks

Use this method to convert a tabbed document to a docking pane. The tabbed document must have been created by using [`CMDIFrameWndEx::ControlBarToTabbedDocument`](#controlbartotabbeddocument).

### Example

The following example shows how `TabbedDocumentToControlBar` is used in the [VisualStudioDemo Sample: MFC Visual Studio Application](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#19](../../mfc/codesnippet/cpp/cmdiframewndex-class_17.cpp)]

## <a name="updatecaption"></a> `CMDIFrameWndEx::UpdateCaption`

Called by the framework to update the window frame caption.

```cpp
void UpdateCaption();
```

### Remarks

## <a name="updatemditabbedbarsicons"></a> `CMDIFrameWndEx::UpdateMDITabbedBarsIcons`

Sets the icon for each MDI tabbed pane.

```cpp
void UpdateMDITabbedBarsIcons();
```

## <a name="winhelp"></a> `CMDIFrameWndEx::WinHelp`

Called by the framework to initiate the WinHelp application or context help.

```cpp
virtual void WinHelp(
    DWORD dwData,
    UINT nCmd = HELP_CONTEXT);
```

### Parameters

*`dwData`*\
[in] Specifies data as required for the type of help specified by *`nCmd`*.

*`nCmd`*\
[in] Specifies the type of help requested. For more information about the possible values and how they affect the *`dwData`* parameter, see [`WinHelp`](/windows/win32/api/winuser/nf-winuser-winhelpw).

### Remarks

This method overrides [`CWnd::WinHelp`](../../mfc/reference/cwnd-class.md#winhelp).

## See also

[Hierarchy Chart](../../mfc/hierarchy-chart.md)\
[Classes](../../mfc/reference/mfc-classes.md)\
[`CMDIFrameWnd` class](../../mfc/reference/cframewnd-class.md)\
[`CMDIChildWndEx` class](../../mfc/reference/cmdichildwndex-class.md)

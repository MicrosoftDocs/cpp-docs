---
description: "Learn more about: COleDocObjectItem Class"
title: "COleDocObjectItem Class"
ms.date: "11/04/2016"
f1_keywords: ["COleDocObjectItem", "AFXOLE/COleDocObjectItem", "AFXOLE/COleDocObjectItem::COleDocObjectItem", "AFXOLE/COleDocObjectItem::DoDefaultPrinting", "AFXOLE/COleDocObjectItem::ExecCommand", "AFXOLE/COleDocObjectItem::GetActiveView", "AFXOLE/COleDocObjectItem::GetPageCount", "AFXOLE/COleDocObjectItem::OnPreparePrinting", "AFXOLE/COleDocObjectItem::OnPrint", "AFXOLE/COleDocObjectItem::QueryCommand", "AFXOLE/COleDocObjectItem::Release"]
helpviewer_keywords: ["COleDocObjectItem [MFC], COleDocObjectItem", "COleDocObjectItem [MFC], DoDefaultPrinting", "COleDocObjectItem [MFC], ExecCommand", "COleDocObjectItem [MFC], GetActiveView", "COleDocObjectItem [MFC], GetPageCount", "COleDocObjectItem [MFC], OnPreparePrinting", "COleDocObjectItem [MFC], OnPrint", "COleDocObjectItem [MFC], QueryCommand", "COleDocObjectItem [MFC], Release"]
ms.assetid: d150d306-8fd3-4831-b06d-afbe71d8fc9b
---
# COleDocObjectItem Class

Implements Active document containment.

## Syntax

```
class COleDocObjectItem : public COleClientItem
```

## Members

### Public Constructors

|Name|Description|
|----------|-----------------|
|[COleDocObjectItem::COleDocObjectItem](#coledocobjectitem)|Constructs a `COleDocObject` item.|

### Public Methods

|Name|Description|
|----------|-----------------|
|[COleDocObjectItem::DoDefaultPrinting](#dodefaultprinting)|Prints the container application's document using the default printer settings.|
|[COleDocObjectItem::ExecCommand](#execcommand)|Executes the command specified by the user.|
|[COleDocObjectItem::GetActiveView](#getactiveview)|Retrieves the document's active view.|
|[COleDocObjectItem::GetPageCount](#getpagecount)|Retrieves the number of pages in the container application's document.|
|[COleDocObjectItem::OnPreparePrinting](#onprepareprinting)|Prepares the container application's document for printing.|
|[COleDocObjectItem::OnPrint](#onprint)|Prints the container application's document.|
|[COleDocObjectItem::QueryCommand](#querycommand)|Queries for the status of one or more commands generated by user interface events.|
|[COleDocObjectItem::Release](#release)|Releases the connection to an OLE linked item and closes it if it was open. Does not destroy the client item.|

## Remarks

In MFC, an Active document is handled similarly to a regular, in-place editable embedding, with the following differences:

- The `COleDocument`-derived class still maintains a list of the currently embedded items; however, these items may be `COleDocObjectItem`-derived items.

- When an active document is active, it occupies the entire client area of the view when it is in-place active.

- An Active document container has full control of the **Help** menu.

- The **Help** menu contains menu items for both the Active document container and server.

Because the Active document container owns the **Help** menu, the container is responsible for forwarding server **Help** menu messages to the server. This integration is handled by `COleDocObjectItem`.

For more information on menu merging and Active document activation, see Overview of [Active Document Containment](../../mfc/active-document-containment.md).

## Inheritance Hierarchy

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

[COleClientItem](../../mfc/reference/coleclientitem-class.md)

`COleDocObjectItem`

## Requirements

**Header:** afxole.h

## <a name="coledocobjectitem"></a> COleDocObjectItem::COleDocObjectItem

Call this member function to initialize the `COleDocObjectItem` object.

```
COleDocObjectItem(COleDocument* pContainerDoc = NULL);
```

### Parameters

*pContainerDoc*<br/>
A pointer to the `COleDocument` object acting as the active document container. This parameter must be NULL to enable IMPLEMENT_SERIALIZE. Normally OLE items are constructed with a non- NULL document pointer.

## <a name="dodefaultprinting"></a> COleDocObjectItem::DoDefaultPrinting

Called by the framework to a document using the default settings.

```
static HRESULT DoDefaultPrinting(
    CView* pCaller,
    CPrintInfo* pInfo);
```

### Parameters

*pCaller*<br/>
A pointer to a [CView](../../mfc/reference/cview-class.md) object that is sending the print command.

*pInfo*<br/>
A pointer to a [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) object that describes the job to be printed.

## <a name="execcommand"></a> COleDocObjectItem::ExecCommand

Call this member function to execute the command specified by the user.

```
HRESULT ExecCommand(
    DWORD nCmdID,
    DWORD nCmdExecOpt = OLECMDEXECOPT_DONTPROMPTUSER,
    const GUID* pguidCmdGroup = NULL);
```

### Parameters

*nCmdID*<br/>
The identifier of the command to execute. Must be in the group identified by *pguidCmdGroup*.

*nCmdExecOpt*<br/>
Specifies command-execution options. By default, set to execute the command without prompting the user. See [OLECMDEXECOPT](/windows/win32/api/docobj/ne-docobj-olecmdexecopt) for a list of values.

*pguidCmdGroup*<br/>
Unique identifier of the command group. By default, NULL, which specifies the standard group. The command passed in *nCmdID* must belong to the group.

### Return Value

Returns S_OK if successful; otherwise,returns one of the following error codes.

|Value|Description|
|-----------|-----------------|
|E_UNEXPECTED|Unexpected error occurred.|
|E_FAIL|Error occurred.|
|E_NOTIMPL|Indicates MFC itself should attempt to translate and dispatch the command.|
|OLECMDERR_E_UNKNOWNGROUP|*pguidCmdGroup* is non- NULL but does not specify a recognized command group.|
|OLECMDERR_E_NOTSUPPORTED|*nCmdID* is not recognized as a valid command in the group pGroup.|
|OLECMDERR_DISABLED|The command identified by *nCmdID* is disabled and cannot be executed.|
|OLECMDERR_NOHELP|Caller asked for help on the command identified by *nCmdID* but no help is available.|
|OLECMDERR_CANCELLED|User canceled the execution.|

### Remarks

The *pguidCmdGroup* and the *nCmdID* parameters together uniquely identify the command to invoke. The *nCmdExecOpt* parameter specifies the exact action to take.

## <a name="getactiveview"></a> COleDocObjectItem::GetActiveView

Call this member function to get a pointer to the `IOleDocumentView` interface of the currently active view.

```
LPOLEDOCUMENTVIEW GetActiveView() const;
```

### Return Value

A pointer to the [IOleDocumentView](/windows/win32/api/docobj/nn-docobj-ioledocumentview) interface of the currently active view. If there is no current view, it returns NULL.

### Remarks

The reference count on the returned `IOleDocumentView` pointer is not incremented before it is returned by this function.

## <a name="getpagecount"></a> COleDocObjectItem::GetPageCount

Call this member function to retrieve the number of pages in the document.

```
BOOL GetPageCount(
    LPLONG pnFirstPage,
    LPLONG pcPages);
```

### Parameters

*pnFirstPage*<br/>
A pointer to the number of the document's first page. Can be NULL, which indicates the caller doesn't need this number.

*pcPages*<br/>
A pointer to the total number of pages in the document. Can be NULL, which indicates the caller doesn't need this number.

### Return Value

Nonzero if successful; otherwise 0.

## <a name="onprepareprinting"></a> COleDocObjectItem::OnPreparePrinting

This member function is called by the framework to prepare a document for printing.

```
static BOOL OnPreparePrinting(
    CView* pCaller,
    CPrintInfo* pInfo,
    BOOL bPrintAll = TRUE);
```

### Parameters

*pCaller*<br/>
A pointer to a [CView](../../mfc/reference/cview-class.md) object that is sending the print command.

*pInfo*<br/>
A pointer to a [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) object that describes the job to be printed.

*bPrintAll*<br/>
Specifies whether the entire document is to be printed.

### Return Value

Nonzero if successful; otherwise 0.

## <a name="onprint"></a> COleDocObjectItem::OnPrint

This member function is called by the framework to print a document.

```
static void OnPrint(
    CView* pCaller,
    CPrintInfo* pInfo,
    BOOL bPrintAll = TRUE);
```

### Parameters

*pCaller*<br/>
A pointer to a CView object that is sending the print command.

*pInfo*<br/>
A pointer to a [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) object that describes the job to be printed.

*bPrintAll*<br/>
Specifies whether the entire document is to be printed.

## <a name="querycommand"></a> COleDocObjectItem::QueryCommand

Queries for the status of one or more commands generated by user interface events.

```
HRESULT QueryCommand(
    ULONG nCmdID,
    DWORD* pdwStatus,
    OLECMDTEXT* pCmdText =NULL,
    const GUID* pguidCmdGroup =NULL);
```

### Parameters

*nCmdID*<br/>
identifier of the command being queried for.

*pdwStatus*<br/>
A pointer to the flags returned as a result of the query. For a list of possible values, see [OLECMDF](/windows/win32/api/docobj/ne-docobj-olecmdf).

*pCmdText*<br/>
Pointer to an [OLECMDTEXT](/windows/win32/api/docobj/ns-docobj-olecmdtext) structure in which to return name and status information for a single command. Can be NULL to indicate that the caller does not need this information.

*pguidCmdGroup*<br/>
Unique identifier of the command group; can be NULL to specify the standard group.

### Return Value

For a complete listing of return values, see [IOleCommandTarget::QueryStatus](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-querystatus) in the Windows SDK.

### Remarks

This member function emulates the functionality of the [IOleCommandTarget::QueryStatus](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-querystatus) method, as described in the Windows SDK.

## <a name="release"></a> COleDocObjectItem::Release

Releases the connection to an OLE linked item and closes it if it was open. Does not destroy the client item.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### Parameters

*dwCloseOption*<br/>
Flag specifying under what circumstances the OLE item is saved when it returns to the loaded state. For a list of possible values, see [COleClientItem::Close](../../mfc/reference/coleclientitem-class.md#close).

### Remarks

Does not destroy the client item.

## See also

[MFC Sample MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[COleClientItem Class](../../mfc/reference/coleclientitem-class.md)<br/>
[Hierarchy Chart](../../mfc/hierarchy-chart.md)<br/>
[COleClientItem Class](../../mfc/reference/coleclientitem-class.md)<br/>
[CDocObjectServerItem Class](../../mfc/reference/cdocobjectserveritem-class.md)

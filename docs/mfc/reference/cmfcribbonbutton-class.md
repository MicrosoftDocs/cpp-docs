---
description: "Learn more about: CMFCRibbonButton Class"
title: "CMFCRibbonButton Class"
ms.date: "11/04/2016"
f1_keywords: ["CMFCRibbonButton", "AFXRIBBONBUTTON/CMFCRibbonButton", "AFXRIBBONBUTTON/CMFCRibbonButton::CMFCRibbonButton", "AFXRIBBONBUTTON/CMFCRibbonButton::AddSubItem", "AFXRIBBONBUTTON/CMFCRibbonButton::CanBeStretched", "AFXRIBBONBUTTON/CMFCRibbonButton::CleanUpSizes", "AFXRIBBONBUTTON/CMFCRibbonButton::ClosePopupMenu", "AFXRIBBONBUTTON/CMFCRibbonButton::DrawBottomText", "AFXRIBBONBUTTON/CMFCRibbonButton::DrawImage", "AFXRIBBONBUTTON/CMFCRibbonButton::DrawRibbonText", "AFXRIBBONBUTTON/CMFCRibbonButton::FindSubItemIndexByID", "AFXRIBBONBUTTON/CMFCRibbonButton::GetCommandRect", "AFXRIBBONBUTTON/CMFCRibbonButton::GetCompactSize", "AFXRIBBONBUTTON/CMFCRibbonButton::GetIcon", "AFXRIBBONBUTTON/CMFCRibbonButton::GetImageIndex", "AFXRIBBONBUTTON/CMFCRibbonButton::GetImageSize", "AFXRIBBONBUTTON/CMFCRibbonButton::GetIntermediateSize", "AFXRIBBONBUTTON/CMFCRibbonButton::GetMenu", "AFXRIBBONBUTTON/CMFCRibbonButton::GetMenuRect", "AFXRIBBONBUTTON/CMFCRibbonButton::GetRegularSize", "AFXRIBBONBUTTON/CMFCRibbonButton::GetSubItems", "AFXRIBBONBUTTON/CMFCRibbonButton::GetTextRowHeight", "AFXRIBBONBUTTON/CMFCRibbonButton::GetToolTipText", "AFXRIBBONBUTTON/CMFCRibbonButton::HasCompactMode", "AFXRIBBONBUTTON/CMFCRibbonButton::HasIntermediateMode", "AFXRIBBONBUTTON/CMFCRibbonButton::HasLargeMode", "AFXRIBBONBUTTON/CMFCRibbonButton::HasMenu", "AFXRIBBONBUTTON/CMFCRibbonButton::IsAlwaysDrawBorder", "AFXRIBBONBUTTON/CMFCRibbonButton::IsAlwaysLargeImage", "AFXRIBBONBUTTON/CMFCRibbonButton::IsApplicationButton", "AFXRIBBONBUTTON/CMFCRibbonButton::IsCommandAreaHighlighted", "AFXRIBBONBUTTON/CMFCRibbonButton::IsDefaultCommand", "AFXRIBBONBUTTON/CMFCRibbonButton::IsDefaultPanelButton", "AFXRIBBONBUTTON/CMFCRibbonButton::IsDrawTooltipImage", "AFXRIBBONBUTTON/CMFCRibbonButton::IsLargeImage", "AFXRIBBONBUTTON/CMFCRibbonButton::IsMenuAreaHighlighted", "AFXRIBBONBUTTON/CMFCRibbonButton::IsMenuOnBottom", "AFXRIBBONBUTTON/CMFCRibbonButton::IsPopupDefaultMenuLook", "AFXRIBBONBUTTON/CMFCRibbonButton::IsRightAlignMenu", "AFXRIBBONBUTTON/CMFCRibbonButton::IsSingleLineText", "AFXRIBBONBUTTON/CMFCRibbonButton::OnCalcTextSize", "AFXRIBBONBUTTON/CMFCRibbonButton::OnDrawBorder", "AFXRIBBONBUTTON/CMFCRibbonButton::OnDraw", "AFXRIBBONBUTTON/CMFCRibbonButton::OnFillBackground", "AFXRIBBONBUTTON/CMFCRibbonButton::RemoveAllSubItems", "AFXRIBBONBUTTON/CMFCRibbonButton::RemoveSubItem", "AFXRIBBONBUTTON/CMFCRibbonButton::SetACCData", "AFXRIBBONBUTTON/CMFCRibbonButton::SetAlwaysLargeImage", "AFXRIBBONBUTTON/CMFCRibbonButton::SetDefaultCommand", "AFXRIBBONBUTTON/CMFCRibbonButton::SetDescription", "AFXRIBBONBUTTON/CMFCRibbonButton::SetImageIndex", "AFXRIBBONBUTTON/CMFCRibbonButton::SetMenu", "AFXRIBBONBUTTON/CMFCRibbonButton::SetParentCategory", "AFXRIBBONBUTTON/CMFCRibbonButton::SetRightAlignMenu", "AFXRIBBONBUTTON/CMFCRibbonButton::SetText", "AFXRIBBONBUTTON/CMFCRibbonButton::OnClick"]
helpviewer_keywords: ["CMFCRibbonButton [MFC], CMFCRibbonButton", "CMFCRibbonButton [MFC], AddSubItem", "CMFCRibbonButton [MFC], CanBeStretched", "CMFCRibbonButton [MFC], CleanUpSizes", "CMFCRibbonButton [MFC], ClosePopupMenu", "CMFCRibbonButton [MFC], DrawBottomText", "CMFCRibbonButton [MFC], DrawImage", "CMFCRibbonButton [MFC], DrawRibbonText", "CMFCRibbonButton [MFC], FindSubItemIndexByID", "CMFCRibbonButton [MFC], GetCommandRect", "CMFCRibbonButton [MFC], GetCompactSize", "CMFCRibbonButton [MFC], GetIcon", "CMFCRibbonButton [MFC], GetImageIndex", "CMFCRibbonButton [MFC], GetImageSize", "CMFCRibbonButton [MFC], GetIntermediateSize", "CMFCRibbonButton [MFC], GetMenu", "CMFCRibbonButton [MFC], GetMenuRect", "CMFCRibbonButton [MFC], GetRegularSize", "CMFCRibbonButton [MFC], GetSubItems", "CMFCRibbonButton [MFC], GetTextRowHeight", "CMFCRibbonButton [MFC], GetToolTipText", "CMFCRibbonButton [MFC], HasCompactMode", "CMFCRibbonButton [MFC], HasIntermediateMode", "CMFCRibbonButton [MFC], HasLargeMode", "CMFCRibbonButton [MFC], HasMenu", "CMFCRibbonButton [MFC], IsAlwaysDrawBorder", "CMFCRibbonButton [MFC], IsAlwaysLargeImage", "CMFCRibbonButton [MFC], IsApplicationButton", "CMFCRibbonButton [MFC], IsCommandAreaHighlighted", "CMFCRibbonButton [MFC], IsDefaultCommand", "CMFCRibbonButton [MFC], IsDefaultPanelButton", "CMFCRibbonButton [MFC], IsDrawTooltipImage", "CMFCRibbonButton [MFC], IsLargeImage", "CMFCRibbonButton [MFC], IsMenuAreaHighlighted", "CMFCRibbonButton [MFC], IsMenuOnBottom", "CMFCRibbonButton [MFC], IsPopupDefaultMenuLook", "CMFCRibbonButton [MFC], IsRightAlignMenu", "CMFCRibbonButton [MFC], IsSingleLineText", "CMFCRibbonButton [MFC], OnCalcTextSize", "CMFCRibbonButton [MFC], OnDrawBorder", "CMFCRibbonButton [MFC], OnDraw", "CMFCRibbonButton [MFC], OnFillBackground", "CMFCRibbonButton [MFC], RemoveAllSubItems", "CMFCRibbonButton [MFC], RemoveSubItem", "CMFCRibbonButton [MFC], SetACCData", "CMFCRibbonButton [MFC], SetAlwaysLargeImage", "CMFCRibbonButton [MFC], SetDefaultCommand", "CMFCRibbonButton [MFC], SetDescription", "CMFCRibbonButton [MFC], SetImageIndex", "CMFCRibbonButton [MFC], SetMenu", "CMFCRibbonButton [MFC], SetParentCategory", "CMFCRibbonButton [MFC], SetRightAlignMenu", "CMFCRibbonButton [MFC], SetText", "CMFCRibbonButton [MFC], OnClick"]
ms.assetid: 732e941c-9504-4b83-a691-d18075965d53
---
# CMFCRibbonButton Class

The `CMFCRibbonButton` class implements buttons that you can position on ribbon bar elements such as panels, Quick Access Toolbars, and pop-up menus.

For more detail see the source code located in the **VC\\atlmfc\\src\\mfc** folder of your Visual Studio installation.

## Syntax

```
class CMFCRibbonButton : public CMFCRibbonBaseElement
```

## Members

### Public Constructors

|Name|Description|
|----------|-----------------|
|[CMFCRibbonButton::CMFCRibbonButton](#cmfcribbonbutton)|Constructs a ribbon button object.|

### Public Methods

|Name|Description|
|----------|-----------------|
|[CMFCRibbonButton::AddSubItem](#addsubitem)|Adds a menu item to the pop-up menu that is associated with the button.|
|[CMFCRibbonButton::CanBeStretched](#canbestretched)|(Overrides [CMFCRibbonBaseElement::CanBeStretched](../../mfc/reference/cmfcribbonbaseelement-class.md#canbestretched).)|
|[CMFCRibbonButton::CleanUpSizes](#cleanupsizes)|(Overrides [CMFCRibbonBaseElement::CleanUpSizes](../../mfc/reference/cmfcribbonbaseelement-class.md#cleanupsizes).)|
|[CMFCRibbonButton::ClosePopupMenu](#closepopupmenu)|(Overrides [CMFCRibbonBaseElement::ClosePopupMenu](../../mfc/reference/cmfcribbonbaseelement-class.md#closepopupmenu).)|
|[CMFCRibbonButton::DrawBottomText](#drawbottomtext)||
|[CMFCRibbonButton::DrawImage](#drawimage)|(Overrides [CMFCRibbonBaseElement::DrawImage](../../mfc/reference/cmfcribbonbaseelement-class.md#drawimage).)|
|[CMFCRibbonButton::DrawRibbonText](#drawribbontext)||
|[CMFCRibbonButton::FindSubItemIndexByID](#findsubitemindexbyid)|Returns the index of a pop-up menu item that is associated with the specified command ID.|
|[CMFCRibbonButton::GetCommandRect](#getcommandrect)||
|[CMFCRibbonButton::GetCompactSize](#getcompactsize)|Returns the compact size of the ribbon element. (Overrides [CMFCRibbonBaseElement::GetCompactSize](../../mfc/reference/cmfcribbonbaseelement-class.md#getcompactsize).)|
|[CMFCRibbonButton::GetIcon](#geticon)||
|[CMFCRibbonButton::GetImageIndex](#getimageindex)|Returns the index of the image that is associated with the button.|
|[CMFCRibbonButton::GetImageSize](#getimagesize)|Returns the image size of the ribbon element. (Overrides [CMFCRibbonBaseElement::GetImageSize](../../mfc/reference/cmfcribbonbaseelement-class.md#getimagesize).)|
|[CMFCRibbonButton::GetIntermediateSize](#getintermediatesize)|Returns the size of the ribbon element in its intermediate state. (Overrides [CMFCRibbonBaseElement::GetIntermediateSize](../../mfc/reference/cmfcribbonbaseelement-class.md#getintermediatesize).)|
|[CMFCRibbonButton::GetMenu](#getmenu)|Returns a handle to a Windows menu that is assigned to the ribbon button.|
|[CMFCRibbonButton::GetMenuRect](#getmenurect)||
|[CMFCRibbonButton::GetRegularSize](#getregularsize)|Returns the regular size of the ribbon element. (Overrides [CMFCRibbonBaseElement::GetRegularSize](../../mfc/reference/cmfcribbonbaseelement-class.md#getregularsize).)|
|[CMFCRibbonButton::GetSubItems](#getsubitems)||
|[CMFCRibbonButton::GetTextRowHeight](#gettextrowheight)||
|[CMFCRibbonButton::GetToolTipText](#gettooltiptext)|Returns tooltip text of the ribbon element. (Overrides [CMFCRibbonBaseElement::GetToolTipText](../../mfc/reference/cmfcribbonbaseelement-class.md#gettooltiptext).)|
|[CMFCRibbonButton::HasCompactMode](#hascompactmode)|Specifies whether the ribbon element has a compact mode. (Overrides [CMFCRibbonBaseElement::HasCompactMode](../../mfc/reference/cmfcribbonbaseelement-class.md#hascompactmode).)|
|[CMFCRibbonButton::HasIntermediateMode](#hasintermediatemode)|Specifies whether the ribbon element has an intermediate mode. (Overrides [CMFCRibbonBaseElement::HasIntermediateMode](../../mfc/reference/cmfcribbonbaseelement-class.md#hasintermediatemode).)|
|[CMFCRibbonButton::HasLargeMode](#haslargemode)|Determines whether the ribbon element has a large mode. (Overrides [CMFCRibbonBaseElement::HasLargeMode](../../mfc/reference/cmfcribbonbaseelement-class.md#haslargemode).)|
|[CMFCRibbonButton::HasMenu](#hasmenu)|(Overrides [CMFCRibbonBaseElement::HasMenu](../../mfc/reference/cmfcribbonbaseelement-class.md#hasmenu).)|
|[CMFCRibbonButton::IsAlwaysDrawBorder](#isalwaysdrawborder)||
|[CMFCRibbonButton::IsAlwaysLargeImage](#isalwayslargeimage)|(Overrides [CMFCRibbonBaseElement::IsAlwaysLargeImage](../../mfc/reference/cmfcribbonbaseelement-class.md#isalwayslargeimage).)|
|[CMFCRibbonButton::IsApplicationButton](#isapplicationbutton)||
|[CMFCRibbonButton::IsCommandAreaHighlighted](#iscommandareahighlighted)||
|[CMFCRibbonButton::IsDefaultCommand](#isdefaultcommand)|Determines whether you have enabled the default command for a ribbon button.|
|[CMFCRibbonButton::IsDefaultPanelButton](#isdefaultpanelbutton)||
|[CMFCRibbonButton::IsDrawTooltipImage](#isdrawtooltipimage)||
|[CMFCRibbonButton::IsLargeImage](#islargeimage)||
|[CMFCRibbonButton::IsMenuAreaHighlighted](#ismenuareahighlighted)||
|[CMFCRibbonButton::IsMenuOnBottom](#ismenuonbottom)||
|[CMFCRibbonButton::IsPopupDefaultMenuLook](#ispopupdefaultmenulook)||
|[CMFCRibbonButton::IsRightAlignMenu](#isrightalignmenu)|Determines whether the menu is right-aligned.|
|[CMFCRibbonButton::IsSingleLineText](#issinglelinetext)||
|[CMFCRibbonButton::OnCalcTextSize](#oncalctextsize)|(Overrides [CMFCRibbonBaseElement::OnCalcTextSize](../../mfc/reference/cmfcribbonbaseelement-class.md#oncalctextsize).)|
|[CMFCRibbonButton::OnDrawBorder](#ondrawborder)||
|[CMFCRibbonButton::OnDraw](#ondraw)|Called by the framework to draw the ribbon element. (Overrides [CMFCRibbonBaseElement::OnDraw](../../mfc/reference/cmfcribbonbaseelement-class.md#ondraw).)|
|[CMFCRibbonButton::OnFillBackground](#onfillbackground)||
|[CMFCRibbonButton::RemoveAllSubItems](#removeallsubitems)|Removes all menu items from the pop-up menu.|
|[CMFCRibbonButton::RemoveSubItem](#removesubitem)|Removes a menu item from the pop-up menu.|
|[CMFCRibbonButton::SetACCData](#setaccdata)|(Overrides [CMFCRibbonBaseElement::SetACCData](../../mfc/reference/cmfcribbonbaseelement-class.md#setaccdata).)|
|[CMFCRibbonButton::SetAlwaysLargeImage](#setalwayslargeimage)|Specifies whether the button displays a large or a small image when the user collapses the button.|
|[CMFCRibbonButton::SetDefaultCommand](#setdefaultcommand)|Enables the default command for the ribbon button.|
|[CMFCRibbonButton::SetDescription](#setdescription)|Sets the description for the ribbon element. (Overrides [CMFCRibbonBaseElement::SetDescription](../../mfc/reference/cmfcribbonbaseelement-class.md#setdescription).)|
|[CMFCRibbonButton::SetImageIndex](#setimageindex)|Assigns an index to the image of the button.|
|[CMFCRibbonButton::SetMenu](#setmenu)|Assigns a pop-up menu to the ribbon button.|
|[CMFCRibbonButton::SetParentCategory](#setparentcategory)|(Overrides [CMFCRibbonBaseElement::SetParentCategory](../../mfc/reference/cmfcribbonbaseelement-class.md#setparentcategory).)|
|[CMFCRibbonButton::SetRightAlignMenu](#setrightalignmenu)|Aligns the pop-up menu to the right of the button.|
|[CMFCRibbonButton::SetText](#settext)|Sets the text for the ribbon element. (Overrides [CMFCRibbonBaseElement::SetText](../../mfc/reference/cmfcribbonbaseelement-class.md#settext).)|

### Protected Methods

|Name|Description|
|----------|-----------------|
|[CMFCRibbonButton::OnClick](#onclick)|Called by the framework when the user clicks the button.|

## Example

The following example demonstrates how to use the various methods in the `CMFCRibbonButton` class. The example shows how to construct an object of the `CMFCRibbonButton` class, assign a pop-up menu to the ribbon button, set the description of the button, remove a menu item from the pop-up menu, and right align the pop-up menu to the edge of the button.

[!code-cpp[NVC_MFC_RibbonApp#7](../../mfc/reference/codesnippet/cpp/cmfcribbonbutton-class_1.cpp)]

## Remarks

To use a ribbon button in an application, construct the button object and add it to the appropriate ribbon [panel](../../mfc/reference/cmfcribbonpanel-class.md).

```cpp
CMFCRibbonPanel* pPanel = pCategory->AddPanel (
    _T("Clipboard"), // Panel name
    m_PanelIcons.ExtractIcon (0)); // Panel icon

// Create the first button ("Paste"):
CMFCRibbonButton* pPasteButton =
    new CMFCRibbonButton (ID_EDIT_PASTE, _T("Paste"), -1, 0);

// The third parameter (-1) disables small images for button.
// This button is always displayed with a large image
// Associate a pop-up menu with the "Paste" button:
pPasteButton->SetMenu (IDR_CONTEXT_MENU);

// Add buttons to the panel. These buttons have only small images.
pPanel->Add (new CMFCRibbonButton (ID_EDIT_CUT, _T("Cut"), 1));
pPanel->Add (new CMFCRibbonButton (ID_EDIT_COPY, _T("Copy"), 2));
pPanel->Add (new CMFCRibbonButton (ID_EDIT_PAINT, _T("Paint"), 9));
```

## Inheritance Hierarchy

[CObject](../../mfc/reference/cobject-class.md)

[CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md)

[CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)

## Requirements

**Header:** afxribbonbutton.h

## <a name="addsubitem"></a> CMFCRibbonButton::AddSubItem

Adds a menu item to the pop-up menu that is associated with the button.

```cpp
void AddSubItem(
    CMFCRibbonBaseElement* pSubItem,
    int nIndex=-1);
```

### Parameters

*pSubItem*<br/>
[in] Specifies a pointer to the new element to add.

*nIndex*<br/>
[in] Specifies the index at which to add the element to the array of menu items of the button; -1 to add the element at the end of the array of menu items.

## <a name="canbestretched"></a> CMFCRibbonButton::CanBeStretched

```
virtual BOOL CanBeStretched();
```

### Return Value

### Remarks

## <a name="cleanupsizes"></a> CMFCRibbonButton::CleanUpSizes

```
virtual void CleanUpSizes();
```

### Remarks

## <a name="closepopupmenu"></a> CMFCRibbonButton::ClosePopupMenu

```
virtual void ClosePopupMenu();
```

### Remarks

## <a name="cmfcribbonbutton"></a> CMFCRibbonButton::CMFCRibbonButton

Constructs a ribbon button object.

```
CMFCRibbonButton(
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex=-1,
    int nLargeImageIndex=-1,
    BOOL bAlwaysShowDescription=FALSE);

CMFCRibbonButton(
    UINT nID,
    LPCTSTR lpszText,
    HICON hIcon,
    BOOL bAlwaysShowDescription=FALSE,
    HICON hIconSmall=NULL,
    BOOL bAutoDestroyIcon=FALSE,
    BOOL bAlphaBlendIcon=FALSE);
```

### Parameters

*nID*<br/>
[in] Specifies the command ID of the button.

*lpszText*<br/>
[in] Specifies the text label of the button.

*nSmallImageIndex*<br/>
[in] Specifies a zero-based index of the button's small image in the image list of the parent category.

*nLargeImageIndex*<br/>
[in] Specifies a zero-based index of the button's large image in the image list of the parent category.

*hIcon*<br/>
[in] Specifies a handle to the icon that the application uses as the button's image.

### Example

The following example demonstrates how to construct a `CMFCRibbonButton` object.

[!code-cpp[NVC_MFC_RibbonApp#6](../../mfc/reference/codesnippet/cpp/cmfcribbonbutton-class_2.cpp)]

## <a name="drawbottomtext"></a> CMFCRibbonButton::DrawBottomText

```
CSize DrawBottomText(
    CDC* pDC,
    BOOL bCalcOnly);
```

### Parameters

[in] *pDC*<br/>
[in] *bCalcOnly*<br/>

### Return Value

### Remarks

## <a name="drawimage"></a> CMFCRibbonButton::DrawImage

```
virtual void DrawImage(
    CDC* pDC,
    RibbonImageType type,
    CRect rectImage);
```

### Parameters

[in] *pDC*<br/>
[in] *type*<br/>
[in] *rectImage*<br/>

### Remarks

## <a name="drawribbontext"></a> CMFCRibbonButton::DrawRibbonText

```
virtual int DrawRibbonText(
    CDC* pDC,
    const CString& strText,
    CRect rectText,
    UINT uiDTFlags,
    COLORREF clrText = (COLORREF)-1);
```

### Parameters

[in] *pDC*<br/>
[in] *strText*<br/>
[in] *rectText*<br/>
[in] *uiDTFlags*<br/>
[in] *clrText*<br/>

### Return Value

### Remarks

## <a name="findsubitemindexbyid"></a> CMFCRibbonButton::FindSubItemIndexByID

Returns the index of a pop-up menu item that is associated with the specified command ID.

```
int FindSubItemIndexByID(UINT uiID) const;
```

### Parameters

*uiID*<br/>
[in] Specifies the command ID of the pop-up menu item.

### Return Value

The zero-based index of the sub-item that is associated with the *uiID*. -1 if there is no such sub-item.

## <a name="getcommandrect"></a> CMFCRibbonButton::GetCommandRect

```
CRect GetCommandRect() const;
```

### Return Value

### Remarks

## <a name="getcompactsize"></a> CMFCRibbonButton::GetCompactSize

```
virtual CSize GetCompactSize(CDC* pDC);
```

### Parameters

[in] *pDC*<br/>

### Return Value

### Remarks

## <a name="geticon"></a> CMFCRibbonButton::GetIcon

```
HICON GetIcon(BOOL bLargeIcon = TRUE) const;
```

### Parameters

[in] *bLargeIcon*<br/>

### Return Value

### Remarks

## <a name="getimageindex"></a> CMFCRibbonButton::GetImageIndex

Returns the index of the image that is associated with the button.

```
int GetImageIndex(BOOL bLargeImage) const;
```

### Parameters

*bLargeImage*<br/>
[in] If TRUE, returns the image index in the image list that contains the large images; otherwise returns the image index in the image list that contains the small images.

### Return Value

The index of the button's image in the associated image list.

## <a name="getimagesize"></a> CMFCRibbonButton::GetImageSize

```
virtual CSize GetImageSize(RibbonImageType type) const;
```

### Parameters

[in] *type*<br/>

### Return Value

### Remarks

## <a name="getintermediatesize"></a> CMFCRibbonButton::GetIntermediateSize

```
virtual CSize GetIntermediateSize(CDC* pDC);
```

### Parameters

[in] *pDC*<br/>

### Return Value

### Remarks

## <a name="getmenu"></a> CMFCRibbonButton::GetMenu

Returns a handle to a Windows menu that is assigned to the ribbon button.

```
HMENU GetMenu() const;
```

### Return Value

A handle to a Windows menu assigned to the button; NULL if there is no menu assigned.

## <a name="getmenurect"></a> CMFCRibbonButton::GetMenuRect

```
CRect GetMenuRect() const;
```

### Return Value

### Remarks

## <a name="getregularsize"></a> CMFCRibbonButton::GetRegularSize

```
virtual CSize GetRegularSize(CDC* pDC);
```

### Parameters

[in] *pDC*<br/>

### Return Value

### Remarks

## <a name="getsubitems"></a> CMFCRibbonButton::GetSubItems

```
const CArray<CMFCRibbonBaseElement*, CMFCRibbonBaseElement*>& GetSubItems() const;
```

### Return Value

### Remarks

## <a name="gettextrowheight"></a> CMFCRibbonButton::GetTextRowHeight

```
int GetTextRowHeight() const;
```

### Return Value

### Remarks

## <a name="gettooltiptext"></a> CMFCRibbonButton::GetToolTipText

```
virtual CString GetToolTipText() const;
```

### Return Value

### Remarks

## <a name="hascompactmode"></a> CMFCRibbonButton::HasCompactMode

```
virtual BOOL HasCompactMode() const;
```

### Return Value

### Remarks

## <a name="hasintermediatemode"></a> CMFCRibbonButton::HasIntermediateMode

```
virtual BOOL HasIntermediateMode() const;
```

### Return Value

### Remarks

## <a name="haslargemode"></a> CMFCRibbonButton::HasLargeMode

```
virtual BOOL HasLargeMode() const;
```

### Return Value

### Remarks

## <a name="hasmenu"></a> CMFCRibbonButton::HasMenu

```
virtual BOOL HasMenu() const;
```

### Return Value

### Remarks

## <a name="isalwaysdrawborder"></a> CMFCRibbonButton::IsAlwaysDrawBorder

```
virtual BOOL IsAlwaysDrawBorder() const;
```

### Return Value

### Remarks

## <a name="isalwayslargeimage"></a> CMFCRibbonButton::IsAlwaysLargeImage

```
virtual BOOL IsAlwaysLargeImage() const;
```

### Return Value

### Remarks

## <a name="isapplicationbutton"></a> CMFCRibbonButton::IsApplicationButton

```
virtual BOOL IsApplicationButton() const;
```

### Return Value

### Remarks

## <a name="iscommandareahighlighted"></a> CMFCRibbonButton::IsCommandAreaHighlighted

```
virtual BOOL IsCommandAreaHighlighted() const;
```

### Return Value

### Remarks

## <a name="isdefaultcommand"></a> CMFCRibbonButton::IsDefaultCommand

Specifies whether the default command for a ribbon button is enabled.

```
BOOL IsDefaultCommand() const;
```

### Return Value

TRUE if you have enabled the default command for a ribbon button; FALSE otherwise.

## <a name="isdefaultpanelbutton"></a> CMFCRibbonButton::IsDefaultPanelButton

```
virtual BOOL IsDefaultPanelButton() const;
```

### Return Value

### Remarks

## <a name="isdrawtooltipimage"></a> CMFCRibbonButton::IsDrawTooltipImage

```
virtual BOOL IsDrawTooltipImage() const;
```

### Return Value

### Remarks

## <a name="islargeimage"></a> CMFCRibbonButton::IsLargeImage

```
BOOL IsLargeImage() const;
```

### Return Value

### Remarks

## <a name="ismenuareahighlighted"></a> CMFCRibbonButton::IsMenuAreaHighlighted

```
virtual BOOL IsMenuAreaHighlighted() const;
```

### Return Value

### Remarks

## <a name="ismenuonbottom"></a> CMFCRibbonButton::IsMenuOnBottom

```
BOOL IsMenuOnBottom() const;
```

### Return Value

### Remarks

## <a name="ispopupdefaultmenulook"></a> CMFCRibbonButton::IsPopupDefaultMenuLook

```
virtual BOOL IsPopupDefaultMenuLook() const;
```

### Return Value

### Remarks

## <a name="isrightalignmenu"></a> CMFCRibbonButton::IsRightAlignMenu

Specifies whether the menu is right-aligned.

```
BOOL IsRightAlignMenu() const;
```

### Return Value

TRUE if menu is right-aligned; otherwise FALSE.

## <a name="issinglelinetext"></a> CMFCRibbonButton::IsSingleLineText

```
BOOL IsSingleLineText() const;
```

### Return Value

### Remarks

## <a name="oncalctextsize"></a> CMFCRibbonButton::OnCalcTextSize

```
virtual void OnCalcTextSize(CDC* pDC);
```

### Parameters

[in] *pDC*<br/>

### Remarks

## <a name="onclick"></a> CMFCRibbonButton::OnClick

Called by the framework when the user clicks the button.

```
virtual void OnClick(CPoint point);
```

### Parameters

*point*<br/>
[in] Specifies the position of the mouse click.

### Remarks

Override this method in a derived class if you want to handle this event.

## <a name="ondraw"></a> CMFCRibbonButton::OnDraw

```
virtual void OnDraw(CDC* pDC);
```

### Parameters

[in] *pDC*<br/>

### Remarks

## <a name="ondrawborder"></a> CMFCRibbonButton::OnDrawBorder

```
virtual void OnDrawBorder(CDC* pDC);
```

### Parameters

[in] *pDC*<br/>

### Remarks

## <a name="onfillbackground"></a> CMFCRibbonButton::OnFillBackground

```
virtual COLORREF OnFillBackground(CDC* pDC);
```

### Parameters

[in] *pDC*<br/>

### Return Value

### Remarks

## <a name="removeallsubitems"></a> CMFCRibbonButton::RemoveAllSubItems

Removes all menu items from the pop-up menu.

```cpp
void RemoveAllSubItems();
```

## <a name="removesubitem"></a> CMFCRibbonButton::RemoveSubItem

Removes a menu item from the pop-up menu.

```
BOOL RemoveSubItem(int nIndex);
```

### Parameters

*nIndex*<br/>
[in] Specifies the zero-based index of the menu item that you want to remove.

### Return Value

TRUE if the specified item has been removed successfully; otherwise FALSE if *nIndex* is negative or exceeds the number of menu items in the pop-up menu.

## <a name="setaccdata"></a> CMFCRibbonButton::SetACCData

Sets the accessibility data for the ribbon button.

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### Parameters

*pParent*<br/>
The parent window for the ribbon element.

*data*<br/>
The accessibility data for the ribbon element.

### Return Value

Returns TRUE if successful; otherwise FALSE.

### Remarks

## <a name="setalwayslargeimage"></a> CMFCRibbonButton::SetAlwaysLargeImage

Specifies whether the button displays a large or a small image when the user collapses the button.

```cpp
void SetAlwaysLargeImage(BOOL bSet=TRUE);
```

### Parameters

*bSet*<br/>
[in] If TRUE, the button displays a large image. Otherwise, the button displays a small image.

## <a name="setdefaultcommand"></a> CMFCRibbonButton::SetDefaultCommand

Enables the default command for the ribbon button.

```cpp
void SetDefaultCommand(BOOL bSet=TRUE);
```

### Parameters

*bSet*<br/>
[in] If TRUE, the button can execute its default command. If FALSE, the button cannot execute its default command.

### Remarks

*bSet* is relevant only when the button has a menu. If *bSet* is TRUE, the button can execute its default command and the assigned pop-up menu appears only when a user clicks the arrow at the right edge of the button. Otherwise, the button cannot execute its default command, and the pop-up menu appears regardless of which area of the button the user clicks.

## <a name="setdescription"></a> CMFCRibbonButton::SetDescription

```
virtual void SetDescription(LPCTSTR lpszText);
```

### Parameters

[in] *lpszText*<br/>

### Remarks

## <a name="setimageindex"></a> CMFCRibbonButton::SetImageIndex

Assigns an index to the image of the button.

```cpp
void SetImageIndex(
    int nIndex,
    BOOL bLargeImage);
```

### Parameters

*nIndex*<br/>
[in] Specifies the image index.

*bLargeImage*<br/>
[in] If TRUE, the specified index refers to the list of large images. Otherwise, the index refers to the list of the small images.

## <a name="setmenu"></a> CMFCRibbonButton::SetMenu

Assigns a pop-up menu to the ribbon button.

```cpp
void SetMenu(
    HMENU hMenu,
    BOOL bIsDefaultCommand=FALSE,
    BOOL bRightAlign=FALSE);

void SetMenu(
    UINT uiMenuResID,
    BOOL bIsDefaultCommand=FALSE,
    BOOL bRightAlign=FALSE);
```

### Parameters

*hMenu*<br/>
A handle to a Windows menu.

*bIsDefaultCommand*<br/>
If TRUE, the button can execute its default command; otherwise, the button displays a pop-up menu.

*bRightAlign*<br/>
If TRUE, the menu is right-aligned. Otherwise, the menu is left-aligned.

*uiMenuResID*<br/>
A menu resource ID.

### Remarks

When the application assigns the menu to the button, the button displays an arrow on its right side. If *bIsDefaultCommand* is TRUE, the menu appears only when the user clicks the arrow. If the user clicks the button, its default command is executed. If *bIsDefaultCommand* is FALSE, the menu appears by clicking anywhere on the button.

## <a name="setparentcategory"></a> CMFCRibbonButton::SetParentCategory

```
virtual void SetParentCategory(CMFCRibbonCategory* pParent);
```

### Parameters

[in] *pParent*<br/>

### Remarks

## <a name="setrightalignmenu"></a> CMFCRibbonButton::SetRightAlignMenu

Aligns the pop-up menu to the edge of the button.

```cpp
void SetRightAlignMenu(BOOL bSet=TRUE);
```

### Parameters

*bSet*<br/>
[in] If TRUE, the menu is right-aligned. Otherwise, the menu is left-aligned

## <a name="settext"></a> CMFCRibbonButton::SetText

```
virtual void SetText(LPCTSTR lpszText);
```

### Parameters

[in] *lpszText*<br/>

### Remarks

## See also

[Hierarchy Chart](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)

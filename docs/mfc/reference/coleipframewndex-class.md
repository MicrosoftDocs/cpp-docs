---
description: "Learn more about: COleIPFrameWndEx Class"
title: "COleIPFrameWndEx Class"
ms.date: "11/04/2016"
f1_keywords: ["COleIPFrameWndEx", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::AddDockSite", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::AddPane", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::AdjustDockingLayout", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::DockPane", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::DockPaneLeftOf", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::EnableAutoHidePanes", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::EnableDocking", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::EnablePaneMenu", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetActivePopup", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetContainerFrameWindow", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetDefaultResId", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetDockFrame", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetDockingManager", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetMainFrame", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetMenuBar", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetPane", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetTearOffBars", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetToolbarButtonToolTipText", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::InsertPane", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::IsMenuBarAvailable", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::IsPointNearDockSite", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::LoadFrame", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnCloseDockingPane", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnCloseMiniFrame", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnClosePopupMenu", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnCmdMsg", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnDrawMenuImage", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnDrawMenuLogo", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnMenuButtonToolHitTest", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnMoveMiniFrame", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnSetPreviewMode", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnShowCustomizePane", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnShowPanes", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnShowPopupMenu", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnTearOffMenu", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::PaneFromPoint", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::PreTranslateMessage", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::RecalcLayout", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::RemovePaneFromDockManager", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::SetDockState", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::SetupToolbarMenu", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::ShowPane", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::WinHelpA", "AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::InitUserToobars"]
helpviewer_keywords: ["COleIPFrameWndEx [MFC], AddDockSite", "COleIPFrameWndEx [MFC], AddPane", "COleIPFrameWndEx [MFC], AdjustDockingLayout", "COleIPFrameWndEx [MFC], DockPane", "COleIPFrameWndEx [MFC], DockPaneLeftOf", "COleIPFrameWndEx [MFC], EnableAutoHidePanes", "COleIPFrameWndEx [MFC], EnableDocking", "COleIPFrameWndEx [MFC], EnablePaneMenu", "COleIPFrameWndEx [MFC], GetActivePopup", "COleIPFrameWndEx [MFC], GetContainerFrameWindow", "COleIPFrameWndEx [MFC], GetDefaultResId", "COleIPFrameWndEx [MFC], GetDockFrame", "COleIPFrameWndEx [MFC], GetDockingManager", "COleIPFrameWndEx [MFC], GetMainFrame", "COleIPFrameWndEx [MFC], GetMenuBar", "COleIPFrameWndEx [MFC], GetPane", "COleIPFrameWndEx [MFC], GetTearOffBars", "COleIPFrameWndEx [MFC], GetToolbarButtonToolTipText", "COleIPFrameWndEx [MFC], InsertPane", "COleIPFrameWndEx [MFC], IsMenuBarAvailable", "COleIPFrameWndEx [MFC], IsPointNearDockSite", "COleIPFrameWndEx [MFC], LoadFrame", "COleIPFrameWndEx [MFC], OnCloseDockingPane", "COleIPFrameWndEx [MFC], OnCloseMiniFrame", "COleIPFrameWndEx [MFC], OnClosePopupMenu", "COleIPFrameWndEx [MFC], OnCmdMsg", "COleIPFrameWndEx [MFC], OnDrawMenuImage", "COleIPFrameWndEx [MFC], OnDrawMenuLogo", "COleIPFrameWndEx [MFC], OnMenuButtonToolHitTest", "COleIPFrameWndEx [MFC], OnMoveMiniFrame", "COleIPFrameWndEx [MFC], OnSetPreviewMode", "COleIPFrameWndEx [MFC], OnShowCustomizePane", "COleIPFrameWndEx [MFC], OnShowPanes", "COleIPFrameWndEx [MFC], OnShowPopupMenu", "COleIPFrameWndEx [MFC], OnTearOffMenu", "COleIPFrameWndEx [MFC], PaneFromPoint", "COleIPFrameWndEx [MFC], PreTranslateMessage", "COleIPFrameWndEx [MFC], RecalcLayout", "COleIPFrameWndEx [MFC], RemovePaneFromDockManager", "COleIPFrameWndEx [MFC], SetDockState", "COleIPFrameWndEx [MFC], SetupToolbarMenu", "COleIPFrameWndEx [MFC], ShowPane", "COleIPFrameWndEx [MFC], WinHelpA", "COleIPFrameWndEx [MFC], InitUserToobars"]
ms.assetid: ebff1560-a1eb-4854-af00-95d4a192bd55
---
# COleIPFrameWndEx Class

The `COleIPFrameWndEx` class implements an OLE container that supports MFC. You must derive the in-place frame window class for your application from the `COleIPFrameWndEx` class, instead of deriving it from the [COleIPFrameWnd](../../mfc/reference/coleipframewnd-class.md)class.
For more detail see the source code located in the **VC\\atlmfc\\src\\mfc** folder of your Visual Studio installation.

## Syntax

```
class COleIPFrameWndEx : public COleIPFrameWnd
```

## Members

### Public Methods

|Name|Description|
|----------|-----------------|
|[COleIPFrameWndEx::AddDockSite](#adddocksite)||
|[COleIPFrameWndEx::AddPane](#addpane)||
|[COleIPFrameWndEx::AdjustDockingLayout](#adjustdockinglayout)||
|[COleIPFrameWndEx::DockPane](#dockpane)||
|[COleIPFrameWndEx::DockPaneLeftOf](#dockpaneleftof)|Docks one pane to the left of another pane.|
|[COleIPFrameWndEx::EnableAutoHidePanes](#enableautohidepanes)||
|[COleIPFrameWndEx::EnableDocking](#enabledocking)||
|[COleIPFrameWndEx::EnablePaneMenu](#enablepanemenu)||
|[COleIPFrameWndEx::GetActivePopup](#getactivepopup)|Returns a pointer to the currently displayed popup menu.|
|[COleIPFrameWndEx::GetContainerFrameWindow](#getcontainerframewindow)||
|[COleIPFrameWndEx::GetDefaultResId](#getdefaultresid)|Returns the resource ID of the frame window that you specified when the window was loaded.|
|[COleIPFrameWndEx::GetDockFrame](#getdockframe)||
|[COleIPFrameWndEx::GetDockingManager](#getdockingmanager)||
|[COleIPFrameWndEx::GetMainFrame](#getmainframe)||
|[COleIPFrameWndEx::GetMenuBar](#getmenubar)|Returns a pointer to the menu bar object attached to the frame window.|
|[COleIPFrameWndEx::GetPane](#getpane)||
|[COleIPFrameWndEx::GetTearOffBars](#gettearoffbars)|Returns a list of pane objects that are in a tear-off state.|
|[COleIPFrameWndEx::GetToolbarButtonToolTipText](#gettoolbarbuttontooltiptext)|Called by the framework before the tooltip for a button is displayed.|
|[COleIPFrameWndEx::InsertPane](#insertpane)||
|[COleIPFrameWndEx::IsMenuBarAvailable](#ismenubaravailable)|Determines whether the pointer to the menu bar object is not `NULL`.|
|[COleIPFrameWndEx::IsPointNearDockSite](#ispointneardocksite)||
|[COleIPFrameWndEx::LoadFrame](#loadframe)|(Overrides `COleIPFrameWnd::LoadFrame`.)|
|[COleIPFrameWndEx::OnCloseDockingPane](#onclosedockingpane)||
|[COleIPFrameWndEx::OnCloseMiniFrame](#oncloseminiframe)||
|[COleIPFrameWndEx::OnClosePopupMenu](#onclosepopupmenu)|Called by the framework when an active pop-up menu processes a WM_DESTROY message.|
|[COleIPFrameWndEx::OnCmdMsg](#oncmdmsg)|(Overrides `CFrameWnd::OnCmdMsg`.)|
|[COleIPFrameWndEx::OnDrawMenuImage](#ondrawmenuimage)|Called by the framework when the image associated with a menu item is drawn.|
|[COleIPFrameWndEx::OnDrawMenuLogo](#ondrawmenulogo)|Called by the framework when a [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)object processes a WM_PAINT message.|
|[COleIPFrameWndEx::OnMenuButtonToolHitTest](#onmenubuttontoolhittest)|Called by the framework when a [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)object processes WM_NCHITTEST message.|
|[COleIPFrameWndEx::OnMoveMiniFrame](#onmoveminiframe)||
|[COleIPFrameWndEx::OnSetPreviewMode](#onsetpreviewmode)|Call this member function to set the application's main frame window into and out of print-preview mode. (Overrides [CFrameWnd::OnSetPreviewMode](../../mfc/reference/cframewnd-class.md#onsetpreviewmode).)|
|[COleIPFrameWndEx::OnShowCustomizePane](#onshowcustomizepane)||
|[COleIPFrameWndEx::OnShowPanes](#onshowpanes)||
|[COleIPFrameWndEx::OnShowPopupMenu](#onshowpopupmenu)|Called by the framework when a pop-up menu is activated.|
|[COleIPFrameWndEx::OnTearOffMenu](#ontearoffmenu)|Called by the framework when a menu that has a tear-off bar is activated.|
|[COleIPFrameWndEx::PaneFromPoint](#panefrompoint)||
|[COleIPFrameWndEx::PreTranslateMessage](#pretranslatemessage)|(Overrides `COleIPFrameWnd::PreTranslateMessage`.)|
|[COleIPFrameWndEx::RecalcLayout](#recalclayout)|(Overrides `COleIPFrameWnd::RecalcLayout`.)|
|[COleIPFrameWndEx::RemovePaneFromDockManager](#removepanefromdockmanager)||
|[COleIPFrameWndEx::SetDockState](#setdockstate)|Applies the specified docking state to the panes that belong to the frame window.|
|[COleIPFrameWndEx::SetupToolbarMenu](#setuptoolbarmenu)|Modifies a toolbar object by searching for dummy items and replacing them with the specified user-defined items.|
|[COleIPFrameWndEx::ShowPane](#showpane)||
|[COleIPFrameWndEx::WinHelpA](#winhelpa)|Called by the framework to initiate the WinHelp application or context help.|

### Protected Methods

|Name|Description|
|----------|-----------------|
|[COleIPFrameWndEx::InitUserToobars](#initusertoobars)|Tells the framework to initialize a range of control IDs that are assigned to user-defined toolbars.|

## Example

The following example demonstrates how to subclass an instance of the `COleIPFrameWndEx` class and over ride its methods. The example shows how to over ride the `OnDestory` method, the `RepositionFrame` method, the `RecalcLayout` method, and the `CalcWindowRect` method. This code snippet is part of the [Word Pad sample](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_WordPad#1](../../mfc/reference/codesnippet/cpp/coleipframewndex-class_1.cpp)]

## Inheritance Hierarchy

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CFrameWnd](../../mfc/reference/cframewnd-class.md)

[COleIPFrameWnd](../../mfc/reference/coleipframewnd-class.md)

[COleIPFrameWndEx](../../mfc/reference/coleipframewndex-class.md)

## Requirements

**Header:** afxoleipframewndex.h

## <a name="adddocksite"></a> COleIPFrameWndEx::AddDockSite

```cpp
void AddDockSite();
```

### Remarks

## <a name="addpane"></a> COleIPFrameWndEx::AddPane

```
BOOL AddPane(
    CBasePane* pControlBar,
    BOOL bTail = TRUE);
```

### Parameters

[in] *pControlBar*<br/>
[in] *bTail*<br/>

### Return Value

### Remarks

## <a name="adjustdockinglayout"></a> COleIPFrameWndEx::AdjustDockingLayout

```
virtual void AdjustDockingLayout(HDWP hdwp = NULL);
```

### Parameters

[in] *hdwp*<br/>

### Remarks

## <a name="dockpane"></a> COleIPFrameWndEx::DockPane

```cpp
void DockPane(
    CBasePane* pBar,
    UINT nDockBarID = 0,
    LPCRECT lpRect = NULL);
```

### Parameters

[in] *pBar*<br/>
[in] *nDockBarID*<br/>
[in] *lpRect*<br/>

### Remarks

## <a name="dockpaneleftof"></a> COleIPFrameWndEx::DockPaneLeftOf

Docks one pane to the left of another pane.

```
BOOL DockPaneLeftOf(
    CPane* pBar,
    CPane* pLeftOf);
```

### Parameters

*pBar*<br/>
[in] A pointer to the pane to dock.

*pLeftOf*<br/>
[in] A pointer to the pane that serves as origin.

### Return Value

Returns TRUE if the operation is successful. Otherwise returns FALSE.

### Remarks

Call this method to dock several pane objects in a predefined order. This method docks the pane specified by *pBar* to the left of the pane specified by *pLeftOf*.

## <a name="enableautohidepanes"></a> COleIPFrameWndEx::EnableAutoHidePanes

```
BOOL EnableAutoHidePanes(DWORD dwDockStyle);
```

### Parameters

[in] *dwDockStyle*<br/>

### Return Value

### Remarks

## <a name="enabledocking"></a> COleIPFrameWndEx::EnableDocking

```
BOOL EnableDocking(DWORD dwDockStyle);
```

### Parameters

[in] *dwDockStyle*<br/>

### Return Value

### Remarks

## <a name="enablepanemenu"></a> COleIPFrameWndEx::EnablePaneMenu

```cpp
void EnablePaneMenu(
    BOOL bEnable,
    UINT uiCustomizeCmd,
    const CString& strCustomizeLabel,
    UINT uiViewToolbarsMenuEntryID,
    BOOL bContextMenuShowsToolbarsOnly = FALSE,
    BOOL bViewMenuShowsToolbarsOnly = FALSE);
```

### Parameters

[in] *bEnable*<br/>
[in] *uiCustomizeCmd*<br/>
[in] *strCustomizeLabel*<br/>
[in] *uiViewToolbarsMenuEntryID*<br/>
[in] *bContextMenuShowsToolbarsOnly*<br/>
[in] *bViewMenuShowsToolbarsOnly*<br/>

### Remarks

## <a name="getactivepopup"></a> COleIPFrameWndEx::GetActivePopup

Returns a pointer to the currently displayed pop-up menu.

```
CMFCPopupMenu* GetActivePopup() const;
```

### Return Value

A pointer to the active pop-up menu; otherwise NULL.

### Remarks

Use this method to obtain a pointer to the [CMFCPopupMenu Class](../../mfc/reference/cmfcpopupmenu-class.md) object that is currently displayed.

## <a name="getcontainerframewindow"></a> COleIPFrameWndEx::GetContainerFrameWindow

```
COleCntrFrameWndEx* GetContainerFrameWindow();
```

### Return Value

### Remarks

## <a name="getdefaultresid"></a> COleIPFrameWndEx::GetDefaultResId

Returns the menu resource ID that was specified when the frame window loaded the menu.

```
UINT GetDefaultResId() const;
```

### Return Value

Returns the resource ID of the menu, or 0 if the frame window has no menu bar.

### Remarks

Call this function to retrieve the resource ID that was specified when the frame window loaded the menu resource by calling `COleIPFrameWndEx::LoadFrame`.

## <a name="getdockframe"></a> COleIPFrameWndEx::GetDockFrame

```
CFrameWnd* GetDockFrame();
```

### Return Value

### Remarks

## <a name="getdockingmanager"></a> COleIPFrameWndEx::GetDockingManager

```
CDockingManager* GetDockingManager();
```

### Return Value

### Remarks

## <a name="getmainframe"></a> COleIPFrameWndEx::GetMainFrame

```
CFrameWnd* GetMainFrame();
```

### Return Value

### Remarks

## <a name="getmenubar"></a> COleIPFrameWndEx::GetMenuBar

Returns a pointer to the menu bar object attached to the frame window.

```
const CMFCMenuBar* GetMenuBar() const;
```

### Return Value

A pointer to the menu bar object.

### Remarks

Use this function to retrieve a pointer to the menu bar object that belongs to the `COleIPFrameWndEx` object.

## <a name="getpane"></a> COleIPFrameWndEx::GetPane

```
CBasePane* GetPane(UINT nID);
```

### Parameters

[in] *nID*<br/>

### Return Value

### Remarks

## <a name="gettearoffbars"></a> COleIPFrameWndEx::GetTearOffBars

Returns a list of pane objects that are in a tear-off state.

```
const CObList& GetTearOffBars() const;
```

### Return Value

A reference to a `CObList` object that contains a collection of pointers to the [CBasePane Class](../../mfc/reference/cbasepane-class.md)-derived objects.

### Remarks

The `COleIPFrameWndEx` object maintains the collection of tear-off menus as a list of [CBasePane Class](../../mfc/reference/cbasepane-class.md)-derived objects. Use this method to retrieve a reference to this list.

## <a name="gettoolbarbuttontooltiptext"></a> COleIPFrameWndEx::GetToolbarButtonToolTipText

Called by the framework before the tooltip for a button is displayed.

```
virtual BOOL GetToolbarButtonToolTipText(
    CMFCToolBarButton* pButton,
    CString& strTTText);
```

### Parameters

*pButton*<br/>
[in] Pointer to the button.

*strTTText*<br/>
[in] Pointer to the tooltip text.

### Return Value

The default implementation returns 0.

### Remarks

Override this function to customize the display of tooltips on toolbar buttons.

## <a name="initusertoobars"></a> COleIPFrameWndEx::InitUserToobars

Specifies a range of control IDs that the framework assigns to the user-defined toolbars.

```cpp
void InitUserToolbars(
    LPCTSTR lpszRegEntry,
    UINT uiUserToolbarFirst,
    UINT uiUserToolbarLast)
```

### Parameters

*lpszRegEntry*<br/>
[in] The registry entry where the library stores user toolbar settings.

*uiUserToolbarFirst*<br/>
[in] Control ID assigned to the first user-defined toolbar.

*uiUserToolbarLast*<br/>
[in] Control ID assigned to the last user-defined toolbar.

### Remarks

Use this function to initialize a range of control IDs for assignment to toolbars that users define dynamically. The parameters *uiUserToolbarFirst* and *uiUserToolbarLast* define a range of allowed toolbar control IDs. To disable the creation of user-defined toolbars, set *uiUserToolbarFirst* or *uiUserToolbarLast* to -1.

## <a name="insertpane"></a> COleIPFrameWndEx::InsertPane

```
BOOL InsertPane(
    CBasePane* pControlBar,
    CBasePane* pTarget,
    BOOL bAfter = TRUE);
```

### Parameters

[in] *pControlBar*<br/>
[in] *pTarget*<br/>
[in] *bAfter*<br/>

### Return Value

### Remarks

## <a name="ismenubaravailable"></a> COleIPFrameWndEx::IsMenuBarAvailable

Determines whether the pointer to the menu bar object is not NULL

```
BOOL IsMenuBarAvailable() const;
```

### Return Value

Returns a non-zero value if the frame window has a menu bar; otherwise returns 0.

### Remarks

Call this method to determine whether the frame window maintains a non- NULL pointer to its menu bar object.

## <a name="ispointneardocksite"></a> COleIPFrameWndEx::IsPointNearDockSite

```
BOOL IsPointNearDockSite(
    CPoint point,
    DWORD& dwBarAlignment,
    BOOL& bOuterEdge) const;
```

### Parameters

[in] *point*<br/>
[in] *dwBarAlignment*<br/>
[in] *bOuterEdge*<br/>

### Return Value

### Remarks

## <a name="loadframe"></a> COleIPFrameWndEx::LoadFrame

```
virtual BOOL LoadFrame(
    UINT nIDResource,
    DWORD dwDefaultStyle = WS_OVERLAPPEDWINDOW | FWS_ADDTOTITLE,
    CWnd* pParentWnd = NULL,
    CCreateContext* pContext = NULL);
```

### Parameters

[in] *nIDResource*<br/>
[in] *dwDefaultStyle*<br/>
[in] *pParentWnd*<br/>
[in] *pContext*<br/>

### Return Value

### Remarks

## <a name="onclosedockingpane"></a> COleIPFrameWndEx::OnCloseDockingPane

```
virtual BOOL OnCloseDockingPane(CDockablePane*);
```

### Parameters

[in] *CDockablePane&#42;*<br/>

### Return Value

### Remarks

## <a name="oncloseminiframe"></a> COleIPFrameWndEx::OnCloseMiniFrame

```
virtual BOOL OnCloseMiniFrame(CPaneFrameWnd*);
```

### Parameters

[in] *CPaneFrameWnd&#42;*<br/>

### Return Value

### Remarks

## <a name="onclosepopupmenu"></a> COleIPFrameWndEx::OnClosePopupMenu

Called by the framework when an active pop-up menu processes a WM_DESTROY message.

```
virtual void OnClosePopupMenu(CMFCPopupMenu* pMenuPopup);
```

### Parameters

*pMenuPopup*<br/>
[in] A pointer to the pop-up menu object.

### Remarks

Override this method to receive notifications from `CMFCPopupMenu` objects when they process WM_DESTROY messages.

## <a name="oncmdmsg"></a> COleIPFrameWndEx::OnCmdMsg

```
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### Parameters

[in] *nID*<br/>
[in] *nCode*<br/>
[in] *pExtra*<br/>
[in] *pHandlerInfo*<br/>

### Return Value

### Remarks

## <a name="ondrawmenuimage"></a> COleIPFrameWndEx::OnDrawMenuImage

Called by the framework when the image that is associated with a menu item is drawn.

```
virtual BOOL OnDrawMenuImage(
    CDC* pDC,
    const CMFCToolBarMenuButton* pMenuButton,
    const CRect& rectImage);
```

### Parameters

*pDC*<br/>
[in] Pointer to the device context.

*pMenuButton*<br/>
[in] Pointer to the menu button.

*rectImage*<br/>
[in] The image associated with the menu item.

### Return Value

The default implementation does nothing and returns 0.

### Remarks

Override this method if you want to customize image drawing for the menu items that belong to the menu bar owned by the `COleIPFrameWndEx`-derived object.

## <a name="ondrawmenulogo"></a> COleIPFrameWndEx::OnDrawMenuLogo

Called by the framework when a [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)object processes a WM_PAINT message.

```
virtual void OnDrawMenuLogo(
    CDC* pDC,
    CMFCPopupMenu* pMenu,
    const CRect& rectLogo);
```

### Parameters

*pDC*<br/>
[in] Pointer to the device context.

*pMenu*<br/>
[in] Pointer to the pop-up menu object.

*rectLogo*<br/>
[in] Pointer to the logo to display.

### Remarks

Override this method to display a logo on the pop-up menu associated with the menu bar owned by the `COleIPFrameWndEx`-derived object. The default implementation does nothing.

## <a name="onmenubuttontoolhittest"></a> COleIPFrameWndEx::OnMenuButtonToolHitTest

Called by the framework when a [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)object processes a WM_NCHITTEST message.

```
virtual BOOL OnMenuButtonToolHitTest(
    CMFCToolBarButton* pButton,
    TOOLINFO* pTI);
```

### Parameters

[in] pButton
Pointer to a menu button.

[out] pTI
Pointer to a `TOOLINFO` structure.

### Return Value

The default implementation does nothing and returns 0. Your implementation should return a non-zero value if it fills the *pTI* parameter.

### Remarks

Override this method to provide ToolTip information about a specific menu item.

## <a name="onmoveminiframe"></a> COleIPFrameWndEx::OnMoveMiniFrame

```
virtual BOOL OnMoveMiniFrame(CWnd* pFrame);
```

### Parameters

[in] *pFrame*<br/>

### Return Value

### Remarks

## <a name="onsetpreviewmode"></a> COleIPFrameWndEx::OnSetPreviewMode

```
virtual void OnSetPreviewMode(
    BOOL bPreview,
    CPrintPreviewState* pState);
```

### Parameters

[in] *bPreview*<br/>
[in] *pState*<br/>

### Remarks

## <a name="onshowcustomizepane"></a> COleIPFrameWndEx::OnShowCustomizePane

```
virtual BOOL OnShowCustomizePane(
    CMFCPopupMenu* pMenuPane,
    UINT uiToolbarID);
```

### Parameters

[in] *pMenuPane*<br/>
[in] *uiToolbarID*<br/>

### Return Value

### Remarks

## <a name="onshowpanes"></a> COleIPFrameWndEx::OnShowPanes

```
virtual BOOL OnShowPanes(BOOL bShow);
```

### Parameters

[in] *bShow*<br/>

### Return Value

### Remarks

## <a name="onshowpopupmenu"></a> COleIPFrameWndEx::OnShowPopupMenu

Called by the framework when a pop-up menu is displayed.

```
virtual BOOL OnShowPopupMenu(CMFCPopupMenu* pMenuPopup);
```

### Parameters

*pMenuPopup*<br/>
[in] Pointer to the pop-up menu to be displayed.

### Return Value

The default implementation does nothing and returns a non-zero value. Your implementation should return FALSE if the pop-up menu cannot be displayed.

### Remarks

Override this method to customize the display of a pop-up menu. For example, you could change the menu buttons to color menu buttons or initialize tear-off bars.

## <a name="ontearoffmenu"></a> COleIPFrameWndEx::OnTearOffMenu

Called by the framework when the user selects a menu that has a tear-off bar.

```
virtual BOOL OnTearOffMenu(
    CMFCPopupMenu* pMenuPopup,
    CPane* pBar);
```

### Parameters

*pMenuPopup*<br/>
[in] A pointer to the pop-up menu that the user selected.

*pBar*<br/>
[in] A pointer to the pane that hosts the menu.

### Return Value

TRUE if you want the framework to activate the pop-up menu; otherwise FALSE. The default value is TRUE.

### Remarks

Override this function if you want to customize the setup of the tear-off bar.

## <a name="panefrompoint"></a> COleIPFrameWndEx::PaneFromPoint

```
CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    bool bExactBar,
    CRuntimeClass* pRTCBarType) const;

CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    DWORD& dwAlignment,
    CRuntimeClass* pRTCBarType) const;
```

### Parameters

[in] *point*<br/>
[in] *nSensitivity*<br/>
[in] *bExactBar*<br/>
[in] *pRTCBarType*<br/>
[in] *dwAlignment*<br/>

### Return Value

### Remarks

## <a name="pretranslatemessage"></a> COleIPFrameWndEx::PreTranslateMessage

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### Parameters

[in] *pMsg*<br/>

### Return Value

### Remarks

## <a name="recalclayout"></a> COleIPFrameWndEx::RecalcLayout

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### Parameters

[in] *bNotify*<br/>

### Remarks

## <a name="removepanefromdockmanager"></a> COleIPFrameWndEx::RemovePaneFromDockManager

```cpp
void RemovePaneFromDockManager(
    CBasePane* pControlBar,
    BOOL bDestroy,
    BOOL bAdjustLayout,
    BOOL bAutoHide,
    CBasePane* pBarReplacement);
```

### Parameters

[in] *pControlBar*<br/>
[in] *bDestroy*<br/>
[in] *bAdjustLayout*<br/>
[in] *bAutoHide*<br/>
[in] *pBarReplacement*<br/>

### Remarks

## <a name="setdockstate"></a> COleIPFrameWndEx::SetDockState

Applies the specified docking state to panes that belong to the frame window.

```cpp
void SetDockState(const CDockState& state);
```

### Parameters

*state*<br/>
[in] Specifies the docking state.

### Remarks

Use this function to specify a new docking state for panes that belong to the `COleIPFrameWndEx` object.

## <a name="setuptoolbarmenu"></a> COleIPFrameWndEx::SetupToolbarMenu

Modifies a toolbar object by searching for dummy items and replacing them with the specified user-defined items.

```cpp
void SetupToolbarMenu(
    CMenu& menu,
    const UINT uiViewUserToolbarCmdFirst,
    const UINT uiViewUserToolbarCmdLast);
```

### Parameters

*menu*<br/>
[in] A reference to a [CMenu](../../mfc/reference/cmenu-class.md) object to be modified.

*uiViewUserToolbarCmdFirst*<br/>
[in] Specifies the first user-defined command.

*uiViewUserToolbarCmdLast*<br/>
[in] Specifies the last user-defined command.

### Remarks

## <a name="showpane"></a> COleIPFrameWndEx::ShowPane

```cpp
void ShowPane(
    CBasePane* pBar,
    BOOL bShow,
    BOOL bDelay,
    BOOL bActivate);
```

### Parameters

[in] *pBar*<br/>
[in] *bShow*<br/>
[in] *bDelay*<br/>
[in] *bActivate*<br/>

### Remarks

## <a name="winhelpa"></a> COleIPFrameWndEx::WinHelpA

Called by the framework to initiate the WinHelp application or context help.

```
virtual void WinHelp(
    DWORD dwData,
    UINT nCmd = HELP_CONTEXT);
```

### Parameters

[in] dwData
Specifies data as required for the type of help specified by *nCmd*.

*nCmd*<br/>
[in] Specifies the type of help requested. For a list of possible values and how they affect the *dwData* parameter, see the [WinHelp Function](/windows/win32/api/winuser/nf-winuser-winhelpw) in the Windows SDK.

### Remarks

## See also

[Hierarchy Chart](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CFrameWndEx Class](../../mfc/reference/cframewndex-class.md)<br/>
[CMDIFrameWndEx Class](../../mfc/reference/cmdiframewndex-class.md)

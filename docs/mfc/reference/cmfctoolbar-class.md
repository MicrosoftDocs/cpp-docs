---
description: "Learn more about: CMFCToolBar Class"
title: "CMFCToolBar Class"
ms.date: "11/04/2016"
f1_keywords: ["CMFCToolBar", "AFXTOOLBAR/CMFCToolBar", "AFXTOOLBAR/CMFCToolBar::AddBasicCommand", "AFXTOOLBAR/CMFCToolBar::AddCommandUsage", "AFXTOOLBAR/CMFCToolBar::AddToolBarForImageCollection", "AFXTOOLBAR/CMFCToolBar::AdjustLayout", "AFXTOOLBAR/CMFCToolBar::AdjustSize", "AFXTOOLBAR/CMFCToolBar::AllowChangeTextLabels", "AFXTOOLBAR/CMFCToolBar::AreTextLabels", "AFXTOOLBAR/CMFCToolBar::AutoGrayInactiveImages", "AFXTOOLBAR/CMFCToolBar::ButtonToIndex", "AFXTOOLBAR/CMFCToolBar::CalcFixedLayout", "AFXTOOLBAR/CMFCToolBar::CalcSize", "AFXTOOLBAR/CMFCToolBar::CanHandleSiblings", "AFXTOOLBAR/CMFCToolBar::CleanUpImages", "AFXTOOLBAR/CMFCToolBar::CleanUpLockedImages", "AFXTOOLBAR/CMFCToolBar::CanBeClosed", "AFXTOOLBAR/CMFCToolBar::CanBeRestored", "AFXTOOLBAR/CMFCToolBar::CanFocus", "AFXTOOLBAR/CMFCToolBar::CommandToIndex", "AFXTOOLBAR/CMFCToolBar::Create", "AFXTOOLBAR/CMFCToolBar::CreateEx", "AFXTOOLBAR/CMFCToolBar::Deactivate", "AFXTOOLBAR/CMFCToolBar::EnableCustomizeButton", "AFXTOOLBAR/CMFCToolBar::EnableDocking", "AFXTOOLBAR/CMFCToolBar::EnableLargeIcons", "AFXTOOLBAR/CMFCToolBar::EnableQuickCustomization", "AFXTOOLBAR/CMFCToolBar::EnableReflections", "AFXTOOLBAR/CMFCToolBar::EnableTextLabels", "AFXTOOLBAR/CMFCToolBar::FromHandlePermanent", "AFXTOOLBAR/CMFCToolBar::GetAllButtons", "AFXTOOLBAR/CMFCToolBar::GetAllToolbars", "AFXTOOLBAR/CMFCToolBar::GetBasicCommands", "AFXTOOLBAR/CMFCToolBar::GetButton", "AFXTOOLBAR/CMFCToolBar::GetButtonInfo", "AFXTOOLBAR/CMFCToolBar::GetButtonSize", "AFXTOOLBAR/CMFCToolBar::GetButtonStyle", "AFXTOOLBAR/CMFCToolBar::GetButtonText", "AFXTOOLBAR/CMFCToolBar::GetColdImages", "AFXTOOLBAR/CMFCToolBar::GetColumnWidth", "AFXTOOLBAR/CMFCToolBar::GetCommandButtons", "AFXTOOLBAR/CMFCToolBar::GetCount", "AFXTOOLBAR/CMFCToolBar::GetCustomizeButton", "AFXTOOLBAR/CMFCToolBar::GetDefaultImage", "AFXTOOLBAR/CMFCToolBar::GetDisabledImages", "AFXTOOLBAR/CMFCToolBar::GetDisabledMenuImages", "AFXTOOLBAR/CMFCToolBar::GetDroppedDownMenu", "AFXTOOLBAR/CMFCToolBar::GetGrayDisabledButtons", "AFXTOOLBAR/CMFCToolBar::GetHighlightedButton", "AFXTOOLBAR/CMFCToolBar::GetHotBorder", "AFXTOOLBAR/CMFCToolBar::GetHotTextColor", "AFXTOOLBAR/CMFCToolBar::GetHwndLastFocus", "AFXTOOLBAR/CMFCToolBar::GetOVERWRITESetText", "AFXTOOLBAR/CMFCToolBar::GetImageSize", "AFXTOOLBAR/CMFCToolBar::GetImages", "AFXTOOLBAR/CMFCToolBar::GetImagesOffset", "AFXTOOLBAR/CMFCToolBar::GetInvalidateItemRect", "AFXTOOLBAR/CMFCToolBar::GetItemID", "AFXTOOLBAR/CMFCToolBar::GetItemRect", "AFXTOOLBAR/CMFCToolBar::GetLargeColdImages", "AFXTOOLBAR/CMFCToolBar::GetLargeDisabledImages", "AFXTOOLBAR/CMFCToolBar::GetLargeImages", "AFXTOOLBAR/CMFCToolBar::GetLockedColdImages", "AFXTOOLBAR/CMFCToolBar::GetLockedDisabledImages", "AFXTOOLBAR/CMFCToolBar::GetLockedImages", "AFXTOOLBAR/CMFCToolBar::GetLockedImageSize", "AFXTOOLBAR/CMFCToolBar::GetLockedMenuImages", "AFXTOOLBAR/CMFCToolBar::GetMenuButtonSize", "AFXTOOLBAR/CMFCToolBar::GetMenuImageSize", "AFXTOOLBAR/CMFCToolBar::GetMenuImages", "AFXTOOLBAR/CMFCToolBar::GetOrigButtons", "AFXTOOLBAR/CMFCToolBar::GetOrigResetButtons", "AFXTOOLBAR/CMFCToolBar::GetResourceID", "AFXTOOLBAR/CMFCToolBar::GetRouteCommandsViaFrame", "AFXTOOLBAR/CMFCToolBar::GetRowHeight", "AFXTOOLBAR/CMFCToolBar::GetShowTooltips", "AFXTOOLBAR/CMFCToolBar::GetSiblingToolBar", "AFXTOOLBAR/CMFCToolBar::GetUserImages", "AFXTOOLBAR/CMFCToolBar::HitTest", "AFXTOOLBAR/CMFCToolBar::InsertButton", "AFXTOOLBAR/CMFCToolBar::InsertSeparator", "AFXTOOLBAR/CMFCToolBar::InvalidateButton", "AFXTOOLBAR/CMFCToolBar::IsAddRemoveQuickCustomize", "AFXTOOLBAR/CMFCToolBar::IsAltCustomizeMode", "AFXTOOLBAR/CMFCToolBar::IsAutoGrayInactiveImages", "AFXTOOLBAR/CMFCToolBar::IsBasicCommand", "AFXTOOLBAR/CMFCToolBar::IsButtonExtraSizeAvailable", "AFXTOOLBAR/CMFCToolBar::IsButtonHighlighted", "AFXTOOLBAR/CMFCToolBar::IsCommandPermitted", "AFXTOOLBAR/CMFCToolBar::IsCommandRarelyUsed", "AFXTOOLBAR/CMFCToolBar::IsCustomizeMode", "AFXTOOLBAR/CMFCToolBar::IsDragButton", "AFXTOOLBAR/CMFCToolBar::IsExistCustomizeButton", "AFXTOOLBAR/CMFCToolBar::IsFloating", "AFXTOOLBAR/CMFCToolBar::IsLargeIcons", "AFXTOOLBAR/CMFCToolBar::IsLastCommandFromButton", "AFXTOOLBAR/CMFCToolBar::IsLocked", "AFXTOOLBAR/CMFCToolBar::IsOneRowWithSibling", "AFXTOOLBAR/CMFCToolBar::IsUserDefined", "AFXTOOLBAR/CMFCToolBar::LoadBitmap", "AFXTOOLBAR/CMFCToolBar::LoadBitmapEx", "AFXTOOLBAR/CMFCToolBar::LoadParameters", "AFXTOOLBAR/CMFCToolBar::LoadState", "AFXTOOLBAR/CMFCToolBar::LoadToolBar", "AFXTOOLBAR/CMFCToolBar::LoadToolBarEx", "AFXTOOLBAR/CMFCToolBar::OnChangeHot", "AFXTOOLBAR/CMFCToolBar::OnFillBackground", "AFXTOOLBAR/CMFCToolBar::OnReset", "AFXTOOLBAR/CMFCToolBar::OnSetAccData", "AFXTOOLBAR/CMFCToolBar::OnSetDefaultButtonText", "AFXTOOLBAR/CMFCToolBar::RemoveAllButtons", "AFXTOOLBAR/CMFCToolBar::RemoveButton", "AFXTOOLBAR/CMFCToolBar::RemoveStateFromRegistry", "AFXTOOLBAR/CMFCToolBar::ReplaceButton", "AFXTOOLBAR/CMFCToolBar::ResetAll", "AFXTOOLBAR/CMFCToolBar::ResetAllImages", "AFXTOOLBAR/CMFCToolBar::RestoreOriginalState", "AFXTOOLBAR/CMFCToolBar::SaveState", "AFXTOOLBAR/CMFCToolBar::SetBasicCommands", "AFXTOOLBAR/CMFCToolBar::SetButtonInfo", "AFXTOOLBAR/CMFCToolBar::SetButtonStyle", "AFXTOOLBAR/CMFCToolBar::SetButtonText", "AFXTOOLBAR/CMFCToolBar::SetButtons", "AFXTOOLBAR/CMFCToolBar::SetCommandUsageOptions", "AFXTOOLBAR/CMFCToolBar::SetCustomizeMode", "AFXTOOLBAR/CMFCToolBar::SetGrayDisabledButtons", "AFXTOOLBAR/CMFCToolBar::SetHeight", "AFXTOOLBAR/CMFCToolBar::SetHotBorder", "AFXTOOLBAR/CMFCToolBar::SetHotTextColor", "AFXTOOLBAR/CMFCToolBar::SetLargeIcons", "AFXTOOLBAR/CMFCToolBar::SetLockedSizes", "AFXTOOLBAR/CMFCToolBar::SetMenuSizes", "AFXTOOLBAR/CMFCToolBar::SetNonPermittedCommands", "AFXTOOLBAR/CMFCToolBar::SetOneRowWithSibling", "AFXTOOLBAR/CMFCToolBar::SetPermament", "AFXTOOLBAR/CMFCToolBar::SetRouteCommandsViaFrame", "AFXTOOLBAR/CMFCToolBar::SetShowTooltips", "AFXTOOLBAR/CMFCToolBar::SetSiblingToolBar", "AFXTOOLBAR/CMFCToolBar::SetSizes", "AFXTOOLBAR/CMFCToolBar::SetToolBarBtnText", "AFXTOOLBAR/CMFCToolBar::SetTwoRowsWithSibling", "AFXTOOLBAR/CMFCToolBar::SetUserImages", "AFXTOOLBAR/CMFCToolBar::StretchPane", "AFXTOOLBAR/CMFCToolBar::TranslateChar", "AFXTOOLBAR/CMFCToolBar::UpdateButton", "AFXTOOLBAR/CMFCToolBar::WrapToolBar", "AFXTOOLBAR/CMFCToolBar::AllowShowOnList", "AFXTOOLBAR/CMFCToolBar::CalcMaxButtonHeight", "AFXTOOLBAR/CMFCToolBar::DoPaint", "AFXTOOLBAR/CMFCToolBar::DrawButton", "AFXTOOLBAR/CMFCToolBar::DrawSeparator", "AFXTOOLBAR/CMFCToolBar::OnUserToolTip", "AFXTOOLBAR/CMFCToolBar::m_bDontScaleImages", "AFXTOOLBAR/CMFCToolBar::m_dblLargeImageRatio"]
helpviewer_keywords: ["CMFCToolBar [MFC], AddBasicCommand", "CMFCToolBar [MFC], AddCommandUsage", "CMFCToolBar [MFC], AddToolBarForImageCollection", "CMFCToolBar [MFC], AdjustLayout", "CMFCToolBar [MFC], AdjustSize", "CMFCToolBar [MFC], AllowChangeTextLabels", "CMFCToolBar [MFC], AreTextLabels", "CMFCToolBar [MFC], AutoGrayInactiveImages", "CMFCToolBar [MFC], ButtonToIndex", "CMFCToolBar [MFC], CalcFixedLayout", "CMFCToolBar [MFC], CalcSize", "CMFCToolBar [MFC], CanHandleSiblings", "CMFCToolBar [MFC], CleanUpImages", "CMFCToolBar [MFC], CleanUpLockedImages", "CMFCToolBar [MFC], CanBeClosed", "CMFCToolBar [MFC], CanBeRestored", "CMFCToolBar [MFC], CanFocus", "CMFCToolBar [MFC], CanHandleSiblings", "CMFCToolBar [MFC], CommandToIndex", "CMFCToolBar [MFC], Create", "CMFCToolBar [MFC], CreateEx", "CMFCToolBar [MFC], Deactivate", "CMFCToolBar [MFC], EnableCustomizeButton", "CMFCToolBar [MFC], EnableDocking", "CMFCToolBar [MFC], EnableLargeIcons", "CMFCToolBar [MFC], EnableQuickCustomization", "CMFCToolBar [MFC], EnableReflections", "CMFCToolBar [MFC], EnableTextLabels", "CMFCToolBar [MFC], FromHandlePermanent", "CMFCToolBar [MFC], GetAllButtons", "CMFCToolBar [MFC], GetAllToolbars", "CMFCToolBar [MFC], GetBasicCommands", "CMFCToolBar [MFC], GetButton", "CMFCToolBar [MFC], GetButtonInfo", "CMFCToolBar [MFC], GetButtonSize", "CMFCToolBar [MFC], GetButtonStyle", "CMFCToolBar [MFC], GetButtonText", "CMFCToolBar [MFC], GetColdImages", "CMFCToolBar [MFC], GetColumnWidth", "CMFCToolBar [MFC], GetCommandButtons", "CMFCToolBar [MFC], GetCount", "CMFCToolBar [MFC], GetCustomizeButton", "CMFCToolBar [MFC], GetDefaultImage", "CMFCToolBar [MFC], GetDisabledImages", "CMFCToolBar [MFC], GetDisabledMenuImages", "CMFCToolBar [MFC], GetDroppedDownMenu", "CMFCToolBar [MFC], GetGrayDisabledButtons", "CMFCToolBar [MFC], GetHighlightedButton", "CMFCToolBar [MFC], GetHotBorder", "CMFCToolBar [MFC], GetHotTextColor", "CMFCToolBar [MFC], GetHwndLastFocus", "CMFCToolBar [MFC], GetIgnoreSetText", "CMFCToolBar [MFC], GetImageSize", "CMFCToolBar [MFC], GetImages", "CMFCToolBar [MFC], GetImagesOffset", "CMFCToolBar [MFC], GetInvalidateItemRect", "CMFCToolBar [MFC], GetItemID", "CMFCToolBar [MFC], GetItemRect", "CMFCToolBar [MFC], GetLargeColdImages", "CMFCToolBar [MFC], GetLargeDisabledImages", "CMFCToolBar [MFC], GetLargeImages", "CMFCToolBar [MFC], GetLockedColdImages", "CMFCToolBar [MFC], GetLockedDisabledImages", "CMFCToolBar [MFC], GetLockedImages", "CMFCToolBar [MFC], GetLockedImageSize", "CMFCToolBar [MFC], GetLockedMenuImages", "CMFCToolBar [MFC], GetMenuButtonSize", "CMFCToolBar [MFC], GetMenuImageSize", "CMFCToolBar [MFC], GetMenuImages", "CMFCToolBar [MFC], GetOrigButtons", "CMFCToolBar [MFC], GetOrigResetButtons", "CMFCToolBar [MFC], GetResourceID", "CMFCToolBar [MFC], GetRouteCommandsViaFrame", "CMFCToolBar [MFC], GetRowHeight", "CMFCToolBar [MFC], GetShowTooltips", "CMFCToolBar [MFC], GetSiblingToolBar", "CMFCToolBar [MFC], GetUserImages", "CMFCToolBar [MFC], HitTest", "CMFCToolBar [MFC], InsertButton", "CMFCToolBar [MFC], InsertSeparator", "CMFCToolBar [MFC], InvalidateButton", "CMFCToolBar [MFC], IsAddRemoveQuickCustomize", "CMFCToolBar [MFC], IsAltCustomizeMode", "CMFCToolBar [MFC], IsAutoGrayInactiveImages", "CMFCToolBar [MFC], IsBasicCommand", "CMFCToolBar [MFC], IsButtonExtraSizeAvailable", "CMFCToolBar [MFC], IsButtonHighlighted", "CMFCToolBar [MFC], IsCommandPermitted", "CMFCToolBar [MFC], IsCommandRarelyUsed", "CMFCToolBar [MFC], IsCustomizeMode", "CMFCToolBar [MFC], IsDragButton", "CMFCToolBar [MFC], IsExistCustomizeButton", "CMFCToolBar [MFC], IsFloating", "CMFCToolBar [MFC], IsLargeIcons", "CMFCToolBar [MFC], IsLastCommandFromButton", "CMFCToolBar [MFC], IsLocked", "CMFCToolBar [MFC], IsOneRowWithSibling", "CMFCToolBar [MFC], IsUserDefined", "CMFCToolBar [MFC], LoadBitmap", "CMFCToolBar [MFC], LoadBitmapEx", "CMFCToolBar [MFC], LoadParameters", "CMFCToolBar [MFC], LoadState", "CMFCToolBar [MFC], LoadToolBar", "CMFCToolBar [MFC], LoadToolBarEx", "CMFCToolBar [MFC], OnChangeHot", "CMFCToolBar [MFC], OnFillBackground", "CMFCToolBar [MFC], OnReset", "CMFCToolBar [MFC], OnSetAccData", "CMFCToolBar [MFC], OnSetDefaultButtonText", "CMFCToolBar [MFC], RemoveAllButtons", "CMFCToolBar [MFC], RemoveButton", "CMFCToolBar [MFC], RemoveStateFromRegistry", "CMFCToolBar [MFC], ReplaceButton", "CMFCToolBar [MFC], ResetAll", "CMFCToolBar [MFC], ResetAllImages", "CMFCToolBar [MFC], RestoreOriginalState", "CMFCToolBar [MFC], SaveState", "CMFCToolBar [MFC], SetBasicCommands", "CMFCToolBar [MFC], SetButtonInfo", "CMFCToolBar [MFC], SetButtonStyle", "CMFCToolBar [MFC], SetButtonText", "CMFCToolBar [MFC], SetButtons", "CMFCToolBar [MFC], SetCommandUsageOptions", "CMFCToolBar [MFC], SetCustomizeMode", "CMFCToolBar [MFC], SetGrayDisabledButtons", "CMFCToolBar [MFC], SetHeight", "CMFCToolBar [MFC], SetHotBorder", "CMFCToolBar [MFC], SetHotTextColor", "CMFCToolBar [MFC], SetLargeIcons", "CMFCToolBar [MFC], SetLockedSizes", "CMFCToolBar [MFC], SetMenuSizes", "CMFCToolBar [MFC], SetNonPermittedCommands", "CMFCToolBar [MFC], SetOneRowWithSibling", "CMFCToolBar [MFC], SetPermament", "CMFCToolBar [MFC], SetRouteCommandsViaFrame", "CMFCToolBar [MFC], SetShowTooltips", "CMFCToolBar [MFC], SetSiblingToolBar", "CMFCToolBar [MFC], SetSizes", "CMFCToolBar [MFC], SetToolBarBtnText", "CMFCToolBar [MFC], SetTwoRowsWithSibling", "CMFCToolBar [MFC], SetUserImages", "CMFCToolBar [MFC], StretchPane", "CMFCToolBar [MFC], TranslateChar", "CMFCToolBar [MFC], UpdateButton", "CMFCToolBar [MFC], WrapToolBar", "CMFCToolBar [MFC], AllowShowOnList", "CMFCToolBar [MFC], CalcMaxButtonHeight", "CMFCToolBar [MFC], DoPaint", "CMFCToolBar [MFC], DrawButton", "CMFCToolBar [MFC], DrawSeparator", "CMFCToolBar [MFC], OnUserToolTip", "CMFCToolBar [MFC], m_bDontScaleImages", "CMFCToolBar [MFC], m_dblLargeImageRatio"]
ms.assetid: e7679c01-fb94-44c0-98c6-3af955292fb5
---
# CMFCToolBar Class

The `CMFCToolBar` class resembles [CToolBar Class](../../mfc/reference/ctoolbar-class.md), but provides additional support for user interface features. These include flat toolbars, toolbars with hot images, large icons, pager buttons, locked toolbars, rebar controls, text under images, background images, and tabbed toolbars. The `CMFCToolBar` class also contains built-in support for user customization of toolbars and menus, drag-and-drop between toolbars and menus, combo box buttons, edit box buttons, color pickers, and roll-up buttons.

For more detail see the source code located in the **VC\\atlmfc\\src\\mfc** folder of your Visual Studio installation.

## Syntax

```
class CMFCToolBar : public CMFCBaseToolBar
```

## Members

### Public Constructors

|Name|Description|
|----------|-----------------|
|`CMFCToolBar::CMFCToolBar`|Default constructor.|
|`CMFCToolBar::~CMFCToolBar`|Destructor.|

### Public Methods

|Name|Description|
|----------|-----------------|
|[CMFCToolBar::AddBasicCommand](#addbasiccommand)|Adds a menu command to the list of commands that are always displayed when a user opens a menu.|
|[CMFCToolBar::AddCommandUsage](#addcommandusage)|Increments by one the counter that is associated with the given command.|
|[CMFCToolBar::AddToolBarForImageCollection](#addtoolbarforimagecollection)|Adds images from the user interface resources to the collection of images in the application.|
|[CMFCToolBar::AdjustLayout](#adjustlayout)|Recalculates the size and position of a toolbar. (Overrides [CBasePane::AdjustLayout](../../mfc/reference/cbasepane-class.md#adjustlayout)).|
|[CMFCToolBar::AdjustSize](#adjustsize)|Recalculates the size of the toolbar.|
|[CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels)|Specifies whether text labels can be shown under images on the toolbar buttons.|
|[CMFCToolBar::AreTextLabels](#aretextlabels)|Specifies whether text labels under images are currently displayed on the toolbar buttons.|
|[CMFCToolBar::AutoGrayInactiveImages](#autograyinactiveimages)|Enable or disables the automatic generation of inactive button images.|
|[CMFCToolBar::ButtonToIndex](#buttontoindex)|Returns the index of a specified [CMFCToolBarButton Class](../../mfc/reference/cmfctoolbarbutton-class.md) object in this toolbar.|
|[CMFCToolBar::CalcFixedLayout](#calcfixedlayout)|Calculates the horizontal size of the toolbar. (Overrides [CBasePane::CalcFixedLayout](../../mfc/reference/cbasepane-class.md#calcfixedlayout).)|
|[CMFCToolBar::CalcSize](#calcsize)|Called by the framework as part of the layout calculation process. (Overrides [CPane::CalcSize](../../mfc/reference/cpane-class.md#calcsize).)|
|[CMFCToolBar::CanHandleSiblings](#canhandlesiblings)|Determines whether the toolbar and its sibling are positioned on the same pane.|
|[CMFCToolBar::CleanUpImages](#cleanupimages)|Frees the system resources allocated for toolbar images.|
|[CMFCToolBar::CleanUpLockedImages](#cleanuplockedimages)|Frees the system resources allocated for locked toolbar images.|
|[CMFCToolBar::CanBeClosed](#canbeclosed)|Specifies whether a user can close the toolbar. (Overrides [CBasePane::CanBeClosed](../../mfc/reference/cbasepane-class.md#canbeclosed).)|
|[CMFCToolBar::CanBeRestored](#canberestored)|Determines whether the system can restore a toolbar to its original state after customization.|
|[CMFCToolBar::CanFocus](#canfocus)|Specifies whether the pane can receive focus. (Overrides [CBasePane::CanFocus](../../mfc/reference/cbasepane-class.md#canfocus).)|
|[CMFCToolBar::CanHandleSiblings](#canhandlesiblings)|Determines whether the toolbar and its sibling are positioned on the same pane.|
|[CMFCToolBar::CommandToIndex](#commandtoindex)|Returns the index of the button in the toolbar with a specified command ID.|
|[CMFCToolBar::Create](#create)|Creates a `CMFCToolBar` object.|
|[CMFCToolBar::CreateEx](#createex)|Creates a `CMFCToolBar` object that uses additional style options, such as large icons.|
|[CMFCToolBar::Deactivate](#deactivate)|Deactivates the toolbar.|
|[CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton)|Enables or disables the **Add or Remove Buttons** button that appears on the end of the toolbar.|
|[CMFCToolBar::EnableDocking](#enabledocking)|Enables docking of the pane to the main frame. (Overrides [CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking).)|
|[CMFCToolBar::EnableLargeIcons](#enablelargeicons)|Enables or disables large icons on toolbar buttons.|
|[CMFCToolBar::EnableQuickCustomization](#enablequickcustomization)|Enables or disables the quick customization of toolbars so that the user can press the **Alt** key and drag a button to a new location.|
|[CMFCToolBar::EnableReflections](#enablereflections)|Enables or disables command reflection.|
|[CMFCToolBar::EnableTextLabels](#enabletextlabels)|Enables or disables text labels under toolbar button images.|
|[CMFCToolBar::FromHandlePermanent](#fromhandlepermanent)|Retrieves a pointer to the `CMFCToolBar` object that contains the given window handle.|
|[CMFCToolBar::GetAllButtons](#getallbuttons)|Returns a read-only list of buttons in a toolbar.|
|[CMFCToolBar::GetAllToolbars](#getalltoolbars)|Returns a read-only list of all toolbars in the application.|
|[CMFCToolBar::GetBasicCommands](#getbasiccommands)|Returns a read-only list of the basic commands defined in the application.|
|[CMFCToolBar::GetButton](#getbutton)|Returns a pointer to the `CMFCToolBarButton` object that has a specified toolbar button index.|
|[CMFCToolBar::GetButtonInfo](#getbuttoninfo)|Returns the command ID, style, and image index of the button at a specified index.|
|[CMFCToolBar::GetButtonSize](#getbuttonsize)|Returns the dimensions of each button on the toolbar.|
|[CMFCToolBar::GetButtonStyle](#getbuttonstyle)|Returns the current style of the toolbar button that is located at the specified index.|
|[CMFCToolBar::GetButtonText](#getbuttontext)|Returns the text label of a button that has a specified index.|
|[CMFCToolBar::GetColdImages](#getcoldimages)|Returns a pointer to the collection of cold toolbar button images in the application.|
|[CMFCToolBar::GetColumnWidth](#getcolumnwidth)|Returns the width of the toolbar buttons.|
|[CMFCToolBar::GetCommandButtons](#getcommandbuttons)|Returns a list of buttons that have a specified command ID from all toolbars in the application.|
|[CMFCToolBar::GetCount](#getcount)|Returns the number of buttons and separators on the toolbar.|
|[CMFCToolBar::GetCustomizeButton](#getcustomizebutton)|Retrieves a pointer to the `CMFCCustomizeButton` object that is associated with the toolbar.|
|[CMFCToolBar::GetDefaultImage](#getdefaultimage)|Returns the index of the default image for a toolbar button with a specified command ID.|
|[CMFCToolBar::GetDisabledImages](#getdisabledimages)|Returns a pointer to the collection of images that are used for disabled toolbar buttons in the application.|
|[CMFCToolBar::GetDisabledMenuImages](#getdisabledmenuimages)|Returns a pointer to the collection of images that are used for disabled menu buttons in the application.|
|[CMFCToolBar::GetDroppedDownMenu](#getdroppeddownmenu)|Retrieves a pointer to the menu button object that is currently displaying its sub-menu.|
|[CMFCToolBar::GetGrayDisabledButtons](#getgraydisabledbuttons)|Specifies whether the images of disabled buttons are dimmed versions of the regular button images, or taken from the collection of disabled button images.|
|[CMFCToolBar::GetHighlightedButton](#gethighlightedbutton)|Returns a pointer to the toolbar button that is currently highlighted.|
|[CMFCToolBar::GetHotBorder](#gethotborder)|Determines whether the toolbar buttons are hot-tracked.|
|[CMFCToolBar::GetHotTextColor](#gethottextcolor)|Returns the text color of the highlighted toolbar buttons.|
|[CMFCToolBar::GetHwndLastFocus](#gethwndlastfocus)|Returns a handle to the window that had the input focus just before the toolbar did.|
|[CMFCToolBar::GetIgnoreSetText](#getignoresettext)|Specifies whether calls to set button labels are ignored.|
|[CMFCToolBar::GetImageSize](#getimagesize)|Returns the current size of toolbar button images.|
|[CMFCToolBar::GetImages](#getimages)|Returns a pointer to the collection of default button images in the application.|
|[CMFCToolBar::GetImagesOffset](#getimagesoffset)|Returns the index offset used to find the toolbar button images for this toolbar in the global list of toolbar button images.|
|[CMFCToolBar::GetInvalidateItemRect](#getinvalidateitemrect)|Retrieves the region of the client area that must be redrawn for the button at the given index.|
|[CMFCToolBar::GetItemID](#getitemid)|Returns the command ID of the toolbar button at a specified index.|
|[CMFCToolBar::GetItemRect](#getitemrect)|Returns the bounding rectangle of the button at a specified index.|
|[CMFCToolBar::GetLargeColdImages](#getlargecoldimages)|Returns a pointer to the collection of large cold toolbar button images in the application.|
|[CMFCToolBar::GetLargeDisabledImages](#getlargedisabledimages)|Returns a pointer to the collection of large disabled toolbar button images in the application.|
|[CMFCToolBar::GetLargeImages](#getlargeimages)|Returns a pointer to the collection of large toolbar button images in the application.|
|[CMFCToolBar::GetLockedColdImages](#getlockedcoldimages)|Returns a pointer to the collection of locked cold images in the toolbar.|
|[CMFCToolBar::GetLockedDisabledImages](#getlockeddisabledimages)|Returns a pointer to the collection of locked disabled images in the toolbar.|
|[CMFCToolBar::GetLockedImages](#getlockedimages)|Returns a pointer to the collection of locked button images in the toolbar.|
|[CMFCToolBar::GetLockedImageSize](#getlockedimagesize)|Returns the default size of locked toolbar images.|
|[CMFCToolBar::GetLockedMenuImages](#getlockedmenuimages)|Returns a pointer to the collection of locked toolbar menu images in the toolbar.|
|[CMFCToolBar::GetMenuButtonSize](#getmenubuttonsize)|Returns the size of menu buttons in the application.|
|[CMFCToolBar::GetMenuImageSize](#getmenuimagesize)|Returns the size of menu button images in the application.|
|[CMFCToolBar::GetMenuImages](#getmenuimages)|Returns a pointer to the collection of menu button images in the application.|
|[CMFCToolBar::GetOrigButtons](#getorigbuttons)|Retrieves the collection of non-customized buttons of the toolbar.|
|[CMFCToolBar::GetOrigResetButtons](#getorigresetbuttons)|Retrieves the collection of non-customized reset buttons of the toolbar.|
|[CMFCToolBar::GetResourceID](#getresourceid)|Retrieves the resource ID of the toolbar.|
|[CMFCToolBar::GetRouteCommandsViaFrame](#getroutecommandsviaframe)|Determines which object, the parent frame or the owner, sends commands to the toolbar.|
|[CMFCToolBar::GetRowHeight](#getrowheight)|Returns the height of toolbar buttons.|
|[CMFCToolBar::GetShowTooltips](#getshowtooltips)|Specifies whether tool tips are displayed for toolbar buttons.|
|[CMFCToolBar::GetSiblingToolBar](#getsiblingtoolbar)|Retrieves the sibling of the toolbar.|
|[CMFCToolBar::GetUserImages](#getuserimages)|Returns a pointer to the collection of user-defined toolbar button images in the application.|
|[CMFCToolBar::HitTest](#hittest)|Returns the index of the toolbar button that is located at the specified position.|
|[CMFCToolBar::InsertButton](#insertbutton)|Inserts a button into the toolbar.|
|[CMFCToolBar::InsertSeparator](#insertseparator)|Inserts a separator into the toolbar.|
|[CMFCToolBar::InvalidateButton](#invalidatebutton)|Invalidates the client area of the toolbar button that exists at the provided index.|
|[CMFCToolBar::IsAddRemoveQuickCustomize](#isaddremovequickcustomize)|Determines whether a user can add or remove toolbar buttons by using the **Customize** menu option.|
|[CMFCToolBar::IsAltCustomizeMode](#isaltcustomizemode)|Specifies whether *quick customization* is being used to drag a button.|
|[CMFCToolBar::IsAutoGrayInactiveImages](#isautograyinactiveimages)|Specifies whether the automatic generation of inactive (non-highlighted) button images is enabled.|
|[CMFCToolBar::IsBasicCommand](#isbasiccommand)|Determines whether a command is on the list of basic commands.|
|[CMFCToolBar::IsButtonExtraSizeAvailable](#isbuttonextrasizeavailable)|Determines whether the toolbar can display buttons that have extended borders.|
|[CMFCToolBar::IsButtonHighlighted](#isbuttonhighlighted)|Determines whether a button on the toolbar is highlighted.|
|[CMFCToolBar::IsCommandPermitted](#iscommandpermitted)|Determines whether a command is permitted.|
|[CMFCToolBar::IsCommandRarelyUsed](#iscommandrarelyused)|Determines whether a command is rarely used (see [CMFCToolBar::SetCommandUsageOptions](#setcommandusageoptions)).|
|[CMFCToolBar::IsCustomizeMode](#iscustomizemode)|Specifies whether the toolbar framework is in customization mode.|
|[CMFCToolBar::IsDragButton](#isdragbutton)|Determines whether a toolbar button is being dragged.|
|[CMFCToolBar::IsExistCustomizeButton](#isexistcustomizebutton)|Determines whether the toolbar contains the **Customize** button.|
|[CMFCToolBar::IsFloating](#isfloating)|Determines whether the toolbar is floating.|
|[CMFCToolBar::IsLargeIcons](#islargeicons)|Specifies whether toolbars in the application currently display large icons.|
|[CMFCToolBar::IsLastCommandFromButton](#islastcommandfrombutton)|Determines whether the most recently executed command was sent from the specified toolbar button.|
|[CMFCToolBar::IsLocked](#islocked)|Determines whether the toolbar is locked.|
|[CMFCToolBar::IsOneRowWithSibling](#isonerowwithsibling)|Determines whether the toolbar and its sibling toolbar are positioned on the same row.|
|[CMFCToolBar::IsUserDefined](#isuserdefined)|Specifies whether the toolbar is user-defined.|
|[CMFCToolBar::LoadBitmap](#loadbitmap)|Loads toolbar images from application resources.|
|[CMFCToolBar::LoadBitmapEx](#loadbitmapex)|Loads toolbar images from application resources. Includes large images.|
|[CMFCToolBar::LoadParameters](#loadparameters)|Loads global toolbar options from the Windows registry.|
|[CMFCToolBar::LoadState](#loadstate)|Loads the toolbar state information from the Windows registry. (Overrides [CPane::LoadState](../../mfc/reference/cpane-class.md#loadstate).)|
|[CMFCToolBar::LoadToolBar](#loadtoolbar)|Loads the toolbar from application resources.|
|[CMFCToolBar::LoadToolBarEx](#loadtoolbarex)|Loads the toolbar from application resources by using the `CMFCToolBarInfo` helper class to enable the application to use large images.|
|[CMFCToolBar::OnChangeHot](#onchangehot)|Called by the framework when a user selects a button on the toolbar.|
|[CMFCToolBar::OnFillBackground](#onfillbackground)|Called by the framework from [CBasePane::DoPaint](../../mfc/reference/cbasepane-class.md#dopaint) to fill the toolbar background.|
|[CMFCToolBar::OnReset](#onreset)|Restores the toolbar to its original state.|
|[CMFCToolBar::OnSetAccData](#onsetaccdata)|(Overrides [CBasePane::OnSetAccData](../../mfc/reference/cbasepane-class.md#onsetaccdata).)|
|[CMFCToolBar::OnSetDefaultButtonText](#onsetdefaultbuttontext)|Restores the text of a toolbar button to its default state.|
|`CMFCToolBar::OnUpdateCmdUI`|Used internally.|
|[CMFCToolBar::RemoveAllButtons](#removeallbuttons)|Removes all buttons from the toolbar.|
|[CMFCToolBar::RemoveButton](#removebutton)|Removes the button with the specified index from the toolbar.|
|[CMFCToolBar::RemoveStateFromRegistry](#removestatefromregistry)|Deletes the state information for the toolbar from the Windows registry.|
|[CMFCToolBar::ReplaceButton](#replacebutton)|Replaces a toolbar button with another toolbar button.|
|[CMFCToolBar::ResetAll](#resetall)|Restores all toolbars to their original states.|
|[CMFCToolBar::ResetAllImages](#resetallimages)|Clears all toolbar image collections in the application.|
|[CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)|Restores the original state of a toolbar.|
|[CMFCToolBar::SaveState](#savestate)|Saves the state information for the toolbar in the Windows registry. (Overrides [CPane::SaveState](../../mfc/reference/cpane-class.md#savestate).)|
|`CMFCToolBar::Serialize`|(Overrides `CBasePane::Serialize`.)|
|[CMFCToolBar::SetBasicCommands](#setbasiccommands)|Sets the list of commands that are always displayed when a user opens a menu.|
|[CMFCToolBar::SetButtonInfo](#setbuttoninfo)|Sets the command ID, style, and image ID of a toolbar button.|
|[CMFCToolBar::SetButtonStyle](#setbuttonstyle)|Sets the style of the toolbar button at the given index.|
|[CMFCToolBar::SetButtonText](#setbuttontext)|Sets the text label of a toolbar button.|
|[CMFCToolBar::SetButtons](#setbuttons)|Sets the buttons for the toolbar.|
|[CMFCToolBar::SetCommandUsageOptions](#setcommandusageoptions)|Specifies when rarely used commands do not appear in the menu of the application.|
|[CMFCToolBar::SetCustomizeMode](#setcustomizemode)|Enables or disables customization mode for all toolbars in the application.|
|[CMFCToolBar::SetGrayDisabledButtons](#setgraydisabledbuttons)|Specifies whether the disabled buttons on the toolbar are dimmed or if disabled images are used for the disabled buttons.|
|[CMFCToolBar::SetHeight](#setheight)|Sets the height of the toolbar.|
|[CMFCToolBar::SetHotBorder](#sethotborder)|Specifies whether toolbar buttons are hot-tracked.|
|[CMFCToolBar::SetHotTextColor](#sethottextcolor)|Sets the text color for hot toolbar buttons.|
|[CMFCToolBar::SetLargeIcons](#setlargeicons)|Specifies whether toolbar buttons display large icons.|
|[CMFCToolBar::SetLockedSizes](#setlockedsizes)|Sets the sizes of locked buttons and locked images on the toolbar.|
|[CMFCToolBar::SetMenuSizes](#setmenusizes)|Sets the size of toolbar menu buttons and their images.|
|[CMFCToolBar::SetNonPermittedCommands](#setnonpermittedcommands)|Sets the list of commands that cannot be executed by the user.|
|[CMFCToolBar::SetOneRowWithSibling](#setonerowwithsibling)|Positions the toolbar and its sibling on the same row.|
|[CMFCToolBar::SetPermament](#setpermament)|Specifies whether a user can close the toolbar.|
|[CMFCToolBar::SetRouteCommandsViaFrame](#setroutecommandsviaframe)|Specifies whether the parent frame or the owner sends commands to the toolbar.|
|[CMFCToolBar::SetShowTooltips](#setshowtooltips)|Specifies whether the framework displays tool tips.|
|[CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)|Specifies the sibling of the toolbar.|
|[CMFCToolBar::SetSizes](#setsizes)|Specifies the sizes of buttons and images on all toolbars.|
|[CMFCToolBar::SetToolBarBtnText](#settoolbarbtntext)|Specifies properties of a button on the toolbar.|
|[CMFCToolBar::SetTwoRowsWithSibling](#settworowswithsibling)|Positions the toolbar and its sibling on separate rows.|
|[CMFCToolBar::SetUserImages](#setuserimages)|Sets the collection of user-defined images in the application.|
|[CMFCToolBar::StretchPane](#stretchpane)|Stretches the toolbar vertically or horizontally. (Overrides [CBasePane::StretchPane](../../mfc/reference/cbasepane-class.md#stretchpane).)|
|[CMFCToolBar::TranslateChar](#translatechar)|Executes a button command if the specified key code corresponds to a valid keyboard shortcut.|
|[CMFCToolBar::UpdateButton](#updatebutton)|Updates the state of the specified button.|
|[CMFCToolBar::WrapToolBar](#wraptoolbar)|Repositions toolbar buttons within the given dimensions.|

### Protected Methods

|Name|Description|
|----------|-----------------|
|[CMFCToolBar::AllowShowOnList](#allowshowonlist)|Determines whether the toolbar is displayed in the list on the **Toolbars** pane of the **Customize** dialog box.|
|[CMFCToolBar::CalcMaxButtonHeight](#calcmaxbuttonheight)|Calculates the maximum height of a button in the toolbar.|
|[CMFCToolBar::DoPaint](#dopaint)|Repaints a toolbar.|
|[CMFCToolBar::DrawButton](#drawbutton)|Repaints a toolbar button.|
|[CMFCToolBar::DrawSeparator](#drawseparator)|Repaints a separator on a toolbar.|
|[CMFCToolBar::OnUserToolTip](#onusertooltip)|Called by the framework when the tooltip for a button is about to be displayed.|

### Data Members

|Name|Description|
|----------|-----------------|
|[CMFCToolBar::m_bDontScaleImages](#m_bdontscaleimages)|Specifies whether to scale or not toolbar images in high DPI mode.|
|[CMFCToolBar::m_dblLargeImageRatio](#m_dbllargeimageratio)|Specifies the ratio between the dimension (height or width) of large images and the dimension of regular images.|

## Remarks

To incorporate a `CMFCToolBar` object into your application, follow these steps:

1. Add a `CMFCToolBar` object to the main frame window.

1. When you process the WM_CREATE message for the main frame window, call either [CMFCToolBar::Create](#create) or [CMFCToolBar::CreateEx](#createex) to create the toolbar and specify its style.

1. Call [CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking) to specify the docking style.

To insert a special button, such as a combo box or drop-down toolbar, reserve a dummy button in the parent resource, and replace the dummy button at runtime by using [CMFCToolBar::ReplaceButton](#replacebutton). For more information, see [Walkthrough: Putting Controls On Toolbars](../walkthrough-putting-controls-on-toolbars.md).

`CMFCToolBar` is the base class for the MFC Library classes [CMFCMenuBar Class](../../mfc/reference/cmfcmenubar-class.md), [CMFCPopupMenuBar Class](../../mfc/reference/cmfcpopupmenubar-class.md), and [CMFCDropDownToolBar Class](../../mfc/reference/cmfcdropdowntoolbar-class.md).

## Example

The following example demonstrates how to use various methods in the `CMFCToolBar` class. The example shows how to set the text of the window label of the tool bar, set the borders, set the style of the pane, and enable the **Add or Remove Buttons** button that appears on the end of the toolbar. This code snippet is part of the [IE Demo sample](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#8](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_2.cpp)]

## Requirements

**Header:** afxtoolbar.h

## Inheritance Hierarchy

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CBasePane](../../mfc/reference/cbasepane-class.md)

[CPane](../../mfc/reference/cpane-class.md)

[CMFCBaseToolBar](../../mfc/reference/cmfcbasetoolbar-class.md)

`CMFCToolBar`

## <a name="addbasiccommand"></a> CMFCToolBar::AddBasicCommand

Adds a menu command to the list of commands that are always displayed when a user opens a menu.

```
static void __stdcall AddBasicCommand(UINT uiCmd);
```

### Parameters

*uiCmd*<br/>
[in] Specifies the command to add.

### Remarks

A basic command is always displayed when the menu is opened. This method is meaningful when the user chooses to view recently used commands.

Use the [CMFCToolBar::SetBasicCommands](#setbasiccommands) method to set the list of commands that are always displayed when a user opens a menu. Use the [CMFCToolBar::GetBasicCommands](#getbasiccommands) method to retrieve the list of basic commands that is used by your application.

## <a name="addcommandusage"></a> CMFCToolBar::AddCommandUsage

Increments by one the counter that is associated with the given command.

```
static void __stdcall AddCommandUsage(UINT uiCommand);
```

### Parameters

*uiCommand*<br/>
[in] Specifies the command counter to increment.

### Remarks

The framework calls this method when the user selects a menu item.

The framework uses command counters to display recently used menu items.

This method increments the command counter by using the [CMFCCmdUsageCount::AddCmd](../../mfc/reference/cmfccmdusagecount-class.md#addcmd) method.

## <a name="addtoolbarforimagecollection"></a> CMFCToolBar::AddToolBarForImageCollection

Adds images from the user interface resources to the collection of images in the application.

```
static BOOL __stdcall AddToolBarForImageCollection(
    UINT uiResID,
    UINT uiBmpResID=0,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### Parameters

*uiResID*<br/>
[in] Resource ID of a toolbar with images to load.

*uiBmpResID*<br/>
[in] Resource ID of a bitmap with toolbar images.

*uiColdResID*<br/>
[in] Resource ID of a bitmap with "cold" toolbar images.

*uiMenuResID*<br/>
[in] Resource ID of a bitmap with menu images.

*uiDisabledResID*<br/>
[in] Resource ID of a bitmap with disabled toolbar images.

*uiMenuDisabledResID*<br/>
[in] Resource ID of a bitmap with disabled menu images.

### Return Value

TRUE if the method succeeds; FALSE if *uiResID* or *uiBmpResID* do not specify valid resources, or another error occurs.

### Remarks

Call this method to load a bitmap with toolbar images and add it to the collection of toolbar images. This method creates a temporary toolbar object and calls [CMFCToolBar::LoadToolBar](#loadtoolbar).

## <a name="adjustlayout"></a> CMFCToolBar::AdjustLayout

Recalculates the size and position of a toolbar.

```
virtual void AdjustLayout();
```

### Remarks

Call this method when the toolbar has been created to recalculate its size and position.

The framework calls this method every time that the layout of the toolbar must be changed. For example, the layout must change when the user moves another control bar, resizes an application window, or customizes the toolbar.

Override this method to provide your own dynamic layout in classes that you derive from `CMFCToolbar`.

## <a name="adjustsize"></a> CMFCToolBar::AdjustSize

Recalculates the size of the toolbar.

```cpp
void AdjustSize();
```

### Remarks

This method makes sure that the toolbar fits in the bounds of the parent frame. This method does nothing if the toolbar has no parent frame.

The [CMFCToolBar::AdjustLayout](#adjustlayout) method calls this method to recalculate the size if the parent of the toolbar is not a `CMFCReBar` object.

## <a name="allowchangetextlabels"></a> CMFCToolBar::AllowChangeTextLabels

Specifies whether text labels can be shown under images on the toolbar buttons.

```
virtual BOOL AllowChangeTextLabels() const;
```

### Return Value

TRUE if it is allowed to display text labels below images; otherwise FALSE.

### Remarks

This method is called by the customization dialog box to determine whether to enable a **Show text labels** check-box on the **Toolbars** page for the selected toolbar.

The default implementation returns TRUE.

Override this method in an object derived from `CMFCToolBar` and return FALSE when you do not want the user to decide whether text labels are displayed on toolbar buttons under the images.

## <a name="allowshowonlist"></a> CMFCToolBar::AllowShowOnList

Determines whether the toolbar is displayed in the list of toolbars on the **Toolbars** pane of the **Customize** dialog box.

```
virtual BOOL AllowShowOnList() const;
```

### Return Value

TRUE if the toolbar object can be displayed in the list box on the toolbar customization page; otherwise FALSE.

### Remarks

This method is called by the framework to determine whether the list on the toolbar customization page should include a particular object derived from `CMFCToolBar`.

The default implementation always returns TRUE. Override this method when you do not want a toolbar to appear in the toolbars list in the customization dialog box.

## <a name="aretextlabels"></a> CMFCToolBar::AreTextLabels

Specifies whether text labels under images are currently displayed on the toolbar buttons.

```
BOOL AreTextLabels() const;
```

### Return Value

TRUE if the toolbar buttons display text labels below images; otherwise FALSE.

### Remarks

Use [CMFCToolBar::EnableTextLabels](#enabletextlabels) to specify whether the text is displayed. The default value is FALSE. Call [CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels) to specify whether the user can change this setting in the customization dialog box.

## <a name="autograyinactiveimages"></a> CMFCToolBar::AutoGrayInactiveImages

Enable or disables the automatic generation of inactive button images.

```
static void AutoGrayInactiveImages(
    BOOL bEnable=TRUE,
    int nGrayImagePercentage=0,
    BOOL bRedrawAllToolbars=TRUE);
```

### Parameters

*bEnable*<br/>
[in] A Boolean value that specifies whether to dim inactive images. If this parameter is TRUE, inactive images are dimmed. Otherwise, inactive images are not dimmed.

*nGrayImagePercentage*<br/>
[in] Specifies the luminance percentage for inactive images. If *bEnable* is FALSE, this value is ignored.

*bRedrawAllToolbars*<br/>
[in] A Boolean value that specifies whether to redraw all toolbars in the application. If this parameter is TRUE, this method redraws all toolbars.

### Remarks

If *bEnable* is TRUE, the framework uses *nGrayImagePercentage* to generate inactive images from the regular images. Otherwise, you must provide the set of inactive images by using the [CMFCToolBar::GetColdImages](#getcoldimages) method. By default, this option is disabled.

For more information about the *nGrayImagePercentage* parameter, see [CMFCToolBarImages::GrayImages](../../mfc/reference/cmfctoolbarimages-class.md#grayimages).

## <a name="buttontoindex"></a> CMFCToolBar::ButtonToIndex

Returns the index of a specified [CMFCToolBarButton Class](../../mfc/reference/cmfctoolbarbutton-class.md) object in this toolbar.

```
int ButtonToIndex(const CMFCToolBarButton* pButton) const;
```

### Parameters

*pButton*<br/>
[in] A pointer to the toolbar button object.

### Return Value

Index of *pButton* in the internal list of toolbar buttons; or -1 if the specified button is not on this toolbar.

## <a name="calcfixedlayout"></a> CMFCToolBar::CalcFixedLayout

Calculates the horizontal size of the toolbar.

```
virtual CSize CalcFixedLayout(
    BOOL bStretch,
    BOOL bHorz);
```

### Parameters

*bStretch*<br/>
[in] TRUE to stretch the toolbar to the size of the parent frame.

*bHorz*<br/>
[in] TRUE to orient the toolbar horizontally; FALSE to orient the toolbar vertically.

### Return Value

A `CSize` object that specifies the size of the toolbar.

### Remarks

This method calculates the size of the toolbar by using the `CMFCToolBar::CalcLayout` method. It passes the LM_STRETCH flag for the *dwMode* parameter if *bStretch* is TRUE. It passes the LM_HORZ flag if *bHorz* is TRUE.

See the VisualStudioDemo sample for an example that uses this method.

## <a name="calcmaxbuttonheight"></a> CMFCToolBar::CalcMaxButtonHeight

Calculates the maximum height of buttons in the toolbar.

```
virtual int CalcMaxButtonHeight();
```

### Return Value

The maximum height of buttons.

### Remarks

This method calculates the maximum height among all toolbar buttons on the toolbar. The height may vary depending on factors such as the current toolbar docking state.

Override this method in a class derived from `CMFCToolBar` to provide your own height calculation.

## <a name="calcsize"></a> CMFCToolBar::CalcSize

Called by the framework as part of the layout calculation process.

```
virtual CSize CalcSize(BOOL bVertDock);
```

### Parameters

*bVertDock*<br/>
[in] TRUE to specify that the toolbar is docked vertically; FALSE to specify that the toolbar is docked horizontally.

### Return Value

A `CSize` object that specifies the overall size of the buttons on the toolbar.

### Remarks

This method considers the attributes that affect the size of each button, such as the area of the text label and the border size.

If the toolbar contains no buttons, this method returns the reserved size of a single button by using the [CMFCToolBar::GetButtonSize](#getbuttonsize) method.

## <a name="canbeclosed"></a> CMFCToolBar::CanBeClosed

Specifies whether a user can close the toolbar.

```
virtual BOOL CanBeClosed() const;
```

### Return Value

TRUE if the toolbar can be closed by the user; otherwise FALSE.

### Remarks

The framework calls this method to determine whether the user can close a toolbar. If the method returns TRUE, the framework enables the SC_CLOSE command in the system menu of the toolbar and the user can close the toolbar by using a check box in the list of toolbars in the customization dialog box.

The default implementation returns TRUE. Override this method in a class derived from `CMFCToolBar` to make toolbar objects that cannot be closed by the user.

## <a name="canberestored"></a> CMFCToolBar::CanBeRestored

Determines whether the system can restore a toolbar to its original state after customization.

```
virtual BOOL CanBeRestored() const;
```

### Return Value

TRUE if the toolbar can be restored from the application resources; otherwise FALSE.

### Remarks

The framework calls this method to determine whether a toolbar can be returned to its original state after customization. The original state is loaded from the application resources.

If `CanBeRestored` returns TRUE, the **Toolbars** page of the customization dialog box enables the **Reset** button for the selected toolbar.

The default implementation returns TRUE if the original resource ID of the toolbar when it was loaded is non-zero. Usually, only user-defined toolbars cannot be restored.

You can override the `CanBeRestored` method to customize this behavior in derived classes.

## <a name="canfocus"></a> CMFCToolBar::CanFocus

Specifies whether the pane can receive focus.

```
virtual BOOL CanFocus() const;
```

### Return Value

This method returns FALSE.

### Remarks

This method overrides the base class implementation, [CBasePane::CanFocus](../../mfc/reference/cbasepane-class.md#canfocus), because toolbar objects cannot receive focus.

## <a name="canhandlesiblings"></a> CMFCToolBar::CanHandleSiblings

Determines whether the toolbar and its sibling are positioned on the same pane.

```
BOOL CanHandleSiblings();
```

### Return Value

TRUE if the toolbar has a sibling and the toolbar and its sibling are positioned on the same pane; otherwise FALSE.

### Remarks

The internal CMFCCustomizeButton::CreatePopupMenu method calls this method to determine how to show the **Customize** pop-up menu. If this method returns TRUE, the framework displays the **Show Buttons on One Row** or **Show Buttons on Two Rows** buttons.

You typically do not have to use this method. To enable the **Customize** button that appears on the toolbar, call the [CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton) method. To enable the **Show Buttons on One Row** or **Show Buttons on Two Rows** buttons, call [CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar).

## <a name="cleanupimages"></a> CMFCToolBar::CleanUpImages

Frees the system resources allocated for toolbar images.

```
static void CMFCToolBar::CleanUpImages();
```

### Remarks

The framework calls this method when an application shuts down.

## <a name="cleanuplockedimages"></a> CMFCToolBar::CleanUpLockedImages

Frees the system resources allocated for locked toolbar images.

```cpp
void CleanUpLockedImages();
```

### Remarks

Call this method when the visual style of your application changes. See the VisualStudioDemo sample for an example that uses this method.

## <a name="commandtoindex"></a> CMFCToolBar::CommandToIndex

Returns the index of the button in the toolbar with a specified command ID.

```
int CommandToIndex(
    UINT nIDFind,
    int iIndexFirst=0) const;
```

### Parameters

*nIDFind*<br/>
[in] Specifies the command ID.

*iIndexFirst*<br/>
[in] Specifies the initial index to start from.

### Return Value

Zero-based index of the toolbar button if the method was successful; -1 if there is no button with the specified ID.

### Remarks

A `CMFCToolBar` object maintains an internal list of the buttons on the toolbar. Call this function to retrieve the index of a button in the list given the command ID of the button.

If *iIndex* is greater than 0, this method ignores any button on the toolbar that has an index less than *iIndex*.

## <a name="create"></a> CMFCToolBar::Create

Creates a `CMFCToolBar` object.

```
virtual BOOL Create(
    CWnd* pParentWnd,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    UINT nID=AFX_IDW_TOOLBAR);
```

### Parameters

*pParentWnd*<br/>
[in] A pointer to the parent window of the toolbar.

*dwStyle*<br/>
[in] The toolbar style. See [Toolbar Control and Button Styles](/windows/win32/Controls/toolbar-control-and-button-styles) in the Windows SDK for the list of styles.

*nID*<br/>
[in] The ID of the child window of the toolbar.

### Return Value

TRUE if this method succeeds; otherwise FALSE.

### Remarks

This method creates a control bar and attaches it to the toolbar. It creates the control bar with the TBSTYLE_FLAT style. Call [CMFCToolBar::CreateEx](#createex) if you want a different control bar style.

## <a name="createex"></a> CMFCToolBar::CreateEx

Creates a `CMFCToolBar` object that uses additional style options, such as large icons.

```
virtual BOOL CreateEx(
    CWnd* pParentWnd,
    DWORD dwCtrlStyle=TBSTYLE_FLAT,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    CRect rcBorders=CRect(1,
    1,
    1,
    1),
    UINT nID=AFX_IDW_TOOLBAR);
```

### Parameters

*pParentWnd*<br/>
[in] A pointer to the parent window of the toolbar.

*dwCtrlStyle*<br/>
[in] Additional styles for creating the embedded control bar object.

*dwStyle*<br/>
[in] The toolbar style. See [Toolbar Control and Button Styles](/windows/win32/Controls/toolbar-control-and-button-styles) for a list of appropriate styles.

*rcBorders*<br/>
[in] A `CRect` object that specifies the widths of the toolbar window borders.

*nID*<br/>
[in] The ID of the child window of the toolbar.

### Return Value

Nonzero if this method succeeds; otherwise 0.

### Remarks

This method creates a control bar and attaches it to the toolbar.

Call this method instead of [CMFCToolBar::Create](#create) when you want to provide specific styles. For example, set *dwCtrlStyle* to TBSTYLE_FLAT | TBSTYLE_TRANSPARENT to create a toolbar that resembles the toolbars that are used by Internet Explorer 4.

### Example

The following example demonstrates how to use the `CreateEx` method of the `CMFCToolBar` class. This code snippet is part of the [IE Demo sample](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

## <a name="deactivate"></a> CMFCToolBar::Deactivate

Deactivates the toolbar.

```
virtual void Deactivate();
```

### Remarks

This method deactivates the toolbar by removing the focus from the highlighted toolbar button. The framework calls this method when the toolbar loses focus or is destroyed.

## <a name="dopaint"></a> CMFCToolBar::DoPaint

Repaints a toolbar.

```
virtual void DoPaint(CDC* pDC);
```

### Parameters

*pDC*<br/>
[in] A pointer to a device context.

### Remarks

This method is called by the framework when a part of the toolbar must be repainted.

Override this method to customize the appearance of an object derived from `CMFCToolBar`.

## <a name="drawbutton"></a> CMFCToolBar::DrawButton

Repaints a toolbar button.

```
virtual BOOL DrawButton(
    CDC* pDC,
    CMFCToolBarButton* pButton,
    CMFCToolBarImages* pImages,
    BOOL bHighlighted,
    BOOL bDrawDisabledImages);
```

### Parameters

*pDC*<br/>
[in] A pointer to a device context.

*pButton*<br/>
[in] A pointer to a button to draw.

*pImages*<br/>
[in] A pointer to the toolbar images.

*bHighlighted*<br/>
[in] TRUE if the button is highlighted; otherwise FALSE.

*bDrawDisabledImages*<br/>
[in] TRUE if disabled buttons are dimmed; otherwise FALSE.

### Return Value

TRUE if the button was repainted; FALSE if the button is hidden.

### Remarks

The [CMFCToolBar::DrawButton](#drawbutton) method calls this method when a toolbar button must be repainted.

Override this method if you want to customize the appearance of buttons on your toolbar.

## <a name="drawseparator"></a> CMFCToolBar::DrawSeparator

Repaints a separator on a toolbar.

```
virtual void DrawSeparator(
    CDC* pDC,
    const CRect& rect,
    BOOL bHorz);
```

### Parameters

*pDC*<br/>
[in] A pointer to a device context.

*rect*<br/>
[in] The bounding rectangle of the location where the separator is drawn, in pixels.

*bHorz*<br/>
[in] TRUE if the separator is horizontal, FALSE if the separator is vertical.

### Remarks

[CMFCToolBar::DoPaint](#dopaint) calls this method for each [CMFCToolBar::DrawSeparator](#drawseparator) object that has the TBBS_SEPARATOR style, instead of calling [CMFCToolBar::DrawButton](#drawbutton) for those buttons.

Override this method in a class derived from [CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md) to customize the appearance of separators on the toolbar. The default implementation calls [CMFCVisualManager::OnDrawSeparator](../../mfc/reference/cmfcvisualmanager-class.md#ondrawseparator) to draw a separator whose appearance is determined by the current visual manager.

## <a name="enablecustomizebutton"></a> CMFCToolBar::EnableCustomizeButton

Enables or disables the Customize button that appears on the toolbar.

```cpp
void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    const CString& strCustomizeText,
    BOOL bQuickCustomize=TRUE);

void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    UINT uiCustomizeTextResId,
    BOOL bQuickCustomize=TRUE);
```

### Parameters

*bEnable*<br/>
[in] Enables or disables the Customize button.

*iCustomizeCmd*<br/>
[in] The command ID of the Customize button.

*strCustomizeText*<br/>
[in] The text label of the Customize button.

*uiCustomizeTextResId*<br/>
[in] The resource string ID of the Customize button label.

*bQuickCustomize*<br/>
[in] Enables or disables the **Add or Remove Buttons** option on the menu that drops down from the button.

### Remarks

If *iCustomizeCmd* is -1, the framework displays the Customize button when multiple toolbar buttons do not fit in the toolbar area. The button displays a double left-pointing arrow, or chevron, which indicates that there are more buttons.

If *iCustomizeCmd* specifies a valid command ID, and *bEnable* is TRUE, the Customize button is always displayed. The button has a small down arrow and opens a menu that contains a command. This command uses the text label specified by *strCustomizeText*. If *bQuickCustomize* is also TRUE, the menu displays the **Add or Remove Buttons** option.

The framework dynamically adds to the menu any buttons that do not fit in the toolbar area before the item that is specified by *iCustomizeCmd*. The chevron is displayed next to the down arrow.

## <a name="enabledocking"></a> CMFCToolBar::EnableDocking

Enables docking of the pane to the main frame.

```
virtual void EnableDocking(DWORD dwAlignment);
```

### Parameters

*dwAlignment*<br/>
[in] Specifies the docking alignment to enable.

### Remarks

This method extends the base class implementation, [CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking), by setting the `CBasePane::m_dwControlBarStyle` data member to AFX_CBRS_FLOAT. This method then passes *dwAlignment* to the base class implementation.

## <a name="enablelargeicons"></a> CMFCToolBar::EnableLargeIcons

Enables or disables large icons on toolbar buttons.

```cpp
void EnableLargeIcons(BOOL bEnable);
```

### Parameters

*bEnable*<br/>
[in] TRUE to enable large icons, FALSE to disable large icons.

### Remarks

By default, large icons are enabled.

## <a name="enablequickcustomization"></a> CMFCToolBar::EnableQuickCustomization

Enables or disables the quick customization of toolbars so that the user can press the **Alt** key and drag a button to a new location.

```
static void EnableQuickCustomization(BOOL bEnable=TRUE);
```

### Parameters

*bEnable*<br/>
[in] TRUE to enable quick customization, FALSE to disable quick customization.

## <a name="enablereflections"></a> CMFCToolBar::EnableReflections

Enables or disables command reflection.

```cpp
void EnableReflections(BOOL bEnable = TRUE);
```

### Parameters

*bEnable*<br/>
[in] TRUE to enable command reflection; FALSE to disable command reflection.

### Remarks

Call this method to enable command reflection for toolbar buttons that contain embedded controls, such as combo boxes.

For more information about command reflection, see [TN062: Message Reflection for Windows Controls](../../mfc/tn062-message-reflection-for-windows-controls.md).

## <a name="enabletextlabels"></a> CMFCToolBar::EnableTextLabels

Enables or disables text labels under toolbar button images.

```cpp
void EnableTextLabels(BOOL bEnable=TRUE);
```

### Parameters

*bEnable*<br/>
TRUE if text labels appear under toolbar button images; otherwise FALSE.

### Remarks

If text labels are enabled, all buttons on the toolbar are enlarged to provide space for the labels to be displayed under the images. The customization dialog box has a **Show text label** check-box on the **Toolbars** page. When the user selects a toolbar and checks this option, the framework calls `EnableTextLabels` for the selected toolbar. You can disable the check-box for an object derived from [CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md) by returning FALSE from [CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels) .

## <a name="fromhandlepermanent"></a> CMFCToolBar::FromHandlePermanent

Retrieves a pointer to the `CMFCToolBar` object that contains the given window handle.

```
static CMFCToolBar* __stdcall FromHandlePermanent(HWND hwnd);
```

### Parameters

*hwnd*<br/>
[in] The window handle to look for.

### Return Value

A pointer to the `CMFCToolBar` object that contains the given window handle, or NULL if no corresponding `CMFCToolBar` object exists.

### Remarks

This shared method examines each toolbar in the application for the `CMFCToolBar` object that contains the given window handle.

## <a name="getallbuttons"></a> CMFCToolBar::GetAllButtons

Returns a read-only list of buttons in a toolbar.

```
const CObList& GetAllButtons() const;
```

### Return Value

A constant reference to a [CObList Class](../../mfc/reference/coblist-class.md) object, which contains a collection of [CMFCToolBarButton Class](../../mfc/reference/cmfctoolbarbutton-class.md) objects.

## <a name="getalltoolbars"></a> CMFCToolBar::GetAllToolbars

Returns a read-only list of all toolbars in the application.

```
static const CObList& GetAllToolbars();
```

### Return Value

A const reference to a [CObList Class](../../mfc/reference/coblist-class.md) object that contains a collection of `CMFCToolBar` objects.

## <a name="getbasiccommands"></a> CMFCToolBar::GetBasicCommands

Returns a read-only list of the basic commands defined in the application.

```
static const CList<UINT,UINT>& GetBasicCommands();
```

### Return Value

A const reference to a [CList Class](../../mfc/reference/clist-class.md) object that contains a collection of basic commands.

### Remarks

Add basic commands by calling [CMFCToolBar::AddBasicCommand](#addbasiccommand) or [CMFCToolBar::SetBasicCommands](#setbasiccommands).

## <a name="getbutton"></a> CMFCToolBar::GetButton

Returns a pointer to the [CMFCToolBarButton Class](../../mfc/reference/cmfctoolbarbutton-class.md) object at a specified index.

```
CMFCToolBarButton* GetButton(int iIndex) const;
```

### Parameters

*iIndex*<br/>
[in] Specifies the index of the button to return.

### Return Value

A pointer to the toolbar button if it exists; or NULL if there is no such button.

## <a name="getbuttoninfo"></a> CMFCToolBar::GetButtonInfo

Returns the command ID, style, and image index of the button at a specified index.

```cpp
void GetButtonInfo(
    int nIndex,
    UINT& nID,
    UINT& nStyle,
    int& iImage) const;
```

### Parameters

*nIndex*<br/>
[in] Specifies the index of the button in the list of buttons on the toolbar.

*nID*<br/>
[out] The command ID of a button.

*nStyle*<br/>
[out] The style of the button.

*iImage*<br/>
[out] The index of the image for the button.

### Remarks

The `GetButtonInfo` method finds a toolbar button at the specified index and retrieves the command ID, style and image index of the button.

If the button at the specified index does not exist, the framework sets *nID* and *nStyle* to 0, and *iImage* to -1 when the method returns.

## <a name="getbuttonsize"></a> CMFCToolBar::GetButtonSize

Returns the dimensions of each button on the toolbar.

```
CSize GetButtonSize() const;
```

### Return Value

A [CSize Class](../../atl-mfc-shared/reference/csize-class.md) object that specifies the dimensions of each button on the toolbar.

### Remarks

Call [CMFCToolBar::SetSizes](#setsizes) or [CMFCToolBar::SetLockedSizes](#setlockedsizes) to set the dimensions of each button on the toolbar.

## <a name="getbuttonstyle"></a> CMFCToolBar::GetButtonStyle

Returns the current style of the toolbar button that is located at the specified index.

```
UINT GetButtonStyle(int nIndex) const;
```

### Parameters

*nIndex*<br/>
[in] Specifies the index of a toolbar button.

### Return Value

A value that specifies the style of the toolbar button. . See [ToolBar Control Styles](../../mfc/reference/toolbar-control-styles.md) for a list of possible styles.

### Remarks

Call [CMFCToolBar::SetButtonStyle](#setbuttonstyle) to set the style of a toolbar button

## <a name="getbuttontext"></a> CMFCToolBar::GetButtonText

Returns the text label of a button that has a specified index.

```
CString GetButtonText(int nIndex) const;

void GetButtonText(
    int nIndex,
    CString& rString) const;
```

### Parameters

*nIndex*<br/>
[in] The index of a toolbar button.

*rString*<br/>
[out] The label text of the toolbar button.

### Return Value

The label text of the toolbar button.

### Remarks

Call [CMFCToolBar::SetButtonText](#setbuttontext) or [CMFCToolBar::SetToolBarBtnText](#settoolbarbtntext) to set the text label.

## <a name="getcoldimages"></a> CMFCToolBar::GetColdImages

Returns a pointer to the collection of cold toolbar button images in the application.

```
static CMFCToolBarImages* GetColdImages();
```

### Return Value

A pointer to the collection of cold toolbar button images.

### Remarks

Cold images are the images that are used when the user is not interacting with the toolbar buttons. Call [CMFCToolBar::LoadBitmapEx](#loadbitmapex) or [CMFCToolBar::LoadBitmap](#loadbitmap) to load the cold images.

## <a name="getcolumnwidth"></a> CMFCToolBar::GetColumnWidth

Returns the width of the toolbar buttons.

```
virtual int GetColumnWidth() const;
```

### Return Value

A value that specifies the width of toolbar buttons.

### Remarks

The framework calls this method to calculate toolbar layout. Override this method in a derived class to specify a different column width for your toolbar.

## <a name="getcommandbuttons"></a> CMFCToolBar::GetCommandButtons

Returns a list of buttons that have a specified command ID from all toolbars in the application.

```
static int GetCommandButtons(
    UINT uiCmd,
    CObList& listButtons);
```

### Parameters

*uiCmd*<br/>
[in] The command ID of the buttons.

*listButtons*<br/>
[out] A reference to a [CObList Class](../../mfc/reference/coblist-class.md) object that receives the list of toolbar buttons.

### Return Value

The number of buttons that have the specified command ID.

## <a name="getcount"></a> CMFCToolBar::GetCount

Returns the number of buttons and separators on the toolbar.

```
int GetCount() const;
```

### Return Value

The number of buttons and separators on the toolbar.

## <a name="getcustomizebutton"></a> CMFCToolBar::GetCustomizeButton

Retrieves a pointer to the `CMFCCustomizeButton` object that is associated with the toolbar.

```
CMFCCustomizeButton* GetCustomizeButton();
```

### Return Value

A pointer to the `CMFCCustomizeButton` object that is associated with the toolbar.

### Remarks

This method retrieves the **Customize** button that appears at the end of the toolbar. Use the [CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton) method to add the **Customize** button to your toolbar.

You can call the [CMFCToolBar::IsExistCustomizeButton](#isexistcustomizebutton) method to determine whether the toolbar contains a valid `CMFCCustomizeButton` object.

## <a name="getdefaultimage"></a> CMFCToolBar::GetDefaultImage

Returns the index of the default image for a toolbar button with a specified command ID.

```
static int GetDefaultImage(UINT uiID);
```

### Parameters

*uiID*<br/>
[in] Specifies the command ID of the button.

### Return Value

The index of the toolbar image in the shared list of images.

### Remarks

Use this shared method to retrieve the index of the default image for a toolbar button with the specified command ID. The return value is an index into the shared collection of toolbar button images for all toolbars in the application. Call the [CMFCToolBar::GetImages](#getimages) method to obtain a pointer to this collection.

## <a name="getdisabledimages"></a> CMFCToolBar::GetDisabledImages

Returns a pointer to the collection of images that are used for disabled toolbar buttons in the application.

```
static CMFCToolBarImages* __stdcall GetDisabledImages();
```

### Return Value

A pointer to the collection of disabled toolbar button images.

### Remarks

Load the disabled toolbar button images by using the [CMFCToolBarEditBoxButton Class](../../mfc/reference/cmfctoolbareditboxbutton-class.md) and [CMFCToolBar::LoadBitmap](#loadbitmap) methods.

## <a name="getdisabledmenuimages"></a> CMFCToolBar::GetDisabledMenuImages

Returns a pointer to the collection of images that are used for disabled menu buttons in the application.

```
static CMFCToolBarImages* __stdcall GetDisabledMenuImages();
```

### Return Value

A pointer to the collection of disabled menu images.

### Remarks

Load the disabled images by using the [CMFCToolBarEditBoxButton Class](../../mfc/reference/cmfctoolbareditboxbutton-class.md) method.

## <a name="getdroppeddownmenu"></a> CMFCToolBar::GetDroppedDownMenu

Retrieves a pointer to the menu button object that is currently displaying its sub-menu.

```
CMFCToolBarMenuButton* GetDroppedDownMenu(int* pIndex = NULL) const;
```

### Parameters

*pIndex*<br/>
[out] Receives the index of the button in the collection of toolbar buttons.

### Return Value

A pointer to the menu button object that is displaying its sub-menu or NULL if no menu is displaying its sub-menu.

### Remarks

If this method returns a non- NULL value and *pIndex* is not NULL, the value pointed to by *pIndex* is set to the index of the menu button in the collection of toolbar buttons.

## <a name="getgraydisabledbuttons"></a> CMFCToolBar::GetGrayDisabledButtons

Specifies whether the images of disabled buttons are dimmed versions of the regular button images, or taken from the collection of disabled button images.

```
BOOL GetGrayDisabledButtons() const;
```

### Return Value

TRUE to dim the images of disabled buttons; FALSE to obtain images from the collection of disabled images.

### Remarks

Use [CMFCToolBar::SetGrayDisabledButtons](#setgraydisabledbuttons) to switch between dimmed images and the images from the collection of disabled images.

## <a name="gethighlightedbutton"></a> CMFCToolBar::GetHighlightedButton

Returns a pointer to the toolbar button that is currently highlighted.

```
CMFCToolBarButton* GetHighlightedButton() const;
```

### Return Value

A pointer to a toolbar button object; or NULL if no button is highlighted.

### Remarks

A toolbar button is highlighted if it has keyboard focus. A toolbar button is also highlighted if the toolbar buttons are hot-tracked in this application (for more information, see [CMFCToolBar::GetHotBorder](#gethotborder) and [CMFCToolBar::SetHotBorder](#sethotborder)) and the mouse is pointing at it when no toolbar button or menu item has keyboard focus.

## <a name="gethotborder"></a> CMFCToolBar::GetHotBorder

Determines whether the toolbar buttons are *hot-tracked*. If a button is hot-tracked, it is highlighted when the mouse moves across it.

```
BOOL GetHotBorder() const;
```

### Return Value

TRUE if the toolbar buttons are hot-tracked; otherwise, FALSE.

### Remarks

By default, toolbar buttons are hot-tracked.

## <a name="gethottextcolor"></a> CMFCToolBar::GetHotTextColor

Returns the text color of the highlighted toolbar buttons.

```
static COLORREF GetHotTextColor();
```

### Return Value

A [COLORREF](/windows/win32/gdi/colorref) value that represent the current highlighted text color.

### Remarks

Call [CMFCToolBar::SetHotTextColor](#sethottextcolor) to set a new text color for highlighted toolbar buttons.

## <a name="gethwndlastfocus"></a> CMFCToolBar::GetHwndLastFocus

Returns a handle to the window that had the input focus just before the toolbar did.

```
HWND GetHwndLastFocus() const;
```

### Return Value

A handle to window that is not derived from [CMFCBaseToolBar Class](../../mfc/reference/cmfcbasetoolbar-class.md), which previously had the input focus; or NULL if there is no such window.

### Remarks

When a `CMFCToolBar` control receives the input focus, it stores a handle to the window that lost the focus so that it can restore it later.

## <a name="getignoresettext"></a> CMFCToolBar::GetIgnoreSetText

Specifies whether calls to set button labels are ignored.

```
BOOL GetIgnoreSetText() const;
```

### Return Value

TRUE if calls to set button labels are ignored; otherwise, FALSE.

### Remarks

## <a name="getimages"></a> CMFCToolBar::GetImages

Returns a pointer to the collection of default button images in the application.

```
static CMFCToolBarImages* GetImages();
```

### Return Value

A pointer to the [CMFCToolBarImages Class](../../mfc/reference/cmfctoolbarimages-class.md) object that contains the collection of default images for all toolbars in the application.

### Remarks

This shared method provides access to the collection of all default toolbar images for the application. Call the [CMFCToolBar::LoadBitmap](#loadbitmap) method to add images to the collection.

## <a name="getimagesize"></a> CMFCToolBar::GetImageSize

Returns the current size of toolbar button images.

```
CSize GetImageSize() const;
```

### Return Value

A [CSize Class](../../atl-mfc-shared/reference/csize-class.md) object that represents the current size of toolbar button images.

## <a name="getimagesoffset"></a> CMFCToolBar::GetImagesOffset

Returns the index offset used to find the toolbar button images for this toolbar in the global list of toolbar button images.

```
int GetImagesOffset() const;
```

### Return Value

The index offset of the toolbar images.

### Remarks

All toolbar default images are stored in the global [CMFCToolBarImages Class](../../mfc/reference/cmfctoolbarimages-class.md) list. The images for each button in the toolbar are stored consecutively in that list. To compute the index of the image, add the index of the button in the toolbar to the offset of the beginning of the list of images for that toolbar button.

Call [CMFCToolBar::ButtonToIndex](#buttontoindex) to obtain the index of a toolbar button given a pointer to the button.

Call [CMFCToolBar::GetImages](#getimages) to obtain a pointer to the collection of toolbar images.

## <a name="getinvalidateitemrect"></a> CMFCToolBar::GetInvalidateItemRect

Retrieves the region of the client area that must be redrawn for the button at the given index.

```
virtual void GetInvalidateItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### Parameters

*nIndex*<br/>
[in] The index of the button for which to retrieve the client area.

*lpRect*<br/>
[out] A pointer to a RECT object that receives the region of the client area.

### Remarks

The *lpRect* parameter must not be NULL. If no button exists at the provided index, *lpRect* receives a RECT object that is initialized to zero.

## <a name="getitemid"></a> CMFCToolBar::GetItemID

Returns the command ID of the toolbar button at a specified index.

```
UINT GetItemID(int nIndex) const;
```

### Parameters

*nIndex*<br/>
[in] Specifies the index of the toolbar button.

### Return Value

The command ID of the toolbar button; or zero if the button with the specified index does not exist.

## <a name="getitemrect"></a> CMFCToolBar::GetItemRect

Returns the bounding rectangle of the button at a specified index.

```
virtual void GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### Parameters

*nIndex*<br/>
[in] Specifies the index of a toolbar button.

*lpRect*<br/>
[out] A pointer to `CRect` object that receives the coordinates of the image bounding rectangle.

### Remarks

The `CRect` object to which *lpRect* points is set to 0 if a button at the specified index does not exist.

### Example

The following example demonstrates how to use the `GetItemRect` method of the `CMFCToolBar` class. This code snippet is part of the [IE Demo sample](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#9](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_4.cpp)]

## <a name="getlargecoldimages"></a> CMFCToolBar::GetLargeColdImages

Returns a pointer to the collection of large cold toolbar button images in the application.

```
static CMFCToolBarImages* GetLargeColdImages();
```

### Return Value

A pointer to the collection of large cold images.

### Remarks

Cold images are the images that are used when the user is not interacting with the toolbar buttons. Call [CMFCToolBar::LoadBitmapEx](#loadbitmapex) to load the large cold images.

## <a name="getlargedisabledimages"></a> CMFCToolBar::GetLargeDisabledImages

Returns a pointer to the collection of large disabled toolbar button images in the application.

```
static CMFCToolBarImages* GetLargeDisabledImages();
```

### Return Value

A pointer to the collection of large disabled toolbar button images.

### Remarks

Large images are large versions of the regular toolbar button images. Call [CMFCToolBar::LoadBitmapEx](#loadbitmapex) or [CMFCToolBar::LoadBitmap](#loadbitmap) to load the large images.

## <a name="getlargeimages"></a> CMFCToolBar::GetLargeImages

Returns a pointer to the collection of large toolbar button images in the application.

```
static CMFCToolBarImages* GetLargeImages();
```

### Return Value

A pointer to the collection of large toolbar button images.

### Remarks

Large images are large versions of the regular toolbar button images. Call [CMFCToolBar::LoadBitmapEx](#loadbitmapex) to load the large images.

## <a name="getlockedcoldimages"></a> CMFCToolBar::GetLockedColdImages

Returns a pointer to the collection of locked cold images in the toolbar.

```
CMFCToolBarImages* GetLockedColdImages();
```

### Return Value

A pointer to the collection of locked cold images, or NULL if the toolbar is not locked.

### Remarks

Locked images are versions of the regular toolbar button images that the framework uses when the user cannot customize the toolbar. Cold images are the images that are used when the user is not interacting with the toolbar buttons.

This method returns NULL if the toolbar is not locked. This method also generates an assertion failure in Debug builds if the toolbar is not locked. For more information about locked toolbars, see [CMFCToolBar::IsLocked](#islocked).

Call the [CMFCToolBar::LoadBitmapEx](#loadbitmapex) method to load the locked cold images.

## <a name="getlockeddisabledimages"></a> CMFCToolBar::GetLockedDisabledImages

Returns a pointer to the collection of locked disabled images in the toolbar.

```
CMFCToolBarImages* GetLockedDisabledImages();
```

### Return Value

A pointer to the collection of locked disabled images, or NULL if the toolbar is not locked.

### Remarks

Locked images are versions of the regular toolbar button images that the framework uses when the user cannot customize the toolbar. Disabled images are the images that the framework uses when a button has the TBBS_DISABLED style.

This method returns NULL if the toolbar is not locked. This method also generates an assertion failure in Debug builds if the toolbar is not locked. For more information about locked toolbars, see [CMFCToolBar::IsLocked](#islocked).

Call the [CMFCToolBar::LoadBitmapEx](#loadbitmapex) method to load the locked disabled images.

## <a name="getlockedimages"></a> CMFCToolBar::GetLockedImages

Returns a pointer to the collection of locked button images in the toolbar.

```
CMFCToolBarImages* GetLockedImages();
```

### Return Value

A pointer to the collection of locked toolbar button images, or NULL if the toolbar is not locked.

### Remarks

Locked images are versions of the regular toolbar button images that the framework uses when the user cannot customize the toolbar.

This method returns NULL if the toolbar is not locked. This method also generates an assertion failure in Debug builds if the toolbar is not locked. For more information about locked toolbars, see [CMFCToolBar::IsLocked](#islocked).

## <a name="getlockedimagesize"></a> CMFCToolBar::GetLockedImageSize

Returns the default size of locked toolbar images.

```
CSize GetLockedImageSize() const;
```

### Return Value

A `CSize` structure that specifies the size of locked toolbar images or an empty `CSize` structure if the toolbar is not locked.

### Remarks

Locked images are versions of the regular toolbar button images that the framework uses when the user cannot customize the toolbar.

This method returns a `CSize` structure with zero width and zero height if the toolbar is not locked. This method also generates an assertion failure in Debug builds if the toolbar is not locked. For more information about locked toolbars, see [CMFCToolBar::IsLocked](#islocked).

Call the [CMFCToolBar::SetLockedSizes](#setlockedsizes) method to specify the locked image size.

## <a name="getlockedmenuimages"></a> CMFCToolBar::GetLockedMenuImages

Returns a pointer to the collection of locked toolbar menu images in the toolbar.

```
CMFCToolBarImages* GetLockedMenuImages();
```

### Return Value

A pointer to the collection of locked toolbar menu images, or NULL if the toolbar is not locked.

### Remarks

Locked images are versions of the regular toolbar menu images that the framework uses when the user cannot customize the toolbar.

This method returns NULL if the toolbar is not locked. This method also generates an assertion failure in Debug builds if the toolbar is not locked. For more information about locked toolbars, see [CMFCToolBar::IsLocked](#islocked).

Call the [CMFCToolBar::LoadBitmapEx](#loadbitmapex) method to load the locked menu images.

## <a name="getmenubuttonsize"></a> CMFCToolBar::GetMenuButtonSize

Returns the size of menu buttons in the application.

```
static CSize GetMenuButtonSize();
```

### Return Value

A `CSize` object that represents the size of menu buttons, in pixels.

### Remarks

The size of menu buttons on toolbars is maintained as a global variable and can be retrieved by this static method.

Call [CMFCToolBar::SetMenuSizes](#setmenusizes) to set this global variable.

## <a name="getmenuimages"></a> CMFCToolBar::GetMenuImages

Returns a pointer to the collection of menu button images in the application.

```
static CMFCToolBarImages* GetMenuImages();
```

### Return Value

A pointer to the collection of menu images.

### Remarks

Call the [CMFCToolBar::LoadBitmapEx](#loadbitmapex) method to load the menu images.

Call the [CMFCToolBar::SetMenuSizes](#setmenusizes) method to set the size of buttons and their images.

## <a name="getmenuimagesize"></a> CMFCToolBar::GetMenuImageSize

Returns the size of menu button images in the application.

```
static CSize GetMenuImageSize();
```

### Return Value

A `CSize` object that represents the size of menu images.

### Remarks

This method returns the size of images on toolbar menu buttons that is maintained as a global variable. Call [CMFCToolBar::SetMenuSizes](#setmenusizes) to set this global variable.

## <a name="getorigbuttons"></a> CMFCToolBar::GetOrigButtons

Retrieves the collection of non-customized buttons of the toolbar.

```
const CObList& GetOrigButtons() const;
```

### Return Value

A reference to the list of non-customized buttons of the toolbar.

### Remarks

The framework creates a copy of toolbar buttons before they are customized by the user. The [CMFCToolBar::SetButtons](#setbuttons) method adds a copy of each button in the provided array to the list of original buttons. The [CMFCToolBar::RestoreOriginalState](#restoreoriginalstate) method restores the original state of the toolbar by loading it from the resource file.

To set the list of original buttons for your toolbar, call the [CMFCToolBar::SetOrigButtons](#setorigbuttons) method.

## <a name="getorigresetbuttons"></a> CMFCToolBar::GetOrigResetButtons

Retrieves the collection of non-customized reset buttons of the toolbar.

```
const CObList& GetOrigResetButtons() const;
```

### Return Value

A reference to the list of non-customized reset buttons of the toolbar.

### Remarks

When the user clicks the **Reset** button during customization mode, the framework uses this method to restore buttons that were removed from the toolbar.

The [CMFCToolBar::SetButtons](#setbuttons) method adds a copy of each toolbar button to the list of original reset buttons after it calls the [CMFCToolBar::OnReset](#onreset) method. You can override the [CMFCToolBar::OnReset](#onreset) method to customize the appearance of buttons after the user presses the **Reset** button.

## <a name="getresourceid"></a> CMFCToolBar::GetResourceID

Retrieves the resource ID of the toolbar.

```
UINT GetResourceID() const;
```

### Return Value

The resource ID of the toolbar.

### Remarks

Call the [CMFCToolBar::LoadToolBarEx](#loadtoolbarex) method to set the resource ID of the toolbar.

## <a name="getroutecommandsviaframe"></a> CMFCToolBar::GetRouteCommandsViaFrame

Determines which object, the parent frame or the owner, sends commands to the toolbar.

```
BOOL GetRouteCommandsViaFrame();
```

### Return Value

Nonzero if the parent frame sends commands to the toolbar; 0 if the owner sends commands to the toolbar.

### Remarks

By default, the parent frame sends commands to the toolbar. Call [CMFCToolBar::SetRouteCommandsViaFrame](#setroutecommandsviaframe) to change this behavior.

If this method returns a nonzero value, you can retrieve a pointer to the parent frame object by using the `CMFCToolBar::GetCommandTarget` method. See the VisualStudioDemo sample for an example that uses this method.

## <a name="getrowheight"></a> CMFCToolBar::GetRowHeight

Returns the height of toolbar buttons.

```
virtual int GetRowHeight() const;
```

### Return Value

The height of toolbar buttons, in pixels.

### Remarks

The framework calls this method to calculate toolbar layout. Override this method in a derived class to specify a different height for your toolbar.

## <a name="getshowtooltips"></a> CMFCToolBar::GetShowTooltips

Specifies whether tool tips are displayed for toolbar buttons.

```
static BOOL GetShowTooltips();
```

### Return Value

TRUE if tool tips are shown for toolbar buttons; otherwise FALSE.

### Remarks

By default tool tips are shown. You can change this static flag by calling [CMFCToolBar::SetShowTooltips](#setshowtooltips).

## <a name="getsiblingtoolbar"></a> CMFCToolBar::GetSiblingToolBar

Retrieves the sibling of the toolbar.

```
CMFCToolBar* GetSiblingToolBar();
```

### Return Value

A pointer to the sibling toolbar.

### Remarks

For more information about how to enable the **Show Buttons on One Row** and **Show Buttons on Two Rows** buttons, see [CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar).

## <a name="getuserimages"></a> CMFCToolBar::GetUserImages

Returns a pointer to the collection of user-defined toolbar button images in the application.

```
static CMFCToolBarImages* GetUserImages();
```

### Return Value

A pointer to the collection of user-defined toolbar button images for all toolbars in the application.

### Remarks

Call the [CMFCToolBar::SetUserImages](#setuserimages) method to set the collection of user-defined images in the application.

## <a name="hittest"></a> CMFCToolBar::HitTest

Returns the index of the toolbar button that is located at the specified position.

```
virtual int HitTest(CPoint point);
```

### Parameters

*point*<br/>
[in] The point to be tested, in client coordinates.

### Return Value

The index of the button that is located at the specified position, or -1 if there is no such button or the button is a separator.

## <a name="insertbutton"></a> CMFCToolBar::InsertButton

Inserts a button into the toolbar.

```
virtual int InsertButton(
    const CMFCToolBarButton& button,
    INT_PTR iInsertAt=-1);

virtual int InsertButton(
    CMFCToolBarButton* pButton,
    int iInsertAt=-1);
```

### Parameters

*button*<br/>
[in] Specifies the button to insert.

*iInsertAt*<br/>
[in] Specifies the zero-based position to insert the button at.

### Return Value

The position at which the button was inserted or -1 if an error occurs.

### Remarks

If *iInsertAt* is -1, this method adds the button to the end of the list of toolbar buttons.

Call the [CMFCToolBar::InsertSeparator](#insertseparator) method to insert a separator into the toolbar.

## <a name="insertseparator"></a> CMFCToolBar::InsertSeparator

Inserts a separator into the toolbar.

```
virtual int InsertSeparator(INT_PTR iInsertAt=-1);
```

### Parameters

*iInsertAt*<br/>
[in] Specifies the zero-based position to insert the separator at. This parameter must be larger than 0.

### Return Value

The position at which the separator was inserted or -1 if an error occurs.

### Remarks

Call this method to insert a separator between two existing buttons. If *iInsertAt* is -1, this method adds the separator to the end of the list of toolbar buttons.

You cannot use this method to add a separator to an empty toolbar.

Call the [CMFCToolBar::InsertButton](#insertbutton) method to insert a button into the toolbar.

## <a name="invalidatebutton"></a> CMFCToolBar::InvalidateButton

Invalidates the client area of the toolbar button that exists at the provided index.

```
CMFCToolBarButton* InvalidateButton(int nIndex);
```

### Parameters

*nIndex*<br/>
[in] The zero-based index of the button in the toolbar.

### Return Value

A pointer to the `CMFCToolBarButton` object that exists at the provided index or NULL if no such object exists.

### Remarks

The framework calls this method when it updates the client area that is associated with a toolbar button. It calls the [CWnd::InvalidateRect](../../mfc/reference/cwnd-class.md#invalidaterect) method with the client rectangle of the `CMFCToolBarButton` object that exists at the provided index.

## <a name="isaddremovequickcustomize"></a> CMFCToolBar::IsAddRemoveQuickCustomize

Determines whether a user can add or remove toolbar buttons by using the **Customize** menu option.

```
BOOL IsAddRemoveQuickCustomize();
```

### Return Value

TRUE if a user can use the **Customize** menu option to modify the toolbar; otherwise, FALSE.

### Remarks

## <a name="isaltcustomizemode"></a> CMFCToolBar::IsAltCustomizeMode

Specifies whether *quick customization* is being used to drag a button. When quick customization is enabled, a user can press and hold the Alt key and drag a button to a new location.

```
static BOOL __stdcall IsAltCustomizeMode();
```

### Return Value

TRUE if quick customization is being used to drag a button; otherwise, FALSE.

### Remarks

## <a name="isautograyinactiveimages"></a> CMFCToolBar::IsAutoGrayInactiveImages

Specifies whether the automatic generation of inactive (non-highlighted) button images is enabled.

```
static BOOL IsAutoGrayInactiveImages();
```

### Return Value

TRUE if the option to automatically dim inactive images is enabled; otherwise FALSE.

### Remarks

You can enable or disable automatic dimming of inactive images by calling [CMFCToolBar::AutoGrayInactiveImages](#autograyinactiveimages).

## <a name="isbasiccommand"></a> CMFCToolBar::IsBasicCommand

Determines whether a command is on the list of basic commands.

```
static BOOL IsBasicCommand(UINT uiCmd);
```

### Parameters

*uiCmd*<br/>
[in] Specifies the command to check.

### Return Value

TRUE if the specified command belongs to the list of basic commands; otherwise FALSE.

### Remarks

This static method determines whether the command specified by *uiCmd* belongs to the global list of basic commands. You can change the list of basic commands by calling [CMFCToolBar::AddBasicCommand](#addbasiccommand) or [CMFCToolBar::SetBasicCommands](#setbasiccommands).

## <a name="isbuttonextrasizeavailable"></a> CMFCToolBar::IsButtonExtraSizeAvailable

Determines whether the toolbar can display buttons that have extended borders.

```
virtual BOOL IsButtonExtraSizeAvailable() const;
```

### Return Value

TRUE if the bar can display buttons with the extra border size; otherwise FALSE.

### Remarks

The toolbar object returns TRUE if it can display buttons that have extended borders. A toolbar button calls this method when it handles the [CMFCToolBarButton::OnChangeParentWnd](../../mfc/reference/cmfctoolbarbutton-class.md#onchangeparentwnd) notification and will set its internal extra border size flag accordingly. This internal flag may be retrieved later by calling [CMFCToolBarButton::IsExtraSize](../../mfc/reference/cmfctoolbarbutton-class.md#isextrasize).

Override this method in a class derived from `CMFCToolBar` and return TRUE if your bar can display the toolbar buttons with the extra border size and return FALSE otherwise. The default implementation returns TRUE.

## <a name="isbuttonhighlighted"></a> CMFCToolBar::IsButtonHighlighted

Determines whether the specified button is highlighted.

```
BOOL IsButtonHighlighted(int iButton) const;
```

### Parameters

*iButton*<br/>
[in] Specifies the index of a toolbar button.

### Return Value

TRUE if the specified button is highlighted; otherwise, FALSE.

### Remarks

## <a name="iscommandpermitted"></a> CMFCToolBar::IsCommandPermitted

Determines whether a command is permitted.

```
static BOOL IsCommandPermitted(UINT uiCmd);
```

### Parameters

*uiCmd*<br/>
[in] Specifies the command to check.

### Return Value

TRUE if the specified command is permitted; otherwise FALSE.

### Remarks

This static method determines whether the command specified by *uiCmd* belongs to the global list of non-permitted commands.

You can change the list of non-permitted commands by calling [CMFCToolBar::SetNonPermittedCommands](#setnonpermittedcommands).

## <a name="iscommandrarelyused"></a> CMFCToolBar::IsCommandRarelyUsed

Determines whether a command is rarely used.

```
static BOOL IsCommandRarelyUsed(UINT uiCmd);
```

### Parameters

*uiCmd*<br/>
[in] Specifies the command to check.

### Return Value

TRUE if the specified command is rarely used; otherwise FALSE.

### Remarks

The `IsCommandRarelyUsed` method returns FALSE when one or more of the following conditions occur:

- The specified command belongs to the list of basic commands

- The specified command is one of the standard commands

- The framework is in customization mode

- The list of basic commands is empty

- More than 20% of command calls are calls to the specified command.

## <a name="iscustomizemode"></a> CMFCToolBar::IsCustomizeMode

Specifies whether the toolbar framework is in customization mode.

```
static BOOL IsCustomizeMode();
```

### Return Value

TRUE if the framework is in customization mode; otherwise FALSE.

### Remarks

You can toggle customization mode by calling [CMFCToolBar::SetCustomizeMode](#setcustomizemode).

The framework changes the mode when the user invokes the customization dialog box ( [CMFCToolBarsCustomizeDialog Class](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)).

## <a name="isdragbutton"></a> CMFCToolBar::IsDragButton

Determines whether a toolbar button is being dragged.

```
BOOL IsDragButton(const CMFCToolBarButton* pButton) const;
```

### Parameters

*pButton*<br/>
[in] Pointer to a toolbar button.

### Return Value

TRUE if the specified button is being dragged; otherwise, FALSE.

### Remarks

## <a name="isexistcustomizebutton"></a> CMFCToolBar::IsExistCustomizeButton

Determines whether the toolbar contains the **Customize** button.

```
BOOL IsExistCustomizeButton();
```

### Return Value

TRUE if the toolbar contains the **Customize** button; otherwise FALSE.

### Remarks

If this method returns TRUE, the [CMFCToolBar::GetCustomizeButton](#getcustomizebutton) method returns a pointer to the **Customize** button that appears at the end of the toolbar.

Use the [CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton) method to add the **Customize** button to your toolbar.

## <a name="isfloating"></a> CMFCToolBar::IsFloating

Determines whether the toolbar is floating.

```
virtual BOOL IsFloating() const;
```

### Return Value

TRUE if the toolbar is floating; otherwise, FALSE.

## <a name="islargeicons"></a> CMFCToolBar::IsLargeIcons

Specifies whether toolbars in the application currently display large icons.

```
static BOOL IsLargeIcons();
```

### Return Value

TRUE if the application is using large icons; otherwise FALSE.

### Remarks

Call [CMFCToolBar::SetLargeIcons](#setlargeicons) to toggle between large icons and regular icons.

The framework automatically changes the mode when the user toggles the **Large icons** check-box on the **Options** page of the **Customization** dialog box.

## <a name="islastcommandfrombutton"></a> CMFCToolBar::IsLastCommandFromButton

Determines whether the most recently executed command was sent from the specified toolbar button.

```
static BOOL IsLastCommandFromButton(CMFCToolBarButton* pButton);
```

### Parameters

*pButton*<br/>
[in] Pointer to button.

### Return Value

TRUE if the last command was sent from the button that *pButton* specifies; otherwise FALSE.

### Remarks

This method obtains a pointer to a [MSG Structure](/windows/win32/api/winuser/ns-winuser-msg) by calling `CWnd::GetCurrentMessage`. It then compares the HWND of the button with the `MSG::lParam` and `MSG::hwnd` members to determine whether the button was the source of the command.

## <a name="islocked"></a> CMFCToolBar::IsLocked

Determines whether the toolbar is locked.

```
BOOL IsLocked() const;
```

### Return Value

TRUE if the toolbar is locked; otherwise, FALSE.

### Remarks

This method returns TRUE when the user cannot perform customization tasks such as repositioning toolbar buttons.

Locked toolbars use separate image lists. For more information about these image lists, see [CMFCToolBar::LoadBitmapEx](#loadbitmapex).

## <a name="isonerowwithsibling"></a> CMFCToolBar::IsOneRowWithSibling

Determines whether the toolbar and its sibling toolbar are positioned on the same row.

```
BOOL IsOneRowWithSibling();
```

### Return Value

TRUE if the toolbar and its sibling are positioned on the same row; otherwise FALSE.

### Remarks

The [CMFCCustomizeButton::CreatePopupMenu](internal-classes.md) method calls this method to determine how to show the **Customize** pop-up menu. If this method returns TRUE, the framework displays the **Show Buttons on One Row** button. Otherwise, the framework displays the **Show Buttons on Two Rows** button.

You typically do not have to use this method. To enable the **Show Buttons on One Row** or **Show Buttons on Two Rows** buttons, call [CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar).

## <a name="isresourcechanged"></a> CMFCToolBar::IsResourceChanged

```
virtual BOOL IsResourceChanged() const;
```

### Return Value

### Remarks

## <a name="issibling"></a> CMFCToolBar::IsSibling

```
BOOL IsSibling();
```

### Return Value

### Remarks

## <a name="isuserdefined"></a> CMFCToolBar::IsUserDefined

Specifies whether the toolbar is user-defined.

```
BOOL IsUserDefined() const;
```

### Return Value

TRUE if the toolbar was created by the user; otherwise FALSE.

## <a name="loadbitmap"></a> CMFCToolBar::LoadBitmap

Loads toolbar images from application resources.

```
virtual BOOL LoadBitmap(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### Parameters

*uiResID*<br/>
[in] The resource ID of the bitmap that refers to the hot toolbar images.

*uiColdResID*<br/>
[in] The resource ID of the bitmap that refers to the cold toolbar images.

*uiMenuResID*<br/>
[in] The resource ID of the bitmap that refers to the regular menu images.

*bLocked*<br/>
[in] TRUE to lock the toolbar; otherwise FALSE.

*uiDisabledResID*<br/>
[in] The resource ID of the bitmap that refers to the disabled toolbar images.

*uiMenuDisabledResID*<br/>
[in] The resource ID of the bitmap that refers to the disabled menu images.

### Return Value

Nonzero if the method succeeds; otherwise 0.

### Remarks

The [CMFCToolBar::LoadToolBarEx](#loadtoolbarex) method calls this method to load the images that are associated with the toolbar. Override this method to perform custom loading of image resources.

Call the `LoadBitmapEx` method to load additional images after you create the toolbar.

## <a name="loadbitmapex"></a> CMFCToolBar::LoadBitmapEx

```
virtual BOOL LoadBitmapEx(
    CMFCToolBarInfo& params,
    BOOL bLocked = FALSE);
```

### Parameters

[in] *params*<br/>
[in] *bLocked*<br/>

### Return Value

### Remarks

## <a name="loadlargeiconsstate"></a> CMFCToolBar::LoadLargeIconsState

```
static BOOL __stdcall LoadLargeIconsState(LPCTSTR lpszProfileName = NULL);
```

### Parameters

[in] *lpszProfileName*<br/>

### Return Value

### Remarks

## <a name="loadparameters"></a> CMFCToolBar::LoadParameters

Loads global toolbar options from the Windows registry.

```
static BOOL LoadParameters(LPCTSTR lpszProfileName=NULL);
```

### Parameters

*lpszProfileName*<br/>
[in] Specifies the relative path of the Windows registry key.

### Return Value

Nonzero if the method succeeds; otherwise 0.

### Remarks

This method loads global parameters such as the menu animation type, the menu shadow style, and whether to display large icons from the Windows registry.

The [CWinAppEx::LoadState](../../mfc/reference/cwinappex-class.md#loadstate) method calls this method as a part of the initialization process of the application.

## <a name="loadstate"></a> CMFCToolBar::LoadState

Loads the toolbar state information from the Windows registry.

```
virtual BOOL LoadState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### Parameters

*lpszProfileName*<br/>
[in] Specifies the relative path of the Windows registry key.

*nIndex*<br/>
[in] Specifies the control ID of the toolbar.

*uiID*<br/>
[in] Specifies the resource ID of the toolbar.

### Return Value

Nonzero if the method succeeds; otherwise 0.

### Remarks

The framework calls this method as a part of the initialization process of the application. For more information, see [CWinAppEx::LoadState](../../mfc/reference/cwinappex-class.md#loadstate).

## <a name="loadtoolbar"></a> CMFCToolBar::LoadToolBar

Loads the toolbar from application resources.

```
virtual BOOL LoadToolBar(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0,
    UINT uiHotResID=0);
```

### Parameters

*uiResID*<br/>
[in] The resource ID of the toolbar.

*uiColdResID*<br/>
[in] The resource ID of the bitmap that refers to the cold toolbar images.

*uiMenuResID*<br/>
[in] The resource ID of the bitmap that refers to the regular menu images.

*bLocked*<br/>
[in] A Boolean value that specifies whether the toolbar is locked or not. If this parameter is *TRUE*, the toolbar is locked. Otherwise, the toolbar is not locked.

*uiDisabledResID*<br/>
[in] The resource ID of the bitmap that refers to the disabled toolbar images.

*uiMenuDisabledResID*<br/>
[in] The resource ID of the bitmap that refers to the disabled menu images.

*uiHotResID*<br/>
[in] The resource ID of the bitmap that refers to the hot toolbar images.

### Return Value

Nonzero if the method succeeds; otherwise 0.

### Remarks

The framework calls this method during initialization to load the images that are associated with the toolbar.

### Example

The following example demonstrates how to use the `LoadToolBar` method in the `CMFCToolBar` class. This code snippet is part of the [IE Demo sample](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

## <a name="loadtoolbarex"></a> CMFCToolBar::LoadToolBarEx

Loads the toolbar from application resources by using the `CMFCToolBarInfo` helper class to enable the application to use large images.

```
virtual BOOL LoadToolBarEx(
    UINT uiToolbarResID,
    CMFCToolBarInfo& params,
    BOOL bLocked=FALSE);
```

### Parameters

*uiToolbarResID*<br/>
[in] The resource ID of the toolbar.

*params*<br/>
[in] A reference to a `CMFCToolBarInfo` object that contains the resource IDs for the toolbar images.

*bLocked*<br/>
[in] A Boolean value that specifies whether the toolbar is locked or not. If this parameter is TRUE, the toolbar is locked. Otherwise, the toolbar is not locked.

### Return Value

Nonzero if the method succeeds; otherwise 0.

### Remarks

Call this method to load toolbar images from the application resources.

## <a name="m_dbllargeimageratio"></a> CMFCToolBar::m_dblLargeImageRatio

Specifies the ratio between the dimension (height or width) of large images and the dimension of regular images.

```
AFX_IMPORT_DATA static double m_dblLargeImageRatio;
```

### Remarks

The default ratio is 2. You can change this value to make large toolbar images larger or smaller.

The framework uses this data member when you do not specify a set of large images. For example, if you provide only the set of small images with size 16x16 and want the large images to have the size 24x24, set this data member to 1.5.

## <a name="nextmenu"></a> CMFCToolBar::NextMenu

```
virtual BOOL NextMenu();
```

### Return Value

### Remarks

## <a name="onbeforeremovebutton"></a> CMFCToolBar::OnBeforeRemoveButton

```
virtual BOOL OnBeforeRemoveButton(
    CMFCToolBarButton* pButton,
    DROPEFFECT dropEffect);
```

### Parameters

*pButton*<br/>
[in] Unused.

*dropEffect*<br/>
[in] Unused.

### Return Value

### Remarks

## <a name="onchangehot"></a> CMFCToolBar::OnChangeHot

Called by the framework when a user selects a button on the toolbar.

```
virtual void OnChangeHot(int iHot);
```

### Parameters

*iHot*<br/>
[in] Specifies the index of the toolbar button that is selected; or -1 if no toolbar button is selected.

### Remarks

Override this method to process notifications that the user selected a button on a toolbar.

## <a name="onchangevisualmanager"></a> CMFCToolBar::OnChangeVisualManager

```
virtual void OnChangeVisualManager();
```

### Remarks

## <a name="onfillbackground"></a> CMFCToolBar::OnFillBackground

Called by the framework from [CBasePane::DoPaint](../../mfc/reference/cbasepane-class.md#dopaint) to fill the toolbar background.

```
virtual void OnFillBackground(CDC* pDC);
```

### Parameters

*pDC*<br/>
[in] A pointer to a device context.

### Remarks

[CMFCToolBar::DoPaint](#dopaint) calls this method when the background of a toolbar has been filled. The default implementation does nothing.

Override this method to draw custom background in derived classes.

## <a name="onglobalfontschanged"></a> CMFCToolBar::OnGlobalFontsChanged

```
virtual void OnGlobalFontsChanged();
```

### Remarks

## <a name="onreset"></a> CMFCToolBar::OnReset

Restores the toolbar to its original state.

```
virtual void OnReset();
```

### Remarks

Override this method to handle notification about a toolbar reset.

The default implementation does nothing. Override `OnReset` in a class derived from `CMFCToolBar` when the toolbar has dummy buttons that must be replaced when the toolbar returns to its original state.

## <a name="onsetaccdata"></a> CMFCToolBar::OnSetAccData

```
virtual BOOL OnSetAccData(long lVal);
```

### Parameters

[in] *lVal*<br/>

### Return Value

### Remarks

## <a name="onsetdefaultbuttontext"></a> CMFCToolBar::OnSetDefaultButtonText

Restores the text of a toolbar button to its default state.

```
virtual BOOL OnSetDefaultButtonText(CMFCToolBarButton* pButton);
```

### Parameters

*pButton*<br/>
[in] Points to a button, whose text is being set.

### Return Value

TRUE ifthe text was successfully restored; otherwise FALSE.

### Remarks

Override this method to process notifications that the text of a toolbar button is being changed to its default.

The default implementation loads the text of a button from the application resources.

## <a name="onusertooltip"></a> CMFCToolBar::OnUserToolTip

Called by the framework when the tooltip for a button is about to be displayed.

```
virtual BOOL OnUserToolTip(
    CMFCToolBarButton* pButton,
    CString& strTTText) const;
```

### Parameters

*pButton*<br/>
[in] Points to a toolbar button for which a tooltip is to be displayed.

*strTTText*<br/>
[out] A reference to `CString` object that receives the text of the tooltip.

### Return Value

TRUE if *strTTText* was populated with tooltip text; otherwise FALSE.

### Remarks

The framework calls this method when the tooltip for a toolbar button is about to be displayed. If `OnUserToolTip` returns TRUE, the framework displays a tooltip which contains the text returned by `OnUserToolTip` in *strTTText*. Otherwise, the tooltip contains the button text.

Override `OnUserToolTip` to customize tool tips of toolbar buttons. The default implementation calls [CMFCToolBar::OnUserToolTip](#onusertooltip) to obtain the tooltip text.

## <a name="prevmenu"></a> CMFCToolBar::PrevMenu

```
virtual BOOL PrevMenu();
```

### Return Value

### Remarks

## <a name="processcommand"></a> CMFCToolBar::ProcessCommand

Posts a WM_COMMAND message to the window that owns the toolbar.

```
BOOL ProcessCommand(CMFCToolBarButton* pButton);
```

### Parameters

*pButton*<br/>
[in] Pointer to a button on the toolbar.

### Return Value

This method should always return TRUE. MFC uses FALSE values internally.

### Remarks

This method posts a WM_COMMAND message to the window that owns the toolbar by calling [CWnd::PostMessage](../../mfc/reference/cwnd-class.md#postmessage) and passing the command ID of the specified button as the *wParam* parameter.

Use the [ON_COMMAND](message-map-macros-mfc.md#on_command) macro to map the WM_COMMAND message to a member function.

## <a name="removeallbuttons"></a> CMFCToolBar::RemoveAllButtons

Removes all buttons and separators from the toolbar.

```
virtual void RemoveAllButtons();
```

### Remarks

The framework calls this method when it recreates or destroys a toolbar.

## <a name="removebutton"></a> CMFCToolBar::RemoveButton

Removes from the toolbar the button that has the specified index.

```
virtual BOOL RemoveButton(int iIndex);
```

### Parameters

*iIndex*<br/>
[in] Specifies the zero-based index of the button to remove.

### Return Value

TRUE if the method succeeds, or FALSE if the specified index is invalid or the index refers to the **Customize** button.

### Remarks

This method updates additional toolbar attributes that are affected by the removal of the button. For example, this method removes nonessential separators from the toolbar and rebuilds the table of shortcut keys.

For more information about the **Customize** button, see [CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton).

## <a name="removestatefromregistry"></a> CMFCToolBar::RemoveStateFromRegistry

Deletes the state information for the toolbar from the Windows registry.

```
virtual BOOL RemoveStateFromRegistry(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### Parameters

*lpszProfileName*<br/>
[in] Specifies the registry key where the state information is located.

*nIndex*<br/>
[in] The control ID of the toolbar.

*uiID*<br/>
[in] The resource ID of the toolbar. If this parameter is -1, this method uses the [CWnd::GetDlgCtrlID](../../mfc/reference/cwnd-class.md#getdlgctrlid) method to retrieve the resource ID.

### Return Value

Nonzero if the method succeeds; otherwise 0.

### Remarks

The framework calls this method when it deletes a user-defined toolbar.

Override this method if you store additional state information in the Windows registry.

## <a name="replacebutton"></a> CMFCToolBar::ReplaceButton

Replaces a toolbar button with another toolbar button.

```
int ReplaceButton(
    UINT uiCmd,
    const CMFCToolBarButton& button,
    BOOL bAll=FALSE);
```

### Parameters

*uiCmd*<br/>
[in] The command ID of the button to replace.

*button*<br/>
[in] A reference to the `CMFCToolBarButton` to insert.

*bAll*<br/>
[in] A Boolean value that specifies whether to replace all buttons that have the command ID specified by *uiCmd*. If this parameter is TRUE, all buttons that have the specified command ID are replaced. Otherwise, the first button is replaced.

### Return Value

The number of buttons that are replaced. This method returns 0 if a button with the specified command ID does not exist on the toolbar.

### Remarks

Call this method when you want to add toolbar buttons that cannot be loaded from resources. You can create a placeholder button at design-time and replace that button with a custom button when you initialize the toolbar. See the VisualStudioDemo sample for an example that uses this method.

### Example

The following example demonstrates how to use the `ReplaceButton` method in the `CMFCToolBar` class. This code snippet is part of the [IE Demo sample](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#10](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_5.cpp)]

## <a name="resetall"></a> CMFCToolBar::ResetAll

Restores all toolbars to their original states.

```
static void __stdcall ResetAll();
```

### Remarks

This method calls the [CMFCToolBar::RestoreOriginalState](#restoreoriginalstate) method on each toolbar in the application that can be restored. It uses the [CMFCToolBar::CanBeRestored](#canberestored) method to determine whether a toolbar can be restored.

## <a name="resetallimages"></a> CMFCToolBar::ResetAllImages

Clears all toolbar image collections in the application.

```
static void __stdcall ResetAllImages();
```

### Remarks

This method clears the image collections that are initialized by the [CMFCToolBar::LoadToolBar](#loadtoolbar) and [CMFCToolBar::LoadBitmap](#loadbitmap) methods.

## <a name="resetimages"></a> CMFCToolBar::ResetImages

```
virtual void ResetImages();
```

### Remarks

## <a name="restorefocus"></a> CMFCToolBar::RestoreFocus

```
virtual void RestoreFocus();
```

### Remarks

## <a name="restoreoriginalstate"></a> CMFCToolBar::RestoreOriginalState

Restores the original state of a toolbar.

```
virtual BOOL RestoreOriginalState();
```

### Return Value

TRUE if the method succeeds, or FALSE if the method fails or the toolbar is user-defined.

### Remarks

This method loads the toolbar from the resource file by using the [CMFCToolBar::LoadToolBar](#loadtoolbar) method.

The framework calls this method when the user chooses the **Reset All** button on the **Toolbars** page of a customization dialog box.

## <a name="saveparameters"></a> CMFCToolBar::SaveParameters

```
static BOOL __stdcall SaveParameters(LPCTSTR lpszProfileName = NULL);
```

### Parameters

[in] *lpszProfileName*<br/>

### Return Value

### Remarks

## <a name="savestate"></a> CMFCToolBar::SaveState

Saves the state information for the toolbar in the Windows registry.

```
virtual BOOL SaveState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### Parameters

*lpszProfileName*<br/>
[in] Specifies the relative path of the Windows registry key.

*nIndex*<br/>
[in] The control ID of the toolbar.

*uiID*<br/>
[in] The resource ID of the toolbar.

### Return Value

Nonzero if the method succeeds; otherwise 0.

### Remarks

The framework calls this method when it saves the application state to the registry. For more information, see [CWinAppEx::SaveState](../../mfc/reference/cwinappex-class.md#savestate).

## <a name="setbasiccommands"></a> CMFCToolBar::SetBasicCommands

Sets the list of commands that are always displayed when a user opens a menu.

```
static void __stdcall SetBasicCommands(CList<UINT,UINT>& lstCommands);
```

### Parameters

*lstCommands*<br/>
[in] A reference to a `CList` object that contains a collection of commands.

### Remarks

A basic command is always displayed when the menu is opened. This method is meaningful when the user chooses to view recently used commands.

Use the [CMFCToolBar::AddBasicCommand](#addbasiccommand) method to add a command to the list of basic commands. Use the [CMFCToolBar::GetBasicCommands](#getbasiccommands) method to retrieve the list of basic commands that is used by your application.

See the Explorer sample for an example that uses this method.

## <a name="setbuttoninfo"></a> CMFCToolBar::SetButtonInfo

Sets the command ID, style, and image ID of a toolbar button.

```cpp
void SetButtonInfo(
    int nIndex,
    UINT nID,
    UINT nStyle,
    int iImage);
```

### Parameters

*nIndex*<br/>
[in] The zero-based index of the button whose properties are set.

*nID*<br/>
[in] The command ID of the button.

*nStyle*<br/>
[in] The style of the button. See [ToolBar Control Styles](../../mfc/reference/toolbar-control-styles.md) for the list of available toolbar button styles.

*iImage*<br/>
[in] The zero-based image index of the button (that is, the index in the collection of toolbar images).

### Remarks

Call this method to set the properties of a toolbar button.

In Debug builds, this method generates an assertion failure if the index that is specified by *nIndex* is invalid.

Call the [CMFCToolBar::SetButtonStyle](#setbuttonstyle) method to set only the style of the button.

## <a name="setbuttons"></a> CMFCToolBar::SetButtons

Sets the buttons for the toolbar.

```
virtual BOOL SetButtons(
    const UINT* lpIDArray,
    int nIDCount,
    BOOL bRemapImages=TRUE);
```

### Parameters

*lpIDArray*<br/>
[in] A pointer to the array of command IDs of the buttons to insert.

*nIDCount*<br/>
[in] The number of items in *lpIDArray*.

*bRemapImages*<br/>
[in] A Boolean value that specifies whether to associate the existing button images with the inserted buttons. If this parameter is TRUE, the images are remapped.

### Return Value

Nonzero if the method succeeds; otherwise 0.

### Remarks

Call this method to remove existing buttons from a toolbar and insert a collection of new buttons.

This method adds the **Customize** button to the toolbar and sends the AFX_WM_RESETTOOLBAR message to the parent window of the toolbar. For more information about the **Customize** button, see [CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton).

## <a name="setbuttonstyle"></a> CMFCToolBar::SetButtonStyle

Sets the style of the toolbar button at the given index.

```
virtual void SetButtonStyle(
    int nIndex,
    UINT nStyle);
```

### Parameters

*nIndex*<br/>
[in] The zero-based index of the toolbar button whose style is to be set.

*nStyle*<br/>
[in] The style of the button. See [ToolBar Control Styles](../../mfc/reference/toolbar-control-styles.md) for the list of available toolbar button styles.

### Remarks

This method removes the TBBS_PRESSED style if *nStyle* is TBBS_DISABLED because the user cannot click a disabled button.

## <a name="setbuttontext"></a> CMFCToolBar::SetButtonText

Sets the text label of a toolbar button.

```
BOOL SetButtonText(
    int nIndex,
    LPCTSTR lpszText);
```

### Parameters

*nIndex*<br/>
[in] The index of the toolbar button.

*lpszText*<br/>
[in] The text label of the toolbar button. Must be non- NULL.

### Return Value

TRUE if the method succeeds; otherwise FALSE.

### Remarks

This method returns FALSE if the provided index does not refer to a valid toolbar button.

## <a name="setcommandusageoptions"></a> CMFCToolBar::SetCommandUsageOptions

Specifies when rarely used commands do not appear in the menu of the application.

```
static BOOL SetCommandUsageOptions(
    UINT nStartCount,
    UINT nMinUsagePercentage=5);
```

### Parameters

*nStartCount*<br/>
[in] Specifies the number of times that commands must be executed before the framework shows only the basic and recently-used commands.

*nMinUsagePercentage*<br/>
[in] The percentage of times that a command must be executed to be considered a recently-used command.

### Return Value

FALSE if *nMinUsagePercentage* is equal to or larger than 100; otherwise TRUE.

### Remarks

Call this method to customize the algorithm that the framework uses to determine how basic and recently used menu items appear. For more information about basic commands, see [CMFCToolBar::AddBasicCommand](#addbasiccommand).

This class uses the `CMFCCmdUsageCount` class to track the usage count of commands. For more information about this class, see [CMFCCmdUsageCount Class](../../mfc/reference/cmfccmdusagecount-class.md).

## <a name="setcustomizemode"></a> CMFCToolBar::SetCustomizeMode

Enables or disables customization mode for all toolbars in the application.

```
static BOOL __stdcall SetCustomizeMode(BOOL bSet=TRUE);
```

### Parameters

*bSet*<br/>
[in] A Boolean value that specifies whether to enable or disable customization mode. Set this parameter to TRUE to enable customization mode or FALSE to disable it.

### Return Value

TRUE if calling this method changes the customization mode; otherwise FALSE.

### Remarks

This method adjusts the layout of and redraws each toolbar in the application. Call the [CMFCToolBar::IsCustomizeMode](#iscustomizemode) method to determine whether the application is in customization mode,

## <a name="setgraydisabledbuttons"></a> CMFCToolBar::SetGrayDisabledButtons

Specifies whether unavailable buttons on the toolbar are dimmed, or whether button-unavailable images are used.

```cpp
void SetGrayDisabledButtons(BOOL bGrayDisabledButtons);
```

### Parameters

*bGrayDisabledButtons*<br/>
[in] A Boolean value that specifies how to display unavailable buttons. If this parameter is TRUE, the framework dims the buttons. Otherwise, the framework uses the collection of button-unavailable images.

### Remarks

By default, unavailable buttons are dimmed.

## <a name="setheight"></a> CMFCToolBar::SetHeight

Sets the height of the toolbar.

```cpp
void SetHeight(int cyHeight);
```

### Parameters

*cyHeight*<br/>
[in] The height of the toolbar, in pixels.

### Remarks

This method redraws the toolbar after it sets the height.

## <a name="sethelpmode"></a> CMFCToolBar::SetHelpMode

```
static void __stdcall SetHelpMode(BOOL bOn = TRUE);
```

### Parameters

[in] *bOn*<br/>

### Remarks

## <a name="sethot"></a> CMFCToolBar::SetHot

```
BOOL SetHot(CMFCToolBarButton* pMenuButton);
```

### Parameters

[in] *pMenuButton*<br/>

### Return Value

### Remarks

## <a name="sethotborder"></a> CMFCToolBar::SetHotBorder

Specifies whether toolbar buttons are hot-tracked.

```cpp
void SetHotBorder(BOOL bShowHotBorder);
```

### Parameters

*bShowHotBorder*<br/>
[in] A Boolean value that specifies whether to hot-track toolbar buttons. If this parameter is TRUE, the toolbar hot-tracks its buttons. Otherwise, the toolbar does not hot-track its buttons.

### Remarks

If a button is hot-tracked, the framework highlights the button when the mouse moves across it. By default, each toolbar hot-tracks its buttons.

Call the [CMFCToolBar::GetHotBorder](#gethotborder) method to determine whether the toolbar hot-tracks its buttons.

## <a name="sethottextcolor"></a> CMFCToolBar::SetHotTextColor

Sets the text color for hot toolbar buttons.

```
static void SetHotTextColor(COLORREF clrText);
```

### Parameters

*clrText*<br/>
[in] Specifies the text color for toolbar buttons that are hot-tracked.

### Remarks

For more information about hot-tracked toolbar buttons, see [CMFCToolBar::GetHotBorder](#gethotborder) and [CMFCToolBar::SetHotBorder](#sethotborder).

## <a name="setignoresettext"></a> CMFCToolBar::SetIgnoreSetText

```cpp
void SetIgnoreSetText(BOOL bValue);
```

### Parameters

[in] *bValue*<br/>

### Remarks

## <a name="setlargeicons"></a> CMFCToolBar::SetLargeIcons

Specifies whether toolbar buttons display large icons.

```
static void SetLargeIcons(BOOL bLargeIcons=TRUE);
```

### Parameters

*bLargeIcons*<br/>
[in] A Boolean value that specifies which icons to use. If this parameter is TRUE, the framework displays large icons. Otherwise, the framework displays regular icons.

### Remarks

The framework calls this method when the user changes the state of the **Large Icons** check box in the **Options** tab of the **Customize** dialog box. This method resizes all toolbars in the application.

By default, the framework displays regular icons.

For more information about the **Customize** dialog box, see [CMFCToolBarsCustomizeDialog Class](../../mfc/reference/cmfctoolbarscustomizedialog-class.md).

## <a name="setlockedsizes"></a> CMFCToolBar::SetLockedSizes

Sets the sizes of locked buttons and locked images on the toolbar.

```cpp
void SetLockedSizes(
    SIZE sizeButton,
    SIZE sizeImage,
    BOOL bDontScale = FALSE);
```

### Parameters

*sizeButton*<br/>
[in] Specifies the size of locked toolbar buttons.

*sizeImage*<br/>
[in] Specifies the size of locked toolbar images.

*bDontScale*<br/>
Specifies whether to scale or not locked toolbar images in high DPI mode.

### Remarks

The default size of locked buttons is 23x22 pixels. The default size of locked images is 16x15 pixels.

Call the [CMFCToolBar::GetLockedImageSize](#getlockedimagesize) method to retrieve the size of locked images. Call the [CMFCToolBar::GetButtonSize](#getbuttonsize) method to retrieve the size of locked toolbar buttons.

## <a name="setmaskmode"></a> CMFCToolBar::SetMaskMode

```cpp
void SetMaskMode(BOOL bMasked);
```

### Parameters

[in] *bMasked*<br/>

### Remarks

## <a name="setmenusizes"></a> CMFCToolBar::SetMenuSizes

Sets the size of toolbar menu buttons and their images.

```
static void __stdcall SetMenuSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### Parameters

*sizeButton*<br/>
[in] Specifies the size of toolbar buttons, in pixels.

*sizeImage*<br/>
[in] Specifies the size of toolbar images, in pixels.

### Remarks

By default, menu buttons and their images have an undefined size.

Call the [CMFCToolBar::GetMenuButtonSize](#getmenubuttonsize) method to determine the size of menu buttons and the [CMFCToolBar::GetMenuImageSize](#getmenuimagesize) method to determine the size of menu button images.

See the IEDemo and MSMoneyDemo samples for examples that use this method.

## <a name="setnonpermittedcommands"></a> CMFCToolBar::SetNonPermittedCommands

Sets the list of commands that cannot be executed by the user.

```
static void SetNonPermittedCommands(CList<UINT,UINT>& lstCommands);
```

### Parameters

*lstCommands*<br/>
[in] A reference to a `CList` object that contains the commands that cannot be executed by the user.

### Remarks

Call this method to prevent the user from selecting certain commands. For example, you might want to prevent the user from selecting certain commands for security reasons. See the MDITabsDemo and MenuSubSet samples for examples that use this method.

This method clears the previous list of non-permitted commands. By default, the list of non-permitted commands is empty.

## <a name="setonerowwithsibling"></a> CMFCToolBar::SetOneRowWithSibling

Positions the toolbar and its sibling on the same row.

```cpp
void SetOneRowWithSibling();
```

### Remarks

The framework calls this method when the user clicks the **Show Buttons on One Row** button.

Call the [CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar) method to enable the **Show Buttons on One Row** or **Show Buttons on Two Rows** buttons. If you call [CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar) for this toolbar, the sibling toolbar is moved to the row of this toolbar. Otherwise, this toolbar is moved to the row of the sibling.

The framework calls the [CMFCToolBar::SetTwoRowsWithSibling](#settworowswithsibling) method when the user clicks the **Show Buttons on Two Rows** button.

## <a name="setorigbuttons"></a> CMFCToolBar::SetOrigButtons

```cpp
void SetOrigButtons(const CObList& lstOrigButtons);
```

### Parameters

[in] *lstOrigButtons*<br/>

### Remarks

## <a name="setpermament"></a> CMFCToolBar::SetPermament

Specifies whether a user can close the toolbar.

```cpp
void SetPermament(BOOL bPermament=TRUE);
```

### Parameters

*bPermament*<br/>
[in] A Boolean value that specifies whether a user can close the toolbar. If this parameter is TRUE, a user cannot close the toolbar. Otherwise, a user can close the toolbar.

### Remarks

By default, a user can close each toolbar.

Call the [CMFCToolBar::CanBeClosed](#canbeclosed) method to determine whether a user can close the toolbar.

## <a name="setroutecommandsviaframe"></a> CMFCToolBar::SetRouteCommandsViaFrame

Specifies whether the parent frame or the owner sends commands to the toolbar.

```cpp
void SetRouteCommandsViaFrame(BOOL bValue);
```

### Parameters

*bValue*<br/>
[in] If this parameter is TRUE, the parent frame sends commands to the toolbar. Otherwise, the owner sends commands to the toolbar.

### Remarks

By default, the parent frame sends commands to the toolbar. Call the [CMFCToolBar::GetRouteCommandsViaFrame](#getroutecommandsviaframe) method to determine whether the parent frame or the owner sends commands to the toolbar.

## <a name="setshowtooltips"></a> CMFCToolBar::SetShowTooltips

Specifies whether the framework displays tool tips.

```
static void SetShowTooltips(BOOL bValue);
```

### Parameters

*bValue*<br/>
[in] If this parameter is TRUE, the framework shows tool tips. Otherwise, the framework hides tool tips.

### Remarks

By default, the framework shows tool tips.

Call the [CMFCToolBar::GetShowTooltips](#getshowtooltips) method to determine whether the framework shows tool tips.

## <a name="setsiblingtoolbar"></a> CMFCToolBar::SetSiblingToolBar

Specifies the sibling of the toolbar.

```cpp
void SetSiblingToolBar(CMFCToolBar* pBrotherToolbar);
```

### Parameters

*pBrotherToolbar*<br/>
[in] A pointer to the sibling toolbar.

### Remarks

This method enables the **Show Buttons on One Row** or **Show Buttons on Two Rows** buttons that are shown when the user displays the **Customize** pop-up menu. Call this method when you want to enable the user to specify whether related toolbars appear on the same row or on different rows.

Call this method after you enable the **Customize** button that appears on the toolbar. To enable the **Customize** button, call the [CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton) method.

To retrieve the sibling of a toolbar, call [CMFCToolBar::GetSiblingToolBar](#getsiblingtoolbar).

## <a name="setsizes"></a> CMFCToolBar::SetSizes

Specifies the sizes of buttons and images on all toolbars.

```
static void __stdcall SetSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### Parameters

*sizeButton*<br/>
[in] The size of toolbar buttons, in pixels.

*sizeImage*<br/>
[in] The size of toolbar button images, in pixels.

### Remarks

The default size of toolbar buttons is 23x22 pixels. The default size of toolbar button images is 16x15 pixels.

Call the [CMFCToolBar::GetImageSize](#getimagesize) method to retrieve the size of toolbar button images. Call the [CMFCToolBar::GetButtonSize](#getbuttonsize) method to retrieve the size of toolbar buttons.

## <a name="settoolbarbtntext"></a> CMFCToolBar::SetToolBarBtnText

Specifies properties of a button on the toolbar.

```cpp
void SetToolBarBtnText(
    UINT nBtnIndex,
    LPCTSTR szText=NULL,
    BOOL bShowText=TRUE,
    BOOL bShowImage=TRUE);
```

### Parameters

*nBtnIndex*<br/>
[in] The zero-based index of the toolbar button in the list of toolbar buttons.

*szText*<br/>
[in] Specifies the text label of the toolbar button.

*bShowText*<br/>
[in] If this parameter is TRUE, the framework shows the text label. Otherwise, the framework hides the text label.

*bShowImage*<br/>
[in] If this parameter is TRUE, the framework shows the toolbar button image. Otherwise, the framework hides the toolbar button image.

### Remarks

By default, the framework shows the images of toolbar buttons but does not show the text label of toolbar buttons.

In Debug builds, this method generates an assertion failure if *nBtnIndex* does not refer to a valid toolbar button or the toolbar button is a separator.

## <a name="settworowswithsibling"></a> CMFCToolBar::SetTwoRowsWithSibling

Positions the toolbar and its sibling on separate rows.

```cpp
void SetTwoRowsWithSibling();
```

### Remarks

The framework calls this method when the user clicks the **Show Buttons on Two Rows** button.

Call the [CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar) method to enable the **Show Buttons on One Row** or **Show Buttons on Two Rows** buttons. If you call [CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar) for this toolbar, the sibling toolbar is moved to a separate row. Otherwise, this toolbar is moved to a separate row.

The framework calls the [CMFCToolBar::SetOneRowWithSibling](#setonerowwithsibling) method when the user clicks the **Show Buttons on One Row** button.

## <a name="setuserimages"></a> CMFCToolBar::SetUserImages

Sets the collection of user-defined images in the application.

```
static BOOL SetUserImages(CMFCToolBarImages* pUserImages);
```

### Parameters

*pUserImages*<br/>
[in] A pointer to the collection of user-defined images.

### Return Value

Nonzero if the method succeeds; otherwise 0 if the specified `CMFCToolBarImages` object is not valid or has an image size that differs from the default image size of the toolbar.

### Remarks

The framework uses user-defined images to draw toolbar buttons that are customized by the user. The image list specified by *pUserImages* is shared among all toolbars in the application.

This method generates an assertion failure in Debug builds if the specified `CMFCToolBarImages` object is not valid or has an image size that differs from the default image size of the toolbar.

The OutlookDemo, ToolTipDemo, and VisualStudioDemo samples use this method to set the global collection of user-defined images. They load the file that is named UserImages.bmp, which is located in the working directory of the application.

Call the [CMFCToolBar::GetUserImages](#getuserimages) method to retrieve the collection of user-defined images in the application.

## <a name="stretchpane"></a> CMFCToolBar::StretchPane

Stretches the toolbar vertically or horizontally, and repositions the buttons if necessary.

```
virtual CSize StretchPane(
    int nLength,
    BOOL bVert);
```

### Parameters

*nLength*<br/>
[in] The amount, in pixels, by which to stretch the pane.

*bVert*<br/>
[in] If TRUE, stretches the pane vertically. If FALSE, stretches the pane horizontally.

### Return Value

A `CSize` object that specifies the size of the toolbar client area.

### Remarks

This method calls [CMFCToolBar::WrapToolBar](#wraptoolbar) to reposition the buttons within the stretched toolbar.

The return value is determined by calling [CMFCToolBar::CalcSize](#calcsize).

## <a name="translatechar"></a> CMFCToolBar::TranslateChar

Executes a button command if the specified key code corresponds to a valid keyboard shortcut.

```
virtual BOOL TranslateChar(UINT nChar);
```

### Parameters

*nChar*<br/>
[in] Specifies a virtual key code. For a list of standard virtual key codes, see Winuser.h

### Return Value

FALSE if the specified key code is either unprintable or does not correspond to a valid keyboard shortcut; TRUE if the specified key code corresponds to a drop-down menu option; otherwise, the return value from [CMFCToolBar::ProcessCommand](#processcommand).

### Remarks

The framework calls this method when a key is pressed together with the Alt key.

## <a name="updatebutton"></a> CMFCToolBar::UpdateButton

Updates the state of the specified button.

```cpp
void UpdateButton(int nIndex);
```

### Parameters

*nIndex*<br/>
[in] Specifies the zero-based index of the button to update.

### Remarks

## <a name="wraptoolbar"></a> CMFCToolBar::WrapToolBar

Repositions toolbar buttons within the given dimensions.

```
int WrapToolBar(
    int nWidth,
    int nHeight = 32767,
    CDC* pDC = NULL,
    int nColumnWidth = -1,
    int nRowHeight = -1);
```

### Parameters

*nWidth*<br/>
[in] Maximum width of the toolbar.

*nHeight*<br/>
[in] Maximum height of the toolbar. Not used if the toolbar is floating.

*pDC*<br/>
[in] Pointer to a device context. If NULL, the device context for the toolbar is used.

*nColumnWidth*<br/>
[in] Button width. If -1, the current width is used.

[in] m *nRowHeight*
Button height. If -1, the current height is used.

### Return Value

The number of rows of buttons on the toolbar.

### Remarks

This method repositions buttons within the toolbar, wrapping buttons to additional rows if necessary.

## <a name="m_bdontscaleimages"></a> CMFCToolBar::m_bDontScaleImages

Specifies whether or not to scale toolbar images in high DPI mode.

```
AFX_IMPORT_DATA static BOOL m_bDontScaleImages;
```

### Remarks

## See also

[Hierarchy Chart](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CMFCMenuBar Class](../../mfc/reference/cmfcmenubar-class.md)<br/>
[CMFCPopupMenuBar Class](../../mfc/reference/cmfcpopupmenubar-class.md)<br/>
[CMFCDropDownToolBar Class](../../mfc/reference/cmfcdropdowntoolbar-class.md)<br/>
[Walkthrough: Putting Controls On Toolbars](../../mfc/walkthrough-putting-controls-on-toolbars.md)

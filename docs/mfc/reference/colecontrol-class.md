---
description: "Learn more about: COleControl Class"
title: "COleControl Class"
ms.date: "08/27/2018"
f1_keywords: ["COleControl", "AFXCTL/COleControl", "AFXCTL/COleControl::COleControl", "AFXCTL/COleControl::AmbientAppearance", "AFXCTL/COleControl::AmbientBackColor", "AFXCTL/COleControl::AmbientDisplayName", "AFXCTL/COleControl::AmbientFont", "AFXCTL/COleControl::AmbientForeColor", "AFXCTL/COleControl::AmbientLocaleID", "AFXCTL/COleControl::AmbientScaleUnits", "AFXCTL/COleControl::AmbientShowGrabHandles", "AFXCTL/COleControl::AmbientShowHatching", "AFXCTL/COleControl::AmbientTextAlign", "AFXCTL/COleControl::AmbientUIDead", "AFXCTL/COleControl::AmbientUserMode", "AFXCTL/COleControl::BoundPropertyChanged", "AFXCTL/COleControl::BoundPropertyRequestEdit", "AFXCTL/COleControl::ClientToParent", "AFXCTL/COleControl::ClipCaretRect", "AFXCTL/COleControl::ControlInfoChanged", "AFXCTL/COleControl::DisplayError", "AFXCTL/COleControl::DoClick", "AFXCTL/COleControl::DoPropExchange", "AFXCTL/COleControl::DoSuperclassPaint", "AFXCTL/COleControl::EnableSimpleFrame", "AFXCTL/COleControl::ExchangeExtent", "AFXCTL/COleControl::ExchangeStockProps", "AFXCTL/COleControl::ExchangeVersion", "AFXCTL/COleControl::FireClick", "AFXCTL/COleControl::FireDblClick", "AFXCTL/COleControl::FireError", "AFXCTL/COleControl::FireEvent", "AFXCTL/COleControl::FireKeyDown", "AFXCTL/COleControl::FireKeyPress", "AFXCTL/COleControl::FireKeyUp", "AFXCTL/COleControl::FireMouseDown", "AFXCTL/COleControl::FireMouseMove", "AFXCTL/COleControl::FireMouseUp", "AFXCTL/COleControl::FireReadyStateChange", "AFXCTL/COleControl::GetActivationPolicy", "AFXCTL/COleControl::GetAmbientProperty", "AFXCTL/COleControl::GetAppearance", "AFXCTL/COleControl::GetBackColor", "AFXCTL/COleControl::GetBorderStyle", "AFXCTL/COleControl::GetCapture", "AFXCTL/COleControl::GetClassID", "AFXCTL/COleControl::GetClientOffset", "AFXCTL/COleControl::GetClientRect", "AFXCTL/COleControl::GetClientSite", "AFXCTL/COleControl::GetControlFlags", "AFXCTL/COleControl::GetControlSize", "AFXCTL/COleControl::GetDC", "AFXCTL/COleControl::GetEnabled", "AFXCTL/COleControl::GetExtendedControl", "AFXCTL/COleControl::GetFocus", "AFXCTL/COleControl::GetFont", "AFXCTL/COleControl::GetFontTextMetrics", "AFXCTL/COleControl::GetForeColor", "AFXCTL/COleControl::GetHwnd", "AFXCTL/COleControl::GetMessageString", "AFXCTL/COleControl::GetNotSupported", "AFXCTL/COleControl::GetReadyState", "AFXCTL/COleControl::GetRectInContainer", "AFXCTL/COleControl::GetStockTextMetrics", "AFXCTL/COleControl::GetText", "AFXCTL/COleControl::GetWindowlessDropTarget", "AFXCTL/COleControl::InitializeIIDs", "AFXCTL/COleControl::InternalGetFont", "AFXCTL/COleControl::InternalGetText", "AFXCTL/COleControl::InternalSetReadyState", "AFXCTL/COleControl::InvalidateControl", "AFXCTL/COleControl::InvalidateRgn", "AFXCTL/COleControl::IsConvertingVBX", "AFXCTL/COleControl::IsModified", "AFXCTL/COleControl::IsOptimizedDraw", "AFXCTL/COleControl::IsSubclassedControl", "AFXCTL/COleControl::Load", "AFXCTL/COleControl::LockInPlaceActive", "AFXCTL/COleControl::OnAmbientPropertyChange", "AFXCTL/COleControl::OnAppearanceChanged", "AFXCTL/COleControl::OnBackColorChanged", "AFXCTL/COleControl::OnBorderStyleChanged", "AFXCTL/COleControl::OnClick", "AFXCTL/COleControl::OnClose", "AFXCTL/COleControl::OnDoVerb", "AFXCTL/COleControl::OnDraw", "AFXCTL/COleControl::OnDrawMetafile", "AFXCTL/COleControl::OnEdit", "AFXCTL/COleControl::OnEnabledChanged", "AFXCTL/COleControl::OnEnumVerbs", "AFXCTL/COleControl::OnEventAdvise", "AFXCTL/COleControl::OnFontChanged", "AFXCTL/COleControl::OnForeColorChanged", "AFXCTL/COleControl::OnFreezeEvents", "AFXCTL/COleControl::OnGetColorSet", "AFXCTL/COleControl::OnGetControlInfo", "AFXCTL/COleControl::OnGetDisplayString", "AFXCTL/COleControl::OnGetInPlaceMenu", "AFXCTL/COleControl::OnGetNaturalExtent", "AFXCTL/COleControl::OnGetPredefinedStrings", "AFXCTL/COleControl::OnGetPredefinedValue", "AFXCTL/COleControl::OnGetViewExtent", "AFXCTL/COleControl::OnGetViewRect", "AFXCTL/COleControl::OnGetViewStatus", "AFXCTL/COleControl::OnHideToolBars", "AFXCTL/COleControl::OnInactiveMouseMove", "AFXCTL/COleControl::OnInactiveSetCursor", "AFXCTL/COleControl::OnKeyDownEvent", "AFXCTL/COleControl::OnKeyPressEvent", "AFXCTL/COleControl::OnKeyUpEvent", "AFXCTL/COleControl::OnMapPropertyToPage", "AFXCTL/COleControl::OnMnemonic", "AFXCTL/COleControl::OnProperties", "AFXCTL/COleControl::OnQueryHitPoint", "AFXCTL/COleControl::OnQueryHitRect", "AFXCTL/COleControl::OnRenderData", "AFXCTL/COleControl::OnRenderFileData", "AFXCTL/COleControl::OnRenderGlobalData", "AFXCTL/COleControl::OnResetState", "AFXCTL/COleControl::OnSetClientSite", "AFXCTL/COleControl::OnSetData", "AFXCTL/COleControl::OnSetExtent", "AFXCTL/COleControl::OnSetObjectRects", "AFXCTL/COleControl::OnShowToolBars", "AFXCTL/COleControl::OnTextChanged", "AFXCTL/COleControl::OnWindowlessMessage", "AFXCTL/COleControl::ParentToClient", "AFXCTL/COleControl::PostModalDialog", "AFXCTL/COleControl::PreModalDialog", "AFXCTL/COleControl::RecreateControlWindow", "AFXCTL/COleControl::Refresh", "AFXCTL/COleControl::ReleaseCapture", "AFXCTL/COleControl::ReleaseDC", "AFXCTL/COleControl::ReparentControlWindow", "AFXCTL/COleControl::ResetStockProps", "AFXCTL/COleControl::ResetVersion", "AFXCTL/COleControl::ScrollWindow", "AFXCTL/COleControl::SelectFontObject", "AFXCTL/COleControl::SelectStockFont", "AFXCTL/COleControl::SerializeExtent", "AFXCTL/COleControl::SerializeStockProps", "AFXCTL/COleControl::SerializeVersion", "AFXCTL/COleControl::SetAppearance", "AFXCTL/COleControl::SetBackColor", "AFXCTL/COleControl::SetBorderStyle", "AFXCTL/COleControl::SetCapture", "AFXCTL/COleControl::SetControlSize", "AFXCTL/COleControl::SetEnabled", "AFXCTL/COleControl::SetFocus", "AFXCTL/COleControl::SetFont", "AFXCTL/COleControl::SetForeColor", "AFXCTL/COleControl::SetInitialSize", "AFXCTL/COleControl::SetModifiedFlag", "AFXCTL/COleControl::SetNotPermitted", "AFXCTL/COleControl::SetNotSupported", "AFXCTL/COleControl::SetRectInContainer", "AFXCTL/COleControl::SetText", "AFXCTL/COleControl::ThrowError", "AFXCTL/COleControl::TransformCoords", "AFXCTL/COleControl::TranslateColor", "AFXCTL/COleControl::WillAmbientsBeValidDuringLoad", "AFXCTL/COleControl::WindowProc", "AFXCTL/COleControl::DrawContent", "AFXCTL/COleControl::DrawMetafile", "AFXCTL/COleControl::IsInvokeAllowed", "AFXCTL/COleControl::SetInitialDataFormats"]
helpviewer_keywords: ["COleControl [MFC], COleControl", "COleControl [MFC], AmbientAppearance", "COleControl [MFC], AmbientBackColor", "COleControl [MFC], AmbientDisplayName", "COleControl [MFC], AmbientFont", "COleControl [MFC], AmbientForeColor", "COleControl [MFC], AmbientLocaleID", "COleControl [MFC], AmbientScaleUnits", "COleControl [MFC], AmbientShowGrabHandles", "COleControl [MFC], AmbientShowHatching", "COleControl [MFC], AmbientTextAlign", "COleControl [MFC], AmbientUIDead", "COleControl [MFC], AmbientUserMode", "COleControl [MFC], BoundPropertyChanged", "COleControl [MFC], BoundPropertyRequestEdit", "COleControl [MFC], ClientToParent", "COleControl [MFC], ClipCaretRect", "COleControl [MFC], ControlInfoChanged", "COleControl [MFC], DisplayError", "COleControl [MFC], DoClick", "COleControl [MFC], DoPropExchange", "COleControl [MFC], DoSuperclassPaint", "COleControl [MFC], EnableSimpleFrame", "COleControl [MFC], ExchangeExtent", "COleControl [MFC], ExchangeStockProps", "COleControl [MFC], ExchangeVersion", "COleControl [MFC], FireClick", "COleControl [MFC], FireDblClick", "COleControl [MFC], FireError", "COleControl [MFC], FireEvent", "COleControl [MFC], FireKeyDown", "COleControl [MFC], FireKeyPress", "COleControl [MFC], FireKeyUp", "COleControl [MFC], FireMouseDown", "COleControl [MFC], FireMouseMove", "COleControl [MFC], FireMouseUp", "COleControl [MFC], FireReadyStateChange", "COleControl [MFC], GetActivationPolicy", "COleControl [MFC], GetAmbientProperty", "COleControl [MFC], GetAppearance", "COleControl [MFC], GetBackColor", "COleControl [MFC], GetBorderStyle", "COleControl [MFC], GetCapture", "COleControl [MFC], GetClassID", "COleControl [MFC], GetClientOffset", "COleControl [MFC], GetClientRect", "COleControl [MFC], GetClientSite", "COleControl [MFC], GetControlFlags", "COleControl [MFC], GetControlSize", "COleControl [MFC], GetDC", "COleControl [MFC], GetEnabled", "COleControl [MFC], GetExtendedControl", "COleControl [MFC], GetFocus", "COleControl [MFC], GetFont", "COleControl [MFC], GetFontTextMetrics", "COleControl [MFC], GetForeColor", "COleControl [MFC], GetHwnd", "COleControl [MFC], GetMessageString", "COleControl [MFC], GetNotSupported", "COleControl [MFC], GetReadyState", "COleControl [MFC], GetRectInContainer", "COleControl [MFC], GetStockTextMetrics", "COleControl [MFC], GetText", "COleControl [MFC], GetWindowlessDropTarget", "COleControl [MFC], InitializeIIDs", "COleControl [MFC], InternalGetFont", "COleControl [MFC], InternalGetText", "COleControl [MFC], InternalSetReadyState", "COleControl [MFC], InvalidateControl", "COleControl [MFC], InvalidateRgn", "COleControl [MFC], IsConvertingVBX", "COleControl [MFC], IsModified", "COleControl [MFC], IsOptimizedDraw", "COleControl [MFC], IsSubclassedControl", "COleControl [MFC], Load", "COleControl [MFC], LockInPlaceActive", "COleControl [MFC], OnAmbientPropertyChange", "COleControl [MFC], OnAppearanceChanged", "COleControl [MFC], OnBackColorChanged", "COleControl [MFC], OnBorderStyleChanged", "COleControl [MFC], OnClick", "COleControl [MFC], OnClose", "COleControl [MFC], OnDoVerb", "COleControl [MFC], OnDraw", "COleControl [MFC], OnDrawMetafile", "COleControl [MFC], OnEdit", "COleControl [MFC], OnEnabledChanged", "COleControl [MFC], OnEnumVerbs", "COleControl [MFC], OnEventAdvise", "COleControl [MFC], OnFontChanged", "COleControl [MFC], OnForeColorChanged", "COleControl [MFC], OnFreezeEvents", "COleControl [MFC], OnGetColorSet", "COleControl [MFC], OnGetControlInfo", "COleControl [MFC], OnGetDisplayString", "COleControl [MFC], OnGetInPlaceMenu", "COleControl [MFC], OnGetNaturalExtent", "COleControl [MFC], OnGetPredefinedStrings", "COleControl [MFC], OnGetPredefinedValue", "COleControl [MFC], OnGetViewExtent", "COleControl [MFC], OnGetViewRect", "COleControl [MFC], OnGetViewStatus", "COleControl [MFC], OnHideToolBars", "COleControl [MFC], OnInactiveMouseMove", "COleControl [MFC], OnInactiveSetCursor", "COleControl [MFC], OnKeyDownEvent", "COleControl [MFC], OnKeyPressEvent", "COleControl [MFC], OnKeyUpEvent", "COleControl [MFC], OnMapPropertyToPage", "COleControl [MFC], OnMnemonic", "COleControl [MFC], OnProperties", "COleControl [MFC], OnQueryHitPoint", "COleControl [MFC], OnQueryHitRect", "COleControl [MFC], OnRenderData", "COleControl [MFC], OnRenderFileData", "COleControl [MFC], OnRenderGlobalData", "COleControl [MFC], OnResetState", "COleControl [MFC], OnSetClientSite", "COleControl [MFC], OnSetData", "COleControl [MFC], OnSetExtent", "COleControl [MFC], OnSetObjectRects", "COleControl [MFC], OnShowToolBars", "COleControl [MFC], OnTextChanged", "COleControl [MFC], OnWindowlessMessage", "COleControl [MFC], ParentToClient", "COleControl [MFC], PostModalDialog", "COleControl [MFC], PreModalDialog", "COleControl [MFC], RecreateControlWindow", "COleControl [MFC], Refresh", "COleControl [MFC], ReleaseCapture", "COleControl [MFC], ReleaseDC", "COleControl [MFC], ReparentControlWindow", "COleControl [MFC], ResetStockProps", "COleControl [MFC], ResetVersion", "COleControl [MFC], ScrollWindow", "COleControl [MFC], SelectFontObject", "COleControl [MFC], SelectStockFont", "COleControl [MFC], SerializeExtent", "COleControl [MFC], SerializeStockProps", "COleControl [MFC], SerializeVersion", "COleControl [MFC], SetAppearance", "COleControl [MFC], SetBackColor", "COleControl [MFC], SetBorderStyle", "COleControl [MFC], SetCapture", "COleControl [MFC], SetControlSize", "COleControl [MFC], SetEnabled", "COleControl [MFC], SetFocus", "COleControl [MFC], SetFont", "COleControl [MFC], SetForeColor", "COleControl [MFC], SetInitialSize", "COleControl [MFC], SetModifiedFlag", "COleControl [MFC], SetNotPermitted", "COleControl [MFC], SetNotSupported", "COleControl [MFC], SetRectInContainer", "COleControl [MFC], SetText", "COleControl [MFC], ThrowError", "COleControl [MFC], TransformCoords", "COleControl [MFC], TranslateColor", "COleControl [MFC], WillAmbientsBeValidDuringLoad", "COleControl [MFC], WindowProc", "COleControl [MFC], DrawContent", "COleControl [MFC], DrawMetafile", "COleControl [MFC], IsInvokeAllowed", "COleControl [MFC], SetInitialDataFormats"]
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
---
# COleControl Class

A powerful base class for developing OLE controls.

## Syntax

```
class COleControl : public CWnd
```

## Members

### Public Constructors

|Name|Description|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Creates a `COleControl` object.|

### Public Methods

|Name|Description|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|Retrieves the current appearance of the control.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Returns the value of the ambient BackColor property.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Returns the name of the control as specified by the container.|
|[COleControl::AmbientFont](#ambientfont)|Returns the value of the ambient Font property.|
|[COleControl::AmbientForeColor](#ambientforecolor)|Returns the value of the ambient ForeColor property.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Returns the container's locale ID.|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Returns the type of units used by the container.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Determines if grab handles should be displayed.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Determines if hatching should be displayed.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Returns the type of text alignment specified by the container.|
|[COleControl::AmbientUIDead](#ambientuidead)|Determines if the control should respond to user-interface actions.|
|[COleControl::AmbientUserMode](#ambientusermode)|Determines the mode of the container.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Notifies the container that a bound property has been changed.|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Requests permission to edit the property value.|
|[COleControl::ClientToParent](#clienttoparent)|Translates a point relative to the control's origin to a point relative to its container's origin.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Adjusts a caret rectangle if it is overlapped by a control.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|Call this function after the set of mnemonics handled by the control has changed.|
|[COleControl::DisplayError](#displayerror)|Displays stock Error events to the control's user.|
|[COleControl::DoClick](#doclick)|Implementation of the stock `DoClick` method.|
|[COleControl::DoPropExchange](#dopropexchange)|Serializes the properties of a `COleControl` object.|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Redraws an OLE control that has been subclassed from a Windows control.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Enables simple frame support for a control.|
|[COleControl::ExchangeExtent](#exchangeextent)|Serializes the control's width and height.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Serializes the control's stock properties.|
|[COleControl::ExchangeVersion](#exchangeversion)|Serializes the control's version number.|
|[COleControl::FireClick](#fireclick)|Fires the stock `Click` event.|
|[COleControl::FireDblClick](#firedblclick)|Fires the stock `DblClick` event.|
|[COleControl::FireError](#fireerror)|Fires the stock `Error` event.|
|[COleControl::FireEvent](#fireevent)|Fires a custom event.|
|[COleControl::FireKeyDown](#firekeydown)|Fires the stock `KeyDown` event.|
|[COleControl::FireKeyPress](#firekeypress)|Fires the stock `KeyPress` event.|
|[COleControl::FireKeyUp](#firekeyup)|Fires the stock `KeyUp` event.|
|[COleControl::FireMouseDown](#firemousedown)|Fires the stock `MouseDown` event.|
|[COleControl::FireMouseMove](#firemousemove)|Fires the stock `MouseMove` event.|
|[COleControl::FireMouseUp](#firemouseup)|Fires the stock `MouseUp` event.|
|[COleControl::FireReadyStateChange](#firereadystatechange)|Fires an event when the control's ready state changes.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Alters the default activation behavior of a control that supports the `IPointerInactive` interface.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Returns the value of the specified ambient property.|
|[COleControl::GetAppearance](#getappearance)|Returns the value of the stock Appearance property.|
|[COleControl::GetBackColor](#getbackcolor)|Returns the value of the stock BackColor property.|
|[COleControl::GetBorderStyle](#getborderstyle)|Returns the value of the stock BorderStyle property.|
|[COleControl::GetCapture](#getcapture)|Determines whether a windowless, activated control object has the mouse capture.|
|[COleControl::GetClassID](#getclassid)|Retrieves the OLE class ID of the control.|
|[COleControl::GetClientOffset](#getclientoffset)|Retrieves the difference between the upper left corner of the control's rectangular area and the upper left corner of its client area.|
|[COleControl::GetClientRect](#getclientrect)|Retrieves the size of the control's client area.|
|[COleControl::GetClientSite](#getclientsite)|Queries an object for the pointer to its current client site within its container.|
|[COleControl::GetControlFlags](#getcontrolflags)|Retrieves the control flag settings.|
|[COleControl::GetControlSize](#getcontrolsize)|Returns the position and size of the OLE control.|
|[COleControl::GetDC](#getdc)|Provides a means for a windowless control to get a device context from its container.|
|[COleControl::GetEnabled](#getenabled)|Returns the value of the stock Enabled property.|
|[COleControl::GetExtendedControl](#getextendedcontrol)|Retrieves a pointer to an extended control object belonging to the container.|
|[COleControl::GetFocus](#getfocus)|Determines whether the control has the focus.|
|[COleControl::GetFont](#getfont)|Returns the value of the stock Font property.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Returns the metrics of a `CFontHolder` object.|
|[COleControl::GetForeColor](#getforecolor)|Returns the value of the stock ForeColor property.|
|[COleControl::GetHwnd](#gethwnd)|Returns the value of the stock hWnd property.|
|[COleControl::GetMessageString](#getmessagestring)|Provides status bar text for a menu item.|
|[COleControl::GetNotSupported](#getnotsupported)|Prevents access to a control's property value by the user.|
|[COleControl::GetReadyState](#getreadystate)|Returns the control's readiness state.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Returns the control's rectangle relative to its container.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Returns the metrics of the stock Font property.|
|[COleControl::GetText](#gettext)|Returns the value of the stock Text or Caption property.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Override to allow a windowless control to be the target of drag and drop operations.|
|[COleControl::InitializeIIDs](#initializeiids)|Informs the base class of the IIDs the control will use.|
|[COleControl::InternalGetFont](#internalgetfont)|Returns a `CFontHolder` object for the stock Font property.|
|[COleControl::InternalGetText](#internalgettext)|Retrieves the stock Caption or Text property.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Sets the control's readiness state and fires the ready-state-change event.|
|[COleControl::InvalidateControl](#invalidatecontrol)|Invalidates an area of the displayed control, causing it to be redrawn.|
|[COleControl::InvalidateRgn](#invalidatergn)|Invalidates the container window's client area within the given region. Can be used to redraw windowless controls in the region.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Allows specialized loading of an OLE control.|
|[COleControl::IsModified](#ismodified)|Determines if the control state has changed.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Indicates whether the container supports optimized drawing for the current drawing operation.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Called to determine if the control subclasses a Windows control.|
|[COleControl::Load](#load)|Resets any previous asynchronous data and initiates a new load of the control's asynchronous property.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Determines if your control can be deactivated by the container.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Called when an ambient property is changed.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Called when the stock Appearance property is changed.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Called when the stock BackColor property is changed.|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Called when the stock BorderStyle property is changed.|
|[COleControl::OnClick](#onclick)|Called to fire the stock Click event.|
|[COleControl::OnClose](#onclose)|Notifies the control that `IOleControl::Close` has been called.|
|[COleControl::OnDoVerb](#ondoverb)|Called after a control verb has been executed.|
|[COleControl::OnDraw](#ondraw)|Called when a control is requested to redraw itself.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Called by the container when a control is requested to redraw itself using a metafile device context.|
|[COleControl::OnEdit](#onedit)|Called by the container to UI Activate an OLE control.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Called when the stock Enabled property is changed.|
|[COleControl::OnEnumVerbs](#onenumverbs)|Called by the container to enumerate a control's verbs.|
|[COleControl::OnEventAdvise](#oneventadvise)|Called when event handlers are connected or disconnected from a control.|
|[COleControl::OnFontChanged](#onfontchanged)|Called when the stock Font property is changed.|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Called when the stock ForeColor property is changed.|
|[COleControl::OnFreezeEvents](#onfreezeevents)|Called when a control's events are frozen or unfrozen.|
|[COleControl::OnGetColorSet](#ongetcolorset)|Notifies the control that `IOleObject::GetColorSet` has been called.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Provides mnemonic information to the container.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Called to obtain a string to represent a property value.|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Requests the handle of the control's menu that will be merged with the container menu.|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Override to retrieve the control's display size closest to the proposed size and extent mode.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Returns strings representing possible values for a property.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Returns the value corresponding to a predefined string.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|Override to retrieve the size of the control's display areas (can be used to enable two-pass drawing).|
|[COleControl::OnGetViewRect](#ongetviewrect)|Override to convert control's size into a rectangle starting at a specific position.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Override to retrieve the control's view status.|
|[COleControl::OnHideToolBars](#onhidetoolbars)|Called by the container when the control is UI deactivated.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Override to have the container for the inactive control under the mouse pointer dispatch WM_MOUSEMOVE messages to the control.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Override to have the container for the inactive control under the mouse pointer dispatch WM_SETCURSOR messages to the control.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Called after the stock KeyDown event has been fired.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Called after the stock KeyPress event has been fired.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Called after the stock KeyUp event has been fired.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Indicates which property page to use for editing a property.|
|[COleControl::OnMnemonic](#onmnemonic)|Called when a mnemonic key of the control has been pressed.|
|[COleControl::OnProperties](#onproperties)|Called when the control's "Properties" verb has been invoked.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Override to query whether a control's display overlaps a given point.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Override to query whether a control's display overlaps any point in a given rectangle.|
|[COleControl::OnRenderData](#onrenderdata)|Called by the framework to retrieve data in the specified format.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|Called by the framework to retrieve data from a file in the specified format.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Called by the framework to retrieve data from global memory in the specified format.|
|[COleControl::OnResetState](#onresetstate)|Resets a control's properties to the default values.|
|[COleControl::OnSetClientSite](#onsetclientsite)|Notifies the control that `IOleControl::SetClientSite` has been called.|
|[COleControl::OnSetData](#onsetdata)|Replaces the control's data with another value.|
|[COleControl::OnSetExtent](#onsetextent)|Called after the control's extent has changed.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Called after the control's dimensions have been changed.|
|[COleControl::OnShowToolBars](#onshowtoolbars)|Called when the control has been UI activated.|
|[COleControl::OnTextChanged](#ontextchanged)|Called when the stock Text or Caption property is changed.|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Processes window messages (other than mouse and keyboard messages) for windowless controls.|
|[COleControl::ParentToClient](#parenttoclient)|Translates a point relative to the container's origin to a point relative to the control's origin.|
|[COleControl::PostModalDialog](#postmodaldialog)|Notifies the container that a modal dialog box has been closed.|
|[COleControl::PreModalDialog](#premodaldialog)|Notifies the container that a modal dialog box is about to be displayed.|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Destroys and re-creates the control's window.|
|[COleControl::Refresh](#refresh)|Forces a repaint of a control's appearance.|
|[COleControl::ReleaseCapture](#releasecapture)|Releases mouse capture.|
|[COleControl::ReleaseDC](#releasedc)|Releases the display device context of a container of a windowless control.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Resets the parent of the control window.|
|[COleControl::ResetStockProps](#resetstockprops)|Initializes `COleControl` stock properties to their default values.|
|[COleControl::ResetVersion](#resetversion)|Initializes the version number to a given value.|
|[COleControl::ScrollWindow](#scrollwindow)|Allows a windowless control to scroll an area within its in-place active image on the display.|
|[COleControl::SelectFontObject](#selectfontobject)|Selects a custom Font property into a device context.|
|[COleControl::SelectStockFont](#selectstockfont)|Selects the stock Font property into a device context.|
|[COleControl::SerializeExtent](#serializeextent)|Serializes or initializes the display space for the control.|
|[COleControl::SerializeStockProps](#serializestockprops)|Serializes or initializes the `COleControl` stock properties.|
|[COleControl::SerializeVersion](#serializeversion)|Serializes or initializes the control's version information.|
|[COleControl::SetAppearance](#setappearance)|Sets the value of the stock Appearance property.|
|[COleControl::SetBackColor](#setbackcolor)|Sets the value of the stock BackColor property.|
|[COleControl::SetBorderStyle](#setborderstyle)|Sets the value of the stock BorderStyle property.|
|[COleControl::SetCapture](#setcapture)|Causes the control's container window to take possession of the mouse capture on the control's behalf.|
|[COleControl::SetControlSize](#setcontrolsize)|Sets the position and size of the OLE control.|
|[COleControl::SetEnabled](#setenabled)|Sets the value of the stock Enabled property.|
|[COleControl::SetFocus](#setfocus)|Causes the control's container window to take possession of the input focus on the control's behalf.|
|[COleControl::SetFont](#setfont)|Sets the value of the stock Font property.|
|[COleControl::SetForeColor](#setforecolor)|Sets the value of the stock ForeColor property.|
|[COleControl::SetInitialSize](#setinitialsize)|Sets the size of an OLE control when first displayed in a container.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Changes the modified state of a control.|
|[COleControl::SetNotPermitted](#setnotpermitted)|Indicates that an edit request has failed.|
|[COleControl::SetNotSupported](#setnotsupported)|Prevents modification to a control's property value by the user.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Sets the control's rectangle relative to its container.|
|[COleControl::SetText](#settext)|Sets the value of the stock Text or Caption property.|
|[COleControl::ThrowError](#throwerror)|Signals that an error has occurred in an OLE control.|
|[COleControl::TransformCoords](#transformcoords)|Transforms coordinate values between a container and the control.|
|[COleControl::TranslateColor](#translatecolor)|Converts an OLE_COLOR value to a COLORREF value.|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Determines whether ambient properties will be available the next time the control is loaded.|
|[COleControl::WindowProc](#windowproc)|Provides a Windows procedure for a `COleControl` object.|

### Protected Methods

|Name|Description|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|Called by the framework when the control's appearance needs to be updated.|
|[COleControl::DrawMetafile](#drawmetafile)|Called by the framework when the metafile device context is being used.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Enables automation method invocation.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Called by the framework to initialize the list of data formats supported by the control.|

## Remarks

Derived from `CWnd`, this class inherits all the functionality of a Windows window object plus additional functionality specific to OLE, such as event firing and the ability to support methods and properties.

OLE controls can be inserted into OLE container applications and communicate with the container by using a two-way system of event firing and exposing methods and properties to the container. Note that standard OLE containers only support the basic functionality of an OLE control. They are unable to support extended features of an OLE control. Event firing occurs when events are sent to the container as a result of certain actions taking place in the control. In turn, the container communicates with the control by using an exposed set of methods and properties analogous to the member functions and data members of a C++ class. This approach allows the developer to control the appearance of the control and notify the container when certain actions occur.

## Windowless Controls

OLE controls can be used in-place active without a window. Windowless controls have significant advantages:

- Windowless controls can be transparent and non-rectangular

- Windowless controls reduce instance size and creation time of the object

Controls do not need a window. Services that a window offers can easily be provided via a single shared window (usually the container's) and a bit of dispatching code. Having a window is mostly an unnecessary complication on the object.

When windowless activation is used, the container (which does have a window) is responsible for providing services that would otherwise have been provided by the control's own window. For example, if your control needs to query the keyboard focus, query the mouse capture, or obtain a device context, these operations are managed by the container. The `COleControl` windowless-operation member functions invoke these operations on the container.

When windowless activation is enabled, the container delegates input messages to the control's `IOleInPlaceObjectWindowless` interface (an extension of [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) for windowless support). `COleControl`'s implementation of this interface will dispatch these messages through your control's message map, after adjusting the mouse coordinates appropriately. You can process these messages like ordinary window messages, by adding the corresponding entries to the message map.

In a windowless control, you should always use the `COleControl` member functions instead of the corresponding `CWnd` member functions or their related Windows API functions.

OLE control objects can also create a window only when they become active, but the amount of work needed for the inactive-active transition goes up and the speed of the transition goes down. There are cases when this is a problem: as an example, consider a grid of text boxes. When cursoring up and down through the column, each control must be in-place activated and then deactivated. The speed of the inactive/active transition will directly affect the scrolling speed.

For more information on developing an OLE control framework, see the articles [MFC ActiveX Controls](../../mfc/mfc-activex-controls.md) and [Overview: Creating an MFC ActiveX Control Program](../../mfc/reference/mfc-activex-control-wizard.md). For information on optimizing OLE controls, including windowless and flicker-free controls, see [MFC ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## Inheritance Hierarchy

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## Requirements

**Header:** afxctl.h

## <a name="ambientbackcolor"></a> COleControl::AmbientBackColor

Returns the value of the ambient BackColor property.

```
OLE_COLOR AmbientBackColor();
```

### Return Value

The current value of the container's ambient BackColor property, if any. If the property is not supported, this function returns the system-defined Windows background color.

### Remarks

The ambient BackColor property is available to all controls and is defined by the container. Note that the container is not required to support this property.

## <a name="ambientdisplayname"></a> COleControl::AmbientDisplayName

The name the container has assigned to the control can be used in error messages displayed to the user.

```
CString AmbientDisplayName();
```

### Return Value

The name of the OLE control. The default is a zero-length string.

### Remarks

Note that the container is not required to support this property.

## <a name="ambientfont"></a> COleControl::AmbientFont

Returns the value of the ambient Font property.

```
LPFONTDISP AmbientFont();
```

### Return Value

A pointer to the container's ambient Font dispatch interface. The default value is NULL. If the return is not equal to NULL, you are responsible for releasing the font by calling its [IUnknown::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) member function.

### Remarks

The ambient Font property is defined by the container and available to all controls.Note that the container is not required to support this property.

## <a name="ambientforecolor"></a> COleControl::AmbientForeColor

Returns the value of the ambient ForeColor property.

```
OLE_COLOR AmbientForeColor();
```

### Return Value

The current value of the container's ambient ForeColor property, if any. If not supported, this function returns the system-defined Windows text color.

### Remarks

The ambient ForeColor property is available to all controls and is defined by the container. Note that the container is not required to support this property.

## <a name="ambientlocaleid"></a> COleControl::AmbientLocaleID

Returns the container's locale ID.

```
LCID AmbientLocaleID();
```

### Return Value

The value of the container's LocaleID property, if any. If this property is not supported, this function returns 0.

### Remarks

The control can use the LocaleID to adapt its user interface for specific locales. Note that the container is not required to support this property.

## <a name="ambientappearance"></a> COleControl::AmbientAppearance

Retrieves the current appearance setting for the control object.

```
short AmbientAppearance();
```

### Return Value

The appearance of the control:

- **0** Flat appearance

- **1** 3D appearance

### Remarks

Call this function to retrieve the current value of the DISPID_AMBIENT_APPEARANCE property for the control.

## <a name="ambientscaleunits"></a> COleControl::AmbientScaleUnits

Returns the type of units used by the container.

```
CString AmbientScaleUnits();
```

### Return Value

A string containing the ambient ScaleUnits of the container. If this property is not supported, this function returns a zero-length string.

### Remarks

The container's ambient ScaleUnits property can be used to display positions or dimensions, labeled with the chosen unit, such as twips or centimeters. Note that the container is not required to support this property.

## <a name="ambientshowgrabhandles"></a> COleControl::AmbientShowGrabHandles

Determines whether the container allows the control to display grab handles for itself when active.

```
BOOL AmbientShowGrabHandles();
```

### Return Value

Nonzero if grab handles should be displayed; otherwise 0. If this property is not supported, this function returns nonzero.

### Remarks

Note that the container is not required to support this property.

## <a name="ambientshowhatching"></a> COleControl::AmbientShowHatching

Determines whether the container allows the control to display itself with a hatched pattern when UI active.

```
BOOL AmbientShowHatching();
```

### Return Value

Nonzero if the hatched pattern should be shown; otherwise 0. If this property is not supported, this function returns nonzero.

### Remarks

Note that the container is not required to support this property.

## <a name="ambienttextalign"></a> COleControl::AmbientTextAlign

Determines the ambient text alignment preferred by the control container.

```
short AmbientTextAlign();
```

### Return Value

The status of the container's ambient TextAlign property. If this property is not supported, this function returns 0.

The following is a list of valid return values:

|Return value|Meaning|
|------------------|-------------|
|0|General alignment (numbers to the right, text to the left).|
|1|Left justify|
|2|Center|
|3|Right justify|

### Remarks

This property is available to all embedded controls and is defined by the container. Note that the container is not required to support this property.

## <a name="ambientuidead"></a> COleControl::AmbientUIDead

Determines if the container wants the control to respond to user-interface actions.

```
BOOL AmbientUIDead();
```

### Return Value

Nonzero if the control should respond to user-interface actions; otherwise 0. If this property is not supported, this function returns 0.

### Remarks

For example, a container might set this to TRUE in design mode.

## <a name="ambientusermode"></a> COleControl::AmbientUserMode

Determines if the container is in design mode or user mode.

```
BOOL AmbientUserMode();
```

### Return Value

Nonzero if the container is in user mode; otherwise 0 (in design mode). If this property is not supported, this function returns TRUE.

### Remarks

For example, a container might set this to FALSE in design mode.

## <a name="boundpropertychanged"></a> COleControl::BoundPropertyChanged

Signals that the bound property value has changed.

```cpp
void BoundPropertyChanged(DISPID dispid);
```

### Parameters

*dispid*<br/>
The dispatch ID of a bound property of the control.

### Remarks

This must be called every time the value of the property changes, even in cases where the change was not made through the property Set method. Be particularly aware of bound properties that are mapped to member variables. Any time such a member variable changes, `BoundPropertyChanged` must be called.

## <a name="boundpropertyrequestedit"></a> COleControl::BoundPropertyRequestEdit

Requests permission from the `IPropertyNotifySink` interface to change a bound property value provided by the control.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### Parameters

*dispid*<br/>
The dispatch ID of a bound property of the control.

### Return Value

Nonzero if the change is permitted; otherwise 0. The default value is nonzero.

### Remarks

If permission is denied, the control must not let the value of the property change. This can be done by ignoring or failing the action that attempted to change the property value.

## <a name="clienttoparent"></a> COleControl::ClientToParent

Translates the coordinates of *pPoint* into parent coordinates.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### Parameters

*lprcBounds*<br/>
Pointer to the bounds of the OLE control within the container. Not the client area but the area of the entire control including borders and scroll bars.

*pPoint*<br/>
Pointer to the OLE client area point to be translated into the coordinates of the parent (container).

### Remarks

On input *pPoint* is relative to the origin of the client area of the OLE control (upper left corner of the client area of the control). On output *pPoint* is relative to the origin of the parent (upper left corner of the container).

## <a name="clipcaretrect"></a> COleControl::ClipCaretRect

Adjusts a caret rectangle if it is entirely or partially covered by overlapping, opaque objects.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### Parameters

*lpRect*<br/>
On input, a pointer to a [RECT](/windows/win32/api/windef/ns-windef-rect) structure that contains the caret area to be adjusted. On output, the adjusted caret area, or NULL if the caret rectangle is completely covered.

### Return Value

Nonzero if successful; otherwise 0.

### Remarks

A caret is a flashing line, block, or bitmap that typically indicates where text or graphics will be inserted.

A windowless object cannot safely show a caret without first checking whether the caret is partially or totally hidden by overlapping objects. In order to make that possible, an object can use `ClipCaretRect` to get the caret adjusted (reduced) to ensure it fits in the clipping region.

Objects creating a caret should submit the caret rectangle to `ClipCaretRect` and use the adjusted rectangle for the caret. If the caret is entirely hidden, this method will return FALSE and the caret should not be shown at all in this case.

## <a name="colecontrol"></a> COleControl::COleControl

Constructs a `COleControl` object.

```
COleControl();
```

### Remarks

This function is normally not called directly. Instead the OLE control is usually created by its class factory.

## <a name="controlinfochanged"></a> COleControl::ControlInfoChanged

Call this function when the set of mnemonics supported by the control has changed.

```cpp
void ControlInfoChanged();
```

### Remarks

Upon receiving this notification, the control's container obtains the new set of mnemonics by making a call to [IOleControl::GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Note that the container is not required to respond to this notification.

## <a name="displayerror"></a> COleControl::DisplayError

Called by the framework after the stock Error event has been handled (unless the event handler has suppressed the display of the error).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### Parameters

*scode*<br/>
The status code value to be reported. For a complete list of possible codes, see the article [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
The description of the error being reported.

*lpszSource*<br/>
The name of the module generating the error (typically, the name of the OLE control module).

*lpszHelpFile*<br/>
The name of the help file containing a description of the error.

*nHelpID*<br/>
The Help Context ID of the error being reported.

### Remarks

The default behavior displays a message box containing the description of the error, contained in *lpszDescription*.

Override this function to customize how errors are displayed.

## <a name="doclick"></a> COleControl::DoClick

Simulates a mouse click action on the control.

```cpp
void DoClick();
```

### Remarks

The overridable `COleControl::OnClick` member function will be called, and a stock Click event will be fired, if supported by the control.

This function is supported by the `COleControl` base class as a stock method, called DoClick. For more information, see the article [ActiveX Controls: Methods](../../mfc/mfc-activex-controls-methods.md).

## <a name="dopropexchange"></a> COleControl::DoPropExchange

Called by the framework when loading or storing a control from a persistent storage representation, such as a stream or property set.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### Parameters

*pPX*<br/>
A pointer to a `CPropExchange` object. The framework supplies this object to establish the context of the property exchange, including its direction.

### Remarks

This function normally makes calls to the **PX_** family of functions to load or store specific user-defined properties of an OLE control.

If Control Wizard has been used to create the OLE control project, the overridden version of this function will serialize the stock properties supported by `COleControl` with a call to the base class function, `COleControl::DoPropExchange`. As you add user-defined properties to your OLE control you will need to modify this function to serialize your new properties. For more information on serialization, see the article [ActiveX Controls: Serializing](../../mfc/mfc-activex-controls-serializing.md).

## <a name="dosuperclasspaint"></a> COleControl::DoSuperclassPaint

Redraws an OLE control that has been subclassed from a Windows control.

```cpp
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### Parameters

*pDC*<br/>
A pointer to the device context of the control container.

*rcBounds*<br/>
The area in which the control is to be drawn.

### Remarks

Call this function to properly handle the painting of a nonactive OLE control. This function should only be used if the OLE control subclasses a Windows control and should be called in the `OnDraw` function of your control.

For more information on this function and subclassing a Windows control, see the article [ActiveX Controls: Subclassing a Windows Control](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

## <a name="drawcontent"></a> COleControl::DrawContent

Called by the framework when the control's appearance needs to be updated.

```cpp
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### Parameters

*pDC*<br/>
Pointer to the device context.

*rc*<br/>
Rectangular area to be drawn in.

### Remarks

This function directly calls the overridable `OnDraw` function.

## <a name="drawmetafile"></a> COleControl::DrawMetafile

Called by the framework when the metafile device context is being used.

```cpp
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### Parameters

*pDC*<br/>
Pointer to the metafile device context.

*rc*<br/>
Rectangular area to be drawn in.

## <a name="enablesimpleframe"></a> COleControl::EnableSimpleFrame

Enables the simple frame characteristic for an OLE control.

```cpp
void EnableSimpleFrame();
```

### Remarks

This characteristic allows a control to support visual containment of other controls, but not true OLE containment. An example would be a group box with several controls inside. These controls are not OLE contained, but they are in the same group box.

## <a name="exchangeextent"></a> COleControl::ExchangeExtent

Serializes or initializes the state of the control's extent (its dimensions in HIMETRIC units).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### Parameters

*pPX*<br/>
A pointer to a [CPropExchange](../../mfc/reference/cpropexchange-class.md) object. The framework supplies this object to establish the context of the property exchange, including its direction.

### Return Value

Nonzero if the function succeeded; 0 otherwise.

### Remarks

This function is normally called by the default implementation of `COleControl::DoPropExchange`.

## <a name="exchangestockprops"></a> COleControl::ExchangeStockProps

Serializes or initializes the state of the control's stock properties.

```cpp
void ExchangeStockProps(CPropExchange* pPX);
```

### Parameters

*pPX*<br/>
A pointer to a [CPropExchange](../../mfc/reference/cpropexchange-class.md) object. The framework supplies this object to establish the context of the property exchange, including its direction.

### Remarks

This function is normally called by the default implementation of `COleControl::DoPropExchange`.

## <a name="exchangeversion"></a> COleControl::ExchangeVersion

Serializes or initializes the state of a control's version information.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### Parameters

*pPX*<br/>
A pointer to a `CPropExchange` object. The framework supplies this object to establish the context of the property exchange, including its direction.

*dwVersionDefault*<br/>
The current version number of the control.

*bConvert*<br/>
Indicates whether persistent data should be converted to the latest format when saved, or maintained in the same format that was loaded.

### Return Value

Nonzero of the function succeeded; 0 otherwise.

### Remarks

Typically, this will be the first function called by a control's override of `COleControl::DoPropExchange`. When loading, this function reads the version number of the persistent data, and sets the version attribute of the [CPropExchange](../../mfc/reference/cpropexchange-class.md) object accordingly. When saving, this function writes the version number of the persistent data.

For more information on persistence and versioning, see the article [ActiveX Controls: Serializing](../../mfc/mfc-activex-controls-serializing.md).

## <a name="fireclick"></a> COleControl::FireClick

Called by the framework when the mouse is clicked over an active control.

```cpp
void FireClick();
```

### Remarks

If this event is defined as a custom event, you determine when the event is fired.

For automatic firing of a Click event to occur, the control's Event map must have a stock Click event defined.

## <a name="firedblclick"></a> COleControl::FireDblClick

Called by the framework when the mouse is double-clicked over an active control.

```cpp
void FireDblClick();
```

### Remarks

If this event is defined as a custom event, you determine when the event is fired.

For automatic firing of a DblClick event to occur, the control's Event map must have a stock DblClick event defined.

## <a name="fireerror"></a> COleControl::FireError

Fires the stock Error event.

```cpp
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### Parameters

*scode*<br/>
The status code value to be reported. For a complete list of possible codes, see the article [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
The description of the error being reported.

*nHelpID*<br/>
The Help ID of the error being reported.

### Remarks

This event provides a way of signalling, at appropriate places in your code, that an error has occurred within your control. Unlike other stock events, such as Click or MouseMove, Error is never fired by the framework.

To report an error that occurs during a property get function, property set function, or automation method, call [COleControl::ThrowError](#throwerror).

The implementation of an OLE control's Stock Error event uses an SCODE value. If your control uses this event, and is intended to be used in Visual Basic 4.0, you will receive errors because the SCODE value is not supported in Visual Basic.

To fix this, manually change the SCODE parameter in the control's .ODL file to a **`long`**. In addition, any custom event, method, or property that uses an SCODE parameter also causes the same problem.

## <a name="fireevent"></a> COleControl::FireEvent

Fires a user-defined event from your control with any number of optional arguments,.

```cpp
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### Parameters

*dispid*<br/>
The dispatch ID of the event to be fired.

*pbParams*<br/>
A descriptor for the event's parameter types.

### Remarks

Usually this function should not be called directly. Instead you will call the event-firing functions in the event map section of your control's class declaration.

The *pbParams* argument is a space-separated list of **VTS_**. One or more of these values, separated by spaces (not commas), specifies the function's parameter list. Possible values are as follows:

|Symbol|Parameter type|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> Additional variant constants have been defined for all variant types, with the exception of VTS_FONT and VTS_PICTURE, that provide a pointer to the variant data constant. These constants are named using the VTS_P\<CONSTANT-NAME> convention. For example, VTS_PCOLOR is a pointer to a VTS_COLOR constant.

## <a name="firekeydown"></a> COleControl::FireKeyDown

Called by the framework when a key is pressed while the control is UI active.

```cpp
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### Parameters

*pnChar*<br/>
Pointer to the virtual key code value of the pressed key. For a list of standard virtual key codes, see Winuser.h

*nShiftState*<br/>
Contains a combination of the following flags:

- SHIFT_MASK The SHIFT key was pressed during the action.

- CTRL_MASK The CTRL key was pressed during the action.

- ALT_MASK The ALT key was pressed during the action.

### Remarks

If this event is defined as a custom event, you determine when the event is fired.

For automatic firing of a KeyDown event to occur, the control's Event map must have a stock KeyDown event defined.

## <a name="firekeypress"></a> COleControl::FireKeyPress

Called by the framework when a key is pressed and released while the custom control is UI Active within the container.

```cpp
void FireKeyPress(USHORT* pnChar);
```

### Parameters

*pnChar*<br/>
A pointer to the character value of the key pressed.

### Remarks

If this event is defined as a custom event, you determine when the event is fired.

The recipient of the event may modify *pnChar*, for example, convert all lowercase characters to uppercase. If you want to examine the modified character, override `OnKeyPressEvent`.

For automatic firing of a KeyPress event to occur, the control's Event map must have a stock KeyPress event defined.

## <a name="firekeyup"></a> COleControl::FireKeyUp

Called by the framework when a key is released while the custom control is UI Active within the container.

```cpp
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### Parameters

*pnChar*<br/>
Pointer to the virtual key code value of the released key. For a list of standard virtual key codes, see Winuser.h

*nShiftState*<br/>
Contains a combination of the following flags:

- SHIFT_MASK The SHIFT key was pressed during the action.

- CTRL_MASK The CTRL key was pressed during the action.

- ALT_MASK The ALT key was pressed during the action.

### Remarks

If this event is defined as a custom event, you determine when the event is fired.

For automatic firing of a KeyUp event to occur, the control's Event map must have a stock KeyUp event defined.

## <a name="firemousedown"></a> COleControl::FireMouseDown

Called by the framework when a mouse button is pressed over an active custom control.

```cpp
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### Parameters

*nButton*<br/>
The numeric value of the mouse button pressed. It can contain one of the following values:

- LEFT_BUTTON The left mouse button was pressed down.

- MIDDLE_BUTTON The middle mouse button was pressed down.

- RIGHT_BUTTON The right mouse button was pressed down.

*nShiftState*<br/>
Contains a combination of the following flags:

- SHIFT_MASK The SHIFT key was pressed during the action.

- CTRL_MASK The CTRL key was pressed during the action.

- ALT_MASK The ALT key was pressed during the action.

*x*<br/>
The x-coordinate of the cursor when a mouse button was pressed down. The coordinate is relative to the upper-left corner of the control window.

*y*<br/>
The y-coordinate of the cursor when a mouse button was pressed down. The coordinate is relative to the upper-left corner of the control window.

### Remarks

If this event is defined as a custom event, you determine when the event is fired.

For automatic firing of a MouseDown event to occur, the control's Event map must have a stock MouseDown event defined.

## <a name="firemousemove"></a> COleControl::FireMouseMove

Called by the framework when the cursor is moved over an active custom control.

```cpp
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### Parameters

*nButton*<br/>
The numeric value of the mouse buttons pressed. Contains a combination of the following values:

- LEFT_BUTTON The left mouse button was pressed down during the action.

- MIDDLE_BUTTON The middle mouse button was pressed down during the action.

- RIGHT_BUTTON The right mouse button was pressed down during the action.

*nShiftState*<br/>
Contains a combination of the following flags:

- SHIFT_MASK The SHIFT key was pressed during the action.

- CTRL_MASK The CTRL key was pressed during the action.

- ALT_MASK The ALT key was pressed during the action.

*x*<br/>
The x-coordinate of the cursor. The coordinate is relative to the upper-left corner of the control window.

*y*<br/>
The y-coordinate of the cursor. The coordinate is relative to the upper-left corner of the control window.

### Remarks

If this event is defined as a custom event, you determine when the event is fired.

For automatic firing of a MouseMove event to occur, the control's Event map must have a stock MouseMove event defined.

## <a name="firemouseup"></a> COleControl::FireMouseUp

Called by the framework when a mouse button is released over an active custom control.

```cpp
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### Parameters

*nButton*<br/>
The numeric value of the mouse button released. It can have one of the following values:

- LEFT_BUTTON The left mouse button was released.

- MIDDLE_BUTTON The middle mouse button was released.

- RIGHT_BUTTON The right mouse button was released.

*nShiftState*<br/>
Contains a combination of the following flags:

- SHIFT_MASK The SHIFT key was pressed during the action.

- CTRL_MASK The CTRL key was pressed during the action.

- ALT_MASK The ALT key was pressed during the action.

*x*<br/>
The x-coordinate of the cursor when a mouse button was released. The coordinate is relative to the upper-left corner of the control window.

*y*<br/>
The y-coordinate of a cursor when a mouse button was released. The coordinate is relative to the upper-left corner of the control window.

### Remarks

If this event is defined as a custom event, you determine when the event is fired.

For automatic firing of a MouseUp event to occur, the control's Event map must have a stock MouseUp event defined.

## <a name="firereadystatechange"></a> COleControl::FireReadyStateChange

Fires an event with the current value of the ready state of control.

```cpp
void FireReadyStateChange();
```

### Remarks

The ready state can be one of the following values:

|Name|Description|
|-|-|
|READYSTATE_UNINITIALIZED|Default initialization state|
|READYSTATE_LOADING|Control is currently loading its properties|
|READYSTATE_LOADED|Control has been initialized|
|READYSTATE_INTERACTIVE|Control has enough data to be interactive but not all asynchronous data is yet loaded|
|READYSTATE_COMPLETE|Control has all its data|

Use [GetReadyState](#getreadystate) to determine the control's current readiness.

[InternalSetReadyState](#internalsetreadystate) changes the ready state to the value supplied, then calls `FireReadyStateChange`.

## <a name="getactivationpolicy"></a> COleControl::GetActivationPolicy

Alters the default activation behavior of a control that supports the `IPointerInactive` interface.

```
virtual DWORD GetActivationPolicy();
```

### Return Value

A combination of flags from the POINTERINACTIVE enumeration. Possible flags are:

|Name|Description|
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|The object should be in-place activated when the mouse enters it during a mouse move operation.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|The object should be deactivated when the mouse leaves the object during a mouse move operation.|
|POINTERINACTIVE_ACTIVATEONDRAG|The object should be in-place activated when the mouse is dragged over it during a drag and drop operation.|

### Remarks

When the `IPointerInactive` interface is enabled, the container will delegate WM_SETCURSOR and WM_MOUSEMOVE messages to it. `COleControl`'s implementation of this interface will dispatch these messages through your control's message map, after adjusting the mouse coordinates appropriately.

Whenever the container receives a WM_SETCURSOR or WM_MOUSEMOVE message with the mouse pointer over an inactive object supporting `IPointerInactive`, it should call `GetActivationPolicy` on the interface and return flags from the POINTERINACTIVE enumeration.

You can process these messages just like ordinary window messages, by adding the corresponding entries to the message map. In your handlers, avoid using the `m_hWnd` member variable (or any member functions that uses it) without first checking that its value is non- NULL.

Any object intended to do more than set the mouse cursor and/or fire a mouse move event, such as give special visual feedback, should return the POINTERINACTIVE_ACTIVATEONENTRY flag and draw the feedback only when active. If the object returns this flag, the container should activate it in-place immediately and then forward it the same message that triggered the call to `GetActivationPolicy`.

If both the POINTERINACTIVE_ACTIVATEONENTRY and POINTERINACTIVE_DEACTIVATEONLEAVE flags are returned, then the object will only be activated when the mouse is over the object. If only the POINTERINACTIVE_ACTIVATEONENTRY flag is returned, then the object will only be activated once when the mouse first enters the object.

You may also want an inactive control to be the target of an OLE drag and drop operation. This requires activating the control at the moment the user drags an object over it, so that the control's window can be registered as a drop target. To cause activation to occur during a drag, return the POINTERINACTIVE_ACTIVATEONDRAG flag:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

The information communicated by `GetActivationPolicy` should not be cached by a container. Instead, this method should be called every time the mouse enters an inactive object.

If an inactive object does not request to be in-place activated when the mouse enters it, its container should dispatch subsequent WM_SETCURSOR messages to this object by calling [OnInactiveSetCursor](#oninactivesetcursor) as long as the mouse pointer stays over the object.

Enabling the `IPointerInactive` interface typically means that you want the control to be capable of processing mouse messages at all times. To get this behaviour in a container that doesn't support the `IPointerInactive` interface, you will need to have your control always activated when visible, which means the control should have the OLEMISC_ACTIVATEWHENVISIBLE flag among its miscellaneous flags. However, to prevent this flag from taking effect in a container that does support `IPointerInactive`, you can also specify the OLEMISC_IGNOREACTIVATEWHENVISIBLE flag:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="getambientproperty"></a> COleControl::GetAmbientProperty

Gets the value of an ambient property of the container.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### Parameters

*dwDispid*<br/>
The dispatch ID of the desired ambient property.

*vtProp*<br/>
A variant type tag that specifies the type of the value to be returned in *pvProp*.

*pvProp*<br/>
A pointer to the address of the variable that will receive the property value or return value. The actual type of this pointer must match the type specified by *vtProp*.

|vtProp|Type of pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### Return Value

Nonzero if the ambient property is supported; otherwise 0.

### Remarks

If you use `GetAmbientProperty` to retrieve the ambient DisplayName and ScaleUnits properties, set *vtProp* to VT_BSTR and *pvProp* to `CString*`. If you are retrieving the ambient Font property, set *vtProp* to VT_FONT and *pvProp* to LPFONTDISP*.

Note that functions have already been provided for common ambient properties, such as [AmbientBackColor](#ambientbackcolor) and [AmbientFont](#ambientfont).

## <a name="getappearance"></a> COleControl::GetAppearance

Implements the Get function of your control's stock Appearance property.

```
short GetAppearance ();
```

### Return Value

The return value specifies the current appearance setting as a **`short`** (VT_I2) value, if successful. This value is zero if the control's appearance is flat and 1 if the control's appearance is 3D.

## <a name="getbackcolor"></a> COleControl::GetBackColor

Implements the Get function of your control's stock BackColor property.

```
OLE_COLOR GetBackColor();
```

### Return Value

The return value specifies the current background color as a OLE_COLOR value, if successful. This value can be translated to a COLORREF value with a call to `TranslateColor`.

## <a name="getborderstyle"></a> COleControl::GetBorderStyle

Implements the Get function of your control's stock BorderStyle property.

```
short GetBorderStyle();
```

### Return Value

1 if the control has a normal border; 0 if the control has no border.

## <a name="getcapture"></a> COleControl::GetCapture

Determines whether the `COleControl` object has the mouse capture.

```
CWnd* GetCapture();
```

### Return Value

If the control is activated and windowless, returns **`this`** if the control currently has the mouse capture (as determined by the control's container), or NULL if it does not have the capture.

Otherwise, returns the `CWnd` object that has the mouse capture (same as `CWnd::GetCapture`).

### Remarks

An activated windowless control receives the mouse capture when [SetCapture](#setcapture) is called.

## <a name="getclassid"></a> COleControl::GetClassID

Called by the framework to retrieve the OLE class ID of the control.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### Parameters

*pclsid*<br/>
Pointer to the location of the class ID.

### Return Value

Nonzero if the call was not successful; otherwise 0.

### Remarks

Usually implemented by the [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

## <a name="getclientoffset"></a> COleControl::GetClientOffset

Retrieves the difference between the upper left corner of the control's rectangular area and the upper left corner of its client area.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### Parameters

*pdxOffset*<br/>
Pointer to the horizontal offset of the OLE control's client area.

*pdyOffset*<br/>
Pointer to the vertical offset of the OLE control's client area.

### Remarks

The OLE control has a rectangular area within its container. The client area of the control is the control area excluding borders and scroll bars. The offset retrieved by `GetClientOffset` is the difference between the upper left corner of the control's rectangular area and the upper left corner of its client area. If your control has non-client elements other than the standard borders and scrollbars, override this member function to specify the offset.

## <a name="getclientrect"></a> COleControl::GetClientRect

Retrieves the size of the control's client area.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### Parameters

*lpRect*<br/>
Pointer to a `RECT` structure containing the dimensions of the windowless control's client area; that is, the control's size minus window borders, frames, scroll bars, and so on. The *lpRect* parameter indicates the size of the control's client rectangle, not its position.

## <a name="getclientsite"></a> COleControl::GetClientSite

Queries an object for the pointer to its current client site within its container.

```
LPOLECLIENTSITE GetClientSite();
```

### Return Value

A pointer to the control's current client site in its container.

### Remarks

The returned pointer points to an instance of `IOleClientSite`. The `IOleClientSite` interface, implemented by containers, is the object's view of its context: where it is anchored in the document, where it gets its storage, user interface, and other resources.

## <a name="getcontrolflags"></a> COleControl::GetControlFlags

Retrieves the control flag settings.

```
virtual DWORD GetControlFlags();
```

### Return Value

An ORed combination of the flags in the ControlFlags enumeration:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### Remarks

By default, `GetControlFlags` returns `fastBeginPaint | clipPaintDC`.

|Name|Description|
|-|-|
|`fastBeginPaint`|If set, uses a begin-paint function tailored for OLE controls instead of the [BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) API (set by default).|
|`clipPaintDC`|If not set, disables the call to `IntersectClipRect` made by `COleControl` and gains a small speed advantage. If you are using windowless activation, the flag has no effect.|
|`pointerInactive`|If set, provides mouse interaction while your control is inactive by enabling `COleControl`'s implementation of the `IPointerInactive` interface, which is disabled by default.|
|`noFlickerActivate`|If set, eliminates extra drawing operations and the accompanying visual flicker. Use when your control draws itself identically in the inactive and active states. If you are using windowless activation, the flag has no effect.|
|`windowlessActivate`|If set, indicates your control uses windowless activation.|
|`canOptimizeDraw`|If set, indicates that the control will perform optimized drawing, if the container supports it.|

For more information about `GetControlFlags` and other optimizations of OLE controls, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="getcontrolsize"></a> COleControl::GetControlSize

Retrieves the size of the OLE control window.

```cpp
void GetControlSize(
    int* pcx,
    int* pcy);
```

### Parameters

*pcx*<br/>
Specifies the width of the control in pixels.

*pcy*<br/>
Specifies the height of the control in pixels.

### Remarks

Note that all coordinates for control windows are relative to the upper-left corner of the control.

## <a name="getdc"></a> COleControl::GetDC

Provides for a windowless object to get a screen (or compatible) device context from its container.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### Parameters

*lprcRect*<br/>
A pointer to the rectangle the windowless control wants to redraw, in client coordinates of the control. NULL means the full object's extent.

*dwFlags*<br/>
Drawing attributes of the device context. Choices are:

- OLEDC_NODRAW Indicates that the object won't use the device context to perform any drawing but merely to get information about the display device. The container should simply pass the window's DC without further processing.

- OLEDC_PAINTBKGND Requests that the container paint the background before returning the DC. An object should use this flag if it is requesting a DC for redrawing an area with transparent background.

- OLEDC_OFFSCREEN Informs the container that the object wishes to render into an off-screen bitmap that should then be copied to the screen. An object should use this flag when the drawing operation it is about to perform generates a lot of flicker. The container is free to honor this request or not. However, if this flag is not set, the container must hand back an on-screen DC. This allows objects to perform direct screen operations such as showing a selection (via an **XOR** operation).

### Return Value

Pointer to the display device context for the container `CWnd` client area if successful; otherwise, the return value is NULL. The display device context can be used in subsequent GDI functions to draw in the client area of the container's window.

### Remarks

The [ReleaseDC](#releasedc) member function must be called to release the context after painting. When calling `GetDC`, objects pass the rectangle they wish to draw into in their own client coordinates. `GetDC` translates these to coordinates of the container client area. The object should not request a desired drawing rectangle larger than its own client area rectangle, the size of which can be retrieved with [GetClientRect](#getclientrect). This prevents objects from inadvertently drawing where they are not supposed to.

## <a name="getenabled"></a> COleControl::GetEnabled

Implements the Get function of your control's stock Enabled property.

```
BOOL GetEnabled();
```

### Return Value

Nonzero if the control is enabled; otherwise 0.

## <a name="getextendedcontrol"></a> COleControl::GetExtendedControl

Obtains a pointer to an object maintained by the container that represents the control with an extended set of properties.

```
LPDISPATCH GetExtendedControl();
```

### Return Value

A pointer to the container's extended control object. If there is no object available, the value is NULL.

This object may be manipulated through its `IDispatch` interface. You can also use `QueryInterface` to obtain other available interfaces provided by the object. However, the object is not required to support a specific set of interfaces. Note that relying on the specific features of a container's extended control object limits the portability of your control to other arbitrary containers.

### Remarks

The function that calls this function is responsible for releasing the pointer when finished with the object. Note that the container is not required to support this object.

## <a name="getfocus"></a> COleControl::GetFocus

Determines whether the `COleControl` object has the focus.

```
CWnd* GetFocus();
```

### Return Value

If the control is activated and windowless, returns **`this`** if the control currently has the keyboard focus (as determined by the control's container), or NULL if it does not have the focus.

Otherwise, returns the `CWnd` object that has the focus (same as `CWnd::GetFocus`).

### Remarks

An activated windowless control receives the focus when [SetFocus](#setfocus) is called.

## <a name="getfont"></a> COleControl::GetFont

Implements the Get function of the stock Font property.

```
LPFONTDISP GetFont();
```

### Return Value

A pointer to the font dispatch interface of the control's stock Font property.

### Remarks

Note that the caller must release the object when finished. Within the implementation of the control, use `InternalGetFont` to access the control's stock Font object. For more information on using fonts in your control, see the article [ActiveX Controls: Using Fonts in an ActiveX Control](../../mfc/mfc-activex-controls-using-fonts.md).

## <a name="getfonttextmetrics"></a> COleControl::GetFontTextMetrics

Measures the text metrics for any `CFontHolder` object owned by the control.

```cpp
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### Parameters

*lptm*<br/>
Pointer to a [TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw) structure.

*fontHolder*<br/>
Reference to a [CFontHolder](../../mfc/reference/cfontholder-class.md) object.

### Remarks

Such a font can be selected with the [COleControl::SelectFontObject](#selectfontobject) function. `GetFontTextMetrics` will initialize the `TEXTMETRIC` structure pointed to by *lptm* with valid metrics information about `fontHolder`'s font if successful, or fill the structure with zeros if not successful. You should use this function instead of [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) when painting your control because controls, like any embedded OLE object, may be required to render themselves into a metafile.

The `TEXTMETRIC` structure for the default font is refreshed when the [SelectFontObject](#selectfontobject) function is called. You should call `GetFontTextMetrics` only after selecting the stock Font property to assure the information it provides is valid.

## <a name="getforecolor"></a> COleControl::GetForeColor

Implements the Get function of the stock ForeColor property.

```
OLE_COLOR GetForeColor();
```

### Return Value

The return value specifies the current foreground color as a OLE_COLOR value, if successful. This value can be translated to a [COLORREF](/windows/win32/gdi/colorref) value with a call to `TranslateColor`.

## <a name="gethwnd"></a> COleControl::GetHwnd

Implements the Get function of the stock hWnd property.

```
OLE_HANDLE GetHwnd();
```

### Return Value

The OLE control's window handle, if any; otherwise NULL.

## <a name="getmessagestring"></a> COleControl::GetMessageString

Called by the framework to obtain a short string that describes the purpose of the menu item identified by *nID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### Parameters

*nID*<br/>
A menu item ID.

*rMessage*<br/>
A reference to a [CString](../../atl-mfc-shared/reference/cstringt-class.md) object through which a string will be returned.

### Remarks

This can be used to obtain a message for display in a status bar while the menu item is highlighted. The default implementation attempts to load a string resource identified by *nID*.

## <a name="getnotsupported"></a> COleControl::GetNotSupported

Prevents access to a control's property value by the user.

```cpp
void GetNotSupported();
```

### Remarks

Call this function in place of the Get function of any property where retrieval of the property by the control's user is not supported. One example would be a property that is write only.

## <a name="getreadystate"></a> COleControl::GetReadyState

Returns the readiness state of the control.

```
long GetReadyState();
```

### Return Value

The readiness state of the control, one of the following values:

|Name|Description|
|-|-|
|READYSTATE_UNINITIALIZED|Default initialization state|
|READYSTATE_LOADING|Control is currently loading its properties|
|READYSTATE_LOADED|Control has been initialized|
|READYSTATE_INTERACTIVE|Control has enough data to be interactive but not all asynchronous data is yet loaded|
|READYSTATE_COMPLETE|Control has all its data|

### Remarks

Most simple controls never need to differentiate between LOADED and INTERACTIVE. However, controls that support data path properties may not be ready to be interactive until at least some data is received asynchronously. A control should attempt to become interactive as soon as possible.

## <a name="getrectincontainer"></a> COleControl::GetRectInContainer

Obtains the coordinates of the control's rectangle relative to the container, expressed in device units.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### Parameters

*lpRect*<br/>
A pointer to the rectangle structure into which the control's coordinates will be copied.

### Return Value

Nonzero if the control is in-place active; otherwise 0.

### Remarks

The rectangle is only valid if the control is in-place active.

## <a name="getstocktextmetrics"></a> COleControl::GetStockTextMetrics

Measures the text metrics for the control's stock Font property, which can be selected with the [SelectStockFont](#selectstockfont) function.

```cpp
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### Parameters

*lptm*<br/>
A pointer to a [TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw) structure.

### Remarks

The `GetStockTextMetrics` function will initialize the `TEXTMETRIC` structure pointed to by *lptm* with valid metrics information if successful, or fill the structure with zeros if not successful. Use this function instead of [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) when painting your control because controls, like any embedded OLE object, may be required to render themselves into a metafile.

The `TEXTMETRIC` structure for the default font is refreshed when the `SelectStockFont` function is called. You should call this function only after selecting the stock font to assure the information it provides is valid.

## <a name="gettext"></a> COleControl::GetText

Implements the Get function of the stock Text or Caption property.

```
BSTR GetText();
```

### Return Value

The current value of the control text string or a zero-length string if no string is present.

> [!NOTE]
> For more information on the BSTR data type, see [Data Types](../../mfc/reference/data-types-mfc.md) in the Macros and Globals section.

### Remarks

Note that the caller of this function must call `SysFreeString` on the string returned in order to free the resource. Within the implementation of the control, use `InternalGetText` to access the control's stock Text or Caption property.

## <a name="getwindowlessdroptarget"></a> COleControl::GetWindowlessDropTarget

Override `GetWindowlessDropTarget` when you want a windowless control to be the target of an OLE drag and drop operation.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### Return Value

Pointer to the object's `IDropTarget` interface. Since it does not have a window, a windowless object cannot register an `IDropTarget` interface. However, to participate in drag and drop, a windowless object can still implement the interface and return it in `GetWindowlessDropTarget`.

### Remarks

Normally, this would require that the control's window be registered as a drop target. But since the control has no window of its own, the container will use its own window as a drop target. The control simply needs to provide an implementation of the `IDropTarget` interface to which the container can delegate calls at the appropriate time. For example:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="initializeiids"></a> COleControl::InitializeIIDs

Informs the base class of the IIDs the control will use.

```cpp
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### Parameters

*piidPrimary*<br/>
Pointer to the interface ID of the control's primary dispatch interface.

*piidEvents*<br/>
Pointer to the interface ID of the control's event interface.

### Remarks

Call this function in the control's constructor to inform the base class of the interface IDs your control will be using.

## <a name="internalgetfont"></a> COleControl::InternalGetFont

Accesses the stock Font property of your control

```
CFontHolder& InternalGetFont();
```

### Return Value

A reference to a [CFontHolder](../../mfc/reference/cfontholder-class.md) object that contains the stock Font object.

## <a name="internalgettext"></a> COleControl::InternalGetText

Accesses the stock Text or Caption property of your control.

```
const CString& InternalGetText();
```

### Return Value

A reference to the control text string.

## <a name="internalsetreadystate"></a> COleControl::InternalSetReadyState

Sets the readiness state of the control.

```cpp
void InternalSetReadyState(long lNewReadyState);
```

### Parameters

*lNewReadyState*<br/>
The readiness state to set for the control, one of the following values:

|Name|Description|
|-|-|
|READYSTATE_UNINITIALIZED|Default initialization state|
|READYSTATE_LOADING|Control is currently loading its properties|
|READYSTATE_LOADED|Control has been initialized|
|READYSTATE_INTERACTIVE|Control has enough data to be interactive but not all asynchronous data is yet loaded|
|READYSTATE_COMPLETE|Control has all its data|

### Remarks

Most simple controls never need to differentiate between LOADED and INTERACTIVE. However, controls that support data path properties may not be ready to be interactive until at least some data is received asynchronously. A control should attempt to become interactive as soon as possible.

## <a name="invalidatecontrol"></a> COleControl::InvalidateControl

Forces the control to redraw itself.

```cpp
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### Parameters

*lpRect*<br/>
A pointer to the region of the control to be invalidated.

*bErase*<br/>
Specifies whether the background within the update region is to be erased when the update region is processed.

### Remarks

If *lpRect* has a NULL value, the entire control will be redrawn. If *lpRect* is not NULL, this indicates the portion of the control's rectangle that is to be invalidated. In cases where the control has no window, or is currently not active, the rectangle is ignored, and a call is made to the client site's [IAdviseSink::OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) member function. Use this function instead of `CWnd::InvalidateRect` or `InvalidateRect`.

## <a name="invalidatergn"></a> COleControl::InvalidateRgn

Invalidates the container window's client area within the given region.

```cpp
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### Parameters

*pRgn*<br/>
A pointer to a [CRgn](../../mfc/reference/crgn-class.md) object that identifies the display region of the OLE object to invalidate, in client coordinates of the containing window. If this parameter is NULL, the extent is the entire object.

*bErase*<br/>
Specifies whether the background within the invalidated region is to be erased. If TRUE, the background is erased. If FALSE, the background remains unchanged.

### Remarks

This can be used to redraw windowless controls within the container. The invalidated region, along with all other areas in the update region, is marked for painting when the next [WM_PAINT](/windows/win32/gdi/wm-paint) message is sent.

If *bErase* is TRUE for any part of the update region, the background in the entire region, not just in the given part, is erased.

## <a name="isconvertingvbx"></a> COleControl::IsConvertingVBX

Allows specialized loading of an OLE control.

```
BOOL IsConvertingVBX();
```

### Return Value

Nonzero if the control is being converted; otherwise 0.

### Remarks

When converting a form that uses VBX controls to one that uses OLE controls, special loading code for the OLE controls may be required. For example, if you are loading an instance of your OLE control, you might have a call to [PX_Font](persistence-of-ole-controls.md#px_font) in your `DoPropExchange`:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

However, VBX controls did not have a Font object; each font property was saved individually. In this case, you would use `IsConvertingVBX` to distinguish between these two cases:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Another case would be if your VBX control saved proprietary binary data (in its VBM_SAVEPROPERTY message handler), and your OLE control saves its binary data in a different format. If you want your OLE control to be backward-compatible with the VBX control, you could read both the old and new formats using the `IsConvertingVBX` function by distinguishing whether the VBX control or the OLE control was being loaded.

In your control's `DoPropExchange` function, you can check for this condition and if true, execute load code specific to this conversion (such as the previous examples). If the control is not being converted, you can execute normal load code. This ability is only applicable to controls being converted from VBX counterparts.

## <a name="isinvokeallowed"></a> COleControl::IsInvokeAllowed

Enables automation method invocation.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### Return Value

Nonzero if the control has been initialized; otherwise 0.

### Remarks

The framework's implementation of `IDispatch::Invoke` calls `IsInvokeAllowed` to determine if a given function (identified by `dispid`) may be invoked. The default behavior for an OLE control is to allow automation methods to be invoked only if the control has been initialized; however, `IsInvokeAllowed` is a virtual function and may be overridden if necessary (for example, when the control is being used as an automation server).

## <a name="ismodified"></a> COleControl::IsModified

Determines if the control's state has been modified.

```
BOOL IsModified();
```

### Return Value

Nonzero if the control's state has been modified since it was last saved; otherwise 0.

### Remarks

The state of a control is modified when a property changes value.

## <a name="isoptimizeddraw"></a> COleControl::IsOptimizedDraw

Determines whether the container supports optimized drawing for the current drawing operation.

```
BOOL IsOptimizedDraw();
```

### Return Value

TRUE if the container supports optimized drawing for the current drawing operation; otherwise FALSE.

### Remarks

If optimized drawing is supported, then the control need not select old objects (pens, brushes, fonts, etc.) into the device context when drawing is finished.

## <a name="issubclassedcontrol"></a> COleControl::IsSubclassedControl

Called by the framework to determine if the control subclasses a Windows control.

```
virtual BOOL IsSubclassedControl();
```

### Return Value

Nonzero if the control is subclassed; otherwise 0.

### Remarks

You must override this function and return TRUE if your OLE control subclasses a Windows control.

## <a name="load"></a> COleControl::Load

Resets any previous data loaded asynchronously and initiates a new loading of the control's asynchronous property.

```cpp
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### Parameters

*strNewPath*<br/>
A pointer to a string containing the path that references the absolute location of the asynchronous control property.

*prop*<br/>
A [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) object implementing an asynchronous control property.

## <a name="lockinplaceactive"></a> COleControl::LockInPlaceActive

Prevents the container from deactivating your control.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### Parameters

*bLock*<br/>
TRUE if the in-place active state of the control is to be locked; FALSE if it is to be unlocked.

### Return Value

Nonzero if the lock was successful; otherwise 0.

### Remarks

Note that every locking of the control must be paired with an unlocking of the control when finished. You should only lock your control for short periods, such as while firing an event.

## <a name="onambientpropertychange"></a> COleControl::OnAmbientPropertyChange

Called by the framework when an ambient property of the container has changed value.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### Parameters

*dispID*<br/>
The dispatch ID of the ambient property that changed, or DISPID_UNKNOWN if multiple properties have changed.

## <a name="onappearancechanged"></a> COleControl::OnAppearanceChanged

Called by the framework when the stock Appearance property value has changed.

```
virtual void OnAppearanceChanged ();
```

### Remarks

Override this function if you want notification after this property changes. The default implementation calls `InvalidateControl`.

## <a name="onbackcolorchanged"></a> COleControl::OnBackColorChanged

Called by the framework when the stock BackColor property value has changed.

```
virtual void OnBackColorChanged();
```

### Remarks

Override this function if you want notification after this property changes. The default implementation calls `InvalidateControl`.

## <a name="onborderstylechanged"></a> COleControl::OnBorderStyleChanged

Called by the framework when the stock BorderStyle property value has changed.

```
virtual void OnBorderStyleChanged();
```

### Remarks

The default implementation calls `InvalidateControl`.

Override this function if you want notification after this property changes.

## <a name="onclick"></a> COleControl::OnClick

Called by the framework when a mouse button has been clicked or the DoClick stock method has been invoked.

```
virtual void OnClick(USHORT iButton);
```

### Parameters

*iButton*<br/>
Index of a mouse button. Can have one of the following values:

- LEFT_BUTTON The left mouse button was clicked.

- MIDDLE_BUTTON The middle mouse button was clicked.

- RIGHT_BUTTON The right mouse button was clicked.

### Remarks

The default implementation calls `COleControl::FireClick`.

Override this member function to modify or extend the default handling.

## <a name="onclose"></a> COleControl::OnClose

Called by the framework when the container has called the control's `IOleControl::Close` function.

```
virtual void OnClose(DWORD dwSaveOption);
```

### Parameters

*dwSaveOption*<br/>
Flag that indicates whether the object should be saved before loading. Valid values are:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### Remarks

By default, `OnClose` saves the control object if it has been modified and *dwSaveOption* is either OLECLOSE_SAVEIFDIRTY or OLECLOSE_PROMPTSAVE.

## <a name="ondoverb"></a> COleControl::OnDoVerb

Called by the framework when the container calls the `IOleObject::DoVerb` member function.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### Parameters

*iVerb*<br/>
The index of the control verb to be invoked.

*lpMsg*<br/>
A pointer to the Windows message that caused the verb to be invoked.

*hWndParent*<br/>
The handle to the parent window of the control. If the execution of the verb creates a window (or windows), *hWndParent* should be used as the parent.

*lpRect*<br/>
A pointer to a RECT structure into which the coordinates of the control, relative to the container, will be copied.

### Return Value

Nonzero if call was successful; otherwise 0.

### Remarks

The default implementation uses the ON_OLEVERB and ON_STDOLEVERB message map entries to determine the proper function to invoke.

Override this function to change the default handling of verb.

## <a name="ondraw"></a> COleControl::OnDraw

Called by the framework to draw the OLE control in the specified bounding rectangle using the specified device context.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### Parameters

*pDC*<br/>
The device context in which the drawing occurs.

*rcBounds*<br/>
The rectangular area of the control, including the border.

*rcInvalid*<br/>
The rectangular area of the control that is invalid.

### Remarks

`OnDraw` is typically called for screen display, passing a screen device context as *pDC*. The *rcBounds* parameter identifies the rectangle in the target device context (relative to its current mapping mode). The *rcInvalid* parameter is the actual rectangle that is invalid. In some cases this will be a smaller area than *rcBounds*.

## <a name="ondrawmetafile"></a> COleControl::OnDrawMetafile

Called by the framework to draw the OLE control in the specified bounding rectangle using the specified metafile device context.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### Parameters

*pDC*<br/>
The device context in which the drawing occurs.

*rcBounds*<br/>
The rectangular area of the control, including the border.

### Remarks

The default implementation calls the [OnDraw](#ondraw) function.

## <a name="onedit"></a> COleControl::OnEdit

Causes the control to be UI activated.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### Parameters

*lpMsg*<br/>
A pointer to the Windows message that invoked the verb.

*hWndParent*<br/>
A handle to the parent window of the control.

*lpRect*<br/>
A pointer to the rectangle used by the control in the container.

### Return Value

Nonzero if the call is successful; otherwise 0.

### Remarks

This has the same effect as invoking the control's OLEIVERB_UIACTIVATE verb.

This function is typically used as the handler function for an ON_OLEVERB message map entry. This makes an "Edit" verb available on the control's "Object" menu. For example:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="onenabledchanged"></a> COleControl::OnEnabledChanged

Called by the framework when the stock Enabled property value has changed.

```
virtual void OnEnabledChanged();
```

### Remarks

Override this function if you want notification after this property changes. The default implementation calls [InvalidateControl](#invalidatecontrol).

## <a name="onenumverbs"></a> COleControl::OnEnumVerbs

Called by the framework when the container calls the `IOleObject::EnumVerbs` member function.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### Parameters

*ppenumOleVerb*<br/>
A pointer to the `IEnumOLEVERB` object that enumerates the control's verbs.

### Return Value

Nonzero if verbs are available; otherwise 0.

### Remarks

The default implementation enumerates the ON_OLEVERB entries in the message map.

Override this function to change the default way of enumerating verbs.

## <a name="oneventadvise"></a> COleControl::OnEventAdvise

Called by the framework when an event handler is connected to or disconnected from an OLE control.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### Parameters

*bAdvise*<br/>
TRUE indicates that an event handler has been connected to the control. FALSE indicates that an event handler has been disconnected from the control.

## <a name="onfontchanged"></a> COleControl::OnFontChanged

Called by the framework when the stock Font property value has changed.

```
virtual void OnFontChanged();
```

### Remarks

The default implementation calls `COleControl::InvalidateControl`. If the control is subclassing a Windows control, the default implementation also sends a WM_SETFONT message to the control's window.

Override this function if you want notification after this property changes.

### Example

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="onforecolorchanged"></a> COleControl::OnForeColorChanged

Called by the framework when the stock ForeColor property value has changed.

```
virtual void OnForeColorChanged();
```

### Remarks

The default implementation calls `InvalidateControl`.

Override this function if you want notification after this property changes.

## <a name="onfreezeevents"></a> COleControl::OnFreezeEvents

Called by the framework after the container calls `IOleControl::FreezeEvents`.

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### Parameters

*bFreeze*<br/>
TRUE if the control's event handling is frozen; otherwise FALSE.

### Remarks

The default implementation does nothing.

Override this function if you want additional behavior when event handling is frozen or unfrozen.

## <a name="ongetcolorset"></a> COleControl::OnGetColorSet

Called by the framework when the container calls the `IViewObject::GetColorSet` member function.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### Parameters

*ptd*<br/>
Points to the target device for which the picture should be rendered. If this value is NULL, the picture should be rendered for a default target device, usually a display device.

*hicTargetDev*<br/>
Specifies the information context on the target device indicated by *ptd*. This parameter can be a device context, but is not one necessarily. If *ptd* is NULL, *hicTargetDev* should also be NULL.

*ppColorSet*<br/>
A pointer to the location into which the set of colors that would be used should be copied. If the function does not return the color set, NULL is returned.

### Return Value

Nonzero if a valid color set is returned; otherwise 0.

### Remarks

The container calls this function to obtain all the colors needed to draw the OLE control. The container can use the color sets obtained in conjunction with the colors it needs to set the overall color palette. The default implementation returns FALSE.

Override this function to do any special processing of this request.

## <a name="ongetcontrolinfo"></a> COleControl::OnGetControlInfo

Called by the framework when the control's container has requested information about the control.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### Parameters

*pControlInfo*<br/>
Pointer to a [CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo) structure to be filled in.

### Remarks

This information consists primarily of a description of the control's mnemonic keys. The default implementation fills *pControlInfo* with default information.

Override this function if your control needs to process mnemonic keys.

## <a name="ongetdisplaystring"></a> COleControl::OnGetDisplayString

Called by the framework to obtain a string that represents the current value of the property identified by *dispid*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### Parameters

*dispid*<br/>
The dispatch ID of a property of the control.

*strValue*<br/>
A reference to a [CString](../../atl-mfc-shared/reference/cstringt-class.md) object through which a string will be returned.

### Return Value

Nonzero if a string has been returned in *strValue;* otherwise 0.

### Remarks

Override this function if your control has a property whose value cannot be directly converted to a string and you want the property's value to be displayed in a container-supplied property browser.

## <a name="ongetinplacemenu"></a> COleControl::OnGetInPlaceMenu

Called by the framework when the control is UI activated to obtain the menu to be merged into the container's existing menu.

```
virtual HMENU OnGetInPlaceMenu();
```

### Return Value

The handle of the control's menu, or NULL if the control has none. The default implementation returns NULL.

### Remarks

For more information on merging OLE resources, see the article [Menus and Resources (OLE)](../../mfc/menus-and-resources-ole.md).

## <a name="ongetnaturalextent"></a> COleControl::OnGetNaturalExtent

Called by the framework in response to a container's `IViewObjectEx::GetNaturalExtent` request.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### Parameters

*dwAspect*<br/>
Specifies how the object is to be represented. Representations include content, an icon, a thumbnail, or a printed document. Valid values are taken from the enumeration [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) or DVASPECT2.

*lindex*<br/>
The portion of the object that is of interest. Currently only -1 is valid.

*ptd*<br/>
Points to the [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) structure defining the target device for which the object's size should be returned.

*hicTargetDev*<br/>
Specifies the information context for the target device indicated by the *ptd* parameter from which the object can extract device metrics and test the device's capabilities. If *ptd* is NULL, the object should ignore the value in the *hicTargetDev* parameter.

*pExtentInfo*<br/>
Points to the `DVEXTENTINFO` structure that specifies sizing data. The `DVEXTENTINFO` structure is:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

The structure member `dwExtentMode` can take one of two values:

- DVEXTENT_CONTENT Inquire how big the control should be to exactly fit content (snap-to-size)

- DVEXTENT_INTEGRAL When resizing, pass proposed size to control

*psizel*<br/>
Points to sizing data returned by control. The returned sizing data is set to -1 for any dimension that was not adjusted.

### Return Value

Nonzero if it successfully returns or adjusts the size; otherwise 0.

### Remarks

Override this function to return the object's display size closest to the proposed size and extent mode in the `DVEXTENTINFO` structure. The default implementation returns FALSE and makes no adjustments to the size.

## <a name="ongetpredefinedstrings"></a> COleControl::OnGetPredefinedStrings

Called by the framework to obtain a set of predefined strings representing the possible values for a property.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### Parameters

*dispid*<br/>
The dispatch ID of a property of the control.

*pStringArray*<br/>
A string array to be filled in with return values.

*pCookieArray*<br/>
A DWORD array to be filled in with return values.

### Return Value

Nonzero if elements have been added to *pStringArray* and *pCookieArray*.

### Remarks

Override this function if your control has a property with a set of possible values that can be represented by strings. For each element added to *pStringArray*, you should add a corresponding "cookie" element to *pCookieArray.* These "cookie" values may later be passed by the framework to the `COleControl::OnGetPredefinedValue` function.

## <a name="ongetpredefinedvalue"></a> COleControl::OnGetPredefinedValue

Called by the framework to obtain the value corresponding to one of the predefined strings previously returned by an override of `COleControl::OnGetPredefinedStrings`.

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### Parameters

*dispid*<br/>
The dispatch ID of a property of the control.

*dwCookie*<br/>
A cookie value previously returned by an override of `COleControl::OnGetPredefinedStrings`.

*lpvarOut*<br/>
Pointer to a `VARIANT` structure through which a property value will be returned.

### Return Value

Nonzero if a value has been returned in *lpvarOut*; otherwise 0.

## <a name="ongetviewextent"></a> COleControl::OnGetViewExtent

Called by the framework in response to a container's [IViewObject2::GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) request.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### Parameters

*dwDrawAspect*<br/>
DWORD describing which form, or aspect, of an object is to be displayed. Valid values are taken from the enumeration [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) or DVASPECT2.

*lindex*<br/>
The portion of the object that is of interest. Currently only -1 is valid.

*ptd*<br/>
Points to the [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) structure defining the target device for which the object's size should be returned.

*lpsizel*<br/>
Points to the location where the object's size is returned.

### Return Value

Nonzero if extent information is successfully returned; otherwise 0.

### Remarks

Override this function if your control uses two-pass drawing, and its opaque and transparent parts have different dimensions.

## <a name="ongetviewrect"></a> COleControl::OnGetViewRect

Called by the framework in response to a container's `IViewObjectEx::GetRect` request.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### Parameters

*dwAspect*<br/>
DWORD describing which form, or aspect, of an object is to be displayed. Valid values are taken from the enumeration [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) or DVASPECT2:

- DVASPECT_CONTENT Bounding rectangle of the whole object. Top-left corner at the object's origin and size equal to the extent returned by `GetViewExtent`*.*

- DVASPECT_OPAQUE Objects with a rectangular opaque region return that rectangle. Others fail.

- DVASPECT_TRANSPARENT Rectangle covering all transparent or irregular parts.

*pRect*<br/>
Points to the [RECTL](/windows/win32/api/windef/ns-windef-rectl) structure specifying the rectangle in which the object should be drawn. This parameter controls the positioning and stretching of the object.

### Return Value

Nonzero if the rectangle sized to the object is successfully returned; otherwise 0.

### Remarks

The object's size is converted by `OnGetViewRect` into a rectangle starting at a specific position (the default is the upper left corner of the display). Override this function if your control uses two-pass drawing, and its opaque and transparent parts have different dimensions.

## <a name="ongetviewstatus"></a> COleControl::OnGetViewStatus

Called by the framework in response to a container's `IViewObjectEx::GetViewStatus` request.

```
virtual DWORD OnGetViewStatus();
```

### Return Value

One of the values of the VIEWSTATUS enumeration if successful; otherwise 0. Possible values are any combination of the following:

|Name|Description|
|-|-|
|VIEWSTATUS_OPAQUE|Object is completely opaque. If this bit is not set, the object contains transparent parts. This bit applies only to content-related aspects and not to DVASPECT_ICON or DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|Object has a solid background (consisting in a solid color, not a brush pattern). This bit is meaningful only if VIEWSTATUS_OPAQUE is set and applies only to content-related aspects and not to DVASPECT_ICON or DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|Object supports DVASPECT_OPAQUE. All IViewObjectEx methods that take a drawing aspect as a parameter can be called with this aspect.|
|VIEWSTATUS_DVASPECTTRANSPARENT|Object supports DVASPECT_TRANSPARENT. All `IViewObjectEx` methods that take a drawing aspect as a parameter can be called with this aspect.|

### Remarks

Override this function if your control uses two-pass drawing. The default implementation returns VIEWSTATUS_OPAQUE.

## <a name="onhidetoolbars"></a> COleControl::OnHideToolBars

Called by the framework when the control is UI deactivated.

```
virtual void OnHideToolBars();
```

### Remarks

The implementation should hide all toolbars displayed by `OnShowToolbars`.

## <a name="oninactivemousemove"></a> COleControl::OnInactiveMouseMove

Called by the container for the inactive object under the mouse pointer on receipt of a WM_MOUSEMOVE message.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### Parameters

*lprcBounds*<br/>
The object bounding rectangle, in client coordinates of the containing window. Tells the object its exact position and size on the screen when the WM_MOUSEMOVE message was received.

*x*<br/>
The x coordinate of the mouse location in client coordinates of the containing window.

*y*<br/>
The y coordinate of the mouse location in client coordinates of the containing window.

*dwKeyState*<br/>
Identifies the current state of the keyboard modifier keys on the keyboard. Valid values can be a combination of any of the flags MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON, and MK_RBUTTON.

### Remarks

Note that window client coordinates (pixels) are used to pass the mouse cursor position. This is made possible by also passing the bounding rectangle of the object in the same coordinate system.

## <a name="oninactivesetcursor"></a> COleControl::OnInactiveSetCursor

Called by the container for the inactive object under the mouse pointer on receipt of a WM_SETCURSOR message.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### Parameters

*lprcBounds*<br/>
The object bounding rectangle, in client coordinates of the containing window. Tells the object its exact position and size on the screen when the WM_SETCURSOR message was received.

*x*<br/>
The x coordinate of the mouse location in client coordinates of the containing window.

*y*<br/>
The y coordinate of the mouse location in client coordinates of the containing window.

*dwMouseMsg*<br/>
The identifier of the mouse message for which a WM_SETCURSOR occurred.

*bSetAlways*<br/>
Specifies whether or not the object must set the cursor. If TRUE, the object must set the cursor; if FALSE, the cursor is not obligated to set the cursor, and should return S_FALSE in that case.

### Return Value

Nonzero if successful; otherwise 0.

### Remarks

Note that window client coordinates (pixels) are used to pass the mouse cursor position. This is made possible by also passing the bounding rectangle of the object in the same coordinate system.

## <a name="onkeydownevent"></a> COleControl::OnKeyDownEvent

Called by the framework after a stock KeyDown event has been processed.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### Parameters

*nChar*<br/>
The virtual key code value of the pressed key. For a list of standard virtual key codes, see Winuser.h

*nShiftState*<br/>
Contains a combination of the following flags:

- SHIFT_MASK The SHIFT key was pressed during the action.

- CTRL_MASK The CTRL key was pressed during the action.

- ALT_MASK The ALT key was pressed during the action.

### Remarks

Override this function if your control needs access to the key information after the event has been fired.

## <a name="onkeypressevent"></a> COleControl::OnKeyPressEvent

Called by the framework after the stock KeyPress event has been fired.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### Parameters

*nChar*<br/>
Contains the virtual key code value of the key pressed. For a list of standard virtual key codes, see Winuser.h

### Remarks

Note that the *nChar* value may have been modified by the container.

Override this function if you want notification after this event occurs.

## <a name="onkeyupevent"></a> COleControl::OnKeyUpEvent

Called by the framework after a stock KeyDown event has been processed.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### Parameters

*nChar*<br/>
The virtual key code value of the pressed key. For a list of standard virtual key codes, see Winuser.h

*nShiftState*<br/>
Contains a combination of the following flags:

- SHIFT_MASK The SHIFT key was pressed during the action.

- CTRL_MASK The CTRL key was pressed during the action.

- ALT_MASK The ALT key was pressed during the action.

### Remarks

Override this function if your control needs access to the key information after the event has been fired.

## <a name="onmappropertytopage"></a> COleControl::OnMapPropertyToPage

Called by the framework to obtain the class ID of a property page that implements editing of the specified property.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### Parameters

*dispid*<br/>
The dispatch ID of a property of the control.

*lpclsid*<br/>
Pointer to a `CLSID` structure through which a class ID will be returned.

*pbPageOptional*<br/>
Returns an indicator of whether use of the specified property page is optional.

### Return Value

Nonzero if a class ID has been returned in *lpclsid*; otherwise 0.

### Remarks

Override this function to provide a way to invoke your control's property pages from the container's property browser.

## <a name="onmnemonic"></a> COleControl::OnMnemonic

Called by the framework when the container has detected that a mnemonic key of the OLE control has been pressed.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### Parameters

*pMsg*<br/>
Pointer to the Windows message generated by a mnemonic key press.

## <a name="onproperties"></a> COleControl::OnProperties

Called by the framework when the control's properties verb has been invoked by the container.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### Parameters

*lpMsg*<br/>
A pointer to the Windows message that invoked the verb.

*hWndParent*<br/>
A handle to the parent window of the control.

*lpRect*<br/>
A pointer to the rectangle used by the control in the container.

### Return Value

Nonzero if the call is successful; otherwise 0.

### Remarks

The default implementation displays a modal property dialog box.

You can also use this function to cause the display of your control's property pages. Make a call to the `OnProperties` function, passing the handle of your control's parent in the *hWndParent* parameter. In this case, the values of the *lpMsg* and *lpRect* parameters are ignored.

## <a name="onqueryhitpoint"></a> COleControl::OnQueryHitPoint

Called by the framework in response to a container's `IViewObjectEx::QueryHitPoint` request.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### Parameters

*dwAspect*<br/>
Specifies how the object is represented. Valid values are taken from the enumeration [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) or DVASPECT2.

*pRectBounds*<br/>
Pointer to a `RECT` structure specifying the bounding rectangle of the OLE control client area.

*ptlLoc*<br/>
Pointer to the `POINT` structure specifying the point to be checked for a hit. The point is specified in OLE client area coordinates.

*lCloseHint*<br/>
The distance that defines "close" to the point checked for a hit.

*pHitResult*<br/>
Pointer to the result of the hit query. One of the following values:

- HITRESULT_OUTSIDE *ptlLoc* is outside the OLE object and not close.

- HITRESULT_TRANSPARENT *ptlLoc* is within the bounds of the OLE object, but not close to the image. For example, a point in the middle of a transparent circle could be HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* is inside or outside the OLE object but close enough to the object to be considered inside. Small, thin, or detailed objects may use this value. Even if a point is outside the bounding rectangle of an object it may still be close (this is needed for hitting small objects).

- HITRESULT_HIT *ptlLoc* is within the image of the object.

### Return Value

Nonzero if a hit result is successfully returned; otherwise 0. A hit is an overlap with the OLE control display area.

### Remarks

Queries whether an object's display rectangle overlaps the given point (hits the point). `QueryHitPoint` can be overridden to test hits for non-rectangular objects.

## <a name="onqueryhitrect"></a> COleControl::OnQueryHitRect

Called by the framework in response to a container's `IViewObjectEx::QueryHitRect` request.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### Parameters

*dwAspect*<br/>
Specifies how the object is to be represented. Valid values are taken from the enumeration [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) or DVASPECT2.

*pRectBounds*<br/>
Pointer to a `RECT` structure specifying the bounding rectangle of the OLE control client area.

*prcLoc*<br/>
Pointer to the `RECT` structure specifying the rectangle to be checked for a hit (overlap with the object rectangle), relative to the upper left corner of the object.

*lCloseHint*<br/>
Not used.

*pHitResult*<br/>
Pointer to the result of the hit query. One of the following values:

- HITRESULT_OUTSIDE no point in the rectangle is hit by the OLE object.

- HITRESULT_HIT at least one point in the rectangle would be a hit on the object.

### Return Value

Nonzero if a hit result is successfully returned; otherwise 0.

### Remarks

Queries whether an object's display rectangle overlaps any point in the given rectangle (hits the rectangle). `QueryHitRect` can be overridden to test hits for non-rectangular objects.

## <a name="onrenderdata"></a> COleControl::OnRenderData

Called by the framework to retrieve data in the specified format.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### Parameters

*lpFormatEtc*<br/>
Points to the [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) structure specifying the format in which information is requested.

*lpStgMedium*<br/>
Points to a [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure in which the data is to be returned.

### Return Value

Nonzero if successful; otherwise 0.

### Remarks

The specified format is one previously placed in the control object using the [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) or [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) member functions for delayed rendering. The default implementation of this function calls `OnRenderFileData` or `OnRenderGlobalData`, respectively, if the supplied storage medium is either a file or memory. If the requested format is CF_METAFILEPICT or the persistent property set format, the default implementation renders the appropriate data and returns nonzero. Otherwise, it returns 0 and does nothing.

If *lpStgMedium->tymed* is TYMED_NULL, the STGMEDIUM should be allocated and filled as specified by *lpFormatEtc->tymed*. If not TYMED_NULL, the STGMEDIUM should be filled in place with the data.

Override this function to provide your data in the requested format and medium. Depending on your data, you may want to override one of the other versions of this function instead. If your data is small and fixed in size, override `OnRenderGlobalData`. If your data is in a file, or is of variable size, override `OnRenderFileData`.

For more information, see the `FORMATETC` and `STGMEDIUM` structures in the Windows SDK.

## <a name="onrenderfiledata"></a> COleControl::OnRenderFileData

Called by the framework to retrieve data in the specified format when the storage medium is a file.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### Parameters

*lpFormatEtc*<br/>
Points to the [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) structure specifying the format in which information is requested.

*pFile*<br/>
Points to a [CFile](../../mfc/reference/cfile-class.md) object in which the data is to be rendered.

### Return Value

Nonzero if successful; otherwise 0.

### Remarks

The specified format is one previously placed in the control object using the [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) member function for delayed rendering. The default implementation of this function simply returns FALSE.

Override this function to provide your data in the requested format and medium. Depending on your data, you might want to override one of the other versions of this function instead. If you want to handle multiple storage mediums, override `OnRenderData`. If your data is in a file, or is of variable size, override `OnRenderFileData`.

For more information, see the `FORMATETC` structure in the Windows SDK.

## <a name="onrenderglobaldata"></a> COleControl::OnRenderGlobalData

Called by the framework to retrieve data in the specified format when the specified storage medium is global memory.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### Parameters

*lpFormatEtc*<br/>
Points to the [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) structure specifying the format in which information is requested.

*phGlobal*<br/>
Points to a handle to global memory in which the data is to be returned. If no memory has been allocated, this parameter can be NULL.

### Return Value

Nonzero if successful; otherwise 0.

### Remarks

The specified format is one previously placed in the control object using the [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) member function for delayed rendering. The default implementation of this function simply returns FALSE.

If *phGlobal* is NULL, then a new HGLOBAL should be allocated and returned in *phGlobal*. Otherwise, the HGLOBAL specified by *phGlobal* should be filled with the data. The amount of data placed in the HGLOBAL must not exceed the current size of the memory block. Also, the block cannot be reallocated to a larger size.

Override this function to provide your data in the requested format and medium. Depending on your data, you may want to override one of the other versions of this function instead. If you want to handle multiple storage mediums, override `OnRenderData`. If your data is in a file, or is of variable size, override `OnRenderFileData`.

For more information, see the `FORMATETC` structure in the Windows SDK.

## <a name="onresetstate"></a> COleControl::OnResetState

Called by the framework when the control's properties should be set to their default values.

```
virtual void OnResetState();
```

### Remarks

The default implementation calls [DoPropExchange](#dopropexchange), passing a `CPropExchange` object that causes properties to be set to their default values.

The control writer can insert initialization code for the OLE control in this overridable. This function is called when [IPersistStream::Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) or [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) fails, or [IPersistStreamInit::InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) or [IPersistStorage::InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) is called, without first calling either `IPersistStream::Load` or `IPersistStorage::Load`.

## <a name="onsetclientsite"></a> COleControl::OnSetClientSite

Called by the framework when the container has called the control's `IOleControl::SetClientSite` function.

```
virtual void OnSetClientSite();
```

### Remarks

By default, `OnSetClientSite` checks whether data path properties are loaded and, if they are, calls `DoDataPathPropExchange`.

Override this function to do any special processing of this notification. In particular, overrides of this function should call the base class.

## <a name="onsetdata"></a> COleControl::OnSetData

Called by the framework to replace the control's data with the specified data.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### Parameters

*lpFormatEtc*<br/>
Pointer to a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) structure specifying the format of the data.

*lpStgMedium*<br/>
Pointer to a [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure in which the data resides.

*bRelease*<br/>
TRUE if the control should free the storage medium; FALSE if the control should not free the storage medium.

### Return Value

Nonzero if successful; otherwise 0.

### Remarks

If the data is in the persistent property set format, the default implementation modifies the control's state accordingly. Otherwise, the default implementation does nothing. If *bRelease* is TRUE, then a call to `ReleaseStgMedium` is made; otherwise not.

Override this function to replace the control's data with the specified data.

For more information, see the `FORMATETC` and `STGMEDIUM` structures in the Windows SDK.

## <a name="onsetextent"></a> COleControl::OnSetExtent

Called by the framework when the control's extent needs to be changed, as a result of a call to [IOleObject::SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### Parameters

*lpSizeL*<br/>
A pointer to the `SIZEL` structure that uses long integers to represent the width and height of the control, expressed in HIMETRIC units.

### Return Value

Nonzero if the size change was accepted; otherwise 0.

### Remarks

The default implementation handles the resizing of the control's extent. If the control is in-place active, a call to the container's `OnPosRectChanged` is then made.

Override this function to alter the default resizing of your control.

## <a name="onsetobjectrects"></a> COleControl::OnSetObjectRects

Called by the framework to implement a call to [IOleInPlaceObject::SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### Parameters

*lpRectPos*<br/>
A pointer to a `RECT` structure indicating the control's new position and size relative to the container.

*lpRectClip*<br/>
A pointer to a `RECT` structure indicating a rectangular area to which the control is to be clipped.

### Return Value

Nonzero if the repositioning was accepted; otherwise 0.

### Remarks

The default implementation automatically handles the repositioning and resizing of the control window and returns TRUE.

Override this function to alter the default behavior of this function.

## <a name="onshowtoolbars"></a> COleControl::OnShowToolBars

Called by the framework when the control has been UI activated.

```
virtual void OnShowToolBars();
```

### Remarks

The default implementation does nothing.

## <a name="ontextchanged"></a> COleControl::OnTextChanged

Called by the framework when the stock Caption or Text property value has changed.

```
virtual void OnTextChanged();
```

### Remarks

The default implementation calls `InvalidateControl`.

Override this function if you want notification after this property changes.

## <a name="onwindowlessmessage"></a> COleControl::OnWindowlessMessage

Called by the framework in response to a container's `IOleInPlaceObjectWindowless::OnWindowMessage` request.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### Parameters

*msg*<br/>
Message identifier as passed by Windows.

*wParam*<br/>
As passed by Windows. Specifies additional message-specific information. The contents of this parameter depend on the value of the *msg* parameter.

*lParam*<br/>
As passed by Windows. Specifies additional message-specific information. The contents of this parameter depend on the value of the *msg* parameter.

*plResult*<br/>
Windows result code. Specifies the result of the message processing and depends on the message sent.

### Return Value

Nonzero if successful; otherwise 0.

### Remarks

Processes window messages for windowless controls. `COleControl`'s `OnWindowlessMessage` should be used for window messages other than mouse messages and keyboard messages. `COleControl` provides [SetCapture](#setcapture) and [SetFocus](#setfocus) specifically to get mouse capture and keyboard focus for windowless OLE objects.

Because windowless objects do not have a window, they need a mechanism to let the container dispatch messages to them. A windowless OLE object gets messages from its container, through the `OnWindowMessage` method on the `IOleInPlaceObjectWindowless` interface (an extension of [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) for windowless support). `OnWindowMessage` does not take an `HWND` parameter.

## <a name="parenttoclient"></a> COleControl::ParentToClient

Translates the coordinates of *pPoint* into client coordinates.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### Parameters

*lprcBounds*<br/>
Pointer to the bounds of the OLE control within the container. Not the client area but the area of the entire control including borders and scroll bars.

*pPoint*<br/>
Pointer to the parent (container) point to be translated into the coordinates of the client area of the control.

*bHitTest*<br/>
Specifies whether or not hit testing is to be done on the point.

### Return Value

If *bHitTest* is FALSE, returns HTNOWHERE. If *bHitTest* is TRUE, returns the location in which the parent (container) point landed in the client area of the OLE control and is one of the following mouse hit-test values:

- HTBORDER In the border of a window that does not have a sizing border.

- HTBOTTOM In the lower horizontal border of the window.

- HTBOTTOMLEFT In the lower-left corner of the window border.

- HTBOTTOMRIGHT In the lower-right corner of the window border.

- HTCAPTION In a title-bar area.

- HTCLIENT In a client area.

- HTERROR On the screen background or on a dividing line between windows (same as HTNOWHERE except that the `DefWndProc` Windows function produces a system beep to indicate an error).

- HTGROWBOX In a size box.

- HTHSCROLL In the horizontal scroll bar.

- HTLEFT In the left border of the window.

- HTMAXBUTTON In a Maximize button.

- HTMENU In a menu area.

- HTMINBUTTON In a Minimize button.

- HTNOWHERE On the screen background or on a dividing line between windows.

- HTREDUCE In a Minimize button.

- HTRIGHT In the right border of the window.

- HTSIZE In a size box (same as HTGROWBOX).

- HTSYSMENU In a Control menu or in a Close button in a child window.

- HTTOP In the upper horizontal border of the window.

- HTTOPLEFT In the upper-left corner of the window border.

- HTTOPRIGHT In the upper-right corner of the window border.

- HTTRANSPARENT In a window currently covered by another window.

- HTVSCROLL In the vertical scroll bar.

- HTZOOM In a Maximize button.

### Remarks

On input *pPoint* is relative to the origin of the parent (upper left corner of the container). On output *pPoint* is relative to the origin of the client area of the OLE control (upper left corner of the client area of the control).

## <a name="postmodaldialog"></a> COleControl::PostModalDialog

Notifies the container that a modal dialog box has been closed.

```cpp
void PostModalDialog(HWND hWndParent = NULL);
```

### Parameters

*hWndParent*<br/>
Handle to the parent window of the modal dialog box.

### Remarks

Call this function after displaying any modal dialog box. You must call this function so that the container can enable any top-level windows disabled by `PreModalDialog`. This function should be paired with a call to `PreModalDialog`.

## <a name="premodaldialog"></a> COleControl::PreModalDialog

Notifies the container that a modal dialog box is about to be displayed.

```cpp
void PreModalDialog(HWND hWndParent = NULL);
```

### Parameters

*hWndParent*<br/>
Handle to the parent window of the modal dialog box.

### Remarks

Call this function before displaying any modal dialog box. You must call this function so that the container can disable all its top-level windows. After the modal dialog box has been displayed, you must then call `PostModalDialog`.

## <a name="recreatecontrolwindow"></a> COleControl::RecreateControlWindow

Destroys and re-creates the control's window.

```cpp
void RecreateControlWindow();
```

### Remarks

This may be necessary if you need to change the window's style bits.

## <a name="refresh"></a> COleControl::Refresh

Forces a repaint of the OLE control.

```cpp
void Refresh();
```

### Remarks

This function is supported by the `COleControl` base class as a stock method, called Refresh. This allows users of your OLE control to repaint the control at a specific time. For more information on this method, see the article [ActiveX Controls: Methods](../../mfc/mfc-activex-controls-methods.md).

## <a name="releasecapture"></a> COleControl::ReleaseCapture

Releases mouse capture.

```
BOOL ReleaseCapture();
```

### Return Value

Nonzero if successful; otherwise 0.

### Remarks

If the control currently has the mouse capture, the capture is released. Otherwise, this function has no effect.

## <a name="releasedc"></a> COleControl::ReleaseDC

Releases the display device context of a container of a windowless control, freeing the device context for use by other applications.

```
int ReleaseDC(CDC* pDC);
```

### Parameters

*pDC*<br/>
Identifies the container device context to be released.

### Return Value

Nonzero if successful; otherwise 0.

### Remarks

The application must call `ReleaseDC` for each call to [GetDC](#getdc).

## <a name="reparentcontrolwindow"></a> COleControl::ReparentControlWindow

Sets the parent of the control.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### Parameters

*hWndOuter*<br/>
The handle of the control window.

*hWndParent*<br/>
The handle of the new parent window.

### Remarks

Call this function to reset the parent of the control window.

## <a name="resetstockprops"></a> COleControl::ResetStockProps

Initializes the state of the `COleControl` stock properties to their default values.

```cpp
void ResetStockProps();
```

### Remarks

The properties are: Appearance, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor, hWnd, and Text. For a description of stock properties, see [ActiveX Controls: Adding Stock Properties](../../mfc/mfc-activex-controls-adding-stock-properties.md).

You can improve a control's binary initialization performance by using `ResetStockProps` and `ResetVersion` to override `COleControl::OnResetState`. See the example below. For further information on optimizing initialization, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

### Example

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="resetversion"></a> COleControl::ResetVersion

Initializes the version number to specified value.

```cpp
void ResetVersion(DWORD dwVersionDefault);
```

### Parameters

*dwVersionDefault*<br/>
The version number to be assigned to the control.

### Remarks

You can improve a control's binary initialization performance by using `ResetVersion` and `ResetStockProps` to override `COleControl::OnResetState`. See the example at [ResetStockProps](#resetstockprops). For further information on optimizing initialization, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="scrollwindow"></a> COleControl::ScrollWindow

Allows a windowless OLE object to scroll an area within its in-place active image on the screen.

```cpp
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### Parameters

*xAmount*<br/>
Specifies the amount, in device units, of horizontal scrolling. This parameter must be a negative value to scroll to the left.

*yAmount*<br/>
Specifies the amount, in device units, of vertical scrolling. This parameter must be a negative value to scroll upward.

*lpRect*<br/>
Points to a [CRect](../../atl-mfc-shared/reference/crect-class.md) object or RECT structure that specifies the portion of the OLE object's client area to scroll, in client coordinates of the containing window. If *lpRect* is NULL, the entire OLE object's client area is scrolled.

*lpClipRect*<br/>
Points to a `CRect` object or `RECT` structure that specifies the rectangle to clip to. Only pixels inside the rectangle are scrolled. Bits outside the rectangle are not affected even if they are in the *lpRect* rectangle. If *lpClipRect* is NULL, no clipping is performed on the scroll rectangle.

## <a name="selectfontobject"></a> COleControl::SelectFontObject

Selects a font into a device context.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### Parameters

*pDC*<br/>
Pointer to a device context object.

*fontHolder*<br/>
Reference to the [CFontHolder](../../mfc/reference/cfontholder-class.md) object representing the font to be selected.

### Return Value

A pointer to the previously selected font. When the caller has finished all drawing operations that use *fontHolder,* it should reselect the previously selected font by passing it as a parameter to [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject).

## <a name="selectstockfont"></a> COleControl::SelectStockFont

Selects the stock Font property into a device context.

```
CFont* SelectStockFont(CDC* pDC);
```

### Parameters

*pDC*<br/>
The device context into which the font will be selected.

### Return Value

A pointer to the previously selected `CFont` object. You should use [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject) to select this font back into the device context when you are finished.

## <a name="serializeextent"></a> COleControl::SerializeExtent

Serializes or initializes the state of the display space allotted to the control.

```cpp
void SerializeExtent(CArchive& ar);
```

### Parameters

*ar*<br/>
A `CArchive` object to serialize to or from.

### Remarks

You can improve a control's binary persistence performance by using `SerializeExtent`, `SerializeStockProps`, and `SerializeVersion` to override `COleControl::Serialize`. See the example below. For further information on optimizing initialization, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

### Example

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="serializestockprops"></a> COleControl::SerializeStockProps

Serializes or initializes the state of the `COleControl` stock properties: Appearance, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor, and Text.

```cpp
void SerializeStockProps(CArchive& ar);
```

### Parameters

*ar*<br/>
A `CArchive` object to serialize to or from.

### Remarks

For a description of stock properties, see [ActiveX Controls: Adding Stock Properties](../../mfc/mfc-activex-controls-adding-stock-properties.md).

You can improve a control's binary persistence performance by using `SerializeStockProps`, `SerializeExtent`, and `SerializeVersion` to override `COleControl::Serialize`. For an example, see the code at [SerializeExtent](#serializeextent). For further information on optimizing initialization, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="serializeversion"></a> COleControl::SerializeVersion

Serializes or initializes the state of a control's version information.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### Parameters

*ar*<br/>
A `CArchive` object to serialize to or from.

*dwVersionDefault*<br/>
The current version number of the control.

*bConvert*<br/>
Indicates whether persistent data should be converted to the latest format when it is saved, or maintained in the same format it had when it was loaded.

### Return Value

The version number of the control. If the specified archive is loading, `SerializeVersion` returns the version loaded from that archive. Otherwise, it returns the currently loaded version.

### Remarks

You can improve a control's binary persistence performance by using `SerializeVersion`, `SerializeExtent`, and `SerializeStockProps` to override `COleControl::Serialize`. For an example, see the code at [SerializeExtent](#serializeextent). For further information on optimizing initialization, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="setappearance"></a> COleControl::SetAppearance

Sets the stock Appearance property value of your control.

```cpp
void SetAppearance (short sAppearance);
```

### Parameters

*sAppearance*<br/>
A **`short`** (VT_I2) value to be used for the appearance of your control. A value of zero sets the control's appearance to flat and a value of 1 sets the control's appearance to 3D.

### Remarks

For more about stock properties, see [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md).

## <a name="setbackcolor"></a> COleControl::SetBackColor

Sets the stock BackColor property value of your control.

```cpp
void SetBackColor(OLE_COLOR dwBackColor);
```

### Parameters

*dwBackColor*<br/>
An OLE_COLOR value to be used for background drawing of your control.

### Remarks

For more information on using this property and other related properties, see the article [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md).

## <a name="setborderstyle"></a> COleControl::SetBorderStyle

Sets the stock BorderStyle property value of your control.

```cpp
void SetBorderStyle(short sBorderStyle);
```

### Parameters

*sBorderStyle*<br/>
The new border style for the control; 0 indicates no border and 1 indicates a normal border.

### Remarks

The control window will then be re-created and `OnBorderStyleChanged` called.

## <a name="setcapture"></a> COleControl::SetCapture

Causes the control's container window to take possession of the mouse capture on the control's behalf.

```
CWnd* SetCapture();
```

### Return Value

A pointer to the `CWnd` window object that previously received mouse input.

### Remarks

If the control is activated and windowless, this function causes the control's container window to take possession of the mouse capture, on the control's behalf. Otherwise, this function causes the control itself to take possession of the mouse capture (same as `CWnd::SetCapture`).

## <a name="setcontrolsize"></a> COleControl::SetControlSize

Sets the size of the OLE control window and notifies the container that the control site is changing.

```
BOOL SetControlSize(int cx, int cy);
```

### Parameters

*cx*<br/>
Specifies the new width of the control in pixels.

*cy*<br/>
Specifies the new height of the control in pixels.

### Return Value

Nonzero if the call was successful; otherwise 0.

### Remarks

This function should not be used in your control's constructor.

Note that all coordinates for control windows are relative to the upper-left corner of the control.

## <a name="setenabled"></a> COleControl::SetEnabled

Sets the stock Enabled property value of your control.

```cpp
void SetEnabled(BOOL bEnabled);
```

### Parameters

*bEnabled*<br/>
TRUE if the control is to be enabled; otherwise FALSE.

### Remarks

After setting this property, `OnEnabledChange` is called.

## <a name="setfocus"></a> COleControl::SetFocus

Causes the control's container window to take possession of the input focus on the control's behalf.

```
CWnd* SetFocus();
```

### Return Value

A pointer to the `CWnd` window object that previously had the input focus, or NULL if there is no such window.

### Remarks

If the control is activated and windowless, this function causes the control's container window to take possession of the input focus, on the control's behalf. The input focus directs keyboard input to the container's window, and the container dispatches all subsequent keyboard messages to the OLE object that calls `SetFocus`. Any window that previously had the input focus loses it.

If the control is not windowless, this function causes the control itself to take possession of the input focus (same as `CWnd::SetFocus`).

## <a name="setfont"></a> COleControl::SetFont

Sets the stock Font property of your control.

```cpp
void SetFont(LPFONTDISP pFontDisp);
```

### Parameters

*pFontDisp*<br/>
A pointer to a Font dispatch interface.

## <a name="setforecolor"></a> COleControl::SetForeColor

Sets the stock ForeColor property value of your control.

```cpp
void SetForeColor(OLE_COLOR dwForeColor);
```

### Parameters

*dwForeColor*<br/>
An OLE_COLOR value to be used for foreground drawing of your control.

### Remarks

For more information on using this property and other related properties, see the article [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md).

## <a name="setinitialdataformats"></a> COleControl::SetInitialDataFormats

Called by the framework to initialize the list of data formats supported by the control.

```
virtual void SetInitialDataFormats();
```

### Remarks

The default implementation specifies two formats: CF_METAFILEPICT and the persistent property set.

## <a name="setinitialsize"></a> COleControl::SetInitialSize

Sets the size of an OLE control when first displayed in a container.

```cpp
void SetInitialSize(
    int cx,
    int cy);
```

### Parameters

*cx*<br/>
The initial width of the OLE control in pixels.

*cy*<br/>
The initial height of the OLE control in pixels.

### Remarks

Call this function in your constructor to set the initial size of your control. The initial size is measured in device units, or pixels. It is recommended that this call be made in your control's constructor.

## <a name="setmodifiedflag"></a> COleControl::SetModifiedFlag

Changes the modified state of a control.

```cpp
void SetModifiedFlag(BOOL bModified = TRUE);
```

### Parameters

*bModified*<br/>
The new value for the control's modified flag. TRUE indicates that the control's state has been modified; FALSE indicates that the control's state has just been saved.

### Remarks

Call this function whenever a change occurs that would affect your control's persistent state. For example, if the value of a persistent property changes, call this function with *bModified* **TRUE**.

## <a name="setnotpermitted"></a> COleControl::SetNotPermitted

Indicates that an edit request has failed.

```cpp
void SetNotPermitted();
```

### Remarks

Call this function when `BoundPropertyRequestEdit` fails. This function throws an exception of type `COleDispScodeException` to indicate that the set operation was not permitted.

## <a name="setnotsupported"></a> COleControl::SetNotSupported

Prevents modification to a control's property value by the user.

```cpp
void SetNotSupported();
```

### Remarks

Call this function in place of the Set function of any property where modification of the property value by the control's user is not supported. One example would be a property that is read only.

## <a name="setrectincontainer"></a> COleControl::SetRectInContainer

Sets the coordinates of the control's rectangle relative to the container, expressed in device units.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### Parameters

*lpRect*<br/>
A pointer to a rectangle containing the control's new coordinates relative to the container.

### Return Value

Nonzero if the call was successful; otherwise 0.

### Remarks

If the control is open, it is resized; otherwise the container's `OnPosRectChanged` function is called.

## <a name="settext"></a> COleControl::SetText

Sets the value of your control's stock Caption or Text property.

```cpp
void SetText(LPCTSTR pszText);
```

### Parameters

*pszText*<br/>
A pointer to a character string.

### Remarks

Note that the stock Caption and Text properties are both mapped to the same value. This means that any changes made to either property will automatically change both properties. In general, a control should support either the stock Caption or Text property, but not both.

## <a name="throwerror"></a> COleControl::ThrowError

Signals the occurrence of an error in your control.

```cpp
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### Parameters

*sc*<br/>
The status code value to be reported. For a complete list of possible codes, see the article [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
The string resource ID of the exception to be reported.

*nHelpID*<br/>
The help ID of the topic to be reported on.

*pszDescription*<br/>
A string containing an explanation of the exception to be reported.

### Remarks

This function should only be called from within a Get or Set function for an OLE property, or the implementation of an OLE automation method. If you need to signal errors that occur at other times, you should fire the stock Error event.

## <a name="transformcoords"></a> COleControl::TransformCoords

Transforms coordinate values between HIMETRIC units and the container's native units.

```cpp
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### Parameters

*lpptlHimetric*<br/>
Pointer to a `POINTL` structure containing coordinates in HIMETRIC units.

*lpptfContainer*<br/>
Pointer to a `POINTF` structure containing coordinates in the container's unit size.

*flags*<br/>
A combination of the following values:

- XFORMCOORDS_POSITION A position in the container.

- XFORMCOORDS_SIZE A size in the container.

- XFORMCOORDS_HIMETRICTOCONTAINER Transform HIMETRIC units to the container's units.

- XFORMCOORDS_CONTAINERTOHIMETRIC Transform the container's units to HIMETRIC units.

### Remarks

The first two flags, XFORMCOORDS_POSITION and XFORMCOORDS_SIZE, indicate whether the coordinates should be treated as a position or a size. The remaining two flags indicate the direction of transformation.

## <a name="translatecolor"></a> COleControl::TranslateColor

Converts a color value from the OLE_COLOR data type to the [COLORREF](/windows/win32/gdi/colorref) data type.

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### Parameters

*clrColor*<br/>
A OLE_COLOR data type. For more information, see the Windows [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor) function.

*hpal*<br/>
A handle to an optional palette; can be NULL.

### Return Value

An RGB (red, green, blue) 32-bit color value that defines the solid color closest to the *clrColor* value that the device can represent.

### Remarks

This function is useful to translate the stock ForeColor and BackColor properties to COLORREF types used by [CDC](../../mfc/reference/cdc-class.md) member functions.

## <a name="willambientsbevalidduringload"></a> COleControl::WillAmbientsBeValidDuringLoad

Determines whether your control should use the values of ambient properties as default values, when it is subsequently loaded from its persistent state.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### Return Value

Nonzero indicates that ambient properties will be valid; otherwise ambient properties will not be valid.

### Remarks

In some containers, your control may not have access to its ambient properties during the initial call to the override of `COleControl::DoPropExchange`. This is the case if the container calls [IPersistStreamInit::Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) or [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) prior to calling [IOleObject::SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) (that is, if it does not honor the OLEMISC_SETCLIENTSITEFIRST status bit).

## <a name="windowproc"></a> COleControl::WindowProc

Provides a Windows procedure for a `COleControl` object.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### Parameters

*message*<br/>
Specifies the Windows message to be processed.

*wParam*<br/>
Provides additional information used in processing the message. The parameter value depends on the message.

*lParam*<br/>
Provides additional information used in processing the message. The parameter value depends on the message.

### Return Value

The return value of the message dispatched.

### Remarks

Call this function to dispatch specific messages through the control's message map.

## See also

[MFC Sample CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC Sample TESTHELP](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage Class](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd Class](../../mfc/reference/cwnd-class.md)<br/>
[Hierarchy Chart](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder Class](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder Class](../../mfc/reference/cpictureholder-class.md)<br/>

---
description: "Learn more about: CHtmlView Class"
title: "CHtmlView Class"
ms.date: "11/04/2016"
f1_keywords: ["CHtmlView", "AFXHTML/CHtmlView", "AFXHTML/CHtmlView::Create", "AFXHTML/CHtmlView::CreateControlSite", "AFXHTML/CHtmlView::ExecFormsCommand", "AFXHTML/CHtmlView::ExecWB", "AFXHTML/CHtmlView::GetAddressBar", "AFXHTML/CHtmlView::GetApplication", "AFXHTML/CHtmlView::GetBusy", "AFXHTML/CHtmlView::GetContainer", "AFXHTML/CHtmlView::GetFullName", "AFXHTML/CHtmlView::GetFullScreen", "AFXHTML/CHtmlView::GetHeight", "AFXHTML/CHtmlView::GetHtmlDocument", "AFXHTML/CHtmlView::GetLeft", "AFXHTML/CHtmlView::GetLocationName", "AFXHTML/CHtmlView::GetLocationURL", "AFXHTML/CHtmlView::GetMenuBar", "AFXHTML/CHtmlView::GetOffline", "AFXHTML/CHtmlView::GetParentBrowser", "AFXHTML/CHtmlView::GetProperty", "AFXHTML/CHtmlView::GetReadyState", "AFXHTML/CHtmlView::GetRegisterAsBrowser", "AFXHTML/CHtmlView::GetRegisterAsDropTarget", "AFXHTML/CHtmlView::GetSilent", "AFXHTML/CHtmlView::GetSource", "AFXHTML/CHtmlView::GetStatusBar", "AFXHTML/CHtmlView::GetTheaterMode", "AFXHTML/CHtmlView::GetToolBar", "AFXHTML/CHtmlView::GetTop", "AFXHTML/CHtmlView::GetTopLevelContainer", "AFXHTML/CHtmlView::GetType", "AFXHTML/CHtmlView::GetVisible", "AFXHTML/CHtmlView::GetWidth", "AFXHTML/CHtmlView::GoBack", "AFXHTML/CHtmlView::GoForward", "AFXHTML/CHtmlView::GoHome", "AFXHTML/CHtmlView::GoSearch", "AFXHTML/CHtmlView::LoadFromResource", "AFXHTML/CHtmlView::Navigate", "AFXHTML/CHtmlView::Navigate2", "AFXHTML/CHtmlView::OnBeforeNavigate2", "AFXHTML/CHtmlView::OnCommandStateChange", "AFXHTML/CHtmlView::OnDocumentComplete", "AFXHTML/CHtmlView::OnDocWindowActivate", "AFXHTML/CHtmlView::OnDownloadBegin", "AFXHTML/CHtmlView::OnDownloadComplete", "AFXHTML/CHtmlView::OnEnableModeless", "AFXHTML/CHtmlView::OnFilterDataObject", "AFXHTML/CHtmlView::OnFrameWindowActivate", "AFXHTML/CHtmlView::OnFullScreen", "AFXHTML/CHtmlView::OnGetDropTarget", "AFXHTML/CHtmlView::OnGetExternal", "AFXHTML/CHtmlView::OnGetHostInfo", "AFXHTML/CHtmlView::OnGetOptionKeyPath", "AFXHTML/CHtmlView::OnHideUI", "AFXHTML/CHtmlView::OnMenuBar", "AFXHTML/CHtmlView::OnNavigateComplete2", "AFXHTML/CHtmlView::OnNavigateError", "AFXHTML/CHtmlView::OnNewWindow2", "AFXHTML/CHtmlView::OnProgressChange", "AFXHTML/CHtmlView::OnPropertyChange", "AFXHTML/CHtmlView::OnQuit", "AFXHTML/CHtmlView::OnResizeBorder", "AFXHTML/CHtmlView::OnShowContextMenu", "AFXHTML/CHtmlView::OnShowUI", "AFXHTML/CHtmlView::OnStatusBar", "AFXHTML/CHtmlView::OnStatusTextChange", "AFXHTML/CHtmlView::OnTheaterMode", "AFXHTML/CHtmlView::OnTitleChange", "AFXHTML/CHtmlView::OnToolBar", "AFXHTML/CHtmlView::OnTranslateAccelerator", "AFXHTML/CHtmlView::OnTranslateUrl", "AFXHTML/CHtmlView::OnUpdateUI", "AFXHTML/CHtmlView::OnVisible", "AFXHTML/CHtmlView::PutProperty", "AFXHTML/CHtmlView::QueryFormsCommand", "AFXHTML/CHtmlView::QueryStatusWB", "AFXHTML/CHtmlView::Refresh", "AFXHTML/CHtmlView::Refresh2", "AFXHTML/CHtmlView::SetAddressBar", "AFXHTML/CHtmlView::SetFullScreen", "AFXHTML/CHtmlView::SetHeight", "AFXHTML/CHtmlView::SetLeft", "AFXHTML/CHtmlView::SetMenuBar", "AFXHTML/CHtmlView::SetOffline", "AFXHTML/CHtmlView::SetRegisterAsBrowser", "AFXHTML/CHtmlView::SetRegisterAsDropTarget", "AFXHTML/CHtmlView::SetSilent", "AFXHTML/CHtmlView::SetStatusBar", "AFXHTML/CHtmlView::SetTheaterMode", "AFXHTML/CHtmlView::SetToolBar", "AFXHTML/CHtmlView::SetTop", "AFXHTML/CHtmlView::SetVisible", "AFXHTML/CHtmlView::SetWidth", "AFXHTML/CHtmlView::Stop"]
helpviewer_keywords: ["CHtmlView [MFC], Create", "CHtmlView [MFC], CreateControlSite", "CHtmlView [MFC], ExecFormsCommand", "CHtmlView [MFC], ExecWB", "CHtmlView [MFC], GetAddressBar", "CHtmlView [MFC], GetApplication", "CHtmlView [MFC], GetBusy", "CHtmlView [MFC], GetContainer", "CHtmlView [MFC], GetFullName", "CHtmlView [MFC], GetFullScreen", "CHtmlView [MFC], GetHeight", "CHtmlView [MFC], GetHtmlDocument", "CHtmlView [MFC], GetLeft", "CHtmlView [MFC], GetLocationName", "CHtmlView [MFC], GetLocationURL", "CHtmlView [MFC], GetMenuBar", "CHtmlView [MFC], GetOffline", "CHtmlView [MFC], GetParentBrowser", "CHtmlView [MFC], GetProperty", "CHtmlView [MFC], GetReadyState", "CHtmlView [MFC], GetRegisterAsBrowser", "CHtmlView [MFC], GetRegisterAsDropTarget", "CHtmlView [MFC], GetSilent", "CHtmlView [MFC], GetSource", "CHtmlView [MFC], GetStatusBar", "CHtmlView [MFC], GetTheaterMode", "CHtmlView [MFC], GetToolBar", "CHtmlView [MFC], GetTop", "CHtmlView [MFC], GetTopLevelContainer", "CHtmlView [MFC], GetType", "CHtmlView [MFC], GetVisible", "CHtmlView [MFC], GetWidth", "CHtmlView [MFC], GoBack", "CHtmlView [MFC], GoForward", "CHtmlView [MFC], GoHome", "CHtmlView [MFC], GoSearch", "CHtmlView [MFC], LoadFromResource", "CHtmlView [MFC], Navigate", "CHtmlView [MFC], Navigate2", "CHtmlView [MFC], OnBeforeNavigate2", "CHtmlView [MFC], OnCommandStateChange", "CHtmlView [MFC], OnDocumentComplete", "CHtmlView [MFC], OnDocWindowActivate", "CHtmlView [MFC], OnDownloadBegin", "CHtmlView [MFC], OnDownloadComplete", "CHtmlView [MFC], OnEnableModeless", "CHtmlView [MFC], OnFilterDataObject", "CHtmlView [MFC], OnFrameWindowActivate", "CHtmlView [MFC], OnFullScreen", "CHtmlView [MFC], OnGetDropTarget", "CHtmlView [MFC], OnGetExternal", "CHtmlView [MFC], OnGetHostInfo", "CHtmlView [MFC], OnGetOptionKeyPath", "CHtmlView [MFC], OnHideUI", "CHtmlView [MFC], OnMenuBar", "CHtmlView [MFC], OnNavigateComplete2", "CHtmlView [MFC], OnNavigateError", "CHtmlView [MFC], OnNewWindow2", "CHtmlView [MFC], OnProgressChange", "CHtmlView [MFC], OnPropertyChange", "CHtmlView [MFC], OnQuit", "CHtmlView [MFC], OnResizeBorder", "CHtmlView [MFC], OnShowContextMenu", "CHtmlView [MFC], OnShowUI", "CHtmlView [MFC], OnStatusBar", "CHtmlView [MFC], OnStatusTextChange", "CHtmlView [MFC], OnTheaterMode", "CHtmlView [MFC], OnTitleChange", "CHtmlView [MFC], OnToolBar", "CHtmlView [MFC], OnTranslateAccelerator", "CHtmlView [MFC], OnTranslateUrl", "CHtmlView [MFC], OnUpdateUI", "CHtmlView [MFC], OnVisible", "CHtmlView [MFC], PutProperty", "CHtmlView [MFC], QueryFormsCommand", "CHtmlView [MFC], QueryStatusWB", "CHtmlView [MFC], Refresh", "CHtmlView [MFC], Refresh2", "CHtmlView [MFC], SetAddressBar", "CHtmlView [MFC], SetFullScreen", "CHtmlView [MFC], SetHeight", "CHtmlView [MFC], SetLeft", "CHtmlView [MFC], SetMenuBar", "CHtmlView [MFC], SetOffline", "CHtmlView [MFC], SetRegisterAsBrowser", "CHtmlView [MFC], SetRegisterAsDropTarget", "CHtmlView [MFC], SetSilent", "CHtmlView [MFC], SetStatusBar", "CHtmlView [MFC], SetTheaterMode", "CHtmlView [MFC], SetToolBar", "CHtmlView [MFC], SetTop", "CHtmlView [MFC], SetVisible", "CHtmlView [MFC], SetWidth", "CHtmlView [MFC], Stop"]
ms.assetid: 904976af-73de-4aba-84ac-cfae8e2be09a
---
# CHtmlView Class

Provides the functionality of the WebBrowser control within the context of MFC's document/view architecture.

## Syntax

```
class CHtmlView : public CFormView
```

## Members

### Public Methods

|Name|Description|
|----------|-----------------|
|[CHtmlView::Create](#create)|Creates the WebBrowser control.|
|[CHtmlView::CreateControlSite](#createcontrolsite)|Overridable used to create a control site instance to host a control on the form.|
|[CHtmlView::ExecFormsCommand](#execformscommand)|Executes the specified command using the `IOleCommandTarget::Exec` method.|
|[CHtmlView::ExecWB](#execwb)|Executes a command.|
|[CHtmlView::GetAddressBar](#getaddressbar)|Determines if the Internet Explorer object's address bar is visible. (WebBrowser control ignores; Internet Explorer only.)|
|[CHtmlView::GetApplication](#getapplication)|Retrieves an application object representing the application that contains the current instance of the Internet Explorer application.|
|[CHtmlView::GetBusy](#getbusy)|Retrieves a value indicating whether a download or other activity is still in progress.|
|[CHtmlView::GetContainer](#getcontainer)|Retrieves the container of the WebBrowser control.|
|[CHtmlView::GetFullName](#getfullname)|Retrieves the full name, including the path, of the resource displayed in the web browser. (WebBrowser control ignores; Internet Explorer only.)|
|[CHtmlView::GetFullScreen](#getfullscreen)|Indicates whether the WebBrowser control is operating in full-screen mode or in normal window mode.|
|[CHtmlView::GetHeight](#getheight)|Retrieves the height of the Internet Explorer main window.|
|[CHtmlView::GetHtmlDocument](#gethtmldocument)|Retrieves the active HTML document.|
|[CHtmlView::GetLeft](#getleft)|Retrieves the screen coordinate of the left edge of the Internet Explorer main window.|
|[CHtmlView::GetLocationName](#getlocationname)|Retrieves the name of the resource that WebBrowser is currently displaying|
|[CHtmlView::GetLocationURL](#getlocationurl)|Retrieves the URL of the resource that WebBrowser is currently displaying.|
|[CHtmlView::GetMenuBar](#getmenubar)|Retrieves a value that determines whether the menu bar is visible.|
|[CHtmlView::GetOffline](#getoffline)|Retrieves a value that determines whether the control is offline.|
|[CHtmlView::GetParentBrowser](#getparentbrowser)|Retrieves a pointer to the `IDispatch` interface. For more information, see [Implementing the IDispatch Interface](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface).|
|[CHtmlView::GetProperty](#getproperty)|Retrieves the current value of a property associated with the given object.|
|[CHtmlView::GetReadyState](#getreadystate)|Retrieves the ready state of the web browser object.|
|[CHtmlView::GetRegisterAsBrowser](#getregisterasbrowser)|Indicates whether the WebBrowser control is registered as a top-level browser for target name resolution.|
|[CHtmlView::GetRegisterAsDropTarget](#getregisterasdroptarget)|Indicates whether the WebBrowser control is registered as a drop target for navigation.|
|[CHtmlView::GetSilent](#getsilent)|Indicates whether any dialog boxes can be shown.|
|[CHtmlView::GetSource](#getsource)|The HTML source code of the web page.|
|[CHtmlView::GetStatusBar](#getstatusbar)|Indicates whether the Internet Explorer's status bar is visible. (WebBrowser control ignores; Internet Explorer only.)|
|[CHtmlView::GetTheaterMode](#gettheatermode)|Indicates whether the WebBrowser control is in theater mode.|
|[CHtmlView::GetToolBar](#gettoolbar)|Retrieves a value that determines whether the toolbar is visible.|
|[CHtmlView::GetTop](#gettop)|Retrieves the screen coordinate of the top edge of the Internet Explorer main window.|
|[CHtmlView::GetTopLevelContainer](#gettoplevelcontainer)|Retrieves a value indicating whether the current object is the top-level container of the WebBrowser control.|
|[CHtmlView::GetType](#gettype)|Retrieves the type name of the document object.|
|[CHtmlView::GetVisible](#getvisible)|Retrieves a value indicating whether the object is visible or hidden.|
|[CHtmlView::GetWidth](#getwidth)|Retrieves the width of the Internet Explorer main window.|
|[CHtmlView::GoBack](#goback)|Navigates to the previous item in the history list.|
|[CHtmlView::GoForward](#goforward)|Navigates to the next item in the history list.|
|[CHtmlView::GoHome](#gohome)|Navigates to the current home or start page.|
|[CHtmlView::GoSearch](#gosearch)|Navigates to the current search page.|
|[CHtmlView::LoadFromResource](#loadfromresource)|Loads a resource in the WebBrowser control.|
|[CHtmlView::Navigate](#navigate)|Navigates to the resource identified by a URL.|
|[CHtmlView::Navigate2](#navigate2)|Navigates to the resource identified by a URL, or to the file identified by a full path.|
|[CHtmlView::OnBeforeNavigate2](#onbeforenavigate2)|Called before a navigation occurs in the given WebBrowser (on either a window or frameset element).|
|[CHtmlView::OnCommandStateChange](#oncommandstatechange)|Called to notify an application that the enabled state of a web browser command has changed.|
|[CHtmlView::OnDocumentComplete](#ondocumentcomplete)|Called to notify an application that a document has reached the READYSTATE_COMPLETE state.|
|[CHtmlView::OnDocWindowActivate](#ondocwindowactivate)|Called from the Internet Explorer or MSHTML implementation of [IOleInPlaceActiveObject::OnDocWindowActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-ondocwindowactivate), which notifies the active in-place object when the container's document window is activated or deactivated.|
|[CHtmlView::OnDownloadBegin](#ondownloadbegin)|Called to notify an application that a navigation operation is beginning.|
|[CHtmlView::OnDownloadComplete](#ondownloadcomplete)|Called when a navigation operation finished, was halted, or failed.|
|[CHtmlView::OnEnableModeless](#onenablemodeless)|Called to enable or disable modeless dialog boxes when the container creates or destroys a modal dialog box.|
|[CHtmlView::OnFilterDataObject](#onfilterdataobject)|Called on the host by Internet Explorer or MSHTML to allow the host to replace Internet Explorer or MSHTML's data object.|
|[CHtmlView::OnFrameWindowActivate](#onframewindowactivate)|Called from [IOleInPlaceActiveObject::OnFrameWindowActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-onframewindowactivate) to notify the object when the container's top-level frame window is activated or deactivated.|
|[CHtmlView::OnFullScreen](#onfullscreen)|Called when the FullScreen property has changed.|
|[CHtmlView::OnGetDropTarget](#ongetdroptarget)|Called by Internet Explorer or MSHTML when it is being used as a drop target to allow the host to supply an alternative [IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget).|
|[CHtmlView::OnGetExternal](#ongetexternal)|Called by Internet Explorer or MSHTML to obtain the host's `IDispatch` interface.|
|[CHtmlView::OnGetHostInfo](#ongethostinfo)|Retrieves the UI capabilities of the Internet Explorer or MSHTML host.|
|[CHtmlView::OnGetOptionKeyPath](#ongetoptionkeypath)|Returns the registry key under which Internet Explorer or MSHTML stores user preferences.|
|[CHtmlView::OnHideUI](#onhideui)|Called when Internet Explorer or MSHTML removes its menus and toolbars.|
|[CHtmlView::OnMenuBar](#onmenubar)|Called when the MenuBar property has changed.|
|[CHtmlView::OnNavigateComplete2](#onnavigatecomplete2)|Called after a navigation to a hyperlink completes (on either a window or frameset element).|
|[CHtmlView::OnNavigateError](#onnavigateerror)|Called by the framework if navigation to a hyperlink fails.|
|[CHtmlView::OnNewWindow2](#onnewwindow2)|Called when a new window is to be created for displaying a resource.|
|[CHtmlView::OnProgressChange](#onprogresschange)|Called to notify an application that the progress of a download operation has been updated.|
|[CHtmlView::OnPropertyChange](#onpropertychange)|Called to notify an application that the [PutProperty](#putproperty) method has changed the value of a property.|
|[CHtmlView::OnQuit](#onquit)|Called to notify an application that the Internet Explorer application is ready to quit. (Applies to Internet Explorer only)|
|[CHtmlView::OnResizeBorder](#onresizeborder)|Called from the Internet Explorer or MSHTML implementation of [IOleInPlaceActiveObject::ResizeBorder](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder), which alerts the object that it needs to resize its border space.|
|[CHtmlView::OnShowContextMenu](#onshowcontextmenu)|Called from Internet Explorer or MSHTML when it is about to show its context menu.|
|[CHtmlView::OnShowUI](#onshowui)|Called before Internet Explorer or MSHTML displays its menus and toolbars.|
|[CHtmlView::OnStatusBar](#onstatusbar)|Called when the StatusBar property has changed.|
|[CHtmlView::OnStatusTextChange](#onstatustextchange)|Called to notify an application that the text of the status bar associated with the WebBrowser control has changed.|
|[CHtmlView::OnTheaterMode](#ontheatermode)|Called when the TheaterMode property has changed.|
|[CHtmlView::OnTitleChange](#ontitlechange)|Called to notify an application if the title of a document in the WebBrowser control becomes available or changes.|
|[CHtmlView::OnToolBar](#ontoolbar)|Called when the ToolBar property has changed.|
|[CHtmlView::OnTranslateAccelerator](#ontranslateaccelerator)|Called by Internet Explorer or MSHTML when [IOleInPlaceActiveObject::TranslateAccelerator](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-translateaccelerator) or [IOleControlSite::TranslateAccelerator](/windows/win32/api/ocidl/nf-ocidl-iolecontrolsite-translateaccelerator) is called to process menu accelerator-key messages from the container's message queue.|
|[CHtmlView::OnTranslateUrl](#ontranslateurl)|Called by Internet Explorer or MSHTML to allow the host an opportunity to modify the URL to be loaded.|
|[CHtmlView::OnUpdateUI](#onupdateui)|Notifies the host that the command state has changed.|
|[CHtmlView::OnVisible](#onvisible)|Called when the window for the WebBrowser control should be shown/hidden.|
|[CHtmlView::PutProperty](#putproperty)|Sets the value of a property associated with the given object.|
|[CHtmlView::QueryFormsCommand](#queryformscommand)|Queries for the status of one or more commands generated by user interface events.|
|[CHtmlView::QueryStatusWB](#querystatuswb)|Queries the status of a command being processed by the WebBrowser control.|
|[CHtmlView::Refresh](#refresh)|Reloads the current file.|
|[CHtmlView::Refresh2](#refresh2)|Reloads the current file and optionally prevents the `pragma:nocache` header from being sent.|
|[CHtmlView::SetAddressBar](#setaddressbar)|Shows or hides the Internet Explorer object's address bar. (WebBrowser control ignores; Internet Explorer only.)|
|[CHtmlView::SetFullScreen](#setfullscreen)|Sets a value to determine whether the control is operating in full-screen mode or in normal window mode. (WebBrowser control ignores; Internet Explorer only.)|
|[CHtmlView::SetHeight](#setheight)|Sets the height of the Internet Explorer main window.|
|[CHtmlView::SetLeft](#setleft)|Sets the horizontal position of the Internet Explorer main window.|
|[CHtmlView::SetMenuBar](#setmenubar)|Sets a value to determine whether the control's menu bar is visible. (WebBrowser control ignores; Internet Explorer only.)|
|[CHtmlView::SetOffline](#setoffline)|Sets a value to determine whether the control is offline.|
|[CHtmlView::SetRegisterAsBrowser](#setregisterasbrowser)|Sets a value indicating whether the WebBrowser control is registered as a top-level browser for target name resolution.|
|[CHtmlView::SetRegisterAsDropTarget](#setregisterasdroptarget)|Sets a value indicating whether the WebBrowser control is registered as a drop target for navigation.|
|[CHtmlView::SetSilent](#setsilent)|Sets a value to determine whether the control will display dialog boxes.|
|[CHtmlView::SetStatusBar](#setstatusbar)|Sets a value to determine whether the Internet Explorer's status bar is visible. (WebBrowser control ignores; Internet Explorer only.)|
|[CHtmlView::SetTheaterMode](#settheatermode)|Sets a value indicating whether the WebBrowser control is in theater mode.|
|[CHtmlView::SetToolBar](#settoolbar)|Sets a value to determine whether the control's toolbar is visible. (WebBrowser control ignores; Internet Explorer only.)|
|[CHtmlView::SetTop](#settop)|Sets the vertical position of the Internet Explorer main window.|
|[CHtmlView::SetVisible](#setvisible)|Sets a value indicating whether the object is visible or hidden.|
|[CHtmlView::SetWidth](#setwidth)|Sets the width of the Internet Explorer main window.|
|[CHtmlView::Stop](#stop)|Stops opening a file.|

## Remarks

The WebBrowser control is a window in which the user can browse sites on the World Wide Web, as well as folders in the local file system and on a network. The WebBrowser control supports hyperlinking, Uniform Resource Locator (URL) navigation, and maintains a history list.

## Using the CHtmlView Class in an MFC Application

In the standard MFC framework application (either SDI or MDI based), the view object is commonly derived from a specialized set of classes. These classes, all derived from `CView`, provide specialized functionality beyond that provided by `CView`.

Basing the application's view class on `CHtmlView` provides the view with the WebBrowser control. This effectively makes the application a web browser. The preferred method of creating a web browser-style application is to use the MFC Application Wizard, and specify `CHtmlView` as the view class. For more information on implementing and using the WebBrowser control within MFC applications, see [Creating a Web Browser-Style Application](../../mfc/reference/creating-a-web-browser-style-mfc-application.md).

> [!NOTE]
> The WebBrowser ActiveX control (and therefore `CHtmlView`) is available only to programs running under Windows NT versions 4.0 or later, in which Internet Explorer 4.0 or later has been installed.

`CHtmlView` is designed for applications that access the Web (and/or HTML documents). The following `CHtmlView` member functions apply to the Internet Explorer application only. These functions will succeed on the WebBrowser control, but they will have no visible effect.

- [GetAddressBar](#getaddressbar)

- [GetFullName](#getfullname)

- [GetStatusBar](#getstatusbar)

- [SetAddressBar](#setaddressbar)

- [SetFullScreen](#setfullscreen)

- [SetMenuBar](#setmenubar)

- [SetStatusBar](#setstatusbar)

- [SetToolBar](#settoolbar)

## Inheritance Hierarchy

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CView](../../mfc/reference/cview-class.md)

[CScrollView](../../mfc/reference/cscrollview-class.md)

[CFormView](../../mfc/reference/cformview-class.md)

`CHtmlView`

## Requirements

**Header:** afxhtml.h

## <a name="create"></a> CHtmlView::Create

Call this member function to create a WebBrowser control or container for the Internet Explorer executable.

```
virtual BOOL Create(
    LPCTSTR lpszClassName,
    LPCTSTR lpszWindowName,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID,
    CCreateContext* pContext = NULL);
```

### Parameters

*lpszClassName*<br/>
Points to a null-terminated character string that names the Windows class. The class name can be any name registered with the [AfxRegisterWndClass](../../mfc/reference/application-information-and-management.md#afxregisterwndclass) global function or the `RegisterClass` Windows function. If NULL, uses the predefined default [CFrameWnd](../../mfc/reference/cframewnd-class.md) attributes.

*lpszWindowName*<br/>
Points to a null-terminated character string that represents the window name.

*dwStyle*<br/>
Specifies the window style attributes. By default, the WS_VISIBLE and WS_CHILD Windows styles are set.

*rect*<br/>
A reference to a [RECT](/windows/win32/api/windef/ns-windef-rect) structure specifying the size and position of the window. The *rectDefault* value allows Windows to specify the size and position of the new window.

*pParentWnd*<br/>
A pointer to the parent window of the control.

*nID*<br/>
The ID number of the view. By default, set to AFX_IDW_PANE_FIRST.

*pContext*<br/>
A pointer to a [CCreateContext](../../mfc/reference/ccreatecontext-structure.md). NULL by default.

## <a name="createcontrolsite"></a> CHtmlView::CreateControlSite

Overridable used to create a control site instance to host a control on the form.

```
virtual BOOL CreateControlSite(
    COleControlContainer* pContainer,
    COleControlSite** ppSite,
    UINT nID,
    REFCLSID clsid);
```

### Parameters

*pContainer*<br/>
A pointer to a [COleControlContainer](../../mfc/reference/colecontrolcontainer-class.md) object containing the control.

*ppSite*<br/>
A pointer to a pointer to a [COleControlSite](../../mfc/reference/colecontrolsite-class.md) object, providing the site for the control.

*nID*<br/>
The identifier of the control to be hosted.

*clsid*<br/>
The CLSID of the control to be hosted

### Return Value

Returns TRUE on success, FALSE on failure.

### Remarks

You can override this member function to return an instance of your own control site class.

## <a name="execformscommand"></a> CHtmlView::ExecFormsCommand

Executes the specified command using the `IOleCommandTarget::Exec` method.

```
HRESULT ExecFormsCommand(
    DWORD dwCommandID,
    VARIANT* pVarIn,
    VARIANT* pVarOut);
```

### Parameters

*dwCommandID*<br/>
The command to be executed. This command must belong to the CMDSETID3_Forms3 group.

*pVarIn*<br/>
Pointer to a `VARIANT` structure containing input arguments. Can be NULL.

*pVarOut*<br/>
Pointer to a `VARIANT` structure to receive command output. Can be NULL.

### Return Value

A standard HRESULT value. For a complete listing of possible values, see [IOleCommandTarget::Exec](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-exec) in the Windows SDK.

### Remarks

`ExecFormsCommand` implements the behavior of the [IOleCommandTarget::Exec](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-exec) method.

## <a name="execwb"></a> CHtmlView::ExecWB

Call this member function to execute a command in the WebBrowser or Internet Explorer.

```cpp
void ExecWB(
    OLECMDID cmdID,
    OLECMDEXECOPT cmdexecopt,
    VARIANT* pvaIn,
    VARIANT* pvaOut);
```

### Parameters

*cmdID*<br/>
The command to execute.

*cmdexecopt*<br/>
The options set for executing the command.

*pvaIn*<br/>
A variant used for specifying command input arguments.

*pvaOut*<br/>
A variant used for specifying command output arguments.

### Remarks

See [IWebBrowser2::ExecWB](/previous-versions//aa752117\(v=vs.85\)) in the Windows SDK.

## <a name="getaddressbar"></a> CHtmlView::GetAddressBar

Call this member function to retrieve Internet Explorer's address bar.

```
BOOL GetAddressBar() const;
```

### Return Value

Nonzero if the address bar is visible; otherwise zero.

### Remarks

Applies to Internet Explorer. If you use this call with a WebBrowser control, it will return no error, but it will ignore this call.

## <a name="getapplication"></a> CHtmlView::GetApplication

Call this member function to retrieve the automation object supported by the application that contains the WebBrowser control.

```
LPDISPATCH GetApplication() const;
```

### Return Value

A pointer to the `IDispatch` interface of the active document object. For more information, see [Implementing the IDispatch Interface](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface).

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="getbusy"></a> CHtmlView::GetBusy

Call this member function to determine whether the WebBrowser control is engaged in a navigation or downloading operation.

```
BOOL GetBusy() const;
```

### Return Value

Nonzero if the web browser is busy; otherwise zero.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="getcontainer"></a> CHtmlView::GetContainer

Call this member function to retrieve an object that evaluates to the container of the web browser.

```
LPDISPATCH GetContainer() const;
```

### Return Value

A pointer to the `IDispatch` interface of the active document object.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="getfullname"></a> CHtmlView::GetFullName

Call this member function to retrieve the full path of the file that Internet Explorer is currently displaying.

```
CString GetFullName() const;
```

### Return Value

A [CString](../../atl-mfc-shared/reference/cstringt-class.md) object containing the path and name of the currently displayed file. If no path and filename exist, `GetFullName` returns an empty `CString`.

### Remarks

Applies to Internet Explorer. If you use this call with a WebBrowser control, it will return no error, but it will ignore this call.

## <a name="getfullscreen"></a> CHtmlView::GetFullScreen

Call this member function to determine whether the WebBrowser control is operating in full-screen mode or in normal window mode.

```
BOOL GetFullScreen() const;
```

### Return Value

Nonzero if the WebBrowser is operating in full-screen mode; otherwise zero.

### Remarks

In full-screen mode, the Internet Explorer main window is maximized and the status bar, toolbar, menu bar, and title bar are hidden.

Applies to Internet Explorer and WebBrowser.

## <a name="getheight"></a> CHtmlView::GetHeight

Call this member function to retrieve the height, in pixels, of the WebBrowser control's frame window.

```
long GetHeight() const;
```

### Return Value

The control's frame window height, in pixels.

## <a name="gethtmldocument"></a> CHtmlView::GetHtmlDocument

Call this member function to retrieve the HTML document for the active document.

```
LPDISPATCH GetHtmlDocument() const;
```

### Return Value

A pointer to the `IDispatch` interface of the active document object.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="getleft"></a> CHtmlView::GetLeft

Call this member function to retrieve the distance between the internal left edge of the WebBrowser control and the left edge of its container.

```
long GetLeft() const;
```

### Return Value

The left-edge distance, in pixels.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="getlocationname"></a> CHtmlView::GetLocationName

Call this member function to get the name of the resource being displayed in the WebBrowser.

```
CString GetLocationName() const;
```

### Return Value

A [CString](../../atl-mfc-shared/reference/cstringt-class.md) object containing the name of the resource currently displayed in the WebBrowser.

### Remarks

If the resource is an HTML page on the World Wide Web, the name is the title of that page. If the resource is a folder or file on the network or local computer, the name is the UNC or full path of the folder or file.

Applies to Internet Explorer and WebBrowser.

## <a name="getlocationurl"></a> CHtmlView::GetLocationURL

Call this member function to retrieve the URL of the resource that the WebBrowser control is currently displaying.

```
CString GetLocationURL() const;
```

### Return Value

A [CString](../../atl-mfc-shared/reference/cstringt-class.md) object containing the URL of the resource currently displayed in the WebBrowser.

### Remarks

If the resource is a folder or file on the network or local computer, the name is the UNC or full path of the folder or file.

Applies to Internet Explorer and WebBrowser.

## <a name="getmenubar"></a> CHtmlView::GetMenuBar

Call this member function to determine whether the menu bar is visible.

```
BOOL GetMenuBar() const;
```

### Return Value

Nonzero if the menu bar is visible; otherwise zero.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="getoffline"></a> CHtmlView::GetOffline

Call this member function to determine whether the web browser is operating offline.

```
BOOL GetOffline() const;
```

### Return Value

Nonzero if the web browser is currently offline; otherwise zero.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="getparentbrowser"></a> CHtmlView::GetParentBrowser

Call this member function to retrieve a pointer to the parent object of the WebBrowser control.

```
LPDISPATCH GetParentBrowser() const;
```

### Return Value

A pointer to the `IDispatch` interface of the object that is the parent of the WebBrowser control.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="getproperty"></a> CHtmlView::GetProperty

Call this member function to get the value of the property currently associated with the control.

```
BOOL GetProperty(
    LPCTSTR lpszProperty,
    CString& strValue);

COleVariant GetProperty(LPCTSTR lpszProperty);
```

### Parameters

*lpszProperty*<br/>
A pointer to a string containing the property to retrieve.

*strValue*<br/>
A reference to a [CString](../../atl-mfc-shared/reference/cstringt-class.md) object that receives the current value of the property.

### Return Value

In the first version, nonzero if completed successfully; otherwise zero. In the second version, a [COleVariant](../../mfc/reference/colevariant-class.md) object.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="getreadystate"></a> CHtmlView::GetReadyState

Call this member function to retrieve the ready state of the WebBrowser object.

```
READYSTATE GetReadyState() const;
```

### Return Value

A [READYSTATE](/previous-versions//aa768362\(v=vs.85\)) value, as described in the Windows SDK.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="getregisterasbrowser"></a> CHtmlView::GetRegisterAsBrowser

Call this member function to determine whether the WebBrowser object is registered as a top-level browser for target name resolution.

```
BOOL GetRegisterAsBrowser() const;
```

### Return Value

Nonzero if the browser is registered as a top-level browser; otherwise zero.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="getregisterasdroptarget"></a> CHtmlView::GetRegisterAsDropTarget

Call this member function to determine whether the WebBrowser control is registered as a drop target for navigation.

```
BOOL GetRegisterAsDropTarget() const;
```

### Return Value

Nonzero if the browser is registered as a drop target; otherwise zero.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="getsilent"></a> CHtmlView::GetSilent

Call this member function to determine whether any dialog boxes can be shown in the WebBrowser control.

```
BOOL GetSilent() const;
```

### Return Value

Nonzero if dialog boxes cannot be displayed from the WebBrowser control; otherwise zero.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="getsource"></a> CHtmlView::GetSource

Call this member function to retrieve the HTML source code for the web page.

```
BOOL GetSource(CString& strRef);
```

### Return Value

Nonzero if successful; otherwise zero.

### Parameters

*refString*<br/>
A [CString](../../atl-mfc-shared/reference/cstringt-class.md) that will hold the source code.

### Remarks

This function is equivalent to the "View Source" command in Internet Explorer, except that the source code is returned in a `CString`.

## <a name="getstatusbar"></a> CHtmlView::GetStatusBar

Call this member function to determine whether the WebBrowser control displays a status bar.

```
BOOL GetStatusBar() const;
```

### Return Value

Nonzero if the status bar can be displayed; otherwise zero.

### Remarks

Applies to Internet Explorer. If you use this call with a WebBrowser control, it will return no error, but it will ignore this call.

## <a name="gettheatermode"></a> CHtmlView::GetTheaterMode

Call this member function to determine whether the web browser is in theater mode.

```
BOOL GetTheaterMode() const;
```

### Return Value

Nonzero if the web browser is in theater mode; otherwise zero.

### Remarks

When the web browser is in theater mode, the browser main window fills the entire screen, a toolbar with a minimal set of navigational tools appears, and the status bar appears in the upper right-hand corner of the screen.

Applies to Internet Explorer and WebBrowser.

## <a name="gettoolbar"></a> CHtmlView::GetToolBar

Call this member function to determine whether the toolbar is visible.

```
int GetToolBar() const;
```

### Return Value

A value indicating whether the toolbar is visible. Nonzero if toolbar is visible; otherwise zero.

## <a name="gettop"></a> CHtmlView::GetTop

Call this member function to retrieve the screen coordinate of the top edge of the WebBrowser control's main window.

```
long GetTop() const;
```

### Return Value

Address of a variable that receives the screen coordinate of the main window's top edge.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="gettoplevelcontainer"></a> CHtmlView::GetTopLevelContainer

Call this member function to determine whether Internet Explorer is the top-level container of the WebBrowser control.

```
BOOL GetTopLevelContainer() const;
```

### Return Value

Nonzero the container is the top-level container; otherwise zero.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="gettype"></a> CHtmlView::GetType

Call this member function to retrieve the type name of the contained active document.

```
CString GetType() const;
```

### Return Value

A [CString](../../atl-mfc-shared/reference/cstringt-class.md) object containing the type name of the contained active document.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="getvisible"></a> CHtmlView::GetVisible

Call this member function to determine if the contained object is visible.

```
BOOL GetVisible() const;
```

### Return Value

Nonzero if the object is visible; otherwise zero.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="getwidth"></a> CHtmlView::GetWidth

Retrieves the width of the Internet Explorer main window.

```
long GetWidth() const;
```

### Return Value

The current width of the window, in pixels.

## <a name="goback"></a> CHtmlView::GoBack

Navigates backward one item in the history list.

```cpp
void GoBack();
```

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="goforward"></a> CHtmlView::GoForward

Navigates forward one item in the history list.

```cpp
void GoForward();
```

## <a name="gohome"></a> CHtmlView::GoHome

Navigates to the current home or start page specified in the Internet Explorer Internet Options dialog box or the Internet Properties dialog box, accessed from the Control Panel.

```cpp
void GoHome();
```

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="gosearch"></a> CHtmlView::GoSearch

Navigates to the current search page, as specified in the Internet Explorer Internet Options dialog box or the Internet Properties dialog box, accessed from the Control Panel.

```cpp
void GoSearch();
```

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="loadfromresource"></a> CHtmlView::LoadFromResource

Call this member function to load the specified resource into the WebBrowser control.

```
BOOL LoadFromResource(LPCTSTR lpszResource);
BOOL LoadFromResource(UINT nRes);
```

### Parameters

*lpszResource*<br/>
A pointer to a string containing the name of the resource to load.

*nRes*<br/>
The ID of the buffer containing the name of the resource to load.

### Return Value

Nonzero if successful; otherwise zero.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="navigate"></a> CHtmlView::Navigate

Call this member function to navigate to the resource identified by a URL.

```cpp
void Navigate(
    LPCTSTR URL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeaders = NULL,
    LPVOID lpvPostData = NULL,
    DWORD dwPostDataLen = 0);
```

### Parameters

*URL*<br/>
A caller-allocated string that contains the URL to navigate to, or the full path of the file to display.

*dwFlags*<br/>
The flags of a variable that specifies whether to add the resource to the history list, whether to read to or write from the cache, and whether to display the resource in a new window. The variable can be a combination of the values defined by the [BrowserNavConstants](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768360\(v=vs.85\)) enumeration.

*lpszTargetFrameName*<br/>
A pointer to a string that contains the name of the frame in which to display the resource.

*lpszHeaders*<br/>
A pointer to a value that specifies the HTTP headers to send to the server. These headers are added to the default Internet Explorer headers. The headers can specify such things as the action required of the server, the type of data being passed to the server, or a status code. This parameter is ignored if *URL* is not an HTTP URL.

*lpvPostData*<br/>
A pointer to the data to send with the HTTP POST transaction. For example, the POST transaction is used to send data gathered by an HTML form. If this parameter does not specify any post data, `Navigate` issues an HTTP GET transaction. This parameter is ignored if *URL* is not an HTTP URL.

*dwPostDataLen*<br/>
Data to send with the HTTP POST transaction. For example, the POST transaction is used to send data gathered by an HTML form. If this parameter does not specify any post data, `Navigate` issues an HTTP GET transaction. This parameter is ignored if *URL* is not an HTTP URL.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="navigate2"></a> CHtmlView::Navigate2

Call this member function to navigate to the resource identified by a URL, or to the file identified by a full path.

```cpp
void Navigate2(
    LPITEMIDLIST pIDL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL);

void Navigate2(
    LPCTSTR lpszURL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeaders = NULL,
    LPVOID lpvPostData = NULL,
    DWORD dwPostDataLen = 0);

void Navigate2(
    LPCTSTR lpszURL,
    DWORD dwFlags,
    CByteArray& baPostedData,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeader = NULL);
```

### Parameters

*pIDL*<br/>
A pointer to an [ITEMIDLIST](/windows/win32/api/shtypes/ns-shtypes-itemidlist) structure.

*dwFlags*<br/>
The flags of a variable that specifies whether to add the resource to the history list, whether to read to or write from the cache, and whether to display the resource in a new window. The variable can be a combination of the values defined by the [BrowserNavConstants](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768360\(v=vs.85\)) enumeration.

*lpszTargetFrameName*<br/>
A pointer to a string that contains the name of the frame in which to display the resource.

*lpszURL*<br/>
A pointer to a string containing the URL.

*lpvPostData*<br/>
Data to send with the HTTP POST transaction. For example, the POST transaction is used to send data gathered by an HTML form. If this parameter does not specify any post data, `Navigate2` issues an HTTP GET transaction. This parameter is ignored if *URL* is not an HTTP or HTTPS URL.

*dwPostDataLen*<br/>
Length in bytes of the data pointed to by the *lpvPostData* parameter.

*lpszHeaders*<br/>
A pointer to a value that specifies the HTTP or HTTPS headers to send to the server. These headers are added to the default Internet Explorer headers. The headers can specify such things as the action required of the server, the type of data being passed to the server, or a status code. This parameter is ignored if *URL* is not an HTTP or HTTPS URL.

*baPostedData*<br/>
A reference to a [CByteArray](../../mfc/reference/cbytearray-class.md) object.

### Remarks

This member function extends the `Navigate` member function by supporting browsing on special folders, such as Desktop and My Computer, that are represented by the parameter *pIDL*.

Applies to Internet Explorer and WebBrowser.

### Example

[!code-cpp[NVC_MFCHtmlHttp#7](../../mfc/reference/codesnippet/cpp/chtmlview-class_1.cpp)]

## <a name="onbeforenavigate2"></a> CHtmlView::OnBeforeNavigate2

This member function is called by the framework to cause an event to fire before a navigation occurs in the web browser.

```
virtual void OnBeforeNavigate2(
    LPCTSTR lpszURL,
    DWORD nFlags,
    LPCTSTR lpszTargetFrameName,
    CByteArray& baPostedData,
    LPCTSTR lpszHeaders,
    BOOL* pbCancel);
```

### Parameters

*lpszURL*<br/>
Pointer to a string containing the URL to navigate to.

*nFlags*<br/>
Reserved for future use.

*lpszTargetFrameName*<br/>
A string that contains the name of the frame in which to display the resource, or NULL if no named frame is targeted for the resource.

*baPostedData*<br/>
A reference to a `CByteArray` object containing the data to send to the server if the HTTP POST transaction is being used.

*lpszHeaders*<br/>
A pointer to a string containing additional HTTP headers to send to the server (HTTP URLs only). The headers can specify such things as the action required of the server, the type of data being passed to the server, or a status code.

*pbCancel*<br/>
A pointer to a cancel flag. An application can set this parameter to nonzero to cancel the navigation operation, or to zero to allow it to proceed.

## <a name="oncommandstatechange"></a> CHtmlView::OnCommandStateChange

This member function is called by the framework to notify an application that the enabled state of a web browser command has changed.

```
virtual void OnCommandStateChange(
    long nCommand,
    BOOL bEnable);
```

### Parameters

*nCommand*<br/>
Identifier of the command whose enabled state has changed.

*bEnable*<br/>
Enabled state. This parameter is nonzero if the command is enabled, or zero if it is disabled.

## <a name="ondocumentcomplete"></a> CHtmlView::OnDocumentComplete

This member function is called by the framework to notify an application that a document has reached the READYSTATE_COMPLETE state.

```
virtual void OnDocumentComplete(LPCTSTR lpszURL);
```

### Parameters

*lpszURL*<br/>
A pointer to a string that evaluates to the URL, UNC file name, or a PIDL (a pointer to an item identifier list) that was navigated to.

### Remarks

Not every frame will fire this event, but each frame that fires an [OnDownloadBegin](#ondownloadbegin) event will fire a corresponding `OnDocumentComplete` event.

The URL indicated by *lpszURL* can be different from the URL that the browser was told to navigate to, because this URL is the canonicalized and qualified URL. For example, if an application specifies a URL of `"www.microsoft.com"` in a call to [Navigate](#navigate) or [Navigate2](#navigate2), the URL passed by `OnNavigateComplete2` will be `"<https://www.microsoft.com/>"`. Also, if the server has redirected the browser to a different URL, the redirected URL will be reflected here.

## <a name="ondocwindowactivate"></a> CHtmlView::OnDocWindowActivate

Called from the Internet Explorer or MSHTML implementation of `IOleInPlaceActiveObject::OnDocWindowActivate`, which notifies the active in-place object when the container's document window is activated or deactivated.

```
virtual HRESULT OnDocWindowActivate(BOOL fActivate);
```

### Parameters

*fActivate*<br/>
Indicates the state of the document window. If this value is nonzero, the window is being activated. If this value is zero, the window is being deactivated.

### Return Value

S_OK if successful, or an OLE-defined error code otherwise.

### Remarks

Override `OnDocWindowActivate` to react to the `OnDocWindowActivate` notification from the Microsoft Web Browser control. See [IDocHostUIHandler::OnDocWindowActivate](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753261\(v=vs.85\)) in the Windows SDK for more information.

## <a name="ondownloadbegin"></a> CHtmlView::OnDownloadBegin

This member function is called by the framework to begin downloading a document.

```
virtual void OnDownloadBegin();
```

### Remarks

This event is fired shortly after the [OnBeforeNavigate2](#onbeforenavigate2) event, unless the navigation is canceled. Any animation or "busy" indication that the container needs to display should be connected to this event.

## <a name="ondownloadcomplete"></a> CHtmlView::OnDownloadComplete

This member function is called by the framework to indicate that a navigation operation finished, was halted, or failed.

```
virtual void OnDownloadComplete();
```

## <a name="onenablemodeless"></a> CHtmlView::OnEnableModeless

Called when Internet Explorer or MSHTML displays modal UI.

```
virtual HRESULT OnEnableModeless(BOOL fEnable);
```

### Parameters

*fEnable*<br/>
Indicates if the host's modeless dialog boxes are enabled or disabled. If this value is nonzero, modeless dialog boxes are enabled. If this value is zero, modeless dialog boxes are disabled.

### Return Value

S_OK if successful, or an OLE-defined error code otherwise.

### Remarks

Enables or disables modeless dialog boxes when the container creates or destroys a modal dialog box. Override `OnEnableModeless` to react to the `EnableModeless` notification from the Microsoft Web Browser control. See [IDocHostUIHandler::EnableModeless](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753253\(v=vs.85\)) in the Windows SDK for more information.

## <a name="onfilterdataobject"></a> CHtmlView::OnFilterDataObject

Called on the host by Internet Explorer or MSHTML to allow the host to replace Internet Explorer or MSHTML's data object.

```
virtual HRESULT OnFilterDataObject(
    LPDATAOBJECT pDataObject,
    LPDATAOBJECT* ppDataObject);
```

### Parameters

*pDataObject*<br/>
Address of the [IDataObject](/windows/win32/api/objidl/nn-objidl-idataobject) interface supplied by Internet Explorer or MSHTML.

*ppDataObject*<br/>
Address that receives the `IDataObject` interface pointer supplied by the host. The contents of this parameter should always be initialized to NULL, even if the method fails.

### Return Value

S_OK if the data object is replaced, S_FALSE if the data object is not replaced, or an OLE-defined error code if an error occurs.

### Remarks

Override `OnFilterDataObject` to react to the `FilterDataObject` notification from the Microsoft Web Browser control. See [IDocHostUIHandler::FilterDataObject](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753254\(v=vs.85\)) in the Windows SDK for more information.

## <a name="onframewindowactivate"></a> CHtmlView::OnFrameWindowActivate

Called from [IOleInPlaceActiveObject::OnFrameWindowActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-onframewindowactivate) to notify the object when the container's top-level frame window is activated or deactivated.

```
virtual HRESULT OnFrameWindowActivate(BOOL fActivate);
```

### Parameters

*fActivate*<br/>
Indicates the state of the container's top-level frame window. If this value is nonzero, the window is being activated. If this value is zero, the window is being deactivated.

### Return Value

S_OK if successful, or an OLE-defined error code otherwise.

### Remarks

Override `OnFrameWindowActivate` to react to the `OnFrameWindowActivate` notification from the Microsoft Web Browser control. See [IDocHostUIHandler::OnFrameWindowActivate](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753262\(v=vs.85\)) in the Windows SDK for more information.

## <a name="onfullscreen"></a> CHtmlView::OnFullScreen

This member function is called by the framework when the [FullScreen](/previous-versions/aa752119\(v=vs.85\)) property has changed.

```
virtual void OnFullScreen(BOOL bFullScreen);
```

### Parameters

*bFullScreen*<br/>
Nonzero if Internet Explorer is in full screen mode; zero otherwise.

## <a name="ongetdroptarget"></a> CHtmlView::OnGetDropTarget

Called by Internet Explorer or MSHTML when it is being used as a drop target to allow the host to supply an alternative `IDropTarget`.

```
virtual HRESULT OnGetDropTarget(
    LPDROPTARGET pDropTarget,
    LPDROPTARGET* ppDropTarget);
```

### Parameters

*pDropTarget*<br/>
[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) Internet Explorer or MSHTML proposes to use.

*ppDropTarget*<br/>
Address of the `IDropTarget` that receives the `IDropTarget` interface pointer the host wants to provide.

### Return Value

See [IDocHostUIHandler::GetDropTarget](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753255\(v=vs.85\)) in the Windows SDK for a list of return codes.

### Remarks

Override `OnGetDropTarget` to react to the `GetDropTarget` notification from the Microsoft Web Browser control. See [IDocHostUIHandler::GetDropTarget](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753255\(v=vs.85\)) in the Windows SDK for more information.

## <a name="ongetexternal"></a> CHtmlView::OnGetExternal

Called by Internet Explorer or MSHTML to obtain the host's `IDispatch` interface.

```
virtual HRESULT OnGetExternal(LPDISPATCH* lppDispatch);
```

### Parameters

*lppDispatch*<br/>
A pointer to the address that receives the `IDispatch` interface pointer of the host application. If the host exposes an Automation interface, it can provide a reference to Internet Explorer or MSHTML through this parameter. The contents of this parameter should always be initialized to NULL, even if the method fails.

### Return Value

S_OK if successful, or an OLE-defined error code otherwise.

### Remarks

Override `OnGetExternal` to react to the `GetExternal` notification from the Microsoft Web Browser control. See [IDocHostUIHandler::GetExternal](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753256\(v=vs.85\)) in the Windows SDK for more information.

## <a name="ongethostinfo"></a> CHtmlView::OnGetHostInfo

Retrieves the UI capabilities of the Internet Explorer or MSHTML host.

```
virtual HRESULT OnGetHostInfo(DOCHOSTUIINFO* pInfo);
```

### Parameters

*pInfo*<br/>
Address of a [DOCHOSTUIINFO](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa770044\(v=vs.85\)) structure that receives the host's UI capabilities.

### Return Value

S_OK if successful, or an OLE-defined error code otherwise.

### Remarks

Override `OnGetHostInfo` to react to the `GetHostInfo` notification from the Microsoft Web Browser control. See [IDocHostUIHandler::GetHostInfo](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753257\(v=vs.85\)) in the Windows SDK for more information.

## <a name="ongetoptionkeypath"></a> CHtmlView::OnGetOptionKeyPath

Call this member function to get the registry key under which Internet Explorer or MSHTML stores user preferences.

```
virtual HRESULT OnGetOptionKeyPath(
    LPOLESTR* pchKey,
    DWORD dwReserved);
```

### Parameters

*pchKey*<br/>
Address of an `LPOLESTR` that receives the registry subkey string where the host stores its default options. This subkey will be under the HKEY_CURRENT_USER key. Allocate this memory using [CoTaskMemAlloc](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemalloc). The calling application is responsible for freeing this memory using [CoTaskMemFree](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree). This parameter should always be initialized to NULL, even if the method fails.

*dwReserved*<br/>
Reserved for future use. Not currently used.

### Return Value

S_OK if successful, or S_FALSE otherwise. If S_FALSE, Internet Explorer or MSHTML will default to its own user options.

### Remarks

Override `OnGetOptionKeyPath` to react to the `GetOptionKeyPath` notification from the Microsoft Web Browser control. See [IDocHostUIHandler::GetOptionKeyPath](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753258\(v=vs.85\)) in the Windows SDK for more information.

## <a name="onhideui"></a> CHtmlView::OnHideUI

This member function is called by the framework when Internet Explorer or MSHTML removes its menus and toolbars.

```
virtual HRESULT OnHideUI();
```

### Return Value

S_OK if successful, or an OLE-defined error code otherwise.

### Remarks

Override `OnHideUI` to react to the `HideUI` notification from the Microsoft Web Browser control. See [IDocHostUIHandler::HideUI](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753259\(v=vs.85\)) in the Windows SDK for more information.

## <a name="onmenubar"></a> CHtmlView::OnMenuBar

This member function is called by the framework when the [MenuBar](/previous-versions/aa752131\(v=vs.85\)) property has changed.

```
virtual void OnMenuBar(BOOL bMenuBar);
```

### Parameters

*bMenuBar*<br/>
Nonzero if the Internet Explorer menu bar is visible; zero otherwise.

## <a name="onnavigatecomplete2"></a> CHtmlView::OnNavigateComplete2

This member function is called by the framework after a navigation to a hyperlink completes (on either a window or frameset element).

```
virtual void OnNavigateComplete2(LPCTSTR strURL);
```

### Parameters

*strURL*<br/>
A string expression that evaluates to the URL, UNC file name, or PIDL (a pointer to an item identifier list) that was navigated to.

### Remarks

The URL parameter can be a PIDL in the case of a shell name space entity for which there is no URL representation.

Note that the URL contained in *strURL* can be different from the URL that the browser was told to navigate to, because this URL is the canonicalized and qualified URL. For example, if an application specifies a URL of `"www.microsoft.com"` in a call to [Navigate](#navigate) or [Navigate2](#navigate2), the URL passed by `OnNavigateComplete2` will be `"<https://www.microsoft.com/>"`. Also, if the server has redirected the browser to a different URL, the redirected URL will be reflected here.

## <a name="onnavigateerror"></a> CHtmlView::OnNavigateError

Called by the framework if navigation to a hyperlink fails.

```
virtual void OnNavigateError(
    LPCTSTR lpszURL,
    LPCTSTR lpszFrame,
    DWORD dwError,
    BOOL* pbCancel);
```

### Parameters

*lpszURL*<br/>
The URL for which navigation failed.

*lpszFrame*<br/>
The name of the frame in which the resource is to be displayed, or NULL if no named frame was targeted for the resource.

*dwError*<br/>
An error status code, if available. For a list of the possible HRESULT and HTTP status codes, see [NavigateError Event Status Codes.](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768365\(v=vs.85\)).

*pbCancel*<br/>
Specifies whether to cancel the navigation to an error page or any further autosearch. If TRUE (the default), continue with navigation to an error page or autosearch; if FALSE, cancel navigation to an error page or autosearch.

### Remarks

Override this method to provide custom navigation error handling.

For more information, see [DWebBrowserEvents2::NavigateError](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768286\(v=vs.85\))

## <a name="onnewwindow2"></a> CHtmlView::OnNewWindow2

This member function is called by the framework when a new window is to be created for displaying a resource.

```
virtual void OnNewWindow2(
    LPDISPATCH* ppDisp,
    BOOL* Cancel);
```

### Parameters

*ppDisp*<br/>
A pointer to an interface pointer that, optionally, receives the `IDispatch` interface pointer of a new WebBrowser or Internet Explorer object.

*Cancel*<br/>
A pointer to a cancel flag. An application can set this parameter to nonzero to cancel the navigation operation, or to zero to allow it to proceed.

### Remarks

This event precedes the creation of a new window from within the WebBrowser.

## <a name="onprogresschange"></a> CHtmlView::OnProgressChange

This member function is called by the framework to notify an application that the progress of a download operation has been updated.

```
virtual void OnProgressChange(
    long nProgress,
    long nProgressMax);
```

### Parameters

*nProgress*<br/>
Amount of total progress to show, or -1 when progress is complete.

*nProgressMax*<br/>
Maximum progress value.

### Remarks

The container can use the information provided by this event to display the number of bytes downloaded so far or to update a progress indicator.

## <a name="onpropertychange"></a> CHtmlView::OnPropertyChange

This member function is called by the framework to notify an application that [PutProperty](#putproperty) has changed the value of a property.

```
virtual void OnPropertyChange(LPCTSTR lpszProperty);
```

### Parameters

*lpszProperty*<br/>
A pointer to a string containing the name of the property.

## <a name="onquit"></a> CHtmlView::OnQuit

This member function is called by the framework to notify an application that the Internet Explorer application is ready to quit.

```
virtual void OnQuit();
```

## <a name="onresizeborder"></a> CHtmlView::OnResizeBorder

Called from the Internet Explorer or MSHTML implementation of [IOleInPlaceActiveObject::ResizeBorder](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder), which alerts the object that it needs to resize its border space.

```
virtual HRESULT OnResizeBorder(
    LPCRECT prcBorder,
    LPOLEINPLACEUIWINDOW pUIWindow,
    BOOL fFrameWindow);
```

### Parameters

*prcBorder*<br/>
New outer rectangle for border space.

*pUIWindow*<br/>
A pointer to the interface for the frame or document window object whose border has changed.

*fFrameWindow*<br/>
TRUE if the frame window is calling [IOleInPlaceActiveObject::ResizeBorder](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder), otherwise FALSE.

### Return Value

S_OK if successful, or an OLE-defined error code otherwise.

### Remarks

Override `OnResizeBorder` to react to the `ResizeBorder` notification from the Microsoft Web Browser control. See [IDocHostUIHandler::ResizeBorder](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753263\(v=vs.85\)) in the Windows SDK for more information.

## <a name="onshowcontextmenu"></a> CHtmlView::OnShowContextMenu

Called from Internet Explorer or MSHTML when it is about to show its context menu.

```
virtual HRESULT OnShowContextMenu(
    DWORD dwID,
    LPPOINT ppt,
    LPUNKNOWN pcmdtReserved,
    LPDISPATCH pdispReserved);
```

### Parameters

*dwID*<br/>
Identifier of the context menu to be displayed. See `IDocHostUIHandler::ShowContextMenu` in the Windows SDK for a list of values.

*ppt*<br/>
Screen coordinates for the menu.

*pcmdtReserved*<br/>
[IOleCommandTarget](/windows/win32/api/docobj/nn-docobj-iolecommandtarget) interface used to query command status and execute commands on this object.

*pdispReserved*<br/>
IDispatch interface of the object at the screen coordinates. This allows a host to differentiate particular objects to provide more specific context.

### Return Value

See [IDocHostUIHandler::ShowContextMenu](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753264\(v=vs.85\)) in the Windows SDK for a list of values.

### Remarks

Override `OnShowContextMenu` to react to the `ShowContextMenu` notification from the Microsoft Web Browser control. See [IDocHostUIHandler::ShowContextMenu](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753264\(v=vs.85\)) in the Windows SDK for more information.

## <a name="onshowui"></a> CHtmlView::OnShowUI

Called before Internet Explorer or MSHTML displays its menus and toolbars.

```
virtual HRESULT OnShowUI(
    DWORD dwID,
    LPOLEINPLACEACTIVEOBJECT pActiveObject,
    LPOLECOMMANDTARGET pCommandTarget,
    LPOLEINPLACEFRAME pFrame,
    LPOLEINPLACEUIWINDOW pDoc);
```

### Parameters

*dwID*<br/>
Reserved for future use.

*pActiveObject*<br/>
[IOleInPlaceActiveObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceactiveobject) interface of the currently active object.

*pCommandTarget*<br/>
[IOleCommandTarget](/windows/win32/api/docobj/nn-docobj-iolecommandtarget) interface of the object.

*pFrame*<br/>
[IOleInPlaceFrame](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceframe) interface of the object. This is needed for menus and toolbars.

*pDoc*<br/>
[IOleInPlaceUIWindow](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceuiwindow) interface for the object. This is needed for toolbars.

### Return Value

See [IDocHostUIHandler::ShowUI](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753265\(v=vs.85\)) in the Windows SDK for a list of values.

### Remarks

Override `OnShowUI` to react to the `ShowUI` notification from the Microsoft Web Browser control. See [IDocHostUIHandler::ShowUI](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753265\(v=vs.85\)) in the Windows SDK for more information.

## <a name="onstatusbar"></a> CHtmlView::OnStatusBar

This member function is called by the framework when the [StatusBar](/previous-versions//aa768270\(v=vs.85\)) property has changed.

```
virtual void OnStatusBar(BOOL bStatusBar);
```

### Parameters

*bStatusBar*<br/>
Nonzero if Internet Explorer's status bar is visible or zero otherwise.

## <a name="onstatustextchange"></a> CHtmlView::OnStatusTextChange

This member function is called by the framework to notify an application that the text of the status bar associated with the WebBrowser control has changed.

```
virtual void OnStatusTextChange(LPCTSTR lpszText);
```

### Parameters

*lpszText*<br/>
A string that contains the new status bar text.

## <a name="ontheatermode"></a> CHtmlView::OnTheaterMode

This member function is called by the framework when the [TheaterMode](/previous-versions/aa768273\(v=vs.85\)) property has changed.

```
virtual void OnTheaterMode(BOOL bTheaterMode);
```

### Parameters

*bTheaterMode*<br/>
Nonzero if Internet Explorer is in theater mode; zero otherwise.

## <a name="ontitlechange"></a> CHtmlView::OnTitleChange

This member function is called by the framework to notify an application if the title of a document in the WebBrowser control becomes available or changes.

```
virtual void OnTitleChange(LPCTSTR lpszText);
```

### Parameters

*lpszText*<br/>
The new document title.

### Remarks

For HTML, the title might change; while HTML is still downloading, the URL of the document is set as the title. After the real title (if there is one) is parsed from the HTML, the title is changed to reflect the actual title.

## <a name="ontoolbar"></a> CHtmlView::OnToolBar

This member function is called by the framework when the [ToolBar](/previous-versions/aa768274\(v=vs.85\)) property has changed.

```
virtual void OnToolBar(BOOL bToolBar);
```

### Parameters

*bToolBar*<br/>
Nonzero if Internet Explorer's toolbar is visible or zero otherwise.

## <a name="ontranslateaccelerator"></a> CHtmlView::OnTranslateAccelerator

Called by Internet Explorer or MSHTML when [IOleInPlaceActiveObject::TranslateAccelerator](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-translateaccelerator) or [IOleControlSite::TranslateAccelerator](/windows/win32/api/ocidl/nf-ocidl-iolecontrolsite-translateaccelerator) is called to process menu accelerator-key messages from the container's message queue.

```
virtual HRESULT OnTranslateAccelerator(
    LPMSG lpMsg,
    const GUID* pguidCmdGroup,
    DWORD nCmdID);
```

### Parameters

*lpMsg*<br/>
Points to the message that might need to be translated.

*pguidCmdGroup*<br/>
Command group identifier.

*nCmdID*<br/>
Command identifier.

### Return Value

S_OK if successful, or S_FALSE otherwise.

### Remarks

Override `OnTranslateAccelerator` to react to the `TranslateAccelerator` notification from the Microsoft Web Browser control. See [IDocHostUIHandler::TranslateAccelerator](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753266\(v=vs.85\)) in the Windows SDK for more information.

## <a name="ontranslateurl"></a> CHtmlView::OnTranslateUrl

Called by Internet Explorer or MSHTML to allow the host an opportunity to modify the URL to be loaded.

```
virtual HRESULT OnTranslateUrl(
    DWORD dwTranslate,
    OLECHAR* pchURLIn,
    OLECHAR** ppchURLOut);
```

### Parameters

*dwTranslate*<br/>
Reserved for future use.

*pchURLIn*<br/>
Address of a string supplied by Internet Explorer or MSHTML that represents the URL to be translated.

*ppchURLOut*<br/>
Address of a string pointer that receives the address of the translated URL. The host allocates the buffer using the task memory allocator. The contents of this parameter should always be initialized to NULL, even if the URL is not translated or the method fails.

### Return Value

`S_OK` if the URL was translated, S_FALSE if the URL was not translated, or an OLE-defined error code if an error occurred.

### Remarks

Override `OnTranslateUrl` to react to the `TranslateUrl` notification from the Microsoft Web Browser control. See [IDocHostUIHandler::TranslateUrl](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753267\(v=vs.85\)) in the Windows SDK for more information.

## <a name="onupdateui"></a> CHtmlView::OnUpdateUI

Notifies the host that the command state has changed.

```
virtual HRESULT OnUpdateUI();
```

### Return Value

S_OK if successful, or an OLE-defined error code otherwise.

### Remarks

The host should update the state of toolbar buttons. This method is called regardless of the return value from `ShowUI`. Override `OnUpdateUI` to react to the `UpdateUI` notification from the Microsoft Web Browser control.

## <a name="onvisible"></a> CHtmlView::OnVisible

This member function is called by the framework when the window for the WebBrowser should be shown or hidden.

```
virtual void OnVisible(BOOL bVisible);
```

### Parameters

*bVisible*<br/>
Nonzero if the object is visible or zero otherwise.

### Remarks

This allows the object control host window to behave the same way the Internet Explorer window would behave.

## <a name="putproperty"></a> CHtmlView::PutProperty

Call this member function to set the property associated with a given object.

```cpp
void PutProperty(
    LPCTSTR lpszProperty,
    const VARIANT& vtValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    double dValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    long lValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    LPCTSTR lpszValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    short nValue);
```

### Parameters

*lpszProperty*<br/>
A string containing the property to set.

*vtValue*<br/>
The new value of the property indicated by *lpszProperty*.

*lpszPropertyName*<br/>
A pointer to a string containing the name of the property to set.

*dValue*<br/>
The new value of the property.

*lValue*<br/>
The new value of the property.

*lpszValue*<br/>
A pointer to a string containing the new value of the property.

*nValue*<br/>
The new value of the property.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="queryformscommand"></a> CHtmlView::QueryFormsCommand

Queries for the status of one or more commands generated by user interface events.

```
HRESULT QueryFormsCommand(
    DWORD dwCommandID,
    BOOL* pbSupported,
    BOOL* pbEnabled,
    BOOL* pbChecked);
```

### Parameters

*dwCommandID*<br/>
The identifier of the command being queried for.

*pbSupported*<br/>
A pointer to a BOOL specifying if the command (identified by *dwCommandID*) is supported. If TRUE, the command is supported; otherwise FALSE.

*pbEnabled*<br/>
A pointer to a BOOL specifying if the command (identified by *dwCommandID*) is enabled. If TRUE, the command is supported; otherwise FALSE.

*pbChecked*<br/>
A pointer to a BOOL specifying if the command (identified by *dwCommandID*) is checked. If TRUE, the command is supported; otherwise FALSE.

### Return Value

A standard HRESULT value. For a complete listing of possible values, see [IOleCommandTarget::QueryStatus](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-querystatus) in the Windows SDK.

### Remarks

`QueryFormsCommand` implements the behavior of the [IOleCommandTarget::QueryStatus](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-querystatus) method.

## <a name="querystatuswb"></a> CHtmlView::QueryStatusWB

Call this member function to query a command status.

```
OLECMDF QueryStatusWB(OLECMDID cmdID) const;
```

### Parameters

*cmdID*<br/>
The [OLECMDID](/windows/win32/api/docobj/ne-docobj-olecmdid) value of the command for which the caller needs status information.

### Return Value

The address of the [OLECMDF](/windows/win32/api/docobj/ne-docobj-olecmdf) value that receives the status of the command.

### Remarks

`QueryStatusWB` implements the behavior of the [IOleCommandTarget::QueryStatus](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-querystatus) method.

Applies to Internet Explorer and WebBrowser.

## <a name="refresh"></a> CHtmlView::Refresh

Reloads the URL or file that the web browser is currently displaying.

```cpp
void Refresh();
```

### Remarks

`Refresh` contains no parameters for setting the refresh level.

Applies to Internet Explorer and WebBrowser.

## <a name="refresh2"></a> CHtmlView::Refresh2

Reloads the file that Internet Explorer is currently displaying.

```cpp
void Refresh2(int nLevel);
```

### Parameters

*nLevel*<br/>
The address of the variable specifying the refresh level. The possible variables are defined in [RefreshConstants](/previous-versions/aa768363\(v=vs.85\)), in the Windows SDK.

### Remarks

Unlike [Refresh](#refresh), `Refresh2` contains a parameter that specifies the refresh level.

Applies to Internet Explorer and WebBrowser.

## <a name="setaddressbar"></a> CHtmlView::SetAddressBar

Call this member function to show or hide the Internet Explorer object's address bar.

```cpp
void SetAddressBar(BOOL bNewValue);
```

### Parameters

*bNewValue*<br/>
Nonzero to show address bar; otherwise zero.

### Remarks

Applies to Internet Explorer. If you use this call with a WebBrowser control, it will return no error, but it will ignore this call.

## <a name="setfullscreen"></a> CHtmlView::SetFullScreen

Call this member function to set Internet Explorer to either full-screen or normal window mode.

```cpp
void SetFullScreen(BOOL bNewValue);
```

### Parameters

*bNewValue*<br/>
Nonzero for full-screen mode; otherwise zero.

### Remarks

In full-screen mode, the Internet Explorer main window is maximized and the status bar, toolbar, menu bar, and title bar are hidden.

Applies to Internet Explorer. If you use this call with a WebBrowser control, it will return no error, but it will ignore this call.

## <a name="setheight"></a> CHtmlView::SetHeight

Call this member function to set the height of the Internet Explorer main window.

```cpp
void SetHeight(long nNewValue);
```

### Parameters

*nNewValue*<br/>
The height, in pixels, of the main window.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="setleft"></a> CHtmlView::SetLeft

Sets the horizontal position of the Internet Explorer main window.

```cpp
void SetLeft(long nNewValue);
```

### Parameters

*nNewValue*<br/>
The screen coordinate of the left edge of the main window.

## <a name="setmenubar"></a> CHtmlView::SetMenuBar

Call this member function to show or hide the Internet Explorer menu bar.

```cpp
void SetMenuBar(BOOL bNewValue);
```

### Parameters

*bNewValue*<br/>
Nonzero to show menu bar; otherwise zero.

### Remarks

Applies to Internet Explorer. If you use this call with a WebBrowser control, it will return no error, but it will ignore this call.

## <a name="setoffline"></a> CHtmlView::SetOffline

Call this member function to set a value indicating whether the WebBrowser control is currently operating in offline mode.

```cpp
void SetOffline(BOOL bNewValue);
```

### Parameters

*bNewValue*<br/>
Nonzero to read from the local cache; otherwise zero.

### Remarks

In offline mode, the browser reads HTML pages from the local cache rather than from the source document.

Applies to Internet Explorer and WebBrowser.

## <a name="setregisterasbrowser"></a> CHtmlView::SetRegisterAsBrowser

Call this member function to set a value indicating whether the WebBrowser control is registered as a top-level browser for target name resolution.

```cpp
void SetRegisterAsBrowser(BOOL bNewValue);
```

### Parameters

*bNewValue*<br/>
Determines whether Internet Explorer is registered as a top-level browser. If nonzero, the web browser is registered as a top-level browser; if zero, it is not a top-level browser. The default value is zero.

### Remarks

A top-level browser is the browser set in the registry as the default browser.

Applies to Internet Explorer and WebBrowser.

## <a name="setregisterasdroptarget"></a> CHtmlView::SetRegisterAsDropTarget

Call this member function to set a value indicating whether the WebBrowser control is registered as a drop target for navigation.

```cpp
void SetRegisterAsDropTarget(BOOL bNewValue);
```

### Parameters

*bNewValue*<br/>
Determines if the WebBrowser control is registered as a drop target for navigation. If nonzero, the object is registered as a drop target; if zero, it is not a drop target.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="setsilent"></a> CHtmlView::SetSilent

Call this member function to set a value indicating whether any dialog boxes can be shown.

```cpp
void SetSilent(BOOL bNewValue);
```

### Parameters

*bNewValue*<br/>
If nonzero, dialog boxes will not be displayed; if zero, dialog boxes will be displayed. The default value is zero.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="setstatusbar"></a> CHtmlView::SetStatusBar

Call this member function to display the status bar.

```cpp
void SetStatusBar(BOOL bNewValue);
```

### Parameters

*bNewValue*<br/>
Nonzero if the status bar is visible; otherwise zero.

### Remarks

Applies to Internet Explorer. If you use this call with a WebBrowser control, it will return no error, but it will ignore this call.

## <a name="settheatermode"></a> CHtmlView::SetTheaterMode

Call this member function to set a value indicating whether the WebBrowser control is in theater mode.

```cpp
void SetTheaterMode(BOOL bNewValue);
```

### Parameters

*bNewValue*<br/>
Nonzero to set the WebBrowser control to theater mode; otherwise zero. The default value is zero.

### Remarks

When the web browser is in theater mode, the browser main window fills the entire screen, a toolbar with a minimal set of navigational tools appears, and the status bar appears in the upper right-hand corner of the screen.

Applies to Internet Explorer and WebBrowser.

## <a name="settoolbar"></a> CHtmlView::SetToolBar

Call this member function to show or hide the Internet Explorer toolbar.

```cpp
void SetToolBar(int nNewValue);
```

### Parameters

*nNewValue*<br/>
Indicates whether to display the toolbar. Nonzero if the toolbar is to be displayed; otherwise zero.

### Remarks

Applies to Internet Explorer. If you use this call with a WebBrowser control, it will return no error, but it will ignore this call.

## <a name="settop"></a> CHtmlView::SetTop

Call this member function to set the distance between the internal top edge of the WebBrowser control and the top edge of its container

```cpp
void SetTop(long nNewValue);
```

### Parameters

*nNewValue*<br/>
The screen coordinate of the top edge of the main window.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="setvisible"></a> CHtmlView::SetVisible

Call this member function to set the visibility state of the WebBrowser control.

```cpp
void SetVisible(BOOL bNewValue);
```

### Parameters

*bNewValue*<br/>
Nonzero if the control is visible; otherwise zero.

### Remarks

Applies to Internet Explorer and WebBrowser.

## <a name="setwidth"></a> CHtmlView::SetWidth

Sets the width of the Internet Explorer main window.

```cpp
void SetWidth(long nNewValue);
```

### Parameters

*nNewValue*<br/>
The width, in pixels, of the Internet Explorer main window.

## <a name="stop"></a> CHtmlView::Stop

Call this member function to cancel any pending navigation or download operation and stop any dynamic page elements, such as background sounds and animations.

```cpp
void Stop();
```

### Remarks

Applies to Internet Explorer and WebBrowser.

## See also

[MFC Sample MFCIE](../../overview/visual-cpp-samples.md)<br/>
[CFormView Class](../../mfc/reference/cformview-class.md)<br/>
[Hierarchy Chart](../../mfc/hierarchy-chart.md)<br/>
[IWebBrowser2](/windows/win32/api/exdisp/nn-exdisp-iwebbrowser2)

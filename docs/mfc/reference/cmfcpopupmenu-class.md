---
description: "Learn more about: CMFCPopupMenu Class"
title: "CMFCPopupMenu Class"
ms.date: "10/18/2018"
f1_keywords: ["CMFCPopupMenu", "AFXPOPUPMENU/CMFCPopupMenu", "AFXPOPUPMENU/CMFCPopupMenu::CMFCPopupMenu", "AFXPOPUPMENU/CMFCPopupMenu::ActivatePopupMenu", "AFXPOPUPMENU/CMFCPopupMenu::AlwaysShowEmptyToolsEntry", "AFXPOPUPMENU/CMFCPopupMenu::AreAllCommandsShown", "AFXPOPUPMENU/CMFCPopupMenu::CheckArea", "AFXPOPUPMENU/CMFCPopupMenu::CloseMenu", "AFXPOPUPMENU/CMFCPopupMenu::Create", "AFXPOPUPMENU/CMFCPopupMenu::DefaultMouseClickOnClose", "AFXPOPUPMENU/CMFCPopupMenu::EnableMenuLogo", "AFXPOPUPMENU/CMFCPopupMenu::EnableMenuSound", "AFXPOPUPMENU/CMFCPopupMenu::EnableResize", "AFXPOPUPMENU/CMFCPopupMenu::EnableScrolling", "AFXPOPUPMENU/CMFCPopupMenu::EnableVertResize", "AFXPOPUPMENU/CMFCPopupMenu::FindSubItemByCommand", "AFXPOPUPMENU/CMFCPopupMenu::GetActiveMenu", "AFXPOPUPMENU/CMFCPopupMenu::GetAnimationSpeed", "AFXPOPUPMENU/CMFCPopupMenu::GetAnimationType", "AFXPOPUPMENU/CMFCPopupMenu::GetDropDirection", "AFXPOPUPMENU/CMFCPopupMenu::GetForceMenuFocus", "AFXPOPUPMENU/CMFCPopupMenu::GetForceShadow", "AFXPOPUPMENU/CMFCPopupMenu::GetHMenu", "AFXPOPUPMENU/CMFCPopupMenu::GetMenuBar", "AFXPOPUPMENU/CMFCPopupMenu::GetMenuItem", "AFXPOPUPMENU/CMFCPopupMenu::GetMenuItemCount", "AFXPOPUPMENU/CMFCPopupMenu::GetMessageWnd", "AFXPOPUPMENU/CMFCPopupMenu::GetParentArea", "AFXPOPUPMENU/CMFCPopupMenu::GetParentButton", "AFXPOPUPMENU/CMFCPopupMenu::GetParentPopupMenu", "AFXPOPUPMENU/CMFCPopupMenu::GetParentRibbonElement", "AFXPOPUPMENU/CMFCPopupMenu::GetParentToolBar", "AFXPOPUPMENU/CMFCPopupMenu::GetQuickCustomizeType", "AFXPOPUPMENU/CMFCPopupMenu::GetSelItem", "AFXPOPUPMENU/CMFCPopupMenu::HasBeenResized", "AFXPOPUPMENU/CMFCPopupMenu::HideRarelyUsedCommands", "AFXPOPUPMENU/CMFCPopupMenu::InCommand", "AFXPOPUPMENU/CMFCPopupMenu::InsertItem", "AFXPOPUPMENU/CMFCPopupMenu::InsertSeparator", "AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysClose", "AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry", "AFXPOPUPMENU/CMFCPopupMenu::IsCustomizePane", "AFXPOPUPMENU/CMFCPopupMenu::IsEscClose", "AFXPOPUPMENU/CMFCPopupMenu::IsIdle", "AFXPOPUPMENU/CMFCPopupMenu::IsMenuSound", "AFXPOPUPMENU/CMFCPopupMenu::IsQuickCustomize", "AFXPOPUPMENU/CMFCPopupMenu::IsResizeble", "AFXPOPUPMENU/CMFCPopupMenu::IsRightAlign", "AFXPOPUPMENU/CMFCPopupMenu::IsScrollable", "AFXPOPUPMENU/CMFCPopupMenu::IsSendMenuSelectMsg", "AFXPOPUPMENU/CMFCPopupMenu::IsShown", "AFXPOPUPMENU/CMFCPopupMenu::MoveTo", "AFXPOPUPMENU/CMFCPopupMenu::OnCmdMsg", "AFXPOPUPMENU/CMFCPopupMenu::PostCommand", "AFXPOPUPMENU/CMFCPopupMenu::PreTranslateMessage", "AFXPOPUPMENU/CMFCPopupMenu::RecalcLayout", "AFXPOPUPMENU/CMFCPopupMenu::RemoveAllItems", "AFXPOPUPMENU/CMFCPopupMenu::RemoveItem", "AFXPOPUPMENU/CMFCPopupMenu::SaveState", "AFXPOPUPMENU/CMFCPopupMenu::SetAnimationSpeed", "AFXPOPUPMENU/CMFCPopupMenu::SetAnimationType", "AFXPOPUPMENU/CMFCPopupMenu::SetAutoDestroy", "AFXPOPUPMENU/CMFCPopupMenu::SetDefaultItem", "AFXPOPUPMENU/CMFCPopupMenu::SetForceMenuFocus", "AFXPOPUPMENU/CMFCPopupMenu::SetForceShadow", "AFXPOPUPMENU/CMFCPopupMenu::SetMaxWidth", "AFXPOPUPMENU/CMFCPopupMenu::SetMessageWnd", "AFXPOPUPMENU/CMFCPopupMenu::SetParentRibbonElement", "AFXPOPUPMENU/CMFCPopupMenu::SetQuickCustomizeType", "AFXPOPUPMENU/CMFCPopupMenu::SetQuickMode", "AFXPOPUPMENU/CMFCPopupMenu::SetRightAlign", "AFXPOPUPMENU/CMFCPopupMenu::SetSendMenuSelectMsg", "AFXPOPUPMENU/CMFCPopupMenu::ShowAllCommands", "AFXPOPUPMENU/CMFCPopupMenu::TriggerResize", "AFXPOPUPMENU/CMFCPopupMenu::UpdateAllShadows", "AFXPOPUPMENU/CMFCPopupMenu::UpdateShadow", "AFXPOPUPMENU/CMFCPopupMenu::CreateTearOffBar", "AFXPOPUPMENU/CMFCPopupMenu::OnChangeHot", "AFXPOPUPMENU/CMFCPopupMenu::OnChooseItem"]
helpviewer_keywords: ["CMFCPopupMenu [MFC], CMFCPopupMenu", "CMFCPopupMenu [MFC], ActivatePopupMenu", "CMFCPopupMenu [MFC], AlwaysShowEmptyToolsEntry", "CMFCPopupMenu [MFC], AreAllCommandsShown", "CMFCPopupMenu [MFC], CheckArea", "CMFCPopupMenu [MFC], CloseMenu", "CMFCPopupMenu [MFC], Create", "CMFCPopupMenu [MFC], DefaultMouseClickOnClose", "CMFCPopupMenu [MFC], EnableMenuLogo", "CMFCPopupMenu [MFC], EnableMenuSound", "CMFCPopupMenu [MFC], EnableResize", "CMFCPopupMenu [MFC], EnableScrolling", "CMFCPopupMenu [MFC], EnableVertResize", "CMFCPopupMenu [MFC], FindSubItemByCommand", "CMFCPopupMenu [MFC], GetActiveMenu", "CMFCPopupMenu [MFC], GetAnimationSpeed", "CMFCPopupMenu [MFC], GetAnimationType", "CMFCPopupMenu [MFC], GetDropDirection", "CMFCPopupMenu [MFC], GetForceMenuFocus", "CMFCPopupMenu [MFC], GetForceShadow", "CMFCPopupMenu [MFC], GetHMenu", "CMFCPopupMenu [MFC], GetMenuBar", "CMFCPopupMenu [MFC], GetMenuItem", "CMFCPopupMenu [MFC], GetMenuItemCount", "CMFCPopupMenu [MFC], GetMessageWnd", "CMFCPopupMenu [MFC], GetParentArea", "CMFCPopupMenu [MFC], GetParentButton", "CMFCPopupMenu [MFC], GetParentPopupMenu", "CMFCPopupMenu [MFC], GetParentRibbonElement", "CMFCPopupMenu [MFC], GetParentToolBar", "CMFCPopupMenu [MFC], GetQuickCustomizeType", "CMFCPopupMenu [MFC], GetSelItem", "CMFCPopupMenu [MFC], HasBeenResized", "CMFCPopupMenu [MFC], HideRarelyUsedCommands", "CMFCPopupMenu [MFC], InCommand", "CMFCPopupMenu [MFC], InsertItem", "CMFCPopupMenu [MFC], InsertSeparator", "CMFCPopupMenu [MFC], IsAlwaysClose", "CMFCPopupMenu [MFC], IsAlwaysShowEmptyToolsEntry", "CMFCPopupMenu [MFC], IsCustomizePane", "CMFCPopupMenu [MFC], IsEscClose", "CMFCPopupMenu [MFC], IsIdle", "CMFCPopupMenu [MFC], IsMenuSound", "CMFCPopupMenu [MFC], IsQuickCustomize", "CMFCPopupMenu [MFC], IsResizeble", "CMFCPopupMenu [MFC], IsRightAlign", "CMFCPopupMenu [MFC], IsScrollable", "CMFCPopupMenu [MFC], IsSendMenuSelectMsg", "CMFCPopupMenu [MFC], IsShown", "CMFCPopupMenu [MFC], MoveTo", "CMFCPopupMenu [MFC], OnCmdMsg", "CMFCPopupMenu [MFC], PostCommand", "CMFCPopupMenu [MFC], PreTranslateMessage", "CMFCPopupMenu [MFC], RecalcLayout", "CMFCPopupMenu [MFC], RemoveAllItems", "CMFCPopupMenu [MFC], RemoveItem", "CMFCPopupMenu [MFC], SaveState", "CMFCPopupMenu [MFC], SetAnimationSpeed", "CMFCPopupMenu [MFC], SetAnimationType", "CMFCPopupMenu [MFC], SetAutoDestroy", "CMFCPopupMenu [MFC], SetDefaultItem", "CMFCPopupMenu [MFC], SetForceMenuFocus", "CMFCPopupMenu [MFC], SetForceShadow", "CMFCPopupMenu [MFC], SetMaxWidth", "CMFCPopupMenu [MFC], SetMessageWnd", "CMFCPopupMenu [MFC], SetParentRibbonElement", "CMFCPopupMenu [MFC], SetQuickCustomizeType", "CMFCPopupMenu [MFC], SetQuickMode", "CMFCPopupMenu [MFC], SetRightAlign", "CMFCPopupMenu [MFC], SetSendMenuSelectMsg", "CMFCPopupMenu [MFC], ShowAllCommands", "CMFCPopupMenu [MFC], TriggerResize", "CMFCPopupMenu [MFC], UpdateAllShadows", "CMFCPopupMenu [MFC], UpdateShadow", "CMFCPopupMenu [MFC], CreateTearOffBar", "CMFCPopupMenu [MFC], OnChangeHot", "CMFCPopupMenu [MFC], OnChooseItem"]
ms.assetid: 9555dca1-8c9c-44c9-af72-0659ddad128e
---
# CMFCPopupMenu Class

Implements Windows pop-up menu functionality and extends it by adding features such as tear-off menus and tooltips.
For more detail see the source code located in the **VC\\atlmfc\\src\\mfc** folder of your Visual Studio installation.

## Syntax

```
class CMFCPopupMenu : public CMiniFrameWnd
```

## Members

### Protected Constructors

|Name|Description|
|----------|-----------------|
|[CMFCPopupMenu::CMFCPopupMenu](#cmfcpopupmenu)|Constructs a `CMFCPopupMenu` object.|

### Public Methods

|Name|Description|
|----------|-----------------|
|[CMFCPopupMenu::ActivatePopupMenu](#activatepopupmenu)||
|[CMFCPopupMenu::AlwaysShowEmptyToolsEntry](#alwaysshowemptytoolsentry)|Sets whether a pop-up menu is enabled to show empty entries for user-defined tools.|
|[CMFCPopupMenu::AreAllCommandsShown](#areallcommandsshown)||
|[CMFCPopupMenu::CheckArea](#checkarea)|Determines the location of a point relative to the pop-up menu.|
|[CMFCPopupMenu::CloseMenu](#closemenu)||
|[CMFCPopupMenu::Create](#create)|Creates a pop-up menu and attaches it to the `CMFCPopupMenu` object.|
|[CMFCPopupMenu::DefaultMouseClickOnClose](#defaultmouseclickonclose)||
|[CMFCPopupMenu::EnableMenuLogo](#enablemenulogo)|Initializes the logo for a pop-up menu.|
|[CMFCPopupMenu::EnableMenuSound](#enablemenusound)|Enables menu sound.|
|[CMFCPopupMenu::EnableResize](#enableresize)||
|[CMFCPopupMenu::EnableScrolling](#enablescrolling)||
|[CMFCPopupMenu::EnableVertResize](#enablevertresize)||
|[CMFCPopupMenu::FindSubItemByCommand](#findsubitembycommand)||
|[CMFCPopupMenu::GetActiveMenu](#getactivemenu)|Returns the currently active menu.|
|[CMFCPopupMenu::GetAnimationSpeed](#getanimationspeed)|Returns the animation speed for pop-up menus.|
|[CMFCPopupMenu::GetAnimationType](#getanimationtype)|Returns the current type of pop-up menu animation.|
|[CMFCPopupMenu::GetDropDirection](#getdropdirection)||
|[CMFCPopupMenu::GetForceMenuFocus](#getforcemenufocus)|Indicates whether the focus is returned to the menu bar when a pop-up menu is displayed.|
|[CMFCPopupMenu::GetForceShadow](#getforceshadow)||
|[CMFCPopupMenu::GetHMenu](#gethmenu)|Returns a handle to the attached menu resource.|
|[CMFCPopupMenu::GetMenuBar](#getmenubar)|Returns the [CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md) embedded inside the pop-up menu.|
|[CMFCPopupMenu::GetMenuItem](#getmenuitem)|Returns a pointer to the menu item at the specified index.|
|[CMFCPopupMenu::GetMenuItemCount](#getmenuitemcount)|Returns the number of items in a popup menu.|
|[CMFCPopupMenu::GetMessageWnd](#getmessagewnd)|Returns a pointer to the window where the framework routes the pop-up menu messages.|
|[CMFCPopupMenu::GetParentArea](#getparentarea)||
|[CMFCPopupMenu::GetParentButton](#getparentbutton)|Returns a pointer to the parent toolbar button.|
|[CMFCPopupMenu::GetParentPopupMenu](#getparentpopupmenu)|Returns a pointer to the parent pop-up menu.|
|[CMFCPopupMenu::GetParentRibbonElement](#getparentribbonelement)||
|[CMFCPopupMenu::GetParentToolBar](#getparenttoolbar)|Returns a pointer to the parent toolbar.|
|[CMFCPopupMenu::GetQuickCustomizeType](#getquickcustomizetype)||
|[CMFCPopupMenu::GetSelItem](#getselitem)|Returns a pointer to the currently selected menu command.|
|[CMFCPopupMenu::HasBeenResized](#hasbeenresized)||
|[CMFCPopupMenu::HideRarelyUsedCommands](#hiderarelyusedcommands)|Indicates whether the pop-up menu can hide rarely used commands.|
|[CMFCPopupMenu::InCommand](#incommand)||
|[CMFCPopupMenu::InsertItem](#insertitem)|Inserts a new item into the pop-up menu at the specified location.|
|[CMFCPopupMenu::InsertSeparator](#insertseparator)|Inserts a separator into the pop-up menu at the specified location.|
|[CMFCPopupMenu::IsAlwaysClose](#isalwaysclose)||
|[CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry](#isalwaysshowemptytoolsentry)||
|[CMFCPopupMenu::IsCustomizePane](#iscustomizepane)|Indicates whether the pop-up menu is functioning as a **QuickCustomizePane**.|
|[CMFCPopupMenu::IsEscClose](#isescclose)||
|[CMFCPopupMenu::IsIdle](#isidle)|Indicates whether a pop-up menu is currently idle.|
|[CMFCPopupMenu::IsMenuSound](#ismenusound)||
|[CMFCPopupMenu::IsQuickCustomize](#isquickcustomize)|Determines whether the associated [CMFCToolBarMenuButton Class](../../mfc/reference/cmfctoolbarmenubutton-class.md) is in QuickCustomize mode.|
|[CMFCPopupMenu::IsResizeble](#isresizeble)||
|[CMFCPopupMenu::IsRightAlign](#isrightalign)|Indicates whether the menu is right-aligned or left-aligned.|
|[CMFCPopupMenu::IsScrollable](#isscrollable)||
|[CMFCPopupMenu::IsSendMenuSelectMsg](#issendmenuselectmsg)|Indicates whether the framework notifies the parent frame when the user selects a command from the pop-up menu.|
|[CMFCPopupMenu::IsShown](#isshown)|Indicates whether the pop-up menu is currently visible.|
|[CMFCPopupMenu::MoveTo](#moveto)||
|[CMFCPopupMenu::OnCmdMsg](#oncmdmsg)|(Overrides `CFrameWnd::OnCmdMsg`.)|
|[CMFCPopupMenu::PostCommand](#postcommand)||
|[CMFCPopupMenu::PreTranslateMessage](#pretranslatemessage)|(Overrides `CFrameWnd::PreTranslateMessage`.)|
|[CMFCPopupMenu::RecalcLayout](#recalclayout)|Called by the framework when the standard control bars are toggled on or off or when the frame window is resized. (Overrides [CFrameWnd::RecalcLayout](../../mfc/reference/cframewnd-class.md#recalclayout).)|
|[CMFCPopupMenu::RemoveAllItems](#removeallitems)|Clears all the items from a pop-up menu.|
|[CMFCPopupMenu::RemoveItem](#removeitem)|Removes the specified item from a pop-up menu.|
|[CMFCPopupMenu::SaveState](#savestate)||
|[CMFCPopupMenu::SetAnimationSpeed](#setanimationspeed)|Sets the animation speed for pop-up menus.|
|[CMFCPopupMenu::SetAnimationType](#setanimationtype)|Sets the animation type for the pop-up menu.|
|[CMFCPopupMenu::SetAutoDestroy](#setautodestroy)||
|[CMFCPopupMenu::SetDefaultItem](#setdefaultitem)|Sets the default command for the pop-up menu.|
|[CMFCPopupMenu::SetForceMenuFocus](#setforcemenufocus)|Forces the input focus to return to the menu bar when a pop-up menu is displayed.|
|[CMFCPopupMenu::SetForceShadow](#setforceshadow)|Forces the framework to draw menu shadows when pop-up menus appear outside the main frame.|
|[CMFCPopupMenu::SetMaxWidth](#setmaxwidth)|Set the maximum width for the pop-up menu.|
|[CMFCPopupMenu::SetMessageWnd](#setmessagewnd)||
|[CMFCPopupMenu::SetParentRibbonElement](#setparentribbonelement)||
|[CMFCPopupMenu::SetQuickCustomizeType](#setquickcustomizetype)||
|[CMFCPopupMenu::SetQuickMode](#setquickmode)||
|[CMFCPopupMenu::SetRightAlign](#setrightalign)|Sets the menu alignment for pop-up menus.|
|[CMFCPopupMenu::SetSendMenuSelectMsg](#setsendmenuselectmsg)|Sets a flag that controls whether the pop-up menu notifies its parent frame when the user selects a command.|
|[CMFCPopupMenu::ShowAllCommands](#showallcommands)|Forces the pop-up menu to display all commands.|
|[CMFCPopupMenu::TriggerResize](#triggerresize)||
|[CMFCPopupMenu::UpdateAllShadows](#updateallshadows)|Updates the shadows for all opened pop-up menus.|
|[CMFCPopupMenu::UpdateShadow](#updateshadow)|Updates the shadow for the pop-up menu.|

### Protected Methods

|Name|Description|
|----------|-----------------|
|[CMFCPopupMenu::CreateTearOffBar](#createtearoffbar)||
|[CMFCPopupMenu::OnChangeHot](#onchangehot)||
|[CMFCPopupMenu::OnChooseItem](#onchooseitem)||

### Remarks

Normally, MFC creates pop-up menus automatically. If you want to create a `CMFCPopupMenu` object manually, allocate one on the heap and then call [CMFCPopupMenu::Create](#create).

## Example

The following example demonstrates how to configure a pop-up menu object. The example shows how to set the logo and the sound of the pop-up menu, set the animation speed and type, draw menu shadows when the pop-up menu appears outside the main frame, set the maximum width, and set the right menu alignment of the pop-up menu. This code snippet is part of the [Custom Pages sample](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_CustomPages#2](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_1.cpp)]

## Inheritance Hierarchy

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CFrameWnd](../../mfc/reference/cframewnd-class.md)

[CMiniFrameWnd](../../mfc/reference/cminiframewnd-class.md)

`CMFCPopupMenu`

## Requirements

**Header:** afxpopupmenu.h

## <a name="activatepopupmenu"></a> CMFCPopupMenu::ActivatePopupMenu

```
static BOOL __stdcall ActivatePopupMenu(
    CFrameWnd* pTopFrame,
    CMFCPopupMenu* pPopupMenu);
```

### Parameters

[in] *pTopFrame*<br/>
[in] *pPopupMenu*<br/>

### Return Value

### Remarks

## <a name="alwaysshowemptytoolsentry"></a> CMFCPopupMenu::AlwaysShowEmptyToolsEntry

Sets whether a pop-up menu is enabled to show empty entries for user-defined tools.

```
static void AlwaysShowEmptyToolsEntry(BOOL bShow = TRUE);
```

### Parameters

*bShow*<br/>
[in] TRUE if the pop-up menu can display empty entries; FALSE otherwise.

## <a name="areallcommandsshown"></a> CMFCPopupMenu::AreAllCommandsShown

```
BOOL AreAllCommandsShown() const;
```

### Return Value

### Remarks

## <a name="checkarea"></a> CMFCPopupMenu::CheckArea

Determines the location of a point relative to the pop-up menu.

```
MENUAREA_TYPE CheckArea(const CPoint& ptScreen) const;
```

### Parameters

*ptScreen*<br/>
[in] A point, in screen coordinates.

### Return Value

A MENUAREA_TYPE parameter that indicates where the point is relative to the pop-up menu.

### Remarks

A MENUAREA_TYPE parameter can have any one of the following values.

- OUTSIDE - *ptScreen* is outside the pop-up menu.

- LOGO - *ptScreen* is over a logo area.

- TEAROFF_CAPTION - *ptScreen* is over the tear-off caption.

- SHADOW_BOTTOM - *ptScreen* is over the bottom shadow of the pop-up menu.

- SHADOW_RIGHT - *ptScreen* is over the right shadow of the pop-up menu.

- MENU - *ptScreen* is over a command.

## <a name="closemenu"></a> CMFCPopupMenu::CloseMenu

```cpp
void CloseMenu(BOOL bSetFocusToBar = FALSE);
```

### Parameters

[in] *bSetFocusToBar*<br/>

### Remarks

## <a name="cmfcpopupmenu"></a> CMFCPopupMenu::CMFCPopupMenu

Constructs a [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) object.

```
CMFCPopupMenu(
    CMFCToolBarsMenuPropertyPage* pCustPage,
    LPCTSTR lpszTitle);
```

### Parameters

*pCustPage*<br/>
[in] A pointer to a customization page.

*lpszTitle*<br/>
[in] A string that contains the menu caption.

### Remarks

This method allocates the resources for a `CMFCPopupMenu`. To create the pop-up menu item, call [CMFCPopupMenu::Create](#create).

## <a name="create"></a> CMFCPopupMenu::Create

Creates a pop-up menu and attaches it to a [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) object.

```
virtual BOOL Create(
    CWnd* pWndParent,
    int x,
    int y,
    HMENU hMenu,
    BOOL bLocked = FALSE,
    BOOL bOwnMessage = FALSE);
```

### Parameters

*pWndParent*<br/>
[in] The parent window for the `CMFCPopupMenu`.

*x*<br/>
[in] The horizontal screen coordinate for the location of the pop-up menu

*y*<br/>
[in] The vertical screen coordinate for the location of the pop-menu.

*hMenu*<br/>
[in] A handle to a menu resource.

*bLocked*<br/>
[in] A Boolean parameter that indicates whether the menu is customizable. FALSE indicates that the pop-up menu is customizable.

*bOwnMessage*<br/>
[in] A Boolean parameter that indicates how the framework routes the menu messages. See the Remarks section for more details.

### Return Value

TRUE if the method is successful; otherwise FALSE.

### Remarks

If *bOwnMessage* is TRUE, the framework routes any menu messages to *pWndParent*. *pWndParent* must not be NULL if *bOwnMessage* is TRUE. If *bOwnMessage* is FALSE, the framework routes the menu messages to the parent pop-up menu.

### Example

The following example demonstrates how to use the `Create` method of the `CMFCPopuMenu` class. This code snippet is part of the [Custom Pages sample](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_CustomPages#1](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_2.cpp)]

## <a name="createtearoffbar"></a> CMFCPopupMenu::CreateTearOffBar

```
virtual CPane* CreateTearOffBar(
    CFrameWnd* pWndMain,
    UINT uiID,
    LPCTSTR lpszName);
```

### Parameters

[in] *pWndMain*<br/>
[in] *uiID*<br/>
[in] *lpszName*<br/>

### Return Value

### Remarks

## <a name="defaultmouseclickonclose"></a> CMFCPopupMenu::DefaultMouseClickOnClose

```
virtual BOOL DefaultMouseClickOnClose() const;
```

### Return Value

### Remarks

## <a name="enablemenulogo"></a> CMFCPopupMenu::EnableMenuLogo

Initializes the logo for a pop-up menu.

```cpp
void EnableMenuLogo(
    int iLogoSize,
    LOGO_LOCATION nLogoLocation = MENU_LOGO_LEFT);
```

### Parameters

*iLogoSize*<br/>
[in] The size of the logo, in pixels.

*nLogoLocation*<br/>
[in] An enumerated data type that indicates the location of the logo.

### Remarks

To display the logo, implement the method [CFrameWndEx::OnDrawMenuLogo](../../mfc/reference/cframewndex-class.md#ondrawmenulogo) in the main frame window.

The possible values for *nLogoLocation* are MENU_LOGO_LEFT, MENU_LOGO_RIGHT, MENU_LOGO_TOP, and MENU_LOGO_BOTTOM.

## <a name="enablemenusound"></a> CMFCPopupMenu::EnableMenuSound

Enables menu sound.

```
static void EnableMenuSound(BOOL bEnable = TRUE);
```

### Parameters

*bEnable*<br/>
[in] TRUE to enable sound, FALSE otherwise.

### Remarks

If you enable sound, the framework calls the [PlaySound](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iusernotification-playsound) method when a user opens a pop-up menu or selects a menu command. By default, this feature is enabled.

## <a name="enableresize"></a> CMFCPopupMenu::EnableResize

```cpp
void EnableResize(CSize sizeMinResize);
```

### Parameters

[in] *sizeMinResize*<br/>

### Remarks

## <a name="enablescrolling"></a> CMFCPopupMenu::EnableScrolling

```cpp
void EnableScrolling(BOOL = TRUE);
```

### Parameters

[in] *BOOL*<br/>

### Remarks

## <a name="enablevertresize"></a> CMFCPopupMenu::EnableVertResize

```cpp
void EnableVertResize(int nMinResize);
```

### Parameters

[in] *nMinResize*<br/>

### Remarks

## <a name="findsubitembycommand"></a> CMFCPopupMenu::FindSubItemByCommand

```
CMFCToolBarMenuButton* FindSubItemByCommand(UINT uiCmd) const;
```

### Parameters

[in] *uiCmd*<br/>

### Return Value

### Remarks

## <a name="getactivemenu"></a> CMFCPopupMenu::GetActiveMenu

Returns the currently active menu.

```
static CMFCPopupMenu* GetActiveMenu();
```

### Return Value

A pointer to the active pop-up menu, or NULL if no pop-up menu is currently active.

### Remarks

Each application can have at most one active pop-up menu.

## <a name="getanimationspeed"></a> CMFCPopupMenu::GetAnimationSpeed

Returns the animation speed for pop-up menus.

```
static UINT GetAnimationSpeed();
```

### Return Value

An integer that indicates the time, in milliseconds, that a pop-up menu animation takes to finish.

### Remarks

The animation speed is a global value. Use [CMFCPopupMenu::SetAnimationSpeed](#setanimationspeed) to change the animation speed for pop-up menus.

## <a name="getanimationtype"></a> CMFCPopupMenu::GetAnimationType

Returns the current type of pop-up animation.

```
static CMFCPopupMenu::ANIMATION_TYPE GetAnimationType(BOOL bNoSystem = FALSE);
```

### Parameters

*bNoSystem*<br/>
[in] A Boolean parameter that indicates whether this method checks the global value. FALSE if you want this method to return the animation style for this instance of the [CMFCPopupMenu Class](../../mfc/reference/cmfcpopupmenu-class.md).

### Return Value

An enumerated value that describes the animation type.

### Remarks

The style of animation for pop-up menus is global for your application. Use [CMFCPopupMenu::SetAnimationType](#setanimationtype) to set the animation style.

The following table lists the possible animation types.

|Value|Description|
|-|-|
|NO_ANIMATION|The pop-up menu is not animated and appears immediately.  |
|UNFOLD|The framework reveals the pop-up menu from the upper-left corner to the lower right corner.  |
|SLIDE|The pop-up menu moves from top to bottom.  |
|FADE|The pop-up menu first appears transparent and gradually solidifies.  |

## <a name="getdropdirection"></a> CMFCPopupMenu::GetDropDirection

```
DROP_DIRECTION GetDropDirection() const;
```

### Return Value

### Remarks

## <a name="getforcemenufocus"></a> CMFCPopupMenu::GetForceMenuFocus

Indicates whether the focus is returned to the menu bar when a pop-up menu is displayed.

```
static BOOL GetForceMenuFocus();
```

### Return Value

TRUE if the input focus is returned to the menu bar when a pop-up menu is displayed; FALSE if the pop-up menu retains the focus.

### Remarks

By default, your application does not return focus to the menu bar. To change this setting, use [CMFCPopupMenu::SetForceMenuFocus](#setforcemenufocus).

## <a name="getforceshadow"></a> CMFCPopupMenu::GetForceShadow

```
static BOOL __stdcall GetForceShadow();
```

### Return Value

### Remarks

## <a name="gethmenu"></a> CMFCPopupMenu::GetHMenu

Returns a handle to the attached menu resource.

```
HMENU GetHMenu();
```

## <a name="getmenubar"></a> CMFCPopupMenu::GetMenuBar

Returns the [CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md) embedded inside the pop-up menu.

```
virtual CMFCPopupMenuBar* GetMenuBar();
```

### Return Value

A pointer to the embedded `CMFCPopupMenuBar`.

### Remarks

The pop-up menu has an embedded `CMFCPopupMenuBar` object. You must override this method in a derived class if you are using a different embedded class.

## <a name="getmenuitem"></a> CMFCPopupMenu::GetMenuItem

Returns a pointer to the menu item at the specified index.

```
CMFCToolBarMenuButton* GetMenuItem(int iIndex) const;
```

### Parameters

*iIndex*<br/>
[in] The zero-based index of a menu item.

### Return Value

A pointer to a menu item. NULL if the index is invalid.

### Remarks

Menu items are represented by the [CMFCToolBarMenuButton Class](../../mfc/reference/cmfctoolbarmenubutton-class.md). When you call this method, it returns a pointer to the appropriate `CMFCToolBarMenuButton`.

## <a name="getmenuitemcount"></a> CMFCPopupMenu::GetMenuItemCount

Returns the number of items in a pop-up menu.

```
int GetMenuItemCount() const;
```

### Return Value

The number of items in the menu.

## <a name="getmessagewnd"></a> CMFCPopupMenu::GetMessageWnd

Returns a pointer to the window where the framework routes the pop-up menu messages.

```
CWnd* GetMessageWnd() const;
```

### Return Value

A pointer to the window that receives the pop-up menu messages; NULL if there is no window.

### Remarks

When you use the method [CMFCPopupMenu::Create](#create) to create a pop-up menu, you specify what window receives the menu messages.

## <a name="getparentarea"></a> CMFCPopupMenu::GetParentArea

```
virtual CWnd* GetParentArea(CRect& rectParentBtn);
```

### Parameters

[in] *rectParentBtn*<br/>

### Return Value

### Remarks

## <a name="getparentbutton"></a> CMFCPopupMenu::GetParentButton

Returns a pointer to the parent toolbar button.

```
CMFCToolBarMenuButton* GetParentButton() const;
```

### Return Value

A pointer to the parent toolbar button. NULL if the pop-up menu has no parent toolbar button.

### Remarks

A `CMFCPopupMenu` can be associated with a button on the menu. In this scenario, the pop-up menu appears when a user selects the parent toolbar button.

If the pop-up menu is a shortcut menu, it will have no parent toolbar button.

## <a name="getparentpopupmenu"></a> CMFCPopupMenu::GetParentPopupMenu

Returns a pointer to the parent pop-up menu.

```
CMFCPopupMenu* GetParentPopupMenu() const;
```

### Return Value

A pointer to the parent `CMFCPopupMenu` object; NULL if there is no parent pop-up menu.

### Remarks

A pop-up menu has a parent `CMFCPopupMenu` object only if it is a submenu.

## <a name="getparentribbonelement"></a> CMFCPopupMenu::GetParentRibbonElement

```
CMFCRibbonBaseElement* GetParentRibbonElement() const;
```

### Return Value

### Remarks

## <a name="getparenttoolbar"></a> CMFCPopupMenu::GetParentToolBar

Returns a pointer to the parent toolbar.

```
CMFCToolBar* GetParentToolBar() const;
```

### Return Value

A pointer to the parent toolbar. NULL if the pop-up menu has no parent toolbar.

### Remarks

If the `CMFCPopupMenu` is a shortcut menu, then it has no parent toolbar.

## <a name="getquickcustomizetype"></a> CMFCPopupMenu::GetQuickCustomizeType

```
QUICK_CUSTOMIZE_TYPE GetQuickCustomizeType() const;
```

### Return Value

### Remarks

## <a name="getselitem"></a> CMFCPopupMenu::GetSelItem

Returns a pointer to the currently selected menu command.

```
CMFCToolBarMenuButton* GetSelItem();
```

### Return Value

A pointer to the currently selected menu command; NULL if no item is selected.

### Remarks

The menu commands on a pop-up menu are represented by the [CMFCToolBarMenuButton Class](../../mfc/reference/cmfctoolbarmenubutton-class.md), or a class derived from `CMFCToolBarMenuButton`.

## <a name="hasbeenresized"></a> CMFCPopupMenu::HasBeenResized

```
BOOL HasBeenResized() const;
```

### Return Value

### Remarks

## <a name="hiderarelyusedcommands"></a> CMFCPopupMenu::HideRarelyUsedCommands

Indicates whether the pop-up menu can hide rarely used commands.

```
BOOL HideRarelyUsedCommands() const;
```

### Return Value

TRUE if the pop-up menu can hide the rarely used commands; otherwise FALSE.

### Remarks

This method specifies only whether a pop-up menu can hide rarely used commands, not if that configuration is enabled. A pop-up menu can hide rarely used commands if it has a parent button and the parent window is derived from the [CMFCMenuBar Class](../../mfc/reference/cmfcmenubar-class.md). Use [CMFCMenuBar::SetRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#setrecentlyusedmenus) to enable this feature and [CMFCMenuBar::IsRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#isrecentlyusedmenus) to determine if this feature is currently enabled. You must call both of these methods for the parent window.

## <a name="incommand"></a> CMFCPopupMenu::InCommand

```
virtual BOOL InCommand();
```

### Return Value

### Remarks

## <a name="insertitem"></a> CMFCPopupMenu::InsertItem

Inserts a new item into the pop-up menu at the specified location.

```
int InsertItem(
    const CMFCToolBarMenuButton& button,
    int iInsertA = -1);
```

### Parameters

*button*<br/>
[in] A reference to the menu item to add.

*iInsertAt*<br/>
[in] The zero-based index for the new item. If *iInsertAt* is -1, the item is added to the end of the menu.

### Return Value

The zero-based index of the position where the item was inserted. -1 if the method fails.

### Remarks

This method will fail if you provide an invalid value for *iInsertAt*, such as an integer larger than the number of items currently on the pop-up menu.

## <a name="insertseparator"></a> CMFCPopupMenu::InsertSeparator

Inserts a separator into the pop-up menu at the specified location.

```
int InsertSeparator(int iInsertAt = -1);
```

### Parameters

*iInsertAt*<br/>
[in] The zero-based index of the position where this method will insert the separator.

### Return Value

The zero-based index of the position where the separator was inserted. -1 if this method fails.

### Remarks

A value of -1 for *iInsertAt* means this method will add the separator to the end of the pop-up menu.

This method fails if *iInsertAt* is an invalid value.

## <a name="isalwaysclose"></a> CMFCPopupMenu::IsAlwaysClose

```
virtual BOOL IsAlwaysClose() const;
```

### Return Value

### Remarks

## <a name="isalwaysshowemptytoolsentry"></a> CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry

```
static BOOL __stdcall IsAlwaysShowEmptyToolsEntry();
```

### Return Value

### Remarks

## <a name="iscustomizepane"></a> CMFCPopupMenu::IsCustomizePane

Indicates whether the pop-up menu is functioning as a **QuickCustomizePane**.

```
BOOL IsCustomizePane();
```

### Return Value

TRUE if the pop-up is a **QuckCustomizePane**; otherwise FALSE.

### Remarks

Use the **QuickCustomizePane** to enable the user to directly customize the pop-up menu. The **QuickCustomizePane** is a `CMFCPopupMenu` that appears when the user clicks on a toolbar button to edit it directly.

Your application should call this method during [CMDIFrameWndEx::OnShowCustomizePane](../../mfc/reference/cmdiframewndex-class.md#onshowcustomizepane).

## <a name="isescclose"></a> CMFCPopupMenu::IsEscClose

```
BOOL IsEscClose();
```

### Return Value

### Remarks

## <a name="isidle"></a> CMFCPopupMenu::IsIdle

Indicates whether a pop-up menu is currently idle.

```
virtual BOOL IsIdle() const;
```

### Return Value

TRUE if the pop-up menu is in idle mode; otherwise FALSE.

### Remarks

By default, a pop-up menu is in idle mode if the display animation is complete and the user is not scrolling the pop-up menu.

## <a name="ismenusound"></a> CMFCPopupMenu::IsMenuSound

```
static UINT __stdcall IsMenuSound();
```

### Return Value

### Remarks

## <a name="isquickcustomize"></a> CMFCPopupMenu::IsQuickCustomize

Determines whether the associated [CMFCToolBarMenuButton Class](../../mfc/reference/cmfctoolbarmenubutton-class.md) is in QuickCustomize mode.

```
BOOL IsQuickCustomize();
```

### Return Value

TRUE if the associated menu button is in QuickCustomize mode; otherwise FALSE. This method will also return FALSE if the pop-up menu is not associated with a `CMFCToolBarMenuButton`.

### Remarks

In QuickCustomize mode the user selects a button on a toolbar to customize the button directly.

## <a name="isresizeble"></a> CMFCPopupMenu::IsResizeble

```
BOOL IsResizeble() const;
```

### Return Value

### Remarks

## <a name="isrightalign"></a> CMFCPopupMenu::IsRightAlign

Indicates whether the menu is right-aligned or left-aligned.

```
BOOL IsRightAlign() const;
```

### Return Value

TRUE if the menu is right-aligned; FALSE if the menu left-aligned.

### Remarks

You can use [CMFCPopupMenu::SetRightAlign](#setrightalign) to set the menu alignment. By default, pop-up menus use left-alignment.

Menu alignment is not a global setting and can vary between pop-up menus.

## <a name="isscrollable"></a> CMFCPopupMenu::IsScrollable

```
BOOL IsScrollable() const;
```

### Return Value

### Remarks

## <a name="issendmenuselectmsg"></a> CMFCPopupMenu::IsSendMenuSelectMsg

Indicates whether the framework notifies the parent frame when the user selects a command from the pop-up menu.

```
static BOOL IsSendMenuSelectMsg();
```

### Return Value

TRUE if the framework notifies the parent frame; otherwise FALSE.

### Remarks

The framework notifies the parent frame by sending it the WM_MENUSELECT message when a used selects a menu command.

## <a name="isshown"></a> CMFCPopupMenu::IsShown

Indicates whether the pop-up menu is currently visible.

```
BOOL IsShown() const;
```

### Return Value

TRUE if a pop-up menu is visible; otherwise FALSE.

## <a name="moveto"></a> CMFCPopupMenu::MoveTo

```cpp
void MoveTo(const CPoint& pt);
```

### Parameters

[in] *pt*<br/>

### Remarks

## <a name="onchangehot"></a> CMFCPopupMenu::OnChangeHot

```
virtual void OnChangeHot(int nHot);
```

### Parameters

[in] *nHot*<br/>

### Remarks

## <a name="onchooseitem"></a> CMFCPopupMenu::OnChooseItem

```
virtual void OnChooseItem(UINT uidCmdID);
```

### Parameters

[in] *uidCmdID*<br/>

### Remarks

## <a name="oncmdmsg"></a> CMFCPopupMenu::OnCmdMsg

```
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### Parameters

[in] *nID*<br/>
[in] *nCode*<br/>
[in] *pExtra*<br/>
[in] *pHandlerInfo*<br/>

### Return Value

### Remarks

## <a name="postcommand"></a> CMFCPopupMenu::PostCommand

```
BOOL PostCommand(UINT uiCommandID);
```

### Parameters

[in] *uiCommandID*<br/>

### Return Value

### Remarks

## <a name="pretranslatemessage"></a> CMFCPopupMenu::PreTranslateMessage

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### Parameters

[in] *pMsg*<br/>

### Return Value

### Remarks

## <a name="recalclayout"></a> CMFCPopupMenu::RecalcLayout

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### Parameters

[in] *bNotify*<br/>

### Remarks

## <a name="removeallitems"></a> CMFCPopupMenu::RemoveAllItems

Clears all the items from a pop-up menu.

```cpp
void RemoveAllItems();
```

## <a name="removeitem"></a> CMFCPopupMenu::RemoveItem

Removes the specified item from the pop-up menu.

```
BOOL RemoveItem(int iIndex);
```

### Parameters

*iIndex*<br/>
[in] The zero-based index of the item to delete.

### Return Value

TRUE if the method is successful; otherwise FALSE.

### Remarks

This method automatically arranges any separators that are affected by the removal of an item. For more information about how the framework rearranges separators, see [CMFCToolBar::RemoveButton](../../mfc/reference/cmfctoolbar-class.md#removebutton).

## <a name="savestate"></a> CMFCPopupMenu::SaveState

```
virtual void SaveState();
```

### Remarks

## <a name="setanimationspeed"></a> CMFCPopupMenu::SetAnimationSpeed

Sets the animation speed for pop-up menus.

```
static void SetAnimationSpeed(UINT nElapse);
```

### Parameters

*nElapse*<br/>
[in] The new animation speed, in milliseconds.

### Remarks

The animation speed is a global value and affects all the pop-up menus in the application. This value specifies how long it takes for the animation for a pop-up menu to finish.

By default, this parameter is set to 30 milliseconds. The range of valid values for *nElapse* is from 0 to 200.

## <a name="setanimationtype"></a> CMFCPopupMenu::SetAnimationType

Sets the animation type for this pop-up menu.

```
static void SetAnimationType(CMFCPopupMenu::ANIMATION_TYPE type);
```

### Parameters

*type*<br/>
[in] An enumerated data type that specifies the type of animation.

### Remarks

See [CMFCPopupMenu::GetAnimationType](#getanimationtype) for a list of valid values for *type*.

## <a name="setautodestroy"></a> CMFCPopupMenu::SetAutoDestroy

```cpp
void SetAutoDestroy(BOOL bAutoDestroy = TRUE);
```

### Parameters

[in] *bAutoDestroy*<br/>

### Remarks

## <a name="setdefaultitem"></a> CMFCPopupMenu::SetDefaultItem

Sets the default command for the pop-up menu.

```cpp
void SetDefaultItem(UINT uiCmd);
```

### Parameters

*uiCmd*<br/>
[in] The menu command ID of the new default command.

### Remarks

The default command in the pop-up menu is the command that is selected when the pop-up menu appears.

## <a name="setforcemenufocus"></a> CMFCPopupMenu::SetForceMenuFocus

Forces the input focus to return to the menu bar when a pop-up menu is displayed.

```
static void SetForceMenuFocus(BOOL bValue);
```

### Parameters

*bValue*<br/>
[in] TRUE if you want the framework to force the input focus to the menu bar when a pop-up menu is displayed. FALSE if you want the pop-up menu to retain the focus.

### Remarks

This method sets a flag that is global for all pop-up menus in the application. By default, this feature is not enabled.

## <a name="setforceshadow"></a> CMFCPopupMenu::SetForceShadow

Forces the framework to draw menu shadows when pop-up menus appear outside the main frame.

```
static void SetForceShadow(BOOL bValue);
```

### Parameters

*bValue*<br/>
[in] TRUE if you want the framework to draw menu shadows, FALSE otherwise.

### Remarks

When you call this method, it sets a global flag in your application. This flag affects all pop-up menus in your application.

## <a name="setmaxwidth"></a> CMFCPopupMenu::SetMaxWidth

Set the maximum width for the pop-up menu.

```cpp
void SetMaxWidth(int iMaxWidth);
```

### Parameters

*iMaxWidth*<br/>
[in] The maximum width for the pop-up menu, in pixels.

### Remarks

If the text associated with a menu command will not fit in the maximum width, it is truncated and the part that does not fit is replaced by three dots.

## <a name="setmessagewnd"></a> CMFCPopupMenu::SetMessageWnd

```cpp
void SetMessageWnd(CWnd* pMsgWnd);
```

### Parameters

[in] *pMsgWnd*<br/>

### Remarks

## <a name="setparentribbonelement"></a> CMFCPopupMenu::SetParentRibbonElement

```cpp
void SetParentRibbonElement(CMFCRibbonBaseElement* pElem);
```

### Parameters

[in] *pElem*<br/>

### Remarks

## <a name="setquickcustomizetype"></a> CMFCPopupMenu::SetQuickCustomizeType

```cpp
void SetQuickCustomizeType(QUICK_CUSTOMIZE_TYPE Type);
```

### Parameters

[in] *Type*<br/>

### Remarks

## <a name="setquickmode"></a> CMFCPopupMenu::SetQuickMode

```cpp
void SetQuickMode();
```

### Remarks

## <a name="setrightalign"></a> CMFCPopupMenu::SetRightAlign

Sets the menu alignment for pop-up menus.

```cpp
void SetRightAlign(BOOL bRightAlign = TRUE);
```

### Parameters

*bRightAlign*<br/>
[in] A Boolean that indicates the menu alignment. TRUE indicates right alignment, FALSE indicates left alignment.

### Remarks

By default, all pop-up menus are left-aligned.

## <a name="setsendmenuselectmsg"></a> CMFCPopupMenu::SetSendMenuSelectMsg

Sets a flag that controls whether the pop-up menu notifies its parent frame when the user selects a command.

```
static void SetSendMenuSelectMsg(BOOL bSet = TRUE);
```

### Parameters

*bSet*<br/>
[in] TRUE if the pop-up menu notifies its parent frame, FALSE otherwise.

### Remarks

This is a global option for all the pop-up menus in an application. If it is enabled, the pop-up menus will send a WM_MENUSELECT message to the parent frame when the user selects a command.

## <a name="showallcommands"></a> CMFCPopupMenu::ShowAllCommands

Forces the pop-up menu to display all commands.

```cpp
void ShowAllCommands();
```

### Remarks

This is not a global setting and affects only the current pop-up menu.

## <a name="triggerresize"></a> CMFCPopupMenu::TriggerResize

```cpp
void TriggerResize();
```

### Remarks

## <a name="updateallshadows"></a> CMFCPopupMenu::UpdateAllShadows

Updates the shadows for all opened pop-up menus.

```
static void UpdateAllShadows(LPRECT lprectScreen = NULL);
```

### Parameters

*lprectScreen*<br/>
[in] A rectangle that specifies the region to update, in screen coordinates.

### Remarks

This method is useful when pop-up menus are displayed over animated controls or other windows that have dynamic content.

## <a name="updateshadow"></a> CMFCPopupMenu::UpdateShadow

Updates the shadow for the pop-up menu.

```cpp
void UpdateShadow(LPRECT lprectScreen = NULL);
```

### Parameters

*lprectScreen*<br/>
[in] A rectangle, in screen coordinates, that specifies the boundaries of the region to update.

### Remarks

Call this method when a pop-up menu that has a shadow overlaps an animated image.

## See also

[Hierarchy Chart](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CMFCPopupMenuBar Class](../../mfc/reference/cmfcpopupmenubar-class.md)

---
title: "CMFCRibbonBar Class"
description: "Learn more about: CMFCRibbonBar Class"
ms.date: "11/04/2016"
f1_keywords: ["CMFCRibbonBar", "AFXRIBBONBAR/CMFCRibbonBar", "AFXRIBBONBAR/CMFCRibbonBar::ActivateContextCategory", "AFXRIBBONBAR/CMFCRibbonBar::AddCategory", "AFXRIBBONBAR/CMFCRibbonBar::AddContextCategory", "AFXRIBBONBAR/CMFCRibbonBar::AddMainCategory", "AFXRIBBONBAR/CMFCRibbonBar::AddPrintPreviewCategory", "AFXRIBBONBAR/CMFCRibbonBar::AddQATOnlyCategory", "AFXRIBBONBAR/CMFCRibbonBar::AddToTabs", "AFXRIBBONBAR/CMFCRibbonBar::CreateEx", "AFXRIBBONBAR/CMFCRibbonBar::Create", "AFXRIBBONBAR/CMFCRibbonBar::DeactivateKeyboardFocus", "AFXRIBBONBAR/CMFCRibbonBar::DrawMenuImage", "AFXRIBBONBAR/CMFCRibbonBar::DWMCompositionChanged", "AFXRIBBONBAR/CMFCRibbonBar::EnableKeyTips", "AFXRIBBONBAR/CMFCRibbonBar::EnablePrintPreview", "AFXRIBBONBAR/CMFCRibbonBar::EnableToolTips", "AFXRIBBONBAR/CMFCRibbonBar::FindByData", "AFXRIBBONBAR/CMFCRibbonBar::FindByID", "AFXRIBBONBAR/CMFCRibbonBar::FindCategoryIndexByData", "AFXRIBBONBAR/CMFCRibbonBar::ForceRecalcLayout", "AFXRIBBONBAR/CMFCRibbonBar::GetActiveCategory", "AFXRIBBONBAR/CMFCRibbonBar::GetCaptionHeight", "AFXRIBBONBAR/CMFCRibbonBar::GetCategory", "AFXRIBBONBAR/CMFCRibbonBar::GetCategoryCount", "AFXRIBBONBAR/CMFCRibbonBar::GetCategoryHeight", "AFXRIBBONBAR/CMFCRibbonBar::GetCategoryIndex", "AFXRIBBONBAR/CMFCRibbonBar::GetContextName", "AFXRIBBONBAR/CMFCRibbonBar::GetDroppedDown", "AFXRIBBONBAR/CMFCRibbonBar::GetElementsByID", "AFXRIBBONBAR/CMFCRibbonBar::GetApplicationButton", "AFXRIBBONBAR/CMFCRibbonBar::GetFocused", "AFXRIBBONBAR/CMFCRibbonBar::GetHideFlags", "AFXRIBBONBAR/CMFCRibbonBar::GetItemIDsList", "AFXRIBBONBAR/CMFCRibbonBar::GetKeyboardNavigationLevel", "AFXRIBBONBAR/CMFCRibbonBar::GetKeyboardNavLevelCurrent", "AFXRIBBONBAR/CMFCRibbonBar::GetKeyboardNavLevelParent", "AFXRIBBONBAR/CMFCRibbonBar::GetMainCategory", "AFXRIBBONBAR/CMFCRibbonBar::GetQATCommandsLocation", "AFXRIBBONBAR/CMFCRibbonBar::GetQATDroppedDown", "AFXRIBBONBAR/CMFCRibbonBar::GetQuickAccessCommands", "AFXRIBBONBAR/CMFCRibbonBar::GetQuickAccessToolbarLocation", "AFXRIBBONBAR/CMFCRibbonBar::GetTabTrancateRatio", "AFXRIBBONBAR/CMFCRibbonBar::GetTooltipFixedWidthLargeImage", "AFXRIBBONBAR/CMFCRibbonBar::GetTooltipFixedWidthRegular", "AFXRIBBONBAR/CMFCRibbonBar::GetVisibleCategoryCount", "AFXRIBBONBAR/CMFCRibbonBar::HideAllContextCategories", "AFXRIBBONBAR/CMFCRibbonBar::HideKeyTips", "AFXRIBBONBAR/CMFCRibbonBar::HitTest", "AFXRIBBONBAR/CMFCRibbonBar::IsKeyTipEnabled", "AFXRIBBONBAR/CMFCRibbonBar::IsMainRibbonBar", "AFXRIBBONBAR/CMFCRibbonBar::IsPrintPreviewEnabled", "AFXRIBBONBAR/CMFCRibbonBar::IsQATEmpty", "AFXRIBBONBAR/CMFCRibbonBar::IsQuickAccessToolbarOnTop", "AFXRIBBONBAR/CMFCRibbonBar::IsReplaceFrameCaption", "AFXRIBBONBAR/CMFCRibbonBar::IsShowGroupBorder", "AFXRIBBONBAR/CMFCRibbonBar::IsToolTipDescrEnabled", "AFXRIBBONBAR/CMFCRibbonBar::IsToolTipEnabled", "AFXRIBBONBAR/CMFCRibbonBar::IsTransparentCaption", "AFXRIBBONBAR/CMFCRibbonBar::IsWindows7Look", "AFXRIBBONBAR/CMFCRibbonBar::LoadFromResource", "AFXRIBBONBAR/CMFCRibbonBar::OnClickButton", "AFXRIBBONBAR/CMFCRibbonBar::OnEditContextMenu", "AFXRIBBONBAR/CMFCRibbonBar::OnRTLChanged", "AFXRIBBONBAR/CMFCRibbonBar::OnSetAccData", "AFXRIBBONBAR/CMFCRibbonBar::OnShowRibbonContextMenu", "AFXRIBBONBAR/CMFCRibbonBar::OnShowRibbonQATMenu", "AFXRIBBONBAR/CMFCRibbonBar::OnSysKeyDown", "AFXRIBBONBAR/CMFCRibbonBar::OnSysKeyUp", "AFXRIBBONBAR/CMFCRibbonBar::PopTooltip", "AFXRIBBONBAR/CMFCRibbonBar::PreTranslateMessage", "AFXRIBBONBAR/CMFCRibbonBar::RecalcLayout", "AFXRIBBONBAR/CMFCRibbonBar::RemoveAllCategories", "AFXRIBBONBAR/CMFCRibbonBar::RemoveAllFromTabs", "AFXRIBBONBAR/CMFCRibbonBar::RemoveCategory", "AFXRIBBONBAR/CMFCRibbonBar::SaveToXMLBuffer", "AFXRIBBONBAR/CMFCRibbonBar::SaveToXMLFile", "AFXRIBBONBAR/CMFCRibbonBar::SetActiveCategory", "AFXRIBBONBAR/CMFCRibbonBar::SetActiveMDIChild", "AFXRIBBONBAR/CMFCRibbonBar::SetElementKeys", "AFXRIBBONBAR/CMFCRibbonBar::SetApplicationButton", "AFXRIBBONBAR/CMFCRibbonBar::SetKeyboardNavigationLevel", "AFXRIBBONBAR/CMFCRibbonBar::SetMaximizeMode", "AFXRIBBONBAR/CMFCRibbonBar::SetQuickAccessCommands", "AFXRIBBONBAR/CMFCRibbonBar::SetQuickAccessDefaultState", "AFXRIBBONBAR/CMFCRibbonBar::SetQuickAccessToolbarOnTop", "AFXRIBBONBAR/CMFCRibbonBar::SetTooltipFixedWidth", "AFXRIBBONBAR/CMFCRibbonBar::SetWindows7Look", "AFXRIBBONBAR/CMFCRibbonBar::ShowCategory", "AFXRIBBONBAR/CMFCRibbonBar::ShowContextCategories", "AFXRIBBONBAR/CMFCRibbonBar::ShowKeyTips", "AFXRIBBONBAR/CMFCRibbonBar::ToggleMimimizeState", "AFXRIBBONBAR/CMFCRibbonBar::TranslateChar"]
helpviewer_keywords: ["CMFCRibbonBar [MFC], ActivateContextCategory", "CMFCRibbonBar [MFC], AddCategory", "CMFCRibbonBar [MFC], AddContextCategory", "CMFCRibbonBar [MFC], AddMainCategory", "CMFCRibbonBar [MFC], AddPrintPreviewCategory", "CMFCRibbonBar [MFC], AddQATOnlyCategory", "CMFCRibbonBar [MFC], AddToTabs", "CMFCRibbonBar [MFC], CreateEx", "CMFCRibbonBar [MFC], Create", "CMFCRibbonBar [MFC], DeactivateKeyboardFocus", "CMFCRibbonBar [MFC], DrawMenuImage", "CMFCRibbonBar [MFC], DWMCompositionChanged", "CMFCRibbonBar [MFC], EnableKeyTips", "CMFCRibbonBar [MFC], EnablePrintPreview", "CMFCRibbonBar [MFC], EnableToolTips", "CMFCRibbonBar [MFC], FindByData", "CMFCRibbonBar [MFC], FindByID", "CMFCRibbonBar [MFC], FindCategoryIndexByData", "CMFCRibbonBar [MFC], ForceRecalcLayout", "CMFCRibbonBar [MFC], GetActiveCategory", "CMFCRibbonBar [MFC], GetCaptionHeight", "CMFCRibbonBar [MFC], GetCategory", "CMFCRibbonBar [MFC], GetCategoryCount", "CMFCRibbonBar [MFC], GetCategoryHeight", "CMFCRibbonBar [MFC], GetCategoryIndex", "CMFCRibbonBar [MFC], GetContextName", "CMFCRibbonBar [MFC], GetDroppedDown", "CMFCRibbonBar [MFC], GetElementsByID", "CMFCRibbonBar [MFC], GetApplicationButton", "CMFCRibbonBar [MFC], GetFocused", "CMFCRibbonBar [MFC], GetHideFlags", "CMFCRibbonBar [MFC], GetItemIDsList", "CMFCRibbonBar [MFC], GetKeyboardNavigationLevel", "CMFCRibbonBar [MFC], GetKeyboardNavLevelCurrent", "CMFCRibbonBar [MFC], GetKeyboardNavLevelParent", "CMFCRibbonBar [MFC], GetMainCategory", "CMFCRibbonBar [MFC], GetQATCommandsLocation", "CMFCRibbonBar [MFC], GetQATDroppedDown", "CMFCRibbonBar [MFC], GetQuickAccessCommands", "CMFCRibbonBar [MFC], GetQuickAccessToolbarLocation", "CMFCRibbonBar [MFC], GetTabTrancateRatio", "CMFCRibbonBar [MFC], GetTooltipFixedWidthLargeImage", "CMFCRibbonBar [MFC], GetTooltipFixedWidthRegular", "CMFCRibbonBar [MFC], GetVisibleCategoryCount", "CMFCRibbonBar [MFC], HideAllContextCategories", "CMFCRibbonBar [MFC], HideKeyTips", "CMFCRibbonBar [MFC], HitTest", "CMFCRibbonBar [MFC], IsKeyTipEnabled", "CMFCRibbonBar [MFC], IsMainRibbonBar", "CMFCRibbonBar [MFC], IsPrintPreviewEnabled", "CMFCRibbonBar [MFC], IsQATEmpty", "CMFCRibbonBar [MFC], IsQuickAccessToolbarOnTop", "CMFCRibbonBar [MFC], IsReplaceFrameCaption", "CMFCRibbonBar [MFC], IsShowGroupBorder", "CMFCRibbonBar [MFC], IsToolTipDescrEnabled", "CMFCRibbonBar [MFC], IsToolTipEnabled", "CMFCRibbonBar [MFC], IsTransparentCaption", "CMFCRibbonBar [MFC], IsWindows7Look", "CMFCRibbonBar [MFC], LoadFromResource", "CMFCRibbonBar [MFC], OnClickButton", "CMFCRibbonBar [MFC], OnEditContextMenu", "CMFCRibbonBar [MFC], OnRTLChanged", "CMFCRibbonBar [MFC], OnSetAccData", "CMFCRibbonBar [MFC], OnShowRibbonContextMenu", "CMFCRibbonBar [MFC], OnShowRibbonQATMenu", "CMFCRibbonBar [MFC], OnSysKeyDown", "CMFCRibbonBar [MFC], OnSysKeyUp", "CMFCRibbonBar [MFC], PopTooltip", "CMFCRibbonBar [MFC], PreTranslateMessage", "CMFCRibbonBar [MFC], RecalcLayout", "CMFCRibbonBar [MFC], RemoveAllCategories", "CMFCRibbonBar [MFC], RemoveAllFromTabs", "CMFCRibbonBar [MFC], RemoveCategory", "CMFCRibbonBar [MFC], SaveToXMLBuffer", "CMFCRibbonBar [MFC], SaveToXMLFile", "CMFCRibbonBar [MFC], SetActiveCategory", "CMFCRibbonBar [MFC], SetActiveMDIChild", "CMFCRibbonBar [MFC], SetElementKeys", "CMFCRibbonBar [MFC], SetApplicationButton", "CMFCRibbonBar [MFC], SetKeyboardNavigationLevel", "CMFCRibbonBar [MFC], SetMaximizeMode", "CMFCRibbonBar [MFC], SetQuickAccessCommands", "CMFCRibbonBar [MFC], SetQuickAccessDefaultState", "CMFCRibbonBar [MFC], SetQuickAccessToolbarOnTop", "CMFCRibbonBar [MFC], SetTooltipFixedWidth", "CMFCRibbonBar [MFC], SetWindows7Look", "CMFCRibbonBar [MFC], ShowCategory", "CMFCRibbonBar [MFC], ShowContextCategories", "CMFCRibbonBar [MFC], ShowKeyTips", "CMFCRibbonBar [MFC], ToggleMimimizeState", "CMFCRibbonBar [MFC], TranslateChar"]
---
# `CMFCRibbonBar` Class

The `CMFCRibbonBar` class implements a ribbon bar similar to that used in Office 2007.

For more detail, see the source code located in the `mfc` folder of your Visual Studio installation. For example, `%ProgramFiles(x86)%\Microsoft Visual Studio\2019\Enterprise\VC\Tools\MSVC\14.29.30133\atlmfc\src\mfc`.

## Syntax

```
class CMFCRibbonBar : public CPane
```

## Members

### Public Constructors

|Name|Description|
|----------|-----------------|
|`CMFCRibbonBar::CMFCRibbonBar`|Default constructor.|

### Public Methods

|Name|Description|
|----------|-----------------|
|[`CMFCRibbonBar::ActivateContextCategory`](#activatecontextcategory)|Activates a context category that is already visible.|
|[`CMFCRibbonBar::AddCategory`](#addcategory)|Adds a new ribbon category to the ribbon.|
|[`CMFCRibbonBar::AddContextCategory`](#addcontextcategory)|Adds a context category.|
|[`CMFCRibbonBar::AddMainCategory`](#addmaincategory)|Adds a new main ribbon category.|
|[`CMFCRibbonBar::AddPrintPreviewCategory`](#addprintpreviewcategory)||
|[`CMFCRibbonBar::AddQATOnlyCategory`](#addqatonlycategory)||
|[`CMFCRibbonBar::AddToTabs`](#addtotabs)|Add a ribbon element to the right side of a ribbon bar.|
|[`CMFCRibbonBar::CreateEx`](#createex)|Creates a control bar and attaches it to the [`CPane`](../../mfc/reference/cpane-class.md) object. (Overrides [`CPane::CreateEx`](../../mfc/reference/cpane-class.md#createex).)|
|[`CMFCRibbonBar::Create`](#create)|Creates a ribbon bar control and attaches it to a ribbon bar.|
|[`CMFCRibbonBar::DeactivateKeyboardFocus`](#deactivatekeyboardfocus)||
|[`CMFCRibbonBar::DrawMenuImage`](#drawmenuimage)||
|[`CMFCRibbonBar::DWMCompositionChanged`](#dwmcompositionchanged)||
|[`CMFCRibbonBar::EnableKeyTips`](#enablekeytips)|Enable or disable key tips for the ribbon control.|
|[`CMFCRibbonBar::EnablePrintPreview`](#enableprintpreview)|Enable the **Print Preview** tab.|
|[`CMFCRibbonBar::EnableToolTips`](#enabletooltips)|Enables or disables tooltips and tooltip descriptions on the ribbon bar.|
|[`CMFCRibbonBar::FindByData`](#findbydata)|Find a ribbon element by using data that a user specifies.|
|[`CMFCRibbonBar::FindByID`](#findbyid)|Finds a ribbon element that has the specified command ID.|
|[`CMFCRibbonBar::FindCategoryIndexByData`](#findcategoryindexbydata)|Finds the index of the ribbon category that contains the user-defined data.|
|[`CMFCRibbonBar::ForceRecalcLayout`](#forcerecalclayout)||
|[`CMFCRibbonBar::GetActiveCategory`](#getactivecategory)|Gets a pointer to an active category.|
|[`CMFCRibbonBar::GetCaptionHeight`](#getcaptionheight)|Returns the caption height. (Overrides [`CBasePane::GetCaptionHeight`](../../mfc/reference/cbasepane-class.md#getcaptionheight).)|
|[`CMFCRibbonBar::GetCategory`](#getcategory)|Gets the pointer to a category located at a specified index.|
|[`CMFCRibbonBar::GetCategoryCount`](#getcategorycount)|Gets the number of the ribbon categories in the ribbon bar.|
|[`CMFCRibbonBar::GetCategoryHeight`](#getcategoryheight)||
|[`CMFCRibbonBar::GetCategoryIndex`](#getcategoryindex)|Returns the index of a ribbon category.|
|[`CMFCRibbonBar::GetContextName`](#getcontextname)|Retrieves the name of the context category caption that you specify by using an ID.|
|[`CMFCRibbonBar::GetDroppedDown`](#getdroppeddown)||
|[`CMFCRibbonBar::GetElementsByID`](#getelementsbyid)|Gets an array that contains the pointers to all the ribbon elements that have the specified ID.|
|[`CMFCRibbonBar::GetApplicationButton`](#getapplicationbutton)|Gets a pointer to a ribbon button.|
|[`CMFCRibbonBar::GetFocused`](#getfocused)|Returns a focused element.|
|[`CMFCRibbonBar::GetHideFlags`](#gethideflags)||
|[`CMFCRibbonBar::GetItemIDsList`](#getitemidslist)||
|[`CMFCRibbonBar::GetKeyboardNavigationLevel`](#getkeyboardnavigationlevel)||
|[`CMFCRibbonBar::GetKeyboardNavLevelCurrent`](#getkeyboardnavlevelcurrent)||
|[`CMFCRibbonBar::GetKeyboardNavLevelParent`](#getkeyboardnavlevelparent)||
|[`CMFCRibbonBar::GetMainCategory`](#getmaincategory)|Returns a pointer to the ribbon category that is currently selected.|
|[`CMFCRibbonBar::GetQATCommandsLocation`](#getqatcommandslocation)||
|[`CMFCRibbonBar::GetQATDroppedDown`](#getqatdroppeddown)||
|[`CMFCRibbonBar::GetQuickAccessCommands`](#getquickaccesscommands)|Fills a list that contains the command IDs of all the elements that appear on the Quick Access Toolbar.|
|[`CMFCRibbonBar::GetQuickAccessToolbarLocation`](#getquickaccesstoolbarlocation)||
|[`CMFCRibbonBar::GetTabTrancateRatio`](#gettabtrancateratio)||
|[`CMFCRibbonBar::GetTooltipFixedWidthLargeImage`](#gettooltipfixedwidthlargeimage)||
|[`CMFCRibbonBar::GetTooltipFixedWidthRegular`](#gettooltipfixedwidthregular)||
|[`CMFCRibbonBar::GetVisibleCategoryCount`](#getvisiblecategorycount)||
|[`CMFCRibbonBar::HideAllContextCategories`](#hideallcontextcategories)|Hides all the categories that are active and visible.|
|[`CMFCRibbonBar::HideKeyTips`](#hidekeytips)||
|[`CMFCRibbonBar::HitTest`](#hittest)|Finds a pointer to the ribbon element that is located at the specified point in the ribbon bar's client coordinates.|
|[`CMFCRibbonBar::IsKeyTipEnabled`](#iskeytipenabled)|Determines whether keytips are enabled.|
|[`CMFCRibbonBar::IsMainRibbonBar`](#ismainribbonbar)||
|[`CMFCRibbonBar::IsPrintPreviewEnabled`](#isprintpreviewenabled)|Determines whether the **Print Preview** tab is enabled.|
|[`CMFCRibbonBar::IsQATEmpty`](#isqatempty)||
|[`CMFCRibbonBar::IsQuickAccessToolbarOnTop`](#isquickaccesstoolbarontop)|Specifies whether the Quick Access Toolbar is located above the ribbon bar.|
|[`CMFCRibbonBar::IsReplaceFrameCaption`](#isreplaceframecaption)|Determines whether the ribbon bar replaces the main frame caption, or is added below the frame caption.|
|[`CMFCRibbonBar::IsShowGroupBorder`](#isshowgroupborder)||
|[`CMFCRibbonBar::IsToolTipDescrEnabled`](#istooltipdescrenabled)|Determines whether the tooltip descriptions are enabled.|
|[`CMFCRibbonBar::IsToolTipEnabled`](#istooltipenabled)|Determines whether the tooltips for the ribbon bar are enabled.|
|[`CMFCRibbonBar::IsTransparentCaption`](#istransparentcaption)||
|[`CMFCRibbonBar::IsWindows7Look`](#iswindows7look)|Indicates whether the ribbon has Windows 7-style look (small rectangular application button).|
|[`CMFCRibbonBar::LoadFromResource`](#loadfromresource)|Overloaded. Loads a Ribbon Bar from application resources.|
|[`CMFCRibbonBar::OnClickButton`](#onclickbutton)||
|[`CMFCRibbonBar::OnEditContextMenu`](#oneditcontextmenu)||
|[`CMFCRibbonBar::OnRTLChanged`](#onrtlchanged)|(Overrides `CPane::OnRTLChanged`.)|
|[`CMFCRibbonBar::OnSetAccData`](#onsetaccdata)|(Overrides [`CBasePane::OnSetAccData`](../../mfc/reference/cbasepane-class.md#onsetaccdata).)|
|[`CMFCRibbonBar::OnShowRibbonContextMenu`](#onshowribboncontextmenu)||
|[`CMFCRibbonBar::OnShowRibbonQATMenu`](#onshowribbonqatmenu)||
|[`CMFCRibbonBar::OnSysKeyDown`](#onsyskeydown)||
|[`CMFCRibbonBar::OnSysKeyUp`](#onsyskeyup)||
|[`CMFCRibbonBar::PopTooltip`](#poptooltip)||
|[`CMFCRibbonBar::PreTranslateMessage`](#pretranslatemessage)|(Overrides `CBasePane::PreTranslateMessage`.)|
|[`CMFCRibbonBar::RecalcLayout`](#recalclayout)|(Overrides [`CPane::RecalcLayout`](../../mfc/reference/cpane-class.md#recalclayout).)|
|[`CMFCRibbonBar::RemoveAllCategories`](#removeallcategories)|Removes all the ribbon categories from the ribbon bar.|
|[`CMFCRibbonBar::RemoveAllFromTabs`](#removeallfromtabs)|Removes all ribbon elements from the tab area.|
|[`CMFCRibbonBar::RemoveCategory`](#removecategory)|Removes the ribbon category that is located at the specified index.|
|[`CMFCRibbonBar::SaveToXMLBuffer`](#savetoxmlbuffer)|Saves the Ribbon Bar to a buffer.|
|[`CMFCRibbonBar::SaveToXMLFile`](#savetoxmlfile)|Saves the Ribbon Bar to XML file.|
|[`CMFCRibbonBar::SetActiveCategory`](#setactivecategory)|Sets a specified ribbon category to active.|
|[`CMFCRibbonBar::SetActiveMDIChild`](#setactivemdichild)||
|[`CMFCRibbonBar::SetElementKeys`](#setelementkeys)|Sets the specified keytips for all ribbon elements that have the specified command ID.|
|[`CMFCRibbonBar::SetApplicationButton`](#setapplicationbutton)|Assigns an application ribbon button to the ribbon bar.|
|[`CMFCRibbonBar::SetKeyboardNavigationLevel`](#setkeyboardnavigationlevel)||
|[`CMFCRibbonBar::SetMaximizeMode`](#setmaximizemode)||
|[`CMFCRibbonBar::SetQuickAccessCommands`](#setquickaccesscommands)|Adds one or more ribbon elements to the Quick Access Toolbar.|
|[`CMFCRibbonBar::SetQuickAccessDefaultState`](#setquickaccessdefaultstate)|Specifies the default state for the Quick Access Toolbar.|
|[`CMFCRibbonBar::SetQuickAccessToolbarOnTop`](#setquickaccesstoolbarontop)|Positions the Quick Access Toolbar (QAT) above or below the ribbon bar.|
|[`CMFCRibbonBar::SetTooltipFixedWidth`](#settooltipfixedwidth)||
|[`CMFCRibbonBar::SetWindows7Look`](#setwindows7look)|Enable/disable ribbon Windows 7-style look (small rectangular application button)|
|[`CMFCRibbonBar::ShowCategory`](#showcategory)|Shows or hides the specified ribbon category.|
|[`CMFCRibbonBar::ShowContextCategories`](#showcontextcategories)|Shows or hides the context categories that have the specified ID.|
|[`CMFCRibbonBar::ShowKeyTips`](#showkeytips)||
|[`CMFCRibbonBar::ToggleMimimizeState`](#togglemimimizestate)|Toggles the ribbon bar between the minimized and maximized states.|
|[`CMFCRibbonBar::TranslateChar`](#translatechar)||

## Remarks

Microsoft introduced the Office Fluent Ribbon when it simultaneously released Microsoft Office 2007. This ribbon bar isn't just a new control. It represents a new user-interface paradigm. The ribbon is a pane that contains a set of tabs called categories. Each category is logically split into ribbon panels and each panel can contain various controls and command buttons.

The elements that appear on the ribbon bar expand and contract to make the best use of available space. For example, if a ribbon panel has insufficient space to display its elements, it becomes a menu button that displays subitems on a pop-up menu. The ribbon bar behaves as a static (non-floating) control bar and can be docked at the top of a frame.

You can use the `CMFCRibbonStatusBar` class to implement a status bar similar to the one used in Office 2007. A ribbon category contains (and displays) a group of [ribbon panels](../../mfc/reference/cmfcribbonpanel-class.md). Each ribbon panel contains one or more ribbon elements, which are derived from [`CMFCRibbonBaseElement`](../../mfc/reference/cmfcribbonbaseelement-class.md).

For information about how to add a ribbon bar to your existing MFC application, see [Walkthrough: Updating the MFC Scribble Application](../../mfc/walkthrough-updating-the-mfc-scribble-application-part-1.md).

## Inheritance Hierarchy

[`CObject`](../../mfc/reference/cobject-class.md)

[`CCmdTarget`](../../mfc/reference/ccmdtarget-class.md)

[`CWnd`](../../mfc/reference/cwnd-class.md)

[`CBasePane`](../../mfc/reference/cbasepane-class.md)

[`CPane`](../../mfc/reference/cpane-class.md)

[`CMFCRibbonBar`](../../mfc/reference/cmfcribbonbar-class.md)

## Requirements

**Header:** `afxribbonbar.h`

## <a name="activatecontextcategory"></a> `CMFCRibbonBar::ActivateContextCategory`

Activates a context category that is already visible.

```
BOOL ActivateContextCategory(UINT uiContextID);
```

### Parameters

*`uiContextID`*\
[in] The context category ID.

### Return Value

`TRUE` if a context category with *`uiContextID`* is found and activated; otherwise `FALSE`.

## <a name="addcategory"></a> `CMFCRibbonBar::AddCategory`

Creates and initializes a new ribbon category for the ribbon bar.

```
CMFCRibbonCategory* AddCategory(
    LPCTSTR lpszName,
    UINT uiSmallImagesResID,
    UINT uiLargeImagesResID,
    CSize sizeSmallImage= CSize(16,
    16),
    CSize sizeLargeImage= CSize(32,
    32),
    int nInsertAt = -1,
    CRuntimeClass* pRTI= NULL);
```

### Parameters

*`lpszName`*\
[in] Name of the ribbon category.

*`uiSmallImagesResID`*\
[in] Resource ID of the small image list for the ribbon category.

*`uiLargeImagesResID`*\
[in] Resource ID of the large image list for the ribbon category.

*`sizeSmallImage`*\
[in] Specifies the size of small images for the ribbon category.

*`sizeLargeImage`*\
[in] Specifies the size of large images for the ribbon category.

*`nInsertAt`*\
[in] Zero based index of the category location.

*`pRTI`*\
[in] Pointer to a [`CMFCRibbonCategory` Class](../../mfc/reference/cmfcribboncategory-class.md) run-time class to dynamically create a ribbon category at run-time.

### Return Value

A pointer to the new ribbon category if the method was successful; otherwise, `NULL`.

### Remarks

If the *`pRTI`* parameter isn't `NULL`, the new ribbon category is created dynamically using the run-time class.

### Example

The following example demonstrates how to use the `AddCategory` method in the `CMFCRibbonBar` class.

[!code-cpp[NVC_MFC_RibbonApp#5](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_1.cpp)]

## <a name="addcontextcategory"></a> `CMFCRibbonBar::AddContextCategory`

Creates and initializes a new context category for the ribbon bar.

```
CMFCRibbonCategory* AddContextCategory(
    LPCTSTR lpszName,
    LPCTSTR lpszContextName,
    UINT uiContextID,
    AFX_RibbonCategoryColor clrContext,
    UINT uiSmallImagesResID,
    UINT uiLargeImagesResID,
    CSize sizeSmallImage = CSize(16,
    16),
    CSize sizeLargeImage = CSize(32,
    32),
    CRuntimeClass* pRTI = NULL);
```

### Parameters

*`lpszName`*\
[in] Name of the category.

*`lpszContextName`*\
[in] Name of the context category caption.

*`uiContextID`*\
[in] Context ID.

*`clrContext`*\
[in] Color of the context category caption.

*`uiSmallImagesResID`*\
[in] Resource ID of the small image of a context category.

*`uiLargeImagesResID`*\
[in] Resource ID of the large image of a context category.

*`sizeSmallImage`*\
[in] Size of a small image.

*`sizeLargeImage`*\
[in] Size of a large image.

*`pRTI`*\
[in] Pointer to a runtime class.

### Return Value

A pointer to the newly created category, or `NULL` if the `CreateObject` method of *`pRTI`* can't create the specified category.

### Remarks

Use this function to add a context category. Context categories are a special type of category that can be shown or hidden at runtime, depending on the current application context. For example, when the user selects an object, you can display special tabs with context categories, which you use to change the specific selected object.

The color of a context category can be one of the following values:

- `AFX_CategoryColor_None`

- `AFX_CategoryColor_Red`

- `AFX_CategoryColor_Orange`

- `AFX_CategoryColor_Yellow`

- `AFX_CategoryColor_Green`

- `AFX_CategoryColor_Blue`

- `AFX_CategoryColor_Indigo`

- `AFX_CategoryColor_Violet`

## <a name="addmaincategory"></a> `CMFCRibbonBar::AddMainCategory`

Creates a new main ribbon category for the ribbon bar.

```
CMFCRibbonMainPanel* AddMainCategory(
    LPCTSTR lpszName,
    UINT uiSmallImagesResID,
    UINT uiLargeImagesResID,
    CSize sizeSmallImage = CSize(16,
    16),
    CSize sizeLargeImage = CSize(32,
    32));
```

### Parameters

*`lpszName`*\
[in] Name of the main ribbon category.

*`uiSmallImagesResID`*\
[in] Resource ID of small images.

*`uiLargeImagesResID`*\
[in] Resource ID of large images.

*`sizeSmallImage`*\
[in] The size of small images.

*`sizeLargeImage`*\
[in] The size of large images.

### Return Value

Pointer to the new main ribbon category if the method was successful; otherwise, `NULL`.

### Remarks

If a main ribbon category already exists, it's deleted.

### Example

The following example demonstrates how to use the `AddMainCategory` method in the `CMFCRibbonBar` class.

[!code-cpp[NVC_MFC_RibbonApp#4](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_2.cpp)]

## <a name="addprintpreviewcategory"></a> `CMFCRibbonBar::AddPrintPreviewCategory`

Creates a print preview category on the ribbon bar.

```
CMFCRibbonCategory* AddPrintPreviewCategory();
```

### Return Value

A pointer to the new ribbon category if the method was successful; otherwise, `NULL`.

### Remarks

This method creates a ribbon category and the controls that it needs in order to provide a print preview.

## <a name="addqatonlycategory"></a> `CMFCRibbonBar::AddQATOnlyCategory`

Creates a quick access toolbar ribbon category.

```
CMFCRibbonCategory* AddQATOnlyCategory(
    LPCTSTR lpszName,
    UINT uiSmallImagesResID,
    CSize sizeSmallImage = CSize(16,
    16));
```

### Parameters

*`lpszName`*\
[in] Name of the category.

*`uiSmallImagesResID`*\
[in] Resource ID of the image list for the category.

*`sizeSmallImage`*\
[in] Size of images for ribbon elements in the category.

### Return Value

A pointer to the new category if the method was successful; otherwise, `NULL`.

### Remarks

The quick access toolbar ribbon category is only used on the quick access toolbar customization dialog box.

## <a name="addtotabs"></a> `CMFCRibbonBar::AddToTabs`

Adds the specified ribbon element to the tabs row of the ribbon bar.

```cpp
void AddToTabs(CMFCRibbonBaseElement* pElement);
```

### Parameters

*`pElement`*\
[in] Pointer to a ribbon element.

### Remarks

The ribbon element is positioned before any system buttons.

## <a name="cmfcribbonbar"></a> `CMFCRibbonBar::CMFCRibbonBar`

Constructs and initializes a [`CMFCRibbonBar`](../../mfc/reference/cmfcribbonbar-class.md) object.

```
CMFCRibbonBar(BOOL bReplaceFrameCaption = TRUE);
```

### Parameters

*`bReplaceFrameCaption`*\
[in] `TRUE` for the ribbon bar to replace the caption of the main frame window; `FALSE` to locate the ribbon bar under the caption of the main frame window.

### Remarks

## <a name="create"></a> `CMFCRibbonBar::Create`

Creates a window for the ribbon bar.

```
BOOL Create(
    CWnd* pParentWnd,
    DWORD dwStyle = WS_CHILD | WS_VISIBLE | CBRS_TOP,
    UINT nID = AFX_IDW_RIBBON_BAR);
```

### Parameters

*`pParentWnd`*\
[in] Pointer to the parent window for the ribbon bar.

*`dwStyle`*\
[in] A logical combination of styles for the new window.

*`nID`*\
[in] ID of the new window.

### Return Value

`TRUE` if the window was created; otherwise `FALSE`.

### Remarks

### Example

The following example demonstrates how to use the `Create` method of the `CMFCRibbonBar` class.

[!code-cpp[NVC_MFC_RibbonApp#1](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_3.cpp)]

## <a name="createex"></a> `CMFCRibbonBar::CreateEx`

Creates a window for the ribbon bar.

```
BOOL CreateEx(
    CWnd* pParentWnd,
    DWORD dwCtrlStyle = 0,
    DWORD dwStyle = WS_CHILD | WS_VISIBLE | CBRS_TOP,
    UINT nID = AFX_IDW_RIBBON_BAR);
```

### Parameters

*`pParentWnd`*\
[in] Pointer to the parent window for the ribbon bar.

*`dwCtrlStyle`*\
[in] This parameter isn't used.

*`dwStyle`*\
[in] A logical combination of styles for the new window.

*`nID`*\
[in] ID of the new window.

### Return Value

`TRUE` if the window was created; otherwise `FALSE`.

### Remarks

## <a name="deactivatekeyboardfocus"></a> `CMFCRibbonBar::DeactivateKeyboardFocus`

Closes all keytip controls on the ribbon bar.

```cpp
void DeactivateKeyboardFocus(BOOL bSetFocus = TRUE);
```

### Parameters

*`bSetFocus`*\
[in] `TRUE` to set the focus to the parent window of the ribbon bar.

### Remarks

## <a name="drawmenuimage"></a> `CMFCRibbonBar::DrawMenuImage`

Draws the image for a menu button.

```
BOOL DrawMenuImage(
    CDC* pDC,
    const CMFCToolBarMenuButton* pMenuItem,
    const CRect& rectImage);
```

### Parameters

*`pDC`*\
[in] Pointer to a device context for the menu button.

*`pMenuItem`*\
[in] Pointer to a toolbar menu button.

*`rectImage`*\
[in] The display rectangle for a menu button.

### Return Value

`TRUE` if the image was drawn; otherwise `FALSE`.

### Remarks

## <a name="dwmcompositionchanged"></a> `CMFCRibbonBar::DWMCompositionChanged`

Adjusts the display of the ribbon bar when Desktop Window Manager (DWM) composition is enabled or disabled.

```
virtual void DWMCompositionChanged();
```

### Remarks

## <a name="enablekeytips"></a> `CMFCRibbonBar::EnableKeyTips`

Enables or disables the keytip feature for the ribbon bar.

```cpp
void EnableKeyTips(BOOL bEnable = TRUE);
```

### Parameters

*`bEnable`*\
[in] `TRUE` to enable the keytips feature; `FALSE` to disable the keytips feature.

### Remarks

When you enable this feature, key tips are displayed when the user presses the **ALT** or **F10** keys. When the user presses **ALT** key, key tips are displayed with a 200 millisecond delay. This delay allows for shortcuts to be executed so that the pressed **ALT** key doesn't interfere with other combinations that include the **ALT** key.

## <a name="enableprintpreview"></a> `CMFCRibbonBar::EnablePrintPreview`

Enables or disables the **Print Preview** feature.

```cpp
void EnablePrintPreview(BOOL bEnable = TRUE);
```

### Parameters

*`bEnable`*\
[in] `TRUE` to enable the **Print Preview** feature; `FALSE` to disable the **Print Preview** feature.

### Remarks

If *`bEnable`* is `FALSE` and a print preview category exists, it's deleted.

By default the **Print Preview** feature is enabled.

## <a name="enabletooltips"></a> `CMFCRibbonBar::EnableToolTips`

Enables or disables tooltips and optional tooltip descriptions on the ribbon bar.

```cpp
void EnableToolTips(
    BOOL bEnable = TRUE,
    BOOL bEnableDescr = TRUE);
```

### Parameters

*`bEnable`*\
[in] `TRUE` to enable tooltips on the ribbon bar; `FALSE` to disable tooltips on the ribbon bar.

*bEnableDescr*\
[in] `TRUE` to enable tooltip descriptions on the tooltip; `FALSE` to disable tooltip descriptions on the tooltip.

### Remarks

The *`bEnable`* parameter determines whether tooltips are displayed when the mouse hovers over a ribbon element. The *`bEnableDescr`* parameter determines whether additional descriptive text appears with the tooltip text.

## <a name="findbydata"></a> `CMFCRibbonBar::FindByData`

Retrieves a pointer to a ribbon element if it has the specified data and visibility.

```
CMFCRibbonBaseElement* FindByData(
    DWORD_PTR dwData,
    BOOL bVisibleOnly = TRUE) const;
```

### Parameters

*`dwData`*\
[in] The data associated with a ribbon element.

*`bVisibleOnly`*\
[in] `TRUE` to search visible ribbon elements only; `FALSE` to search all ribbon elements.

### Return Value

A pointer to a ribbon element if it has the specified data and visibility; otherwise `NULL`.

### Remarks

A ribbon element is any control that you can add to the ribbon, such as a ribbon button, or a ribbon category, or a ribbon slider.

## <a name="findbyid"></a> `CMFCRibbonBar::FindByID`

Retrieves a pointer to the ribbon element that has the specified command ID and search values.

```
CMFCRibbonBaseElement* FindByID(
    UINT uiCmdID,
    BOOL bVisibleOnly = TRUE,
    BOOL bExcludeQAT = FALSE) const;
```

### Parameters

*`uiCmdID`*\
[in] Command ID for a ribbon element.

*`bVisibleOnly`*\
[in] `TRUE` to search visible ribbon elements only; `FALSE` to search all ribbon elements.

*`bExcludeQAT`*\
[in] `TRUE` to exclude quick access toolbar elements from the search; otherwise, `FALSE`.

### Return Value

A pointer to a ribbon element if it has the specified command ID and search values; otherwise, `NULL`.

### Remarks

A ribbon element is any ribbon control that can be added to the ribbon, such as a ribbon button, or a ribbon category, or a ribbon slider.

In general, there can be more than one ribbon element that has the same command ID. If you want to obtain pointers to all ribbon elements that use a specified command ID, use the [`CMFCRibbonBar::GetElementsByID`](#getelementsbyid) method.

## <a name="findcategoryindexbydata"></a> `CMFCRibbonBar::FindCategoryIndexByData`

Retrieves the index of the ribbon category that contains the specified data.

```
int FindCategoryIndexByData(DWORD dwData) const;
```

### Parameters

*`dwData`*\
[in] The data associated with a ribbon category.

### Return Value

The zero-based index of a ribbon category if the method was successful; otherwise -1.

## <a name="forcerecalclayout"></a> `CMFCRibbonBar::ForceRecalcLayout`

Adjusts the layout of all items in the ribbon bar and parent window and redraws the whole window.

```cpp
void ForceRecalcLayout();
```

### Remarks

## <a name="getactivecategory"></a> `CMFCRibbonBar::GetActiveCategory`

Retrieves a pointer to the active ribbon category.

```
CMFCRibbonCategory* GetActiveCategory() const;
```

### Return Value

A pointer to the active ribbon category; or `NULL` if no category is active.

### Remarks

A category is active if it has the focus. By default, the active category is the first category on the left side of the ribbon bar.

The main category is displayed when the user presses the application button and it can't be the active category.

## <a name="getapplicationbutton"></a> `CMFCRibbonBar::GetApplicationButton`

Retrieves a pointer to the application button.

```
CMFCRibbonApplicationButton* GetApplicationButton() const;
```

### Return Value

A pointer to the application button; or `NULL` if the button hasn't been set.

## <a name="getcaptionheight"></a> `CMFCRibbonBar::GetCaptionHeight`

Retrieves the height of the caption area for the ribbon bar.

```
int GetCaptionHeight() const;
```

### Return Value

The height, in pixels, of the caption area for the ribbon bar.

### Remarks

## <a name="getcategory"></a> `CMFCRibbonBar::GetCategory`

Retrieves a pointer to the ribbon category at the specified index.

```
CMFCRibbonCategory* GetCategory(int nIndex) const;
```

### Parameters

*`nIndex`*\
[in] The zero-based index of a ribbon category in the list of ribbon categories that is contained in the ribbon bar.

### Return Value

A pointer to the ribbon category at the specified index; otherwise, `NULL` if *`nIndex`* was out of range.

## <a name="getcategorycount"></a> `CMFCRibbonBar::GetCategoryCount`

Retrieves the number of ribbon categories in the ribbon bar.

```
int GetCategoryCount() const;
```

### Return Value

The number of the ribbon categories in the ribbon bar.

## <a name="getcategoryheight"></a> `CMFCRibbonBar::GetCategoryHeight`

Retrieves the height of the category.

```
int GetCategoryHeight() const;
```

### Return Value

The height of the category.

### Remarks

The category height includes the height of the category tab.

## <a name="getcategoryindex"></a> `CMFCRibbonBar::GetCategoryIndex`

Retrieves the index of the specified ribbon category.

```
int GetCategoryIndex(CMFCRibbonCategory* pCategory) const;
```

### Parameters

*`pCategory`*\
[in] Pointer to a ribbon category.

### Return Value

The zero-based index of a ribbon category specified by *`pCategory`*; or -1 if the ribbon category isn't found.

## <a name="getcontextname"></a> `CMFCRibbonBar::GetContextName`

Retrieves the name of the context category caption specified by a context ID.

```
BOOL GetContextName(
    UINT uiContextID,
    CString& strName) const;
```

### Parameters

*`uiContextID`*\
[in] A ribbon category context ID.

*`strName`*\
[out] The name of a context category caption.

### Return Value

`TRUE` if the method was successful; otherwise, `FALSE` if *`uiContextID`* was zero or the context category caption wasn't found.

## <a name="getdroppeddown"></a> `CMFCRibbonBar::GetDroppedDown`

Retrieves the ribbon element that is currently dropped down.

```
virtual CMFCRibbonBaseElement* GetDroppedDown();
```

### Return Value

The ribbon element that is currently dropped down; or `NULL` if no ribbon element is currently dropped down.

### Remarks

## <a name="getelementsbyid"></a> `CMFCRibbonBar::GetElementsByID`

Retrieves an array of pointers to all ribbon elements that have a specific command ID.

```cpp
void GetElementsByID(
    UINT uiCmdID,
    CArray<CMFCRibbonBaseElement*,CMFCRibbonBaseElement*>& arButtons);
```

### Parameters

*`uiCmdID`*\
[in] Command ID of a ribbon element.

*`arButtons`*\
[out] An array of pointers to ribbon elements.

### Remarks

Multiple ribbon elements can have the same command ID because some ribbon elements can be copied to the quick access toolbar.

## <a name="gethideflags"></a> `CMFCRibbonBar::GetHideFlags`

Retrieves the flags that indicate how much of the ribbon bar is visible.

```
DWORD GetHideFlags() const;
```

### Return Value

The flags that indicate how much of the ribbon bar is visible.

### Remarks

The following table lists the possible combination of flags for the return value:

|Flag|Description|
|-|-|
|`AFX_RIBBONBAR_HIDE_ELEMENTS`|The ribbon bar is minimized vertically and only the category tabs, main button, and quick access toolbar are visible.  |
|`AFX_RIBBONBAR_HIDE_ALL`|The width of the ribbon bar is less than the minimum width and is completely hidden.  |

## <a name="getitemidslist"></a> `CMFCRibbonBar::GetItemIDsList`

Retrieves the command IDs for the specified collection of ribbon elements on the ribbon bar.

```cpp
void GetItemIDsList(CList<UINT, UINT>& lstItems,
    BOOL bHiddenOnly = FALSE) const;
```

### Parameters

*`lstItems`*\
[out] The list of command IDs for ribbon elements that are contained in the ribbon bar.

*`bHiddenOnly`*\
[in] `TRUE` to exclude ribbon elements that are displayed; `FALSE` to include all ribbon elements in the ribbon bar.

### Remarks

## <a name="getkeyboardnavigationlevel"></a> `CMFCRibbonBar::GetKeyboardNavigationLevel`

Retrieves the current navigation level as the user presses the keytips that are contained on the ribbon bar.

```
int GetKeyboardNavigationLevel() const;
```

### Return Value

The current navigation level as the user presses the keytips that are contained on the ribbon bar. The following table lists possible return values:

|Value|Description|
|-|-|
|-1|Keytips aren't displayed.|
|0|Keytips are displayed.|
|1|User has pressed a displayed keytip.|

### Remarks

## <a name="getkeyboardnavlevelcurrent"></a> `CMFCRibbonBar::GetKeyboardNavLevelCurrent`

Retrieves the current keyboard navigation object on the ribbon bar.

```
CObject* GetKeyboardNavLevelCurrent() const;
```

### Return Value

The current keyboard navigation object on the ribbon bar; otherwise `NULL` if no object currently displays keytips.

### Remarks

The object that is currently displaying keytips is the current keyboard navigation object.

## <a name="getkeyboardnavlevelparent"></a> `CMFCRibbonBar::GetKeyboardNavLevelParent`

Retrieves the parent keyboard navigation object on the ribbon bar.

```
CObject* GetKeyboardNavLevelParent() const;
```

### Return Value

The parent keyboard navigation object on the ribbon bar; otherwise `NULL`.

### Remarks

When the user presses a keytip on the ribbon bar, the current keyboard navigation object becomes the parent keyboard navigation object.

## <a name="getmaincategory"></a> `CMFCRibbonBar::GetMainCategory`

Retrieves a pointer to the main ribbon category.

```
CMFCRibbonCategory* GetMainCategory() const;
```

### Return Value

A pointer to the main ribbon category.

### Remarks

The main ribbon category contains the main ribbon panel.

## <a name="getqatcommandslocation"></a> `CMFCRibbonBar::GetQATCommandsLocation`

Retrieves the display rectangle for the commands section of the quick access toolbar.

```
CRect GetQATCommandsLocation() const;
```

### Return Value

The display rectangle for the commands section of the quick access toolbar.

### Remarks

The commands section of the display rectangle doesn't include the customization button.

## <a name="getqatdroppeddown"></a> `CMFCRibbonBar::GetQATDroppedDown`

Retrieves a pointer to the ribbon element on the quick access toolbar that has its pop-up menu dropped down.

```
CMFCRibbonBaseElement* GetQATDroppedDown();
```

### Return Value

A pointer to the ribbon element on the quick access toolbar that has its pop-up menu dropped down.

### Remarks

## <a name="getquickaccesscommands"></a> `CMFCRibbonBar::GetQuickAccessCommands`

Retrieves a list of command IDs for the ribbon elements on the quick access toolbar.

```cpp
void GetQuickAccessCommands(CList<UINT,UINT>& lstCommands);
```

### Parameters

*`lstCommands`*\
[out] The list of command IDs for the ribbon elements on the quick access toolbar.

### Remarks

The list doesn't contain ribbon elements that are control separators.

## <a name="getquickaccesstoolbarlocation"></a> `CMFCRibbonBar::GetQuickAccessToolbarLocation`

Retrieves the display rectangle for the quick access toolbar.

```
CRect GetQuickAccessToolbarLocation() const;
```

### Return Value

The display rectangle for the quick access toolbar.

### Remarks

## <a name="gettabtrancateratio"></a> `CMFCRibbonBar::GetTabTrancateRatio`

Retrieves the percent size reduction in the display width of the category tabs.

```
int GetTabTrancateRatio() const;
```

### Return Value

The percent size reduction in the display width of the category tabs.

### Remarks

Category tabs are reduced in width when there isn't enough width on the ribbon bar.

## <a name="gettooltipfixedwidthlargeimage"></a> `CMFCRibbonBar::GetTooltipFixedWidthLargeImage`

Retrieves the large size of tooltip width for the ribbon bar.

```
int GetTooltipFixedWidthLargeImage() const;
```

### Return Value

The large size of tooltip width in pixels.

### Remarks

If the large size of tooltip width is 0, the width varies.

## <a name="gettooltipfixedwidthregular"></a> `CMFCRibbonBar::GetTooltipFixedWidthRegular`

Retrieves the regular size of tooltip width for the ribbon bar.

```
int GetTooltipFixedWidthRegular() const;
```

### Return Value

The regular size of tooltip width in pixels.

### Remarks

If the regular size of tooltip width is 0, the width varies.

## <a name="getvisiblecategorycount"></a> `CMFCRibbonBar::GetVisibleCategoryCount`

Retrieves the number of visible categories on the ribbon bar.

```
int GetVisibleCategoryCount() const;
```

### Return Value

The number of visible categories on the ribbon bar.

### Remarks

## <a name="hideallcontextcategories"></a> `CMFCRibbonBar::HideAllContextCategories`

Hides all the context categories on the ribbon bar.

```
BOOL HideAllContextCategories();
```

### Return Value

`TRUE` if at least one context category was hidden; otherwise, `FALSE`.

### Remarks

If a context category is active, the active category is reset to the first visible category in the category list.

## <a name="hidekeytips"></a> `CMFCRibbonBar::HideKeyTips`

Hides all keytips on the ribbon bar.

```cpp
void HideKeyTips();
```

### Remarks

## <a name="hittest"></a> `CMFCRibbonBar::HitTest`

Retrieves a pointer to the ribbon element specified by the location of the point.

```
virtual CMFCRibbonBaseElement* HitTest(
    CPoint point,
    BOOL bCheckActiveCategory= FALSE,
    BOOL bCheckPanelCaption= FALSE);
```

### Parameters

*`point`*\
[in] Location of the point in ribbon bar coordinates.

*`bCheckActiveCategory`*\
[in] `TRUE` to search the active category; `FALSE` not to search the active category.

*`bCheckPanelCaption`*\
[in] `TRUE` to test the caption of the ribbon panel with the point located in it; `FALSE` not to test the caption of the ribbon panel with the point located in it. See the [Remarks](#hittest-remarks) section for more information.

### Return Value

A pointer to the ribbon element located at the specified point; otherwise `NULL` if the point isn't located in a ribbon element.

### <a name="hittest-remarks"></a> Remarks

The caption of the ribbon panel with the point located in it isn't tested unless the *`bCheckActiveCategory`* parameter is `TRUE`.

## <a name="iskeytipenabled"></a> `CMFCRibbonBar::IsKeyTipEnabled`

Indicates whether the keytips feature is enabled.

```
BOOL IsKeyTipEnabled() const;
```

### Return Value

`TRUE` if the keytips feature is enabled; otherwise `FALSE`.

## <a name="ismainribbonbar"></a> `CMFCRibbonBar::IsMainRibbonBar`

Indicates whether the ribbon bar is the primary ribbon bar.

```
virtual BOOL IsMainRibbonBar() const;
```

### Return Value

Always returns `TRUE`.

### Remarks

By default this method always returns `TRUE`. Override this method to indicate whether the ribbon bar is the primary ribbon bar.

## <a name="isprintpreviewenabled"></a> `CMFCRibbonBar::IsPrintPreviewEnabled`

Indicates whether the **Print Preview** feature is enabled.

```
BOOL IsPrintPreviewEnabled() const;
```

### Return Value

`TRUE` if the **Print Preview** feature is enabled; otherwise `FALSE`.

## <a name="isqatempty"></a> `CMFCRibbonBar::IsQATEmpty`

Indicates whether the quick access toolbar contains command buttons.

```
BOOL IsQATEmpty() const;
```

### Return Value

`TRUE` if the quick access toolbar contains command buttons; otherwise `FALSE`.

### Remarks

## <a name="isquickaccesstoolbarontop"></a> `CMFCRibbonBar::IsQuickAccessToolbarOnTop`

Indicates whether the quick access toolbar is located over or under the ribbon bar.

```
BOOL IsQuickAccessToolbarOnTop() const;
```

### Return Value

`TRUE` if the quick access toolbar is located over the ribbon bar; `FALSE` if the quick access toolbar is located under the ribbon bar.

## <a name="isreplaceframecaption"></a> `CMFCRibbonBar::IsReplaceFrameCaption`

Indicates whether the ribbon bar replaces or is under the caption of the main frame window.

```
BOOL IsReplaceFrameCaption() const;
```

### Return Value

`TRUE` if the ribbon bar replaces the caption of the main frame window; `FALSE` if ribbon bar is under the caption of the main frame window.

## <a name="isshowgroupborder"></a> `CMFCRibbonBar::IsShowGroupBorder`

Indicates whether button groups located on the ribbon bar display a group border.

```
virtual BOOL IsShowGroupBorder(CMFCRibbonButtonsGroup* pGroup) const;
```

### Parameters

*`pGroup`*\
[in] This parameter isn't used.

### Return Value

Always returns `FALSE`.

### Remarks

By default this method always returns `FALSE`. Override this method to indicate whether button groups located on the ribbon bar display a group border.

## <a name="istooltipdescrenabled"></a> `CMFCRibbonBar::IsToolTipDescrEnabled`

Indicates whether tooltip descriptions are enabled.

```
BOOL IsToolTipDescrEnabled() const;
```

### Return Value

`TRUE` if tooltip descriptions are enabled; `FALSE` if tooltip descriptions are disabled.

### Remarks

Tooltip descriptions are additional descriptive text displayed with the tooltip text.

## <a name="istooltipenabled"></a> `CMFCRibbonBar::IsToolTipEnabled`

Indicates whether tooltips are enabled or disabled for the ribbon bar.

```
BOOL IsToolTipEnabled() const;
```

### Return Value

`TRUE` if tooltips are enabled; `FALSE` if tooltips are disabled.

## <a name="istransparentcaption"></a> `CMFCRibbonBar::IsTransparentCaption`

Indicates whether the display is set for Windows Aero color scheme.

```
BOOL IsTransparentCaption() const;
```

### Return Value

`TRUE` if the color scheme is Windows Aero; otherwise `FALSE`.

### Remarks

## <a name="onclickbutton"></a> `CMFCRibbonBar::OnClickButton`

This method is retained for backward compatibility with existing applications and shouldn't be used for new development.

```
virtual void OnClickButton(
    CMFCRibbonButton* pButton,
    CPoint point);
```

### Parameters

*`pButton`*\
[in] Pointer to the button that was clicked.

*`point`*\
[in] This parameter isn't used.

### Remarks

## <a name="oneditcontextmenu"></a> `CMFCRibbonBar::OnEditContextMenu`

```
virtual void OnEditContextMenu(
    CMFCRibbonRichEditCtrl* pEdit,
    CPoint point);
```

### Parameters

[in] *`pEdit`*\
[in] *`point`*

### Remarks

## <a name="onrtlchanged"></a> `CMFCRibbonBar::OnRTLChanged`

Called by the framework when the layout changes direction.

```
virtual void OnRTLChanged(BOOL bIsRTL);
```

### Parameters

*`bIsRTL`*\
[in] `TRUE` if the layout is right-to-left; `FALSE` if the layout is left-to-right.

### Remarks

This method adjusts the layout of all controls on the ribbon bar for the new layout direction.

## <a name="onsetaccdata"></a> `CMFCRibbonBar::OnSetAccData`

This method is internal to the Framework and isn't intended to be called from user code.

```
BOOL OnSetAccData(long lVal);
```

### Parameters

long *`lVal`*
The index of the accessible object.

### Return Value

`S_OK` if successful; otherwise `FALSE` or `S_FALSE`.

### Remarks

## <a name="onshowribboncontextmenu"></a> `CMFCRibbonBar::OnShowRibbonContextMenu`

```
virtual BOOL OnShowRibbonContextMenu(
    CWnd* pWnd,
    int x,
    int y,
    CMFCRibbonBaseElement* pHit);
```

### Parameters

[in] *`pWnd`*\
[in] *`x`*\
[in] *`y`*\
[in] *`pHit`*

### Return Value

### Remarks

## <a name="onshowribbonqatmenu"></a> `CMFCRibbonBar::OnShowRibbonQATMenu`

```
virtual BOOL OnShowRibbonQATMenu(
    CWnd* pWnd,
    int x,
    int y,
    CMFCRibbonBaseElement* pHit);
```

### Parameters

[in] *`pWnd`*\
[in] *`x`*\
[in] *`y`*\
[in] *`pHit`*

### Return Value

### Remarks

## <a name="onsyskeydown"></a> `CMFCRibbonBar::OnSysKeyDown`

Called by the framework when the user presses the **F10** key or holds down the **ALT** key and then presses another key.

```
BOOL OnSysKeyDown(
    CFrameWnd* pFrameWnd,
    WPARAM wParam,
    LPARAM lParam);
```

### Parameters

*`pFrameWnd`*\
[in] Pointer to the parent main frame window of the ribbon bar.

*`wParam`*\
[in] Virtual key code of the key being pressed.

*`lParam`*\
[in] Keyboard state flags when the key was pressed.

### Return Value

`TRUE` if the keystroke event was processed; otherwise `FALSE`.

### Remarks

## <a name="onsyskeyup"></a> `CMFCRibbonBar::OnSysKeyUp`

Called by the framework when the user releases the **F10** key, the **ALT** key, or a key that was pressed when the **ALT** key was held down.

```
BOOL OnSysKeyUp(
    CFrameWnd* pFrameWnd,
    WPARAM wParam,
    LPARAM lParam);
```

### Parameters

*`pFrameWnd`*\
[in] Pointer to the parent main frame window of the ribbon bar.

*`wParam`*\
[in] Virtual key code of the key being released.

*`lParam`*\
[in] This parameter isn't used.

### Return Value

`TRUE` if the keystroke event was processed; otherwise `FALSE`.

### Remarks

## <a name="poptooltip"></a> `CMFCRibbonBar::PopTooltip`

Removes a tooltip from view.

```cpp
void PopTooltip();
```

### Remarks

## <a name="pretranslatemessage"></a> `CMFCRibbonBar::PreTranslateMessage`

Determines if the specified message is processed by the ribbon bar.

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### Parameters

*`pMsg`*\
[in] Pointer to a message.

### Return Value

`TRUE` if the message was processed by the ribbon bar; otherwise `FALSE`.

### Remarks

## <a name="recalclayout"></a> `CMFCRibbonBar::RecalcLayout`

Adjusts the layout of all controls on the ribbon bar.

```
virtual void RecalcLayout();
```

### Remarks

After layout adjustment, the display of the ribbon bar is updated.

## <a name="removeallcategories"></a> `CMFCRibbonBar::RemoveAllCategories`

Deletes all ribbon categories from the ribbon bar.

```cpp
void RemoveAllCategories();
```

### Remarks

This method deletes all ribbon categories from memory and from the category list.

## <a name="removeallfromtabs"></a> `CMFCRibbonBar::RemoveAllFromTabs`

Removes all ribbon elements from the tab area.

```cpp
void RemoveAllFromTabs();
```

### Remarks

Use this function if you want to remove all the elements that you added to the tab area by using [`CMFCRibbonBar::AddToTabs`](#addtotabs) method.

## <a name="removecategory"></a> `CMFCRibbonBar::RemoveCategory`

Deletes the specified ribbon category from the ribbon bar.

```
BOOL RemoveCategory(int nIndex);
```

### Parameters

*`nIndex`*\
[in] The zero-based index of a category in the list of ribbon categories that is contained in the ribbon bar.

### Return Value

`TRUE` if the specified ribbon category was deleted; otherwise `FALSE`.

### Remarks

The specified ribbon category is deleted from memory and from the category list.

## <a name="setactivecategory"></a> `CMFCRibbonBar::SetActiveCategory`

Sets the specified ribbon category as the active category.

```
BOOL SetActiveCategory(
    CMFCRibbonCategory* pCategory,
    BOOL bForceRestore= FALSE);
```

### Parameters

*`pCategory`*\
[in] A ribbon category that is contained in the ribbon bar.

*`bForceRestore`*\
[in] `TRUE` to maximize the ribbon bar if it's minimized; `FALSE` to display the active category in a pop-up window if the ribbon bar is minimized.

### Return Value

`TRUE` if the specified category was set as the active category; otherwise `FALSE`.

### Remarks

The main ribbon category can't be the active category.

If the category specified by *`pCategory`* isn't displayed, it can't be set as the active category.

## <a name="setactivemdichild"></a> `CMFCRibbonBar::SetActiveMDIChild`

Associates the system buttons on the ribbon bar that belong to a multiple-document interface (MDI) child window to the specified MDI child window.

```cpp
void SetActiveMDIChild(CWnd* pWnd);
```

### Parameters

*`pWnd`*\
[in] Pointer to an MDI child window.

### Remarks

## <a name="setapplicationbutton"></a> `CMFCRibbonBar::SetApplicationButton`

Assigns an application ribbon button to the ribbon bar.

```cpp
void SetApplicationButton(
    CMFCRibbonApplicationButton* pButton,
    CSize sizeButton);
```

### Parameters

*`pButton`*\
[in] A pointer to the application ribbon button.

*`sizeButton`*\
[in] The size of the application ribbon button.

### Remarks

The application ribbon button is a large rounded button located at the upper-left corner of Ribbon control.

### Example

The following example demonstrates how to use the `SetApplicationButton` method in the `CMFCRibbonBar` class.

[!code-cpp[NVC_MFC_RibbonApp#3](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_4.cpp)]

## <a name="setelementkeys"></a> `CMFCRibbonBar::SetElementKeys`

Sets the keytips for all ribbon elements that have the specified command ID.

```
BOOL SetElementKeys(
    UINT uiCmdID,
    LPCTSTR lpszKeys,
    LPCTSTR lpszMenuKeys= NULL);
```

### Parameters

*`uiCmdID`*\
[in] The command ID of a ribbon element.

*`lpszKeys`*\
[in] The keytip.

*`lpszMenuKeys`*\
[in] The menu keytip.

### Return Value

`TRUE` if the keytips of at least one ribbon element are set; otherwise `FALSE`.

### Remarks

The optional menu keytip is for ribbon elements with a split button that opens a popup menu.

## <a name="setkeyboardnavigationlevel"></a> `CMFCRibbonBar::SetKeyboardNavigationLevel`

Sets the keyboard navigation level as the user presses the keytips that are contained on the ribbon bar.

```cpp
void SetKeyboardNavigationLevel(
    CObject* pLevel,
    BOOL bSetFocus = TRUE);
```

### Parameters

*`pLevel`*\
[in] Pointer to the current keyboard navigation object.

*`bSetFocus`*\
[in] `TRUE` to set the keyboard focus to the ribbon bar.

### Remarks

Keyboard navigation of the ribbon bar starts when the user presses the **ALT** or **F10** key. The user selects the next navigation level by pressing a keytip on the ribbon bar. The user can return to the previous navigation level by pressing the escape key.

## <a name="setmaximizemode"></a> `CMFCRibbonBar::SetMaximizeMode`

Adjusts the ribbon bar when the window size of a multiple-document interface (MDI) child window enters or leaves the maximized state.

```cpp
void SetMaximizeMode(
    BOOL bMax,
    CWnd* pWnd = NULL);
```

### Parameters

*`bMax`*\
[in] `TRUE` to display the system buttons for an MDI child window on the ribbon bar; `FALSE` to remove the system buttons for an MDI child window from the ribbon bar.

*`pWnd`*\
[in] Pointer to the main frame window for the ribbon bar.

### Remarks

The ribbon bar displays system buttons for an MDI child window in the tab row when an MDI child window is maximized.

## <a name="setquickaccesscommands"></a> `CMFCRibbonBar::SetQuickAccessCommands`

Adds one or more ribbon elements to the Quick Access Toolbar.

```cpp
void SetQuickAccessCommands(
    const CList<UINT,UINT>& lstCommands,
    BOOL bRecalcLayout=TRUE);
```

### Parameters

*`lstCommands`*\
[in] The list of commands to be placed on the Quick Access Toolbar.

*`bRecalcLayout`*\
[in] `TRUE` if want to redraw the ribbon after you add the ribbon elements; `FALSE` otherwise.

### Example

The following example demonstrates how to use the `SetQuickAccessCommands` method in the `CMFCRibbonBar` class.

[!code-cpp[NVC_MFC_RibbonApp#8](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_5.cpp)]

## <a name="setquickaccessdefaultstate"></a> `CMFCRibbonBar::SetQuickAccessDefaultState`

Sets the quick access toolbar to the default state.

```cpp
void SetQuickAccessDefaultState(const CMFCRibbonQuickAccessToolBarDefaultState& state);
```

### Parameters

*`state`*\
[in] The quick access toolbar default state.

### Remarks

The quick access toolbar state includes a list of commands and their visibility.

### Example

The following example demonstrates how to use the `SetQuickAccessDefaultState` method in the `CMFCRibbonBar` class.

[!code-cpp[NVC_MFC_RibbonApp#9](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_6.cpp)]

## <a name="setquickaccesstoolbarontop"></a> `CMFCRibbonBar::SetQuickAccessToolbarOnTop`

Positions the quick access toolbar above or below the ribbon bar.

```cpp
void SetQuickAccessToolbarOnTop(BOOL bOnTop);
```

### Parameters

*`bOnTop`*\
[in] `TRUE` to position the quick access toolbar above the ribbon bar; `FALSE` to position the quick access toolbar below the ribbon bar.

## <a name="settooltipfixedwidth"></a> `CMFCRibbonBar::SetTooltipFixedWidth`

Sets the regular and large sizes of tooltip fixed widths for the ribbon bar.

```cpp
void SetTooltipFixedWidth(
    int nWidthRegular,
    int nWidthLargeImage);
```

### Parameters

*`nWidthRegular`*\
[in] The width, in pixels, of a regular fixed sized tooltip.

*`nWidthLargeImage`*\
[in] The width, in pixels, of a large fixed sized tooltip.

### Remarks

Setting a parameter to 0 causes the corresponding width to vary.

## <a name="showcategory"></a> `CMFCRibbonBar::ShowCategory`

Shows or hides the specified ribbon category.

```cpp
void ShowCategory(
    int nIndex,
    BOOL bShow=TRUE);
```

### Parameters

*`nIndex`*\
[in] The index of the ribbon category.

*`bShow`*\
[in] If `TRUE`, show the ribbon category; otherwise, hide the ribbon category.

## <a name="showcontextcategories"></a> `CMFCRibbonBar::ShowContextCategories`

Shows or hides the context categories that have the specified ID.

```cpp
void ShowContextCategories(
    UINT uiContextID,
    BOOL bShow=TRUE);
```

### Parameters

*`uiContextID`*\
[in] The context category ID.

*`bShow`*\
[in] If `TRUE`, show the categories that have the specified ID; otherwise, hide the categories that have the specified ID.

## <a name="showkeytips"></a> `CMFCRibbonBar::ShowKeyTips`

Shows the keytips for each ribbon element on the ribbon bar.

```cpp
void ShowKeyTips();
```

### Remarks

## <a name="togglemimimizestate"></a> `CMFCRibbonBar::ToggleMimimizeState`

Toggles the ribbon bar between the minimized and maximized states.

```cpp
void ToggleMimimizeState();
```

### Remarks

The misspelling in the method name is a known issue.

In the minimized state, the ribbon control is hidden and only the tabs are displayed. When the user clicks a tab, the ribbon control is displayed as a popup window. The window closes when the user clicks away or executes a command.

## <a name="translatechar"></a> `CMFCRibbonBar::TranslateChar`

Determines whether the specified keystroke character code is processed by the ribbon bar.

```
virtual BOOL TranslateChar(UINT nChar);
```

### Parameters

*`nChar`*\
[in] A user keystroke character code.

### Return Value

`TRUE` if the character code was processed by the ribbon bar; otherwise `FALSE`.

### Remarks

The keytips feature enables users to navigate the ribbon bar by using the keyboard.

## <a name="getfocused"></a> `CMFCRibbonBar::GetFocused`

Returns a focused element.

```
virtual CMFCRibbonBaseElement* GetFocused();
```

### Return Value

A pointer to a focused element or `NULL`.

### Remarks

## <a name="iswindows7look"></a> `CMFCRibbonBar::IsWindows7Look`

Indicates whether the ribbon has a Windows 7 look (small rectangular application button).

```
BOOL IsWindows7Look() const;
```

### Return Value

`TRUE` if the ribbon has a Windows 7 look; otherwise `FALSE`.

### Remarks

## <a name="loadfromresource"></a> `CMFCRibbonBar::LoadFromResource`

Overloaded. Loads a Ribbon Bar from application resources.

```
virtual BOOL LoadFromResource(
    UINT uiXMLResID,
    LPCTSTR lpszResType = RT_RIBBON,
    HINSTANCE hInstance = NULL);

virtual BOOL LoadFromResource(
    LPCTSTR lpszXMLResID,
    LPCTSTR lpszResType = RT_RIBBON,
    HINSTANCE hInstance = NULL);
```

### Parameters

*`uiXMLResID`*\
Specifies resource ID of XML string with Ribbon Bar information.

*`lpszResType`*\
Specifies type of the resource located at *`uiXMLResID`*.

*`hInstance`*\
Handle to the module whose executable file contains the resource. If *`hInstance`* is `NULL`, the system loads the resource from the module that was used to create the current process.

*`lpszXMLResID`*\
Specifies resource ID (in string form) with Ribbon Bar information.

### Return Value

`TRUE` if load succeeds; otherwise `FALSE`.

### Remarks

## <a name="savetoxmlbuffer"></a> `CMFCRibbonBar::SaveToXMLBuffer`

Saves the Ribbon Bar to a buffer.

```
UINT SaveToXMLBuffer(LPBYTE* ppBuffer) const;
```

### Parameters

*`ppBuffer`*\
When this function returns, *`ppBuffer`* points to a buffer allocated by this method and contains Ribbon Bar information in XML format.

### Return Value

`TRUE` if successful; otherwise `FALSE`.

### Remarks

## <a name="savetoxmlfile"></a> `CMFCRibbonBar::SaveToXMLFile`

Saves the Ribbon Bar to an XML file.

```
BOOL SaveToXMLFile(LPCTSTR lpszFilePath) const;
```

### Parameters

*`lpszFilePath`*\
Specifies the output file.

### Return Value

`TRUE` if successful; otherwise `FALSE`.

### Remarks

## <a name="setwindows7look"></a> `CMFCRibbonBar::SetWindows7Look`

Enables or disables a Windows 7 look (small rectangular application button) for the Ribbon.

```cpp
void SetWindows7Look(
    BOOL bWindows7Look,
    BOOL bRecalc = TRUE);
```

### Parameters

*`bWindows7Look`*\
`TRUE` sets a Windows 7 look; `FALSE` otherwise.

*`bRecalc`*\
`TRUE` recalculates the ribbon layout; `FALSE` otherwise.

### Remarks

## See also

[Hierarchy Chart](../../mfc/hierarchy-chart.md)\
[Classes](../../mfc/reference/mfc-classes.md)\
[`CPane` Class](../../mfc/reference/cpane-class.md)\
[`CMFCRibbonCategory` Class](../../mfc/reference/cmfcribboncategory-class.md)\
[`CMFCRibbonPanel` Class](../../mfc/reference/cmfcribbonpanel-class.md)\
[`CMFCRibbonBaseElement` Class](../../mfc/reference/cmfcribbonbaseelement-class.md)\
[Walkthrough: Updating the MFC Scribble Application](../../mfc/walkthrough-updating-the-mfc-scribble-application-part-1.md)

---
description: "Learn more about: CMFCToolBarImages Class"
title: "CMFCToolBarImages Class"
ms.date: "11/04/2016"
f1_keywords: ["CMFCToolBarImages", "AFXTOOLBARIMAGES/CMFCToolBarImages", "AFXTOOLBARIMAGES/CMFCToolBarImages::CMFCToolBarImages", "AFXTOOLBARIMAGES/CMFCToolBarImages::AdaptColors", "AFXTOOLBARIMAGES/CMFCToolBarImages::AddIcon", "AFXTOOLBARIMAGES/CMFCToolBarImages::AddImage", "AFXTOOLBARIMAGES/CMFCToolBarImages::CleanUp", "AFXTOOLBARIMAGES/CMFCToolBarImages::Clear", "AFXTOOLBARIMAGES/CMFCToolBarImages::ConvertTo32Bits", "AFXTOOLBARIMAGES/CMFCToolBarImages::CopyImageToClipboard", "AFXTOOLBARIMAGES/CMFCToolBarImages::CopyTo", "AFXTOOLBARIMAGES/CMFCToolBarImages::CreateFromImageList", "AFXTOOLBARIMAGES/CMFCToolBarImages::CreateRegionFromImage", "AFXTOOLBARIMAGES/CMFCToolBarImages::DeleteImage", "AFXTOOLBARIMAGES/CMFCToolBarImages::Draw", "AFXTOOLBARIMAGES/CMFCToolBarImages::DrawEx", "AFXTOOLBARIMAGES/CMFCToolBarImages::EnableRTL", "AFXTOOLBARIMAGES/CMFCToolBarImages::EndDrawImage", "AFXTOOLBARIMAGES/CMFCToolBarImages::ExtractIcon", "AFXTOOLBARIMAGES/CMFCToolBarImages::FillDitheredRect", "AFXTOOLBARIMAGES/CMFCToolBarImages::GetAlwaysLight", "AFXTOOLBARIMAGES/CMFCToolBarImages::GetBitsPerPixel", "AFXTOOLBARIMAGES/CMFCToolBarImages::GetCount", "AFXTOOLBARIMAGES/CMFCToolBarImages::GetDisabledImageAlpha", "AFXTOOLBARIMAGES/CMFCToolBarImages::GetFadedImageAlpha", "AFXTOOLBARIMAGES/CMFCToolBarImages::GetImageSize", "AFXTOOLBARIMAGES/CMFCToolBarImages::GetImageWell", "AFXTOOLBARIMAGES/CMFCToolBarImages::GetImageWellLight", "AFXTOOLBARIMAGES/CMFCToolBarImages::GetLastImageRect", "AFXTOOLBARIMAGES/CMFCToolBarImages::GetLightPercentage", "AFXTOOLBARIMAGES/CMFCToolBarImages::GetMapTo3DColors", "AFXTOOLBARIMAGES/CMFCToolBarImages::GetMask", "AFXTOOLBARIMAGES/CMFCToolBarImages::GetResourceOffset", "AFXTOOLBARIMAGES/CMFCToolBarImages::GetScale", "AFXTOOLBARIMAGES/CMFCToolBarImages::GetTransparentColor", "AFXTOOLBARIMAGES/CMFCToolBarImages::GrayImages", "AFXTOOLBARIMAGES/CMFCToolBarImages::Is32BitTransparencySupported", "AFXTOOLBARIMAGES/CMFCToolBarImages::IsPreMultiplyAutoCheck", "AFXTOOLBARIMAGES/CMFCToolBarImages::IsRTL", "AFXTOOLBARIMAGES/CMFCToolBarImages::IsReadOnly", "AFXTOOLBARIMAGES/CMFCToolBarImages::IsScaled", "AFXTOOLBARIMAGES/CMFCToolBarImages::IsUserImagesList", "AFXTOOLBARIMAGES/CMFCToolBarImages::IsValid", "AFXTOOLBARIMAGES/CMFCToolBarImages::Load", "AFXTOOLBARIMAGES/CMFCToolBarImages::LoadStr", "AFXTOOLBARIMAGES/CMFCToolBarImages::MapFromSysColor", "AFXTOOLBARIMAGES/CMFCToolBarImages::MapTo3dColors", "AFXTOOLBARIMAGES/CMFCToolBarImages::MapToSysColor", "AFXTOOLBARIMAGES/CMFCToolBarImages::MapToSysColorAlpha", "AFXTOOLBARIMAGES/CMFCToolBarImages::Mirror", "AFXTOOLBARIMAGES/CMFCToolBarImages::MirrorBitmap", "AFXTOOLBARIMAGES/CMFCToolBarImages::MirrorBitmapVert", "AFXTOOLBARIMAGES/CMFCToolBarImages::MirrorVert", "AFXTOOLBARIMAGES/CMFCToolBarImages::OnSysColorChange", "AFXTOOLBARIMAGES/CMFCToolBarImages::PrepareDrawImage", "AFXTOOLBARIMAGES/CMFCToolBarImages::Save", "AFXTOOLBARIMAGES/CMFCToolBarImages::SetAlwaysLight", "AFXTOOLBARIMAGES/CMFCToolBarImages::SetDisabledImageAlpha", "AFXTOOLBARIMAGES/CMFCToolBarImages::SetFadedImageAlpha", "AFXTOOLBARIMAGES/CMFCToolBarImages::SetImageSize", "AFXTOOLBARIMAGES/CMFCToolBarImages::SetLightPercentage", "AFXTOOLBARIMAGES/CMFCToolBarImages::SetMapTo3DColors", "AFXTOOLBARIMAGES/CMFCToolBarImages::SetPreMultiplyAutoCheck", "AFXTOOLBARIMAGES/CMFCToolBarImages::SetSingleImage", "AFXTOOLBARIMAGES/CMFCToolBarImages::SetTransparentColor", "AFXTOOLBARIMAGES/CMFCToolBarImages::SmoothResize", "AFXTOOLBARIMAGES/CMFCToolBarImages::UpdateImage", "AFXTOOLBARIMAGES/CMFCToolBarImages::PreMultiplyAlpha", "AFXTOOLBARIMAGES/CMFCToolBarImages::m_bDisableTrueColorAlpha"]
helpviewer_keywords: ["CMFCToolBarImages [MFC], CMFCToolBarImages", "CMFCToolBarImages [MFC], AdaptColors", "CMFCToolBarImages [MFC], AddIcon", "CMFCToolBarImages [MFC], AddImage", "CMFCToolBarImages [MFC], CleanUp", "CMFCToolBarImages [MFC], Clear", "CMFCToolBarImages [MFC], ConvertTo32Bits", "CMFCToolBarImages [MFC], CopyImageToClipboard", "CMFCToolBarImages [MFC], CopyTo", "CMFCToolBarImages [MFC], CreateFromImageList", "CMFCToolBarImages [MFC], CreateRegionFromImage", "CMFCToolBarImages [MFC], DeleteImage", "CMFCToolBarImages [MFC], Draw", "CMFCToolBarImages [MFC], DrawEx", "CMFCToolBarImages [MFC], EnableRTL", "CMFCToolBarImages [MFC], EndDrawImage", "CMFCToolBarImages [MFC], ExtractIcon", "CMFCToolBarImages [MFC], FillDitheredRect", "CMFCToolBarImages [MFC], GetAlwaysLight", "CMFCToolBarImages [MFC], GetBitsPerPixel", "CMFCToolBarImages [MFC], GetCount", "CMFCToolBarImages [MFC], GetDisabledImageAlpha", "CMFCToolBarImages [MFC], GetFadedImageAlpha", "CMFCToolBarImages [MFC], GetImageSize", "CMFCToolBarImages [MFC], GetImageWell", "CMFCToolBarImages [MFC], GetImageWellLight", "CMFCToolBarImages [MFC], GetLastImageRect", "CMFCToolBarImages [MFC], GetLightPercentage", "CMFCToolBarImages [MFC], GetMapTo3DColors", "CMFCToolBarImages [MFC], GetMask", "CMFCToolBarImages [MFC], GetResourceOffset", "CMFCToolBarImages [MFC], GetScale", "CMFCToolBarImages [MFC], GetTransparentColor", "CMFCToolBarImages [MFC], GrayImages", "CMFCToolBarImages [MFC], Is32BitTransparencySupported", "CMFCToolBarImages [MFC], IsPreMultiplyAutoCheck", "CMFCToolBarImages [MFC], IsRTL", "CMFCToolBarImages [MFC], IsReadOnly", "CMFCToolBarImages [MFC], IsScaled", "CMFCToolBarImages [MFC], IsUserImagesList", "CMFCToolBarImages [MFC], IsValid", "CMFCToolBarImages [MFC], Load", "CMFCToolBarImages [MFC], LoadStr", "CMFCToolBarImages [MFC], MapFromSysColor", "CMFCToolBarImages [MFC], MapTo3dColors", "CMFCToolBarImages [MFC], MapToSysColor", "CMFCToolBarImages [MFC], MapToSysColorAlpha", "CMFCToolBarImages [MFC], Mirror", "CMFCToolBarImages [MFC], MirrorBitmap", "CMFCToolBarImages [MFC], MirrorBitmapVert", "CMFCToolBarImages [MFC], MirrorVert", "CMFCToolBarImages [MFC], OnSysColorChange", "CMFCToolBarImages [MFC], PrepareDrawImage", "CMFCToolBarImages [MFC], Save", "CMFCToolBarImages [MFC], SetAlwaysLight", "CMFCToolBarImages [MFC], SetDisabledImageAlpha", "CMFCToolBarImages [MFC], SetFadedImageAlpha", "CMFCToolBarImages [MFC], SetImageSize", "CMFCToolBarImages [MFC], SetLightPercentage", "CMFCToolBarImages [MFC], SetMapTo3DColors", "CMFCToolBarImages [MFC], SetPreMultiplyAutoCheck", "CMFCToolBarImages [MFC], SetSingleImage", "CMFCToolBarImages [MFC], SetTransparentColor", "CMFCToolBarImages [MFC], SmoothResize", "CMFCToolBarImages [MFC], UpdateImage", "CMFCToolBarImages [MFC], PreMultiplyAlpha", "CMFCToolBarImages [MFC], m_bDisableTrueColorAlpha"]
ms.assetid: d4e50518-9ffc-406f-9996-f79e5cd38155
---
# CMFCToolBarImages Class

The images on a toolbar. The `CMFCToolBarImages` class manages toolbar images loaded from application resources or from files.
For more detail see the source code located in the **VC\\atlmfc\\src\\mfc** folder of your Visual Studio installation.

## Syntax

```
class CMFCToolBarImages : public CObject
```

## Members

### Public Constructors

|Name|Description|
|----------|-----------------|
|[CMFCToolBarImages::CMFCToolBarImages](#cmfctoolbarimages)|Constructs a `CMFCToolBarImages` object.|

### Public Methods

|Name|Description|
|----------|-----------------|
|[CMFCToolBarImages::AdaptColors](#adaptcolors)||
|[CMFCToolBarImages::AddIcon](#addicon)|Adds an icon to the toolbar images.|
|[CMFCToolBarImages::AddImage](#addimage)|Adds a bitmap to the toolbar images.|
|[CMFCToolBarImages::CleanUp](#cleanup)||
|[CMFCToolBarImages::Clear](#clear)|Frees the system resources that were allocated to this object.|
|[CMFCToolBarImages::ConvertTo32Bits](#convertto32bits)|Converts underlined bitmaps to 32 bpp images.|
|[CMFCToolBarImages::CopyImageToClipboard](#copyimagetoclipboard)||
|[CMFCToolBarImages::CopyTo](#copyto)||
|[CMFCToolBarImages::CreateFromImageList](#createfromimagelist)|Initializes the toolbar images from an image list ( [CImageList Class](../../mfc/reference/cimagelist-class.md)).|
|[CMFCToolBarImages::CreateRegionFromImage](#createregionfromimage)||
|[CMFCToolBarImages::DeleteImage](#deleteimage)|Deletes the image that has a specified index from the toolbar images if this set of toolbar images contains user-defined images.|
|[CMFCToolBarImages::Draw](#draw)|Draws a single toolbar image (button).|
|[CMFCToolBarImages::DrawEx](#drawex)||
|[CMFCToolBarImages::EnableRTL](#enablertl)||
|[CMFCToolBarImages::EndDrawImage](#enddrawimage)|Frees system resources after a toolbar image is drawn.|
|[CMFCToolBarImages::ExtractIcon](#extracticon)|Returns the icon that has a specified image index from the toolbar images.|
|[CMFCToolBarImages::FillDitheredRect](#fillditheredrect)|Fills a rectangle by using a brush that has the toolbar background colors.|
|[CMFCToolBarImages::GetAlwaysLight](#getalwayslight)||
|[CMFCToolBarImages::GetBitsPerPixel](#getbitsperpixel)|Returns current resolution of underlined images.|
|[CMFCToolBarImages::GetCount](#getcount)|Returns the number of images on the toolbar.|
|[CMFCToolBarImages::GetDisabledImageAlpha](#getdisabledimagealpha)|Returns the alpha channel value that is used for disabled images.|
|[CMFCToolBarImages::GetFadedImageAlpha](#getfadedimagealpha)||
|[CMFCToolBarImages::GetImageSize](#getimagesize)|Retrieves either the size of the toolbar images that are stored in memory (source size), or the size of the toolbar images that are drawn on the screen (destination size).|
|[CMFCToolBarImages::GetImageWell](#getimagewell)|Returns the handle to the bitmap that contains all the toolbar images.|
|[CMFCToolBarImages::GetImageWellLight](#getimagewelllight)||
|[CMFCToolBarImages::GetLastImageRect](#getlastimagerect)||
|[CMFCToolBarImages::GetLightPercentage](#getlightpercentage)||
|[CMFCToolBarImages::GetMapTo3DColors](#getmapto3dcolors)||
|[CMFCToolBarImages::GetMask](#getmask)||
|[CMFCToolBarImages::GetResourceOffset](#getresourceoffset)|Returns the image index for a specified resource ID.|
|[CMFCToolBarImages::GetScale](#getscale)|Returns current scale ratio of underlined images.|
|[CMFCToolBarImages::GetTransparentColor](#gettransparentcolor)||
|[CMFCToolBarImages::GrayImages](#grayimages)|Grays the toolbar images to make them look disabled.|
|[CMFCToolBarImages::Is32BitTransparencySupported](#is32bittransparencysupported)|Determines whether the operating system supports 32-bit alpha blending.|
|[CMFCToolBarImages::IsPreMultiplyAutoCheck](#ispremultiplyautocheck)||
|[CMFCToolBarImages::IsRTL](#isrtl)|Determines whether right-to-left (RTL) support is enabled.|
|[CMFCToolBarImages::IsReadOnly](#isreadonly)|Determines whether the toolbar images are read-only.|
|[CMFCToolBarImages::IsScaled](#isscaled)|Tells whether the underlined images are scaled or not.|
|[CMFCToolBarImages::IsUserImagesList](#isuserimageslist)|Determines whether this set of toolbar images contains user-defined images.|
|[CMFCToolBarImages::IsValid](#isvalid)|Determines whether this set of toolbar images contains a valid toolbar image.|
|[CMFCToolBarImages::Load](#load)|Loads toolbar images from system resources or from a file.|
|[CMFCToolBarImages::LoadStr](#loadstr)||
|[CMFCToolBarImages::MapFromSysColor](#mapfromsyscolor)||
|[CMFCToolBarImages::MapTo3dColors](#mapto3dcolors)||
|[CMFCToolBarImages::MapToSysColor](#maptosyscolor)||
|[CMFCToolBarImages::MapToSysColorAlpha](#maptosyscoloralpha)||
|[CMFCToolBarImages::Mirror](#mirror)|Horizontally mirrors all of the toolbar images.|
|[CMFCToolBarImages::MirrorBitmap](#mirrorbitmap)|Horizontally mirrors a bitmap.|
|[CMFCToolBarImages::MirrorBitmapVert](#mirrorbitmapvert)||
|[CMFCToolBarImages::MirrorVert](#mirrorvert)||
|[CMFCToolBarImages::OnSysColorChange](#onsyscolorchange)||
|[CMFCToolBarImages::PrepareDrawImage](#preparedrawimage)|Allocates the resources that are required to draw a toolbar image at a specified size.|
|[CMFCToolBarImages::Save](#save)|Stores the toolbar images in a file if this set of toolbar images contains user-defined images.|
|[CMFCToolBarImages::SetAlwaysLight](#setalwayslight)||
|[CMFCToolBarImages::SetDisabledImageAlpha](#setdisabledimagealpha)|Sets the alpha channel value that is used for disabled images.|
|[CMFCToolBarImages::SetFadedImageAlpha](#setfadedimagealpha)||
|[CMFCToolBarImages::SetImageSize](#setimagesize)|Sets the size of a toolbar image (source size).|
|[CMFCToolBarImages::SetLightPercentage](#setlightpercentage)||
|[CMFCToolBarImages::SetMapTo3DColors](#setmapto3dcolors)||
|[CMFCToolBarImages::SetPreMultiplyAutoCheck](#setpremultiplyautocheck)||
|[CMFCToolBarImages::SetSingleImage](#setsingleimage)||
|[CMFCToolBarImages::SetTransparentColor](#settransparentcolor)|Sets the transparent color of the toolbar images.|
|[CMFCToolBarImages::SmoothResize](#smoothresize)|Smoothly resizes underlined images.|
|[CMFCToolBarImages::UpdateImage](#updateimage)|Updates a user-defined toolbar image from a bitmap.|

### Protected Methods

|Name|Description|
|----------|-----------------|
|[CMFCToolBarImages::PreMultiplyAlpha](#premultiplyalpha)||

### Data Members

|Name|Description|
|----------|-----------------|
|[CMFCToolBarImages::m_bDisableTrueColorAlpha](#m_bdisabletruecoloralpha)|TRUE if truecolor alpha blending (32-bit color) is disabled.|

## Remarks

The full bitmap of toolbar images managed by `CMFCToolbarImages` consists of one or more small toolbar images (buttons) of a fixed size.

## Example

The following example demonstrates how to configure a `CMFCToolBarImages` object by using various methods in the `CMFCToolBarImages` class. The example shows how to set the size of the toolbar image, load an image, and set the transparent color of the image. This code snippet is part of the [Visual Studio Demo sample](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_VisualStudioDemo#32](../../mfc/codesnippet/cpp/cmfctoolbarimages-class_1.h)]
[!code-cpp[NVC_MFC_VisualStudioDemo#33](../../mfc/codesnippet/cpp/cmfctoolbarimages-class_2.cpp)]

## Inheritance Hierarchy

[CObject](../../mfc/reference/cobject-class.md)

`CMFCToolBarImages`

## Requirements

**Header:** afxtoolbarimages.h

## <a name="adaptcolors"></a> CMFCToolBarImages::AdaptColors

```cpp
void AdaptColors(
    COLORREF clrBase,
    COLORREF clrTone);
```

### Parameters

[in] *clrBase*<br/>
[in] *clrTone*<br/>

### Remarks

## <a name="addicon"></a> CMFCToolBarImages::AddIcon

Adds an icon to the list of toolbar images.

```
int AddIcon(
    HICON hIcon,
    BOOL bAlphaBlend=FALSE);
```

### Parameters

*hIcon*<br/>
[in] A handle to the icon to be added.

*bAlphaBlend*<br/>
[in] TRUE if this icon is used with alpha blending; otherwise FALSE.

### Return Value

The zero-based index of the toolbar image that was added if the method is successful; otherwise -1.

## <a name="addimage"></a> CMFCToolBarImages::AddImage

Adds a bitmap to the toolbar images.

```
int AddImage(
    HBITMAP hbmp,
    BOOL bSetBitPerPixel=FALSE);

int AddImage(
    const CMFCToolBarImages& imageList,
    int nIndex);
```

### Parameters

*hbmp*<br/>
[in] The handle to the bitmap to add.

*bSetBitPerPixel*<br/>
[in] TRUE if the `CMFCToolBarImages`  object uses the color depth (bits per pixel) of the new image; FALSE if the `CMFCToolbarImages` object keeps the current color depth.

*imageList*<br/>
[in] A reference to a `CMFCToolbarImages` object that contains the image to add.

*nIndex*<br/>
[in] The index in the source `CMFCToolbarImages` object of the image to add.

### Return Value

The number of toolbar images that the `CMFCToolBarImages`  object maintains after the new bitmap was added successfully; -1 if the operation failed.

## <a name="cleanup"></a> CMFCToolBarImages::CleanUp

```
static void __stdcall CleanUp();
```

### Remarks

## <a name="clear"></a> CMFCToolBarImages::Clear

Frees the system resources that the [CMFCToolbarImages](../../mfc/reference/cmfctoolbarimages-class.md) object allocated.

```cpp
void Clear();
```

## <a name="cmfctoolbarimages"></a> CMFCToolBarImages::CMFCToolBarImages

Constructs a `CMFCToolBarImages` object.

```
CMFCToolBarImages();
```

### Remarks

Constructs a `CMFCToolBarImages` object, initializes its rendering engine and sets the image size to its default value 16x15 pixels. Use [CMFCToolBarImages::SetImageSize](#setimagesize) to change the image size before you add images.

## <a name="copyimagetoclipboard"></a> CMFCToolBarImages::CopyImageToClipboard

```
BOOL CopyImageToClipboard(int iImage);
```

### Parameters

[in] *iImage*<br/>

### Return Value

### Remarks

## <a name="copyto"></a> CMFCToolBarImages::CopyTo

```
BOOL CopyTo(CMFCToolBarImages& imageList);
```

### Parameters

[in] *imageList*<br/>

### Return Value

### Remarks

## <a name="createfromimagelist"></a> CMFCToolBarImages::CreateFromImageList

Initializes the toolbar images from a [CImageList Class](../../mfc/reference/cimagelist-class.md) object.

```
BOOL CreateFromImageList(const CImageList& imageList);
```

### Parameters

*imageList*<br/>
[in] The image list to be used as a source for toolbar images.

### Return Value

Always returns TRUE.

### Remarks

Use this function to quickly initialize the toolbar images list from an external image list.

## <a name="createregionfromimage"></a> CMFCToolBarImages::CreateRegionFromImage

```
static HRGN __stdcall CreateRegionFromImage(
    HBITMAP bmp,
    COLORREF clrTransparent);
```

### Parameters

[in] *bmp*<br/>
[in] *clrTransparent*<br/>

### Return Value

### Remarks

## <a name="deleteimage"></a> CMFCToolBarImages::DeleteImage

Deletes the user-defined image that has a specified index from the toolbar images.

```
BOOL DeleteImage(int iImage);
```

### Parameters

*iImage*<br/>
[in] Specifies the zero-based index of the image to delete.

### Return Value

TRUE if the image was deleted successfully; FALSE if the image index is invalid, the `CMFCToolbarImages` object is temporary, the `CMFCToolbarImages` object does not contain user-defined images, or if some other error occurred.

## <a name="draw"></a> CMFCToolBarImages::Draw

Draws a single toolbar image.

```
BOOL Draw(
    CDC* pDC,
    int x,
    int y,
    int iImageIndex,
    BOOL bHilite=FALSE,
    BOOL bDisabled=FALSE,
    BOOL bIndeterminate=FALSE,
    BOOL bShadow=FALSE,
    BOOL bInactive=FALSE,
    BYTE alphaSrc=255);
```

### Parameters

*pDC*<br/>
[in] A pointer to a device context.

*x*<br/>
[in] The X coordinate of the left side of the rectangle where the image is to be drawn.

*y*<br/>
[in] The Y coordinate of the top of the rectangle where the image is to be drawn.

*iImageIndex*<br/>
[in] The zero-based index of the image to be displayed.

*bHilite*<br/>
[in] TRUE if the image is to be highlighted; otherwise FALSE.

*bDisabled*<br/>
[in] TRUE if the image is to be drawn in the disabled style; otherwise FALSE.

*bIndeterminate*<br/>
[in] TRUE if the image is to be drawn in the indeterminate state style; otherwise FALSE.

*bShadow*<br/>
[in] TRUE if the image is to be drawn with a drop shadow; otherwise FALSE.

*bInactive*<br/>
[in] TRUE if the image is to be drawn in the inactive state style; otherwise FALSE.

*alphaSrc*<br/>
[in] The alpha channel (opacity) value. A value of 255 means the image is drawn opaque. A value of 0 means the image is drawn transparent. This value is used only for 32 bit color images and for images that displayed a Windows Vista glass style.

### Return Value

TRUE if the specified image was displayed successfully; FALSE if the image index was invalid or some other error occurred.

## <a name="drawex"></a> CMFCToolBarImages::DrawEx

```
BOOL DrawEx(
    CDC* pDC,
    CRect rect,
    int iImageIndex,
    ImageAlignHorz horzAlign = ImageAlignHorzLeft,
    ImageAlignVert vertAlign = ImageAlignVertTop,
    CRect rectSrc = CRect(0, 0, 0, 0),
    BYTE alphaSrc = 255);
```

### Parameters

[in] *pDC*<br/>
[in] *rect*<br/>
[in] *iImageIndex*<br/>
[in] *horzAlign*<br/>
[in] *vertAlign*<br/>
[in] *rectSrc*<br/>
[in] *alphaSrc*<br/>

### Return Value

### Remarks

## <a name="enablertl"></a> CMFCToolBarImages::EnableRTL

```
static void __stdcall EnableRTL(BOOL bIsRTL = TRUE);
```

### Parameters

[in] *bIsRTL*<br/>

### Remarks

## <a name="enddrawimage"></a> CMFCToolBarImages::EndDrawImage

Frees system resources that [CMFCToolBarImages::PrepareDrawImage](#preparedrawimage) allocated after you draw a toolbar image by calling [CMFCToolBarImages::Draw](#draw).

```cpp
void EndDrawImage(CAfxDrawState& ds);
```

### Parameters

*ds*<br/>
[in] A reference to the `CAfxDrawState` object that was passed to the `PrepareDrawImage` method.

## <a name="extracticon"></a> CMFCToolBarImages::ExtractIcon

Returns the icon that has a specified image index from the toolbar images.

```
HICON ExtractIcon(int nIndex);
```

### Parameters

*nIndex*<br/>
[in] The zero-based index in the image list at which the image to be extracted as an icon is located.

### Return Value

A handle to the extracted icon, or NULL if *nIndex* is out of range.

## <a name="fillditheredrect"></a> CMFCToolBarImages::FillDitheredRect

Fills a rectangle with the toolbar background colors.

```
static void FillDitheredRect(
    CDC* pDC,
    const CRect& rect);
```

### Parameters

*pDC*<br/>
[in] A pointer to a device context.

*rect*<br/>
[in] The coordinates of a rectangle to fill.

### Remarks

Use this method to fill a rectangle with a color that is the average of the system colors COLOR_BTNFACE and COLOR_BTNHIGHLIGHT. If the system is using 256 or fewer colors, the rectangle will be filled with a dithered pattern of those two colors instead.

## <a name="getalwayslight"></a> CMFCToolBarImages::GetAlwaysLight

```
BOOL GetAlwaysLight() const;
```

### Return Value

### Remarks

## <a name="getcount"></a> CMFCToolBarImages::GetCount

Returns the number of images in the toolbar images list.

```
int GetCount() const;
```

### Return Value

The number of images in the `CMFCToolBarImages`  object.

## <a name="getdisabledimagealpha"></a> CMFCToolBarImages::GetDisabledImageAlpha

Returns the alpha channel (opacity) value that is used for disabled images.

```
static BYTE GetDisabledImageAlpha();
```

### Return Value

The current alpha channel value.

### Remarks

You can call [CMFCToolBarImages::SetDisabledImageAlpha](#setdisabledimagealpha) to change the alpha channel value.

## <a name="getfadedimagealpha"></a> CMFCToolBarImages::GetFadedImageAlpha

```
static BYTE __stdcall GetFadedImageAlpha();
```

### Return Value

### Remarks

## <a name="getimagesize"></a> CMFCToolBarImages::GetImageSize

Retrieves either the size of the toolbar images that are stored in memory (source size), or the size of the toolbar images that are drawn on the screen (destination size).

```
SIZE GetImageSize(BOOL bDest=FALSE) const;
```

### Parameters

*bDest*<br/>
[in] TRUE to retrieve the destination size; FALSE to retrieve the source image size.

### Return Value

A `SIZE` structure, which specifies the size of an image in pixels.

### Remarks

The size of the source image is the size of the images that are stored in the [CMFCToolbarImages](../../mfc/reference/cmfctoolbarimages-class.md) object. You can call [CMFCToolBarImages::SetImageSize](#setimagesize) to set the source size. The default value is 16x15 pixels.

By default, the destination image size is 0x0. You specify the destination size when you call [CMFCToolBarImages::PrepareDrawImage](#preparedrawimage). The [CMFCToolBarImages::EndDrawImage](#enddrawimage) method resets the destination size to the default value.

## <a name="getimagewell"></a> CMFCToolBarImages::GetImageWell

Returns the handle to the bitmap that contains all the toolbar images.

```
HBITMAP GetImageWell() const;
```

### Return Value

A handle to a bitmap that contains toolbar images.

### Remarks

The toolbar images are stored in a row in a single bitmap that is known as an *image well*. To find a toolbar image in the image well, multiply the index of the image by the width of the toolbar images (see [CMFCToolBarImages::GetImageSize](#getimagesize)) to obtain the horizontal offset of the image inside the image well.

## <a name="getimagewelllight"></a> CMFCToolBarImages::GetImageWellLight

```
HBITMAP GetImageWellLight() const;
```

### Return Value

### Remarks

## <a name="getlastimagerect"></a> CMFCToolBarImages::GetLastImageRect

```
CRect GetLastImageRect() const;
```

### Return Value

### Remarks

## <a name="getlightpercentage"></a> CMFCToolBarImages::GetLightPercentage

```
int GetLightPercentage() const;
```

### Return Value

### Remarks

## <a name="getmapto3dcolors"></a> CMFCToolBarImages::GetMapTo3DColors

```
BOOL GetMapTo3DColors() const;
```

### Return Value

### Remarks

## <a name="getmask"></a> CMFCToolBarImages::GetMask

```
HBITMAP GetMask(int iImage);
```

### Parameters

[in] *iImage*<br/>

### Return Value

### Remarks

## <a name="getresourceoffset"></a> CMFCToolBarImages::GetResourceOffset

Returns the image index for a specified resource ID.

```
int GetResourceOffset(UINT uiResId) const;
```

### Parameters

*uiResId*<br/>
[in] An image resource ID.

### Return Value

An image index if the method was successful; -1 if the image with the specified resource ID does not exist.

## <a name="gettransparentcolor"></a> CMFCToolBarImages::GetTransparentColor

```
COLORREF GetTransparentColor() const;
```

### Return Value

### Remarks

## <a name="grayimages"></a> CMFCToolBarImages::GrayImages

Grays the toolbar images to make them look disabled.

```
BOOL GrayImages(int nGrayImageLuminancePercentage);
```

### Parameters

*nGrayImageLuminancePercentage*<br/>
[in] Luminance percentage.

### Return Value

TRUE if images in the collection were grayed successfully; otherwise FALSE.

### Remarks

This method modifies the toolbar images by averaging the red, green, and blue components of each pixel and multiplying the result by *nGrayImageLuminancePercentage* divided by 100. If *nGrayImageLuminancePercentage* is zero or negative, the default value of 130 is used instead.

> [!NOTE]
> If you want to undo the change, you must reload the images from the source. You can do this by calling [CMFCToolBarImages::Load](#load) or [CMFCToolBarImages::UpdateImage](#updateimage) (only for user-defined images), or by calling [CMFCToolBarImages::Clear](#clear) and adding the images again by calling [CMFCToolBarImages::AddIcon](#addicon) or [CMFCToolBarImages::AddImage](#addimage).

## <a name="is32bittransparencysupported"></a> CMFCToolBarImages::Is32BitTransparencySupported

Specifies whether the operating system supports 32-bit alpha blending.

```
static BOOL Is32BitTransparencySupported();
```

### Return Value

TRUE if 32-bit alpha blending is supported; otherwise FALSE.

### Remarks

Use this static method to determine at runtime whether the operating system supports 32-bit alpha blending. This feature is supported on Windows 2000 and later versions.

## <a name="ispremultiplyautocheck"></a> CMFCToolBarImages::IsPreMultiplyAutoCheck

```
BOOL IsPreMultiplyAutoCheck() const;
```

### Return Value

### Remarks

## <a name="isreadonly"></a> CMFCToolBarImages::IsReadOnly

Specifies whether the toolbar images are read-only.

```
BOOL IsReadOnly() const;
```

### Return Value

TRUE if the toolbar images are read-only, otherwise FALSE.

### Remarks

The `CMFCToolbarImages` object is read-only when the bitmap with toolbar images was loaded from a read-only file, or when the bitmap was copied in using the `CMFCToolBarImages::CopyTemp` method.

## <a name="isrtl"></a> CMFCToolBarImages::IsRTL

Specifies whether right-to-left (RTL) support is enabled.

```
static BOOL IsRTL();
```

### Return Value

TRUE if RTL support is enabled; otherwise FALSE.

### Remarks

RTL support is used when the application is localized to a language that is read from right to left, such as Arabic, Hebrew, Persian, or Urdu.

## <a name="isuserimageslist"></a> CMFCToolBarImages::IsUserImagesList

Specifies whether this set of toolbar images contains user-defined images.

```
BOOL IsUserImagesList() const;
```

### Return Value

TRUE if the `CMFCToolBarImages`  object contains user-defined toolbar images; otherwise FALSE.

## <a name="isvalid"></a> CMFCToolBarImages::IsValid

Indicates whether this set of toolbar images contains a valid toolbar image.

```
BOOL IsValid() const;
```

### Return Value

TRUE if a `CMFCToolBarImages`  object is valid; otherwise FALSE.

### Remarks

The `CMFCToolBarImages` object is not valid when its handle to a bitmap with toolbar images is NULL.

## <a name="load"></a> CMFCToolBarImages::Load

Loads toolbar images from system resources or from a file.

```
BOOL Load(
    UINT uiResID,
    HINSTANCE hinstRes=NULL,
    BOOL bAdd=FALSE);

BOOL Load(
    LPCTSTR lpszBmpFileName,
    DWORD nMaxFileSize = 819200);
```

### Parameters

*uiResID*<br/>
[in] The ID of a bitmap resource.

*hinstRes*<br/>
[in] An instance of the resource DLL.

*bAdd*<br/>
[in] TRUE to add the loaded bitmap to the existing bitmap, or FALSE to replace the existing bitmap.

*lpszBmpFileName*<br/>
[in] A path to a disk file from which to load the bitmap.

*nMaxFileSize*<br/>
[in] Maximum number of bytes in the bitmap file; or 0 to load the bitmap regardless of file size. If the size of the file exceeds this maximum size, the method returns FALSE and does not load the bitmap.

### Return Value

TRUE if the bitmap was loaded successfully; otherwise FALSE.

### Remarks

If the file has the read-only attribute, the image list is marked as read-only.

## <a name="loadstr"></a> CMFCToolBarImages::LoadStr

```
BOOL LoadStr(
    LPCTSTR lpszResourceName,
    HINSTANCE hinstRes = NULL,
    BOOL bAdd = FALSE);
```

### Parameters

[in] *lpszResourceName*<br/>
[in] *hinstRes*<br/>
[in] *bAdd*<br/>

### Return Value

### Remarks

## <a name="mapfromsyscolor"></a> CMFCToolBarImages::MapFromSysColor

```
static COLORREF __stdcall MapFromSysColor(
    COLORREF color,
    BOOL bUseRGBQUAD = TRUE);
```

### Parameters

[in] *color*<br/>
[in] *bUseRGBQUAD*<br/>

### Return Value

### Remarks

## <a name="mapto3dcolors"></a> CMFCToolBarImages::MapTo3dColors

```
BOOL MapTo3dColors(
    BOOL bUseRGBQUAD = TRUE,
    COLORREF clrSrc = (COLORREF)-1,
    COLORREF clrDest = (COLORREF)-1);
```

### Parameters

[in] *bUseRGBQUAD*<br/>
[in] *clrSrc*<br/>
[in] *clrDest*<br/>

### Return Value

### Remarks

## <a name="maptosyscolor"></a> CMFCToolBarImages::MapToSysColor

```
static COLORREF __stdcall MapToSysColor(
    COLORREF color,
    BOOL bUseRGBQUAD = TRUE);
```

### Parameters

[in] *color*<br/>
[in] *bUseRGBQUAD*<br/>

### Return Value

### Remarks

## <a name="maptosyscoloralpha"></a> CMFCToolBarImages::MapToSysColorAlpha

```
static COLORREF __stdcall MapToSysColorAlpha(COLORREF color);
```

### Parameters

[in] *color*<br/>

### Return Value

### Remarks

## <a name="mirror"></a> CMFCToolBarImages::Mirror

Replaces the toolbar images with their horizontal mirror image.

```
BOOL Mirror();
```

### Return Value

TRUE if the images were successfully mirrored; otherwise FALSE.

### Remarks

This method is used to support right-to-left writing systems.

## <a name="mirrorbitmap"></a> CMFCToolBarImages::MirrorBitmap

Replaces a bitmap with its horizontal mirror image.

```
static BOOL MirrorBitmap(
    HBITMAP& hbmp,
    int cxImage);
```

### Parameters

*hbmp*<br/>
[in, out] A handle to bitmap to mirror.

*cxImage*<br/>
[in] Width of the image in pixels.

### Return Value

TRUE if the image was successfully mirrored; otherwise FALSE.

### Remarks

This function is used to support right-to-left writing systems.

## <a name="mirrorbitmapvert"></a> CMFCToolBarImages::MirrorBitmapVert

```
static BOOL __stdcall MirrorBitmapVert(
    HBITMAP& hbmp,
    int cyImage);
```

### Parameters

[in] *hbmp*<br/>
[in] *cyImage*<br/>

### Return Value

### Remarks

## <a name="mirrorvert"></a> CMFCToolBarImages::MirrorVert

```
BOOL MirrorVert();
```

### Return Value

### Remarks

## <a name="onsyscolorchange"></a> CMFCToolBarImages::OnSysColorChange

```cpp
void OnSysColorChange();
```

### Remarks

## <a name="premultiplyalpha"></a> CMFCToolBarImages::PreMultiplyAlpha

```
static BOOL __stdcall PreMultiplyAlpha(
    HBITMAP hbmp,
    BOOL bAutoCheckPremlt);

BOOL PreMultiplyAlpha(HBITMAP hbmp);
```

### Parameters

[in] *hbmp*<br/>
[in] *bAutoCheckPremlt*<br/>

### Return Value

### Remarks

## <a name="m_bdisabletruecoloralpha"></a> CMFCToolBarImages::m_bDisableTrueColorAlpha

TRUE if truecolor alpha blending (32-bit color) is disabled.

```
static BOOL m_bDisableTrueColorAlpha;
```

### Remarks

Set this member variable to FALSE to enable truecolor alpha-blending for toolbar images.

The default value is TRUE for backward compatibility.

## <a name="preparedrawimage"></a> CMFCToolBarImages::PrepareDrawImage

Allocates the resources that are required to draw a toolbar image at a specified size.

```
BOOL PrepareDrawImage(
    CAfxDrawState& ds,
    CSize sizeImageDest=CSize(0,
    0)
    BOOL bFadeInactive=FALSE);
```

### Parameters

*ds*<br/>
[in] A reference to `CAfxDrawState` structure, which stores the allocated resources between image rendering stages.

*sizeImageDest*<br/>
[in] Specifies the size of a destination image.

*bFadeInactive*<br/>
[in] TRUE if you want inactive images to be drawn faded.

### Return Value

TRUE if the resources required to draw the toolbar image were allocated successfully, otherwise FALSE.

### Remarks

After you call this method, you can call [CMFCToolBarImages::Draw](#draw) any number of times. After you finished drawing, you must call [CMFCToolBarImages::EndDrawImage](#enddrawimage) to release the resources allocated by `PrepareDrawImage`.

## <a name="save"></a> CMFCToolBarImages::Save

Stores the toolbar images in a file if this set of toolbar images contains user-defined images.

```
BOOL Save(LPCTSTR lpszBmpFileName=NULL);
```

### Parameters

*lpszBmpFileName*<br/>
A path to a disk file.

### Return Value

TRUE if the toolbar images were saved successfully; otherwise FALSE.

### Remarks

Call this method to store the user-defined images into a disk file. If *lpszBmpFileName* is NULL, the method stores the bitmap into the file from which the bitmap was loaded by the [CMFCToolBarImages::Load](#load) method.

## <a name="setalwayslight"></a> CMFCToolBarImages::SetAlwaysLight

```cpp
void SetAlwaysLight(BOOL bAlwaysLight = TRUE);
```

### Parameters

[in] *bAlwaysLight*<br/>

### Remarks

## <a name="setdisabledimagealpha"></a> CMFCToolBarImages::SetDisabledImageAlpha

Sets the alpha channel (opacity) value that is used for disabled images.

```
static void SetDisabledImageAlpha(BYTE nValue);
```

### Parameters

*nValue*<br/>
[in] The new value of the alpha channel.

### Remarks

Use this method to set a custom alpha value for disabled images. The default value is 127, which causes disabled button images to be semitransparent. If you set a value of 0, disabled images will be completely transparent. If you set a value of 255, disabled images will be completely opaque.

## <a name="setfadedimagealpha"></a> CMFCToolBarImages::SetFadedImageAlpha

```
static void __stdcall SetFadedImageAlpha(BYTE nValue);
```

### Parameters

[in] *nValue*<br/>

### Remarks

## <a name="setimagesize"></a> CMFCToolBarImages::SetImageSize

Sets the size of each toolbar image (source size).

```cpp
void SetImageSize(
    SIZE sizeImage,
    BOOL bUpdateCount=FALSE);
```

### Parameters

*sizeImage*<br/>
[in] The new size of toolbar images.

### Remarks

By default the size of the toolbar image is 16x15 pixels. Call this method if you want to use toolbar images of a different size.

## <a name="setlightpercentage"></a> CMFCToolBarImages::SetLightPercentage

```cpp
void SetLightPercentage(int nValue);
```

### Parameters

[in] *nValue*<br/>

### Remarks

## <a name="setmapto3dcolors"></a> CMFCToolBarImages::SetMapTo3DColors

```cpp
void SetMapTo3DColors(BOOL bMapTo3DColors);
```

### Parameters

[in] *bMapTo3DColors*<br/>

### Remarks

## <a name="setpremultiplyautocheck"></a> CMFCToolBarImages::SetPreMultiplyAutoCheck

```cpp
void SetPreMultiplyAutoCheck(BOOL bAuto = TRUE);
```

### Parameters

[in] *bAuto*<br/>

### Remarks

## <a name="setsingleimage"></a> CMFCToolBarImages::SetSingleImage

```cpp
void SetSingleImage();
```

### Remarks

## <a name="settransparentcolor"></a> CMFCToolBarImages::SetTransparentColor

Sets the transparent color of the toolbar images.

```
COLORREF SetTransparentColor(COLORREF clrTransparent);
```

### Parameters

*clrTransparent*<br/>
[in] An RGB value.

### Return Value

The previous transparent color.

### Remarks

When you or the framework call [CMFCToolBarImages::Draw](#draw), the method does not draw any pixel that matches the color specified by *clrTransparent*.

## <a name="updateimage"></a> CMFCToolBarImages::UpdateImage

Updates a user-defined toolbar image from a bitmap.

```
BOOL UpdateImage(
    int iImage,
    HBITMAP hbmp);
```

### Parameters

*iImage*<br/>
[in] The zero-based index of the image to update.

*hbmp*<br/>
[in] A handle to the bitmap from which to update the image.

### Return Value

TRUE if the image was updated successfully; FALSE if the image list is not user-defined or temporary.

## <a name="convertto32bits"></a> CMFCToolBarImages::ConvertTo32Bits

Converts underlined bitmaps to 32 bpp images.

```
BOOL ConvertTo32Bits(COLORREF clrTransparent = (COLORREF)-1);
```

### Parameters

*clrTransparent*<br/>
Specifies transparent color of underlined bitmaps.

### Remarks

## <a name="getbitsperpixel"></a> CMFCToolBarImages::GetBitsPerPixel

Returns current resolution of underlined images.

```
int GetBitsPerPixel() const;
```

### Return Value

An integer value representing the current resolution of underlined images, in bits per pixel (bpp).

### Remarks

## <a name="getscale"></a> CMFCToolBarImages::GetScale

Returns the current scale ratio of underlined images.

```
double GetScale() const;
```

### Return Value

A value representing the current scale ratio.

### Remarks

## <a name="isscaled"></a> CMFCToolBarImages::IsScaled

Tells whether the underlined images are scaled or not.

```
BOOL IsScaled () const;
```

### Return Value

TRUE if underlined images are scaled; otherwise FALSE.

### Remarks

## <a name="smoothresize"></a> CMFCToolBarImages::SmoothResize

Smoothly resizes underlined images.

```
BOOL SmoothResize(double dblImageScale);
```

### Parameters

*dblImageScale*<br/>
Scale ratio.

### Return Value

TRUE if resize succeeds; otherwise FALSE.

### Remarks

## See also

[Hierarchy Chart](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CObject Class](../../mfc/reference/cobject-class.md)<br/>
[CMFCToolBar Class](../../mfc/reference/cmfctoolbar-class.md)<br/>
[CMFCToolBarButton Class](../../mfc/reference/cmfctoolbarbutton-class.md)
